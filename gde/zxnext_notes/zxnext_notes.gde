@title ZX Spectrum Next Programming Notes
@author Theodore (Alex) Evans
@date 2020/12/07

@index NODE001
@-----------------------------------------------
@node NODE002
@next NODE003
@-----------------------------------------------
@node NODE001
@{r}ZX Spectrum Next Notes
@{c}Contents
@{" Contents " LINK NODE1}
@{" Introduction " LINK NODE2}
@{" Video " LINK NODE3}
@{" General Features " LINK NODE4}
@{" Video Layering and Transparency " LINK NODE5}
@{" Palette " LINK NODE6}
@{" Scrolling " LINK NODE8}
@{" Clipping " LINK NODE9}
@{" Layer 1 " LINK NODE10}
@{" Colour Attributes " LINK NODE11}
@{" Layer 1 Scrolling " LINK NODE21}
@{" Layer 1 Clipping " LINK NODE22}
@{" ZX Spectrum Mode " LINK NODE23}
@{" Alternate Page Mode " LINK NODE24}
@{" Timex Hi-Colour Mode " LINK NODE25}
@{" Timex Hi-Resolution Mode " LINK NODE26}
@{" Lo-Resolution Mode " LINK NODE27}
@{" Layer 2 " LINK NODE28}
@{" Configuration " LINK NODE29}
@{" Scrolling " LINK NODE34}
@{" Clipping " LINK NODE35}
@{" Layer 3 (Tilemap) Mode " LINK NODE36}
@{" General Description " LINK NODE37}
@{" Data Structures " LINK NODE38}
@{" Memory Organization &amp; Display Layer " LINK NODE41}
@{" Combining ULA &amp; Tilemap " LINK NODE42}
@{" Programming Tilemap mode " LINK NODE43}
@{" Sprites " LINK NODE46}
@{" Sprite Patterns " LINK NODE47}
@{" Sprite Palette " LINK NODE51}
@{" Sprite Attributes " LINK NODE52}
@{" Relative Sprites " LINK NODE53}
@{" Programming Sprites " LINK NODE54}
@{" Global Control of Sprites " LINK NODE55}
@{" Audio " LINK NODE56}
@{" ZX Spectrum 1-bit " LINK NODE57}
@{" Sampled 8-bit " LINK NODE58}
@{" Turbosound " LINK NODE59}
@{" Pi Audio " LINK NODE60}
@{" Memory " LINK NODE61}
@{" Memory Management " LINK NODE62}
@{" Default Layout " LINK NODE63}
@{" RAM " LINK NODE64}
@{" ROM " LINK NODE70}
@{" Interactions between paging methods " LINK NODE76}
@{" Memory Map " LINK NODE77}
@{" Global Memory Map " LINK NODE78}
@{" Z80 Visible Memory Map " LINK NODE79}
@{" zxnDMA " LINK NODE80}
@{" Overview " LINK NODE81}
@{" Accessing the zxnDMA " LINK NODE82}
@{" Description " LINK NODE83}
@{" Modes of Operation " LINK NODE84}
@{" Programming the zxnDMA " LINK NODE85}
@{" zxnDMA Registers " LINK NODE86}
@{" Programming examples " LINK NODE96}
@{" Copper and Display Timing " LINK NODE97}
@{" Timing " LINK NODE100}
@{" Instructions " LINK NODE108}
@{" Control " LINK NODE113}
@{" Configuration " LINK NODE118}
@{" Interrupts " LINK NODE123}
@{" Interrupt Types " LINK NODE124}
@{" Interrupt Modes " LINK NODE128}
@{" Z80 CTC " LINK NODE132}
@{" Serial Communication " LINK NODE134}
@{" Raspberry Pi0 Acceleration " LINK NODE135}
@{" System Software " LINK NODE136}
@{" CP/M " LINK NODE137}
@{" Utilities " LINK NODE138}
@{" BDOS " LINK NODE139}
@{" BIOS " LINK NODE140}
@{" System Initialization Functions " LINK NODE141}
@{" Character I/O Functions " LINK NODE142}
@{" Disk I/O Functions " LINK NODE143}
@{" Memory Select and Move Functions " LINK NODE144}
@{" Clock Support Function " LINK NODE145}
@{" NextZXOS " LINK NODE146}
@{" NextZXOS " LINK NODE147}
@{" +3DOS compatible API " LINK NODE148}
@{" esxDOS compatible API " LINK NODE149}
@{" Next Extensions " LINK NODE150}
@{" esxDOS compatible API " LINK NODE151}
@{" Ports " LINK NODE152}
@{" 8-bit " LINK NODE153}
@{" 16-bit " LINK NODE154}
@{" Registers " LINK NODE155}
@{" ZX Spectrum Next Registers " LINK NODE156}
@{" AY-3-8912 " LINK NODE157}
@{" zxDMA " LINK NODE158}
@{" Extended Opcodes to Mnemonics " LINK NODE159}
@{" Single Byte Opcodes " LINK NODE160}
@{" $CBxx Bit Operations " LINK NODE161}
@{" $DDxx IX " LINK NODE162}
@{" $EDxx Block/Port " LINK NODE163}
@{" $FDxx IY " LINK NODE164}
@{" $DDCBxx IX Bit Operations " LINK NODE165}
@{" $FDCBxx IY Bit Operations " LINK NODE166}
@{" Mnemonics to Extended Opcodes " LINK NODE167}
@{" File Formats " LINK NODE168}
@{" BAS " LINK NODE169}
@{" BMP " LINK NODE170}
@{" DSK " LINK NODE171}
@{" NDR " LINK NODE172}
@{" NEX " LINK NODE173}
@{" O " LINK NODE174}
@{" P3D " LINK NODE175}
@{" PT3 " LINK NODE176}
@{" P " LINK NODE177}
@{" SCR " LINK NODE178}
@{" SHC " LINK NODE179}
@{" SHR " LINK NODE180}
@{" SL2 " LINK NODE181}
@{" SLR " LINK NODE182}
@{" SNA " LINK NODE183}
@{" SNX " LINK NODE184}
@{" SPR " LINK NODE185}
@{" TAP " LINK NODE186}
@{" TXT,DOC,ASM,INI,CFG,MD " LINK NODE187}
@{" TZX " LINK NODE188}
@{" Z3 to Z8 " LINK NODE189}
@{" Z80 " LINK NODE190}
@{" Call Tables " LINK NODE191}
@{" BDOS Call Table " LINK NODE192}
@{" BIOS Call Table " LINK NODE193}
@{" NextZXOS Calls " LINK NODE194}
@{" +3DOS Compatible Calls " LINK NODE195}
@{" +3DOS compatible error codes " LINK NODE196}
@{" esxDOS Compatible Calls " LINK NODE197}
@{" List of Figures " LINK NODE198}
@{" List of Tables " LINK NODE199}
@{" Index " LINK NODE200}
@{" About this document ... " LINK NODE201}
node001.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Contents</TITLE>
<META NAME="description" CONTENT="Contents">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node2.html">
<LINK REL="previous" HREF="zxnext_notes.html">
<LINK REL="next" HREF="node2.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node2.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>  
<A ID="tex2html220"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node2.html">Introduction</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
 &nbsp; <B>  <A ID="tex2html221"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<BR>

<H2><A ID="SECTION00100000000000000000">
Contents</A>
</H2>
<!--Table of Contents-->

<UL CLASS="TofC">
@{" Introduction " LINK NODE2}
@{" Video " LINK NODE3}
@{" General Features " LINK NODE4}
@{" Video Layering and Transparency " LINK NODE5}
@{" Palette " LINK NODE6}
@{" Scrolling " LINK NODE8}
@{" Clipping " LINK NODE9}
</UL>
@{" Layer 1 " LINK NODE10}
@{" Colour Attributes " LINK NODE11}
@{" Layer 1 Scrolling " LINK NODE21}
@{" Layer 1 Clipping " LINK NODE22}
@{" ZX Spectrum Mode " LINK NODE23}
@{" Alternate Page Mode " LINK NODE24}
@{" Timex Hi-Colour Mode " LINK NODE25}
@{" Timex Hi-Resolution Mode " LINK NODE26}
@{" Lo-Resolution Mode " LINK NODE27}
</UL>
@{" Layer 2 " LINK NODE28}
@{" Configuration " LINK NODE29}
@{" Scrolling " LINK NODE34}
@{" Clipping " LINK NODE35}
</UL>
@{" Layer 3 (Tilemap) Mode " LINK NODE36}
@{" General Description " LINK NODE37}
@{" Data Structures " LINK NODE38}
@{" Memory Organization &amp; Display Layer " LINK NODE41}
@{" Combining ULA &amp; Tilemap " LINK NODE42}
@{" Programming Tilemap mode " LINK NODE43}
</UL>
@{" Sprites " LINK NODE46}
@{" Sprite Patterns " LINK NODE47}
@{" Sprite Palette " LINK NODE51}
@{" Sprite Attributes " LINK NODE52}
@{" Relative Sprites " LINK NODE53}
@{" Programming Sprites " LINK NODE54}
@{" Global Control of Sprites " LINK NODE55}
</UL>
</UL>
<BR>
@{" Audio " LINK NODE56}
@{" ZX Spectrum 1-bit " LINK NODE57}
@{" Sampled 8-bit " LINK NODE58}
@{" Turbosound " LINK NODE59}
@{" Pi Audio " LINK NODE60}
</UL>
</UL>
<BR>
@{" Memory " LINK NODE61}
@{" Memory Management " LINK NODE62}
@{" Default Layout " LINK NODE63}
@{" RAM " LINK NODE64}
@{" ROM " LINK NODE70}
</UL>
@{" Interactions between paging methods " LINK NODE76}
@{" Memory Map " LINK NODE77}
@{" Global Memory Map " LINK NODE78}
@{" Z80 Visible Memory Map " LINK NODE79}
</UL>
</UL>
<BR>
@{" zxnDMA " LINK NODE80}
@{" Overview " LINK NODE81}
@{" Accessing the zxnDMA " LINK NODE82}
@{" Description " LINK NODE83}
@{" Modes of Operation " LINK NODE84}
@{" Programming the zxnDMA " LINK NODE85}
@{" zxnDMA Registers " LINK NODE86}
@{" Programming examples " LINK NODE96}
</UL>
<BR>
@{" Copper and Display Timing " LINK NODE97}
@{" Timing " LINK NODE100}
@{" Instructions " LINK NODE108}
@{" Control " LINK NODE113}
@{" Configuration " LINK NODE118}
</UL>
<BR>
@{" Interrupts " LINK NODE123}
@{" Interrupt Types " LINK NODE124}
@{" Interrupt Modes " LINK NODE128}
@{" Z80 CTC " LINK NODE132}
</UL>
<BR>
@{" Serial Communication " LINK NODE134}
@{" Raspberry Pi0 Acceleration " LINK NODE135}
@{" System Software " LINK NODE136}
@{" CP/M " LINK NODE137}
@{" Utilities " LINK NODE138}
@{" BDOS " LINK NODE139}
@{" BIOS " LINK NODE140}
@{" Memory Select and Move Functions " LINK NODE144}
</UL>
@{" NextZXOS " LINK NODE146}
@{" NextZXOS " LINK NODE147}
@{" +3DOS compatible API " LINK NODE148}
@{" esxDOS compatible API " LINK NODE149}
@{" Next Extensions " LINK NODE150}
@{" esxDOS compatible API " LINK NODE151}
</UL>
</UL>
<BR>
@{" Ports " LINK NODE152}
@{" 8-bit " LINK NODE153}
@{" 16-bit " LINK NODE154}
</UL>
<BR>
@{" Registers " LINK NODE155}
@{" ZX Spectrum Next Registers " LINK NODE156}
@{" AY-3-8912 " LINK NODE157}
@{" zxDMA " LINK NODE158}
</UL>
<BR>
@{" Extended Opcodes to Mnemonics " LINK NODE159}
@{" Single Byte Opcodes " LINK NODE160}
@{" $CBxx Bit Operations " LINK NODE161}
@{" $DDxx IX " LINK NODE162}
@{" $EDxx Block/Port " LINK NODE163}
@{" $FDxx IY " LINK NODE164}
@{" $DDCBxx IX Bit Operations " LINK NODE165}
@{" $FDCBxx IY Bit Operations " LINK NODE166}
</UL>
<BR>
@{" Mnemonics to Extended Opcodes " LINK NODE167}
@{" File Formats " LINK NODE168}
@{" BAS " LINK NODE169}
@{" BMP " LINK NODE170}
@{" DSK " LINK NODE171}
@{" NDR " LINK NODE172}
@{" NEX " LINK NODE173}
@{" O " LINK NODE174}
@{" P3D " LINK NODE175}
@{" PT3 " LINK NODE176}
@{" P " LINK NODE177}
@{" SCR " LINK NODE178}
@{" SHC " LINK NODE179}
@{" SHR " LINK NODE180}
@{" SL2 " LINK NODE181}
@{" SLR " LINK NODE182}
@{" SNA " LINK NODE183}
@{" SNX " LINK NODE184}
@{" SPR " LINK NODE185}
@{" TAP " LINK NODE186}
@{" TXT,DOC,ASM,INI,CFG,MD " LINK NODE187}
@{" TZX " LINK NODE188}
@{" Z3 to Z8 " LINK NODE189}
@{" Z80 " LINK NODE190}
</UL>
<BR>
@{" Call Tables " LINK NODE191}
@{" BDOS Call Table " LINK NODE192}
@{" BIOS Call Table " LINK NODE193}
@{" NextZXOS Calls " LINK NODE194}
@{" +3DOS Compatible Calls " LINK NODE195}
@{" +3DOS compatible error codes " LINK NODE196}
@{" esxDOS Compatible Calls " LINK NODE197}
</UL>
</UL>
<BR>
@{" List of Figures " LINK NODE198}
@{" List of Tables " LINK NODE199}
@{" Index " LINK NODE200}
</UL>
<!--End of Table of Contents-->
<BR><HR>

</BODY>
</HTML>
node002.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Introduction</TITLE>
<META NAME="description" CONTENT="Introduction">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node3.html">
<LINK REL="previous" HREF="node1.html">
<LINK REL="next" HREF="node3.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node3.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node1.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html349"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html351"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node3.html">Video</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node1.html">Contents</A>
 &nbsp; <B>  <A ID="tex2html350"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html352"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00200000000000000000">
Introduction</A>
</H1>
The ZX Spectrum Next is an extension of the original ZX Spectrum
implemented in FPGA which implements many of the common additions to
the system includin the characteristics of all of the original ZX
Spectrum line, including the Timex/Sinclair 2068, along with a number
of characteristics to modernize the design.

<P>
This document is an attempt to consolidate the programming interface
for the ZX Spectrum Next into a single location. This document started
when much of the documentation on the ZX Spectrum Next site
(https://www.specnext.com/) was out of date and/or difficult to figure
out. The way to figure out how things actually worked was to either
dig through the forums and ask questions or find someones code that
implemented a particular bit of functionality and reverse engineer
it. The situation has greatly improved and this document may even be
redundant at this point.

<P>
Description from http://www.specnext.com/about/:

<P>
The Spectrum Next is fully implemented with FPGA technology, ensuring
it can be upgraded and enhanced while remaining truly compatible with
the original hardware by using special memory chips and clever
design. Here’s what under the hood of the machine:

<P>

<UL>
<LI>Processor: Z80n normal and turbo modes
</LI>
<LI>Memory: 1024Kb RAM (expandable to 2048Kb on board)
</LI>
<LI>Video: Multilayer video implementing classic ZX Spectrum, Timex
  Hi-Resolution, Timex Hi-Colour, LoRes, Layer 2, and Tilemap video
  modes with Hardware sprites
</LI>
<LI>Video Output: RGB, VGA, HDMI
</LI>
<LI>Storage: SD Card slot, with DivMMC-compatible protocol
</LI>
<LI>Audio: ZX Spectrum 1-bit audio, Turbo Sound Next (3x AY-3-8912
  audio chips with stereo output), stereo PCM audio, and ability to
  use Pi accelerator as a sound source
</LI>
<LI>Joystick: DB9 compatible with Cursor, Kempston and Interface 2
  protocols (selectable)
</LI>
<LI>PS/2 port: Mouse with Kempston mode emulation and an external keyboard
</LI>
<LI>Special: Multiface functionality for memory access, savegames,
  cheats etc.
</LI>
<LI>Tape support: Mic and Ear ports for tape loading and saving
</LI>
<LI>Expansion: Original external bus expansion port and accelerator
  expansion port
</LI>
<LI>Accelerator board (optional): Pi Zero with GPU / 1Ghz CPU / 512Mb RAM
</LI>
<LI>Network (optional): Wi Fi module
</LI>
<LI>Extras: Real Time Clock (optional), internal speaker (optional)
</LI>
</UL>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node3.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node1.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html349"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html351"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node3.html">Video</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node1.html">Contents</A>
 &nbsp; <B>  <A ID="tex2html350"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html352"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node003.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Video</TITLE>
<META NAME="description" CONTENT="Video">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node56.html">
<LINK REL="previous" HREF="node2.html">
<LINK REL="next" HREF="node4.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node4.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node2.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html353"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html355"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node4.html">General Features</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node2.html">Introduction</A>
 &nbsp; <B>  <A ID="tex2html354"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html356"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00300000000000000000">
Video</A>
</H1>

<P>
ZX Spectrum Next video splits the display types into four categories
(layer 1 (ULA/Timex/LoRes), layer 2, layer 3 (tilemap) and sprites)
which have their own sets of controls for colour palettes, clipping,
and scrolling. Some aspects of ULA and tilemap are tied together, but
all the rest operate in a largely independent manner using a layering
system. The ULA category has a number of separate video modes that it
can use. One of these (LoRes) is incompatible with using tilemaps
(This may have change in the most recent cores).

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" General Features " LINK NODE4}
@{" Video Layering and Transparency " LINK NODE5}
@{" Palette " LINK NODE6}
@{" Next Colour Palettes " LINK NODE7}
</UL>
@{" Scrolling " LINK NODE8}
@{" Clipping " LINK NODE9}
</UL>
<BR>
@{" Layer 1 " LINK NODE10}
@{" Colour Attributes " LINK NODE11}
@{" ULA Colour " LINK NODE12}
@{" ULANext " LINK NODE13}
@{" ULAplus " LINK NODE14}
</UL>
@{" Layer 1 Scrolling " LINK NODE21}
@{" Layer 1 Clipping " LINK NODE22}
@{" ZX Spectrum Mode " LINK NODE23}
@{" Alternate Page Mode " LINK NODE24}
@{" Timex Hi-Colour Mode " LINK NODE25}
@{" Timex Hi-Resolution Mode " LINK NODE26}
@{" Lo-Resolution Mode " LINK NODE27}
</UL>
<BR>
@{" Layer 2 " LINK NODE28}
@{" Configuration " LINK NODE29}
<LI><A ID="tex2html377"
  HREF="node30.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN>, Write only overlaid on ROM</A>
<LI><A ID="tex2html378"
  HREF="node31.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution</A>
<LI><A ID="tex2html379"
  HREF="node32.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img2.svg"
 ALT="$320\times 256$"></SPAN> resolution</A>
<LI><A ID="tex2html380"
  HREF="node33.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img3.svg"
 ALT="$640\times 256$"></SPAN> resolution</A>
</UL>
@{" Scrolling " LINK NODE34}
@{" Clipping " LINK NODE35}
</UL>
<BR>
@{" Layer 3 (Tilemap) Mode " LINK NODE36}
@{" General Description " LINK NODE37}
@{" Data Structures " LINK NODE38}
@{" Tilemap " LINK NODE39}
@{" Tile Definitions " LINK NODE40}
</UL>
@{" Memory Organization &amp; Display Layer " LINK NODE41}
@{" Combining ULA &amp; Tilemap " LINK NODE42}
@{" Programming Tilemap mode " LINK NODE43}
@{" Changes Since 2.00.26 " LINK NODE44}
@{" Future Direction " LINK NODE45}
</UL>
</UL>
<BR>
@{" Sprites " LINK NODE46}
@{" Sprite Patterns " LINK NODE47}
@{" Pattern Number " LINK NODE48}
</UL>
@{" Sprite Palette " LINK NODE51}
@{" Sprite Attributes " LINK NODE52}
@{" Relative Sprites " LINK NODE53}
@{" Programming Sprites " LINK NODE54}
@{" Global Control of Sprites " LINK NODE55}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node004.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>General Features</TITLE>
<META NAME="description" CONTENT="General Features">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node10.html">
<LINK REL="previous" HREF="node3.html">
<LINK REL="next" HREF="node5.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html401"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html403"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node5.html">Video Layering and Transparency</A>
<B> Up:</B> <A
 HREF="node3.html">Video</A>
<B> Previous:</B> <A
 HREF="node3.html">Video</A>
 &nbsp; <B>  <A ID="tex2html402"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html404"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00310000000000000000">
General Features</A>
</H1>
There are a number of control features for the various video modes
that are done in a unified fashion. These features are layering and
transparency, palettes, scrolling, and clipping. For the sake of
convenience we will occasionally talk about a global coordinate system
for graphics on the ZX Next. This coordinate system has (0, 0) at the
upper left corner of the usable display area and (319, 255) at the
lower right corner. Individual pixels generally correspond to integer
locations in this grid, but some modes may either double or halve this
grid. This will be discussed in the sections for each of the video
layers.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Video Layering and Transparency " LINK NODE5}
@{" Palette " LINK NODE6}
@{" Next Colour Palettes " LINK NODE7}
</UL>
<BR>
@{" Scrolling " LINK NODE8}
@{" Clipping " LINK NODE9}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node005.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Video Layering and Transparency</TITLE>
<META NAME="description" CONTENT="Video Layering and Transparency">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node6.html">
<LINK REL="previous" HREF="node4.html">
<LINK REL="next" HREF="node6.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node6.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node4.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node4.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html410"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html412"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node6.html">Palette</A>
<B> Up:</B> <A
 HREF="node4.html">General Features</A>
<B> Previous:</B> <A
 HREF="node4.html">General Features</A>
 &nbsp; <B>  <A ID="tex2html411"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html413"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00311000000000000000">
Video Layering and Transparency</A>
</H2>
Video for the ZX Next is composed of a number of features and layers
each of which may have its own set of video modes. Not all of these
features are mandatory.

<P>
By composing together the border colour and transparency fallback
color, layer 1 (ULA, Timex modes, or LoRes), layer 2
(<!-- MATH
 $256\times192\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img7.svg"
 ALT="$256\times192\times256$"></SPAN>, <!-- MATH
 $320\times256\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img8.svg"
 ALT="$320\times256\times256$"></SPAN>, or
<!-- MATH
 $640\times256\times16$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img9.svg"
 ALT="$640\times256\times16$"></SPAN>), layer 3 (16 or 2 colour tiles), and sprites;
we generate the full video display.

<P>
The border/transparency fallback is the bottom with the ordering of
the layers controlled by a combination of the video layering register
(Next register $15 (21) bits 4-2), the interaction of layers 1 and 3
(Next register $6B (107) bit 0), and whether or not a pixel in layer
2 is set as a priority colour.

<P>
Register (R/W) $15 (15) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite and Layer System Setup

<UL>
<LI>bit 7 = LoRes mode (0 on reset)
</LI>
<LI>bit 6 = Sprite priority (1 = sprite 0 on top, 0 = sprite 127 on
  top) (0 on reset)
</LI>
<LI>bit 5 = Enable sprite clipping in over border mode (0 on reset)
</LI>
<LI>bits 4-2 = set layers priorities (000 on reset)
  
<UL>
<LI>000 - S L U
</LI>
<LI>001 - L S U
</LI>
<LI>010 - S U L
</LI>
<LI>011 - L U S
</LI>
<LI>100 - U S L
</LI>
<LI>101 - U L S
</LI>
<LI>110 - S(U+L) ULA and Layer 2 combined, colours clamped to 7
</LI>
<LI>111 - S(U+L-5) ULA and Layer 2 combined, colours clamped to [0,7]
  
</LI>
</UL>
</LI>
<LI>bit 1 = Enable Sprites Over border (0 on reset)
</LI>
<LI>bit 0 = Enable Sprites (0 on reset)
</LI>
</UL>

<P>
<A NAME="90"></A>
Transparency for Layer 2, Layer 1, and 1-bit Tilemaps are
controlled by Next register $14 (20) and defaults to $E3. Sprites
and 4-bit Tilemaps have their own registers ($4B and $4C
respectively) for setting their transparency index (not colour). This
colour ignores the state of the least significant blue bit, so $E3
equates to both $1C6 and $1C7. For Sprites and Tilemaps transparency
is determined by colour index. For Sprites this is controlled by
register $4B (with only the least significant 4-bits being relevant
for 16-colour Sprites). For Tilemaps, the transparency index is set by
register $4C. If all layers are transparent, the transparency
fallback colour is displayed. This is set by register $4A.

<P>
Register (R/W) $14 (14) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Global transparency color

<UL>
<LI>bits 7-0 = Transparency color value ($E3 after a reset)
</LI>
</UL>
(Note: this value is 8-bit, so the transparency is compared against
only by the MSB bits of the final 9-bit colour)
<BR>(Note2: this only affects Layer 2, ULA and LoRes. Sprites use register
$4B for transparency and tilemap uses nextreg $4C)

<P>
Register (R/W) $4A (4A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Fallback Colour Value

<UL>
<LI>bits 7-0 = 8-bit colour if all layers are transparent ($E3 on
  reset)
</LI>
</UL>
(black on reset = 0)

<P>
Register (R/W) $4B (4B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Transparency Index

<UL>
<LI>bits 7-0 = Index value ($E3 if reset)
</LI>
</UL>
For 4-bit sprites only the bottom 4-bits are relevant.

<P>
Register (R/W) $4C (4C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Level 3 Transparency Index

<UL>
<LI>bits 7-4 = Reserved, must be 0
</LI>
<LI>bits 3-0 = Index value ($0F on reset)
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node6.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node4.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node4.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html410"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html412"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node6.html">Palette</A>
<B> Up:</B> <A
 HREF="node4.html">General Features</A>
<B> Previous:</B> <A
 HREF="node4.html">General Features</A>
 &nbsp; <B>  <A ID="tex2html411"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html413"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node006.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Palette</TITLE>
<META NAME="description" CONTENT="Palette">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node8.html">
<LINK REL="previous" HREF="node5.html">
<LINK REL="next" HREF="node7.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node7.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node4.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node5.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html414"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html416"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node7.html">Next Colour Palettes</A>
<B> Up:</B> <A
 HREF="node4.html">General Features</A>
<B> Previous:</B> <A
 HREF="node5.html">Video Layering and Transparency</A>
 &nbsp; <B>  <A ID="tex2html415"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html417"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00312000000000000000"></A>
<A NAME="112"></A>
<BR>
Palette
</H2>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
@{" Next Colour Palettes " LINK NODE7}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node007.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Next Colour Palettes</TITLE>
<META NAME="description" CONTENT="Next Colour Palettes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node6.html">
<LINK REL="next" HREF="node8.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node6.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html419"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html421"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node8.html">Scrolling</A>
<B> Up:</B> <A
 HREF="node6.html">Palette</A>
<B> Previous:</B> <A
 HREF="node6.html">Palette</A>
 &nbsp; <B>  <A ID="tex2html420"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html422"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00312010000000000000">
Next Colour Palettes</A>
</H4>
Each video mode group has a pair of palettes assigned to it a primary
and an alternate palette. Each palette entry is actually a 9-bit value
(RRRGGGBBB) and can be set by selecting a palette using nextreg $43
(palette control), the entry using nextreg $40 (palette index), then
writing the value into nextreg $44 (palette value, 9-bit) using pairs
of consecutive writes for each palette value or nextreg $41 (palette
value, 8-bit). Once a palette index has been selected writes
automatically increment the palette index number so it is possible to
efficiently write the values for a collection of palette entries.

<P>
Register (R/W) $40 (40) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Palette Index Select

<UL>
<LI>bits 7-0 = Palette Index Number
</LI>
</UL>
Selects the palette index to change the associated colour

<P>
For ULA only, INKs are mapped to indices 0 through 7, BRIGHT INKs to
indices 8 through 15, PAPERs to indices 16 through 23 and BRIGHT
PAPERs to indices 24 through 31.  In EnhancedULA mode, INKs come from
a subset of indices from 0 through 127 and PAPERs from a subset of
indices from 128 through 255.

<P>
The number of active indices depends on the number of attribute bits
assigned to INK and PAPER out of the attribute byte.

<P>
In ULAplus mode, the last 64 entries (indices 192 to 255) hold the
ULAplus palette.  The ULA always takes border colour from PAPER for
standard ULA and Enhanced ULA

<P>
Register (R/W) $41 (41) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> 8-bit Palette Data

<UL>
<LI>bits 7-0 = Colour Entry in RRRGGGBB format
</LI>
</UL>
The lower blue bit of the 9-bit internal colour will be the logical or
of bits 0 and 1 of the 8-bit entry. After each write, the palette
index auto-increments if aut-increment has been enabled (NextReg $43
bit 7), Reads do not auto-increment.

<P>
Register (R/W) $43 (43) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Palette Control

<UL>
<LI>bit 7 = Disable palette write auto-increment.
</LI>
<LI>bits 6-4 = Select palette for reading or writing:
  
<UL>
<LI>000 = ULA first palette
</LI>
<LI>100 = ULA second palette
</LI>
<LI>001 = Layer 2 first palette
</LI>
<LI>101 = Layer 2 second palette
</LI>
<LI>010 = Sprite first palette
</LI>
<LI>110 = Sprite second palette
</LI>
<LI>011 = Layer 3 first palette
</LI>
<LI>111 = Layer 3 second palette
  
</LI>
</UL>
</LI>
<LI>bit 3 = Select Sprite palette (0 = first palette, 1 = second
  palette)
</LI>
<LI>bit 2 = Select Layer 2 palette (0 = first palette, 1 = second
  palette)
</LI>
<LI>bit 1 = Select ULA palette (0 = first palette, 1 = second
  palette)
</LI>
<LI>bit 0 = Enable EnhancedULA mode if 1. (0 after a reset)
</LI>
</UL>

<P>
Register (R/W) $44 (44) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> 9-bit Palette Data
<BR>
Non Level 2
<table width="90%"><tr><td valign="top">&nbsp;1st write
bits 7-0 = MSB (RRRGGGBB)</td></tr>
<tr><td valign="top">&nbsp;2nd write
bits 7-1 = Reserved, must be 0
bit 0 = LSB (B)
</td></tr></table>

Level 2
<table width="90%"><tr><td valign="top">&nbsp;1st write
bits 7-0 = MSB (RRRGGGBB)</td></tr>
<tr><td valign="top">&nbsp;2nd write
bit 7 = Priority
bits 6-1 = Reserved, must be 0
bit 0 = LSB (B)
</td></tr></table>

9-bit Palette Data is entered in two consecutive writes; the second
write autoincrements the palette index if auto-increment is enabled in
NextREG $43 bit 7

<P>
If writing an L2 palette, the second write's D7 holds the L2 priority
bit which if set (1) brings the colour defined at that index on top of
all other layers. If you also need the same colour in regular priority
(for example: for enviromental masking) you will have to set it up
again, this time with no priority.

<P>
Reads return the second byte and do not autoincrement. Writes to
nextreg $40, $41, $41, or $43 reset to the first write.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node8.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node6.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node6.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html419"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html421"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node8.html">Scrolling</A>
<B> Up:</B> <A
 HREF="node6.html">Palette</A>
<B> Previous:</B> <A
 HREF="node6.html">Palette</A>
 &nbsp; <B>  <A ID="tex2html420"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html422"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node008.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Scrolling</TITLE>
<META NAME="description" CONTENT="Scrolling">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node9.html">
<LINK REL="previous" HREF="node6.html">
<LINK REL="next" HREF="node9.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node9.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node4.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node7.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html423"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html425"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node9.html">Clipping</A>
<B> Up:</B> <A
 HREF="node4.html">General Features</A>
<B> Previous:</B> <A
 HREF="node7.html">Next Colour Palettes</A>
 &nbsp; <B>  <A ID="tex2html424"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html426"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00313000000000000000">
Scrolling</A>
</H2>
The ZX Spectrum Next has four sets of scrolling registers to
independently contol the display offsets of various video modes
(Layer2, ULA, Tilemap, and LoRes). When the video is offset, the
portion that is pushed off the screen (to the left and or top) then
becomes visible on the opposite side of the screen so that the video
offset values are effectively the coordinates of the origin in a
toroidal universe.

<P>
<BR><HR>

</BODY>
</HTML>
node009.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Clipping</TITLE>
<META NAME="description" CONTENT="Clipping">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node8.html">
<LINK REL="next" HREF="node10.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node10.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node4.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node8.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html427"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html429"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Up:</B> <A
 HREF="node4.html">General Features</A>
<B> Previous:</B> <A
 HREF="node8.html">Scrolling</A>
 &nbsp; <B>  <A ID="tex2html428"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html430"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00314000000000000000">
Clipping</A>
</H2>
The ZX Spectrum Next has four clipping registers create a window of
the layer that is visible. Clipping is managed by a set of four
successive writes to the clipping register applicable for the video
mode. If a section is masked off by clipping, it is as if the area
were the transparency colour and the video lyers behind it become
visible.
<BR><HR>

</BODY>
</HTML>
node010.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 1</TITLE>
<META NAME="description" CONTENT="Layer 1">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node28.html">
<LINK REL="previous" HREF="node4.html">
<LINK REL="next" HREF="node11.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node11.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node9.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html431"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html433"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node11.html">Colour Attributes</A>
<B> Up:</B> <A
 HREF="node3.html">Video</A>
<B> Previous:</B> <A
 HREF="node9.html">Clipping</A>
 &nbsp; <B>  <A ID="tex2html432"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html434"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00320000000000000000">
Layer 1</A>
</H1>
<BR><P></P>
<DIV class="CENTER">

<DIV class="CENTER"><A ID="142"></A>
<TABLE class="PAD  BORDER" style="">
<CAPTION><STRONG>Table 2.1:</STRONG>
Layer 1 Mode summary</CAPTION>
<TR><TD CLASS="LEFT">Mode</TD>
<TD CLASS="CENTER">Resolution</TD>
<TD CLASS="CENTER">Colour</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">ULA</TD>
<TD CLASS="CENTER">256<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>192</TD>
<TD CLASS="CENTER">ULA 8<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>8</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">Timex Alt</TD>
<TD CLASS="CENTER">256<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>192</TD>
<TD CLASS="CENTER">ULA 8<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>8</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">HiCol</TD>
<TD CLASS="CENTER">256<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>192</TD>
<TD CLASS="CENTER">ULA 8<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>1</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">HiRes</TD>
<TD CLASS="CENTER">512<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>192</TD>
<TD CLASS="CENTER">2 colours</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">128 Alt</TD>
<TD CLASS="CENTER">256<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>192</TD>
<TD CLASS="CENTER">ULA 8<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>8</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">LoRes</TD>
<TD CLASS="CENTER">128<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>96</TD>
<TD CLASS="CENTER">256 colours</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">Rad</TD>
<TD CLASS="CENTER">128<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img11.svg"
 ALT="$\times$"></SPAN>96</TD>
<TD CLASS="CENTER">16 colours</TD>
<TD CLASS="CENTER">&nbsp;</TD>
</TR>
</TABLE></DIV>
</DIV>
<BR>

<P>
The Layer 1 consists of ZX Spectrum ULA video, Timex video modes, and
the Spectrum Next’s lores video modes all use 16k memory bank 5 or 7
with the data coming from some combination of addresses $0000-$17FF
(bitmap 1), $1800-$1AFF (attribute 1), $2000-$37FF (bitmap 2), and
$3800-$3AFF (attribute 2) within the selected bank.  Assuming
default memory mapping and the use of bank 5 this will be mapped as
some combination of memory $4000-$57FF, $5800-$5AFF,
$6000-$77FF, $780-$7AFF. All of the modes other than the lores
mode can either use the default ZX Spectrum colours, ULANext mode, or
an emulation of ULAplus. In the Spectrum and Timex modes all colours are
either Paper (foreground), paper (background), or border colours.

<P>
<BR><P></P>
<DIV class="CENTER">
  
  <DIV class="CENTER">  <A ID="148"></A>
<TABLE class="PAD  BORDER" style="">
<CAPTION><STRONG>Table 2.2:</STRONG>
Layer 1 Memory Map</CAPTION>
<TR><TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">BM 1</TD>
<TD CLASS="LEFT">Attr 1</TD>
<TD CLASS="LEFT">BM 2</TD>
<TD CLASS="CENTER">Attr 2</TD>
<TD CLASS="LEFT">BM a</TD>
<TD CLASS="LEFT">Attr a</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">Bank</TD>
<TD CLASS="LEFT">5</TD>
<TD CLASS="LEFT">5</TD>
<TD CLASS="LEFT">5</TD>
<TD CLASS="CENTER">5</TD>
<TD CLASS="LEFT">7</TD>
<TD CLASS="LEFT">7</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">start</TD>
<TD CLASS="LEFT">$0000</TD>
<TD CLASS="LEFT">$1800</TD>
<TD CLASS="LEFT">$2000</TD>
<TD CLASS="CENTER">$3800</TD>
<TD CLASS="LEFT">$0000</TD>
<TD CLASS="LEFT">$1800</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">end</TD>
<TD CLASS="LEFT">$17FF</TD>
<TD CLASS="LEFT">$1AFF</TD>
<TD CLASS="LEFT">$37FF</TD>
<TD CLASS="CENTER">$3AFF</TD>
<TD CLASS="LEFT">$17FF</TD>
<TD CLASS="LEFT">$1AFF</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">ULA</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">Timex Alt</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="CENTER">*</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">HiCol</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">HiRes</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">128 Alt</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">LoRes</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">*</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">Rad</TD>
<TD CLASS="LEFT">1</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">2</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="CENTER">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE></DIV>
</DIV>
<BR>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Colour Attributes " LINK NODE11}
@{" ULA Colour " LINK NODE12}
@{" ULANext " LINK NODE13}
@{" ULAplus " LINK NODE14}
@{" I/O ports " LINK NODE15}
@{" GRB palette entries " LINK NODE16}
@{" Grayscale palette entries " LINK NODE17}
@{" Limitations " LINK NODE18}
@{" Emulation " LINK NODE19}
@{" Palette file format " LINK NODE20}
</UL>
</UL>
<BR>
@{" Layer 1 Scrolling " LINK NODE21}
@{" Layer 1 Clipping " LINK NODE22}
@{" ZX Spectrum Mode " LINK NODE23}
@{" Alternate Page Mode " LINK NODE24}
@{" Timex Hi-Colour Mode " LINK NODE25}
@{" Timex Hi-Resolution Mode " LINK NODE26}
@{" Lo-Resolution Mode " LINK NODE27}
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node11.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node9.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html431"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html433"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node11.html">Colour Attributes</A>
<B> Up:</B> <A
 HREF="node3.html">Video</A>
<B> Previous:</B> <A
 HREF="node9.html">Clipping</A>
 &nbsp; <B>  <A ID="tex2html432"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html434"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node011.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Colour Attributes</TITLE>
<META NAME="description" CONTENT="Colour Attributes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node21.html">
<LINK REL="previous" HREF="node10.html">
<LINK REL="next" HREF="node12.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node12.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html452"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html454"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node12.html">ULA Colour</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node10.html">Layer 1</A>
 &nbsp; <B>  <A ID="tex2html453"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html455"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00321000000000000000">
Colour Attributes</A>
</H2>
The ZX Spectrum Next has three major modes for colour attributes: the
ZX Spectrum attribute mapping, which is augmented by using the ZX
Spectrum Next's palette; ULANext, which allows the user to how many
foreground and how many background colous are to be selected by the
attribute bytes; and an emulation of ULAplus.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
@{" ULA Colour " LINK NODE12}
@{" ULANext " LINK NODE13}
@{" ULAplus " LINK NODE14}
@{" I/O ports " LINK NODE15}
@{" GRB palette entries " LINK NODE16}
@{" Grayscale palette entries " LINK NODE17}
@{" Limitations " LINK NODE18}
@{" Emulation " LINK NODE19}
@{" Palette file format " LINK NODE20}
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node012.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ULA Colour</TITLE>
<META NAME="description" CONTENT="ULA Colour">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node13.html">
<LINK REL="previous" HREF="node11.html">
<LINK REL="next" HREF="node13.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node13.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node11.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node11.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html465"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html467"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node13.html">ULANext</A>
<B> Up:</B> <A
 HREF="node11.html">Colour Attributes</A>
<B> Previous:</B> <A
 HREF="node11.html">Colour Attributes</A>
 &nbsp; <B>  <A ID="tex2html466"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html468"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00321010000000000000">
ULA Colour</A>
</H4>
In ULA colour INKs are mapped to indices 0-7, Bright INKS to indices
8-15, PAPERs to indices 16-23 and Bright PAPERs to indices 24-31. This
is the default state for interpreting ULA palettes.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="156"></A>
<TABLE>
<CAPTION><STRONG>Table 2.3:</STRONG>
ULA Colour</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img12.svg"
 ALT="\begin{table}\centering
\csvautotabular{video/flash.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node013.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ULANext</TITLE>
<META NAME="description" CONTENT="ULANext">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node14.html">
<LINK REL="previous" HREF="node12.html">
<LINK REL="next" HREF="node14.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node14.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node11.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node12.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html469"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html471"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Up:</B> <A
 HREF="node11.html">Colour Attributes</A>
<B> Previous:</B> <A
 HREF="node12.html">ULA Colour</A>
 &nbsp; <B>  <A ID="tex2html470"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html472"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00321020000000000000">
ULANext</A>
</H4>
The ULANext modes use a varying number of bits from the attribute
byte to determine the ink colours as the palette index from the
appropriate bits (all others being zero) and the paper colours coming
from the indicated value+128 with palette format 255 being a special
case where all the bits determine the ink colour while the paper is
always palette index 128. The ULA always takes border colour from
paper. ULANext is enabled using bit 0 of nextreg $43 (palette
control) and controlled with nextreg $42 (ULA Next attribute byte
format)

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="161"></A>
<TABLE>
<CAPTION><STRONG>Table 2.4:</STRONG>
ULANext</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img13.svg"
 ALT="\begin{table}\centering
\csvautotabular{video/palfmt.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node014.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ULAplus</TITLE>
<META NAME="description" CONTENT="ULAplus">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node13.html">
<LINK REL="next" HREF="node15.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node15.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node11.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node13.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html473"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html475"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node15.html">I/O ports</A>
<B> Up:</B> <A
 HREF="node11.html">Colour Attributes</A>
<B> Previous:</B> <A
 HREF="node13.html">ULANext</A>
 &nbsp; <B>  <A ID="tex2html474"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html476"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00321030000000000000">
ULAplus</A>
</H4>
The ZX Next emulates ULAPlus using the last 64 (192-255) entries of
the ULA palette. ULAplus is controlled using two ports: $BF3B (register
port) and $FF3B (data port)

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" I/O ports " LINK NODE15}
@{" GRB palette entries " LINK NODE16}
@{" Grayscale palette entries " LINK NODE17}
@{" Limitations " LINK NODE18}
@{" Emulation " LINK NODE19}
@{" Palette file format " LINK NODE20}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node015.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>I/O ports</TITLE>
<META NAME="description" CONTENT="I/O ports">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node16.html">
<LINK REL="previous" HREF="node14.html">
<LINK REL="next" HREF="node16.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node16.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html483"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html485"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node16.html">GRB palette entries</A>
<B> Up:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Previous:</B> <A
 HREF="node14.html">ULAplus</A>
 &nbsp; <B>  <A ID="tex2html484"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html486"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00321031000000000000">
I/O ports</A>
</H5>
ULAplus is controlled by two ports.

<P>
$BF3B is the register port (write only)

<P>
The byte output will be interpreted as follows:
<table width="90%">
Bits 7-6: Select the register group. Two groups are currently available:
  
<UL>
<LI>00=palette group
<BR>
When this group is selected, the sub-group determines the entry in the
    palette table (0-63).
</LI>
<LI>01=mode group
<BR>
The sub-group is (optionally) used to mirror the video functionality
    of Timex port $FF as follows:
  
</LI>
</UL>
Bits 5-0: Select the register sub-group<tr><td valign="top">&nbsp;Mode group
Bits 5-3: Sets the screen colour in hi-res mode.
  
<UL>
<LI>000=Black on White
</LI>
<LI>001=Blue on Yellow
</LI>
<LI>010=Red on Cyan
</LI>
<LI>011=Magenta on Green
</LI>
<LI>100=Green on Magenta
</LI>
<LI>101=Cyan on Red
</LI>
<LI>110=Yellow on Blue
</LI>
<LI>111=White on Black
  
</LI>
</UL>
Bits 2-0: Screen mode.
  
<UL>
<LI>000=screen 0 (bank 5)
</LI>
<LI>001=screen 1 (bank 5)
</LI>
<LI>010=hi-colour (bank 5)
</LI>
<LI>100=screen 0 (bank 7)
</LI>
<LI>101=screen 1 (bank 7)
</LI>
<LI>110=hi-colour (bank 7)
</LI>
<LI>110=hi-res (bank 5)
</LI>
<LI>111=hi-res (bank 7)
  
</LI>
</UL></td></tr></table>

<P>
$FF3B is the data port (read/write)

<P>
When the palette group is selected, the byte written will describe the
color.

<P>
When the mode group is selected, the byte output will be interpreted
as follows:

<UL>
<LI>Bit 0: ULAplus palette on (1) / off (0)
</LI>
<LI>Bit 1: (optional) grayscale: on (1) / off (0) (same as turing
  the color off on the television)
</LI>
</UL>

<P>
Implementations that support the Timex video modes use the $FF
register as the primary means to set the video mode, as per the Timex
machines. It is left to the individual implementations to determine if
reading the port returns the previous write or the floating bus.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node16.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html483"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html485"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node16.html">GRB palette entries</A>
<B> Up:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Previous:</B> <A
 HREF="node14.html">ULAplus</A>
 &nbsp; <B>  <A ID="tex2html484"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html486"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node016.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>GRB palette entries</TITLE>
<META NAME="description" CONTENT="GRB palette entries">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node17.html">
<LINK REL="previous" HREF="node15.html">
<LINK REL="next" HREF="node17.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node17.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node15.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html487"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html489"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node17.html">Grayscale palette entries</A>
<B> Up:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Previous:</B> <A
 HREF="node15.html">I/O ports</A>
 &nbsp; <B>  <A ID="tex2html488"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html490"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00321032000000000000">
GRB palette entries</A>
</H5>

<P>
G3R3B2 encoding
<BR>
For a device using the GRB colour space the palette entry is
interpreted as follows

<UL>
<LI>Bits 7-5: Green intensity.
</LI>
<LI>Bits 4-2: Red intensity.
</LI>
<LI>Bits 1-0: Blue intensity.
</LI>
</UL>

<P>
This colour space uses a sub-set of 9-bit GRB. The missing lowest blue
bit is set to OR of the other two blue bits (Bb becomes 000 for 00,
and Bb1 for anything else). This gives access to a fixed half the
potential 512 colour palette. The reduces the jump in intensity in the
lower range in the earlier version of the specification. It also means
the standard palette can now be represented by the ULAplus palette.

<P>
<BR><HR>

</BODY>
</HTML>
node017.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Grayscale palette entries</TITLE>
<META NAME="description" CONTENT="Grayscale palette entries">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node18.html">
<LINK REL="previous" HREF="node16.html">
<LINK REL="next" HREF="node18.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node18.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node16.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html491"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html493"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node18.html">Limitations</A>
<B> Up:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Previous:</B> <A
 HREF="node16.html">GRB palette entries</A>
 &nbsp; <B>  <A ID="tex2html492"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html494"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00321033000000000000">
Grayscale palette entries</A>
</H5>
This is an optional ULAPlus feature that is not supported on the Next.

<P>
In grayscale mode, each palette entry describes an intensity from zero
to 255. This can be achieved by simply removing the colour from the
output signal.

<P>
<BR><HR>

</BODY>
</HTML>
node018.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Limitations</TITLE>
<META NAME="description" CONTENT="Limitations">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node19.html">
<LINK REL="previous" HREF="node17.html">
<LINK REL="next" HREF="node19.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node19.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node17.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html495"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html497"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node19.html">Emulation</A>
<B> Up:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Previous:</B> <A
 HREF="node17.html">Grayscale palette entries</A>
 &nbsp; <B>  <A ID="tex2html496"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html498"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00321034000000000000">
Limitations</A>
</H5>
Although in theory 64 colours can be displayed at once, in practice
this is usually not possible except when displaying colour bars,
because the four CLUTs are mutually exclusive; it is not possible to
mix colours from two CLUTs in the same cell. However, with software
palette cycling it is possible to display all 256 colours on screen at
once.

<P>
<BR><HR>

</BODY>
</HTML>
node019.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Emulation</TITLE>
<META NAME="description" CONTENT="Emulation">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node20.html">
<LINK REL="previous" HREF="node18.html">
<LINK REL="next" HREF="node20.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node20.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node18.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html499"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html501"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node20.html">Palette file format</A>
<B> Up:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Previous:</B> <A
 HREF="node18.html">Limitations</A>
 &nbsp; <B>  <A ID="tex2html500"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html502"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00321035000000000000">
Emulation</A>
</H5>
The 64 colour mode lookup table is organized as 4 palettes of 16
colours.

<P>
Bits 7 and 6 of each Spectrum attribute byte (normally used for FLASH
and BRIGHT) will be used as an index value (0-3) to select one of the
four colour palettes.

<P>
Each colour palette has 16 entries (8 for INK, 8 for PAPER). Bits 0 to
2 (INK) and 3 to 5 (PAPER) of the attribute byte will be used as
indexes to retrieve colour data from the selected palette.

<P>
With the standard Spectrum display, the BORDER colour is the same as
the PAPER colour in the first CLUT. For example BORDER 0 would set the
border to the same colour as PAPER 0 (with the BRIGHT and FLASH bits
not set).

<P>
The complete index can be calculated as
<BR>
ink_colour = (FLASH * 2 + BRIGHT) * 16 + INK
paper_colour = (FLASH * 2 + BRIGHT) * 16 + PAPER + 8

<P>
<BR><HR>

</BODY>
</HTML>
node020.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Palette file format</TITLE>
<META NAME="description" CONTENT="Palette file format">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node19.html">
<LINK REL="next" HREF="node21.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node21.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node14.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node19.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html503"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html505"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node21.html">Layer 1 Scrolling</A>
<B> Up:</B> <A
 HREF="node14.html">ULAplus</A>
<B> Previous:</B> <A
 HREF="node19.html">Emulation</A>
 &nbsp; <B>  <A ID="tex2html504"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html506"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00321036000000000000">
Palette file format</A>
</H5>
The palette format doubles as the BASIC patch loader. This enables you
to edit patches produced by other people.
<PRE>
; 64 colour palette file format (internal) - version 1.0
; copyright (c) 2009 Andrew Owen
;
; The palette file is stored as a BASIC program with embedded machine code

header:

db 0x00 ; program file
db 0x14, 0x01, "64colour" ; file name
dw 0x0097 ; data length
dw 0x0000 ; autostart line
dw 0x0097 ; program length

basic:

; 0 RANDOMIZE USR ((PEEK VAL "2
; 3635"+VAL "256"*PEEK VAL "23636"
; )+VAL "48"): LOAD "": REM

db 0x00, 0x00, 0x93, 0x00, 0xf9, 0xc0, 0x28, 0x28
db 0xbe, 0xb0, 0x22, 0x32, 0x33, 0x36, 0x33, 0x35
db 0x22, 0x2b, 0xb0, 0x22, 0x32, 0x35, 0x36, 0x22
db 0x2a, 0xbe, 0xb0, 0x22, 0x32, 0x33, 0x36, 0x33
db 0x36, 0x22, 0x29, 0x2b, 0xb0, 0x22, 0x34, 0x38
db 0x22, 0x29, 0x3a, 0xef, 0x22, 0x22, 0x3a, 0xea

start:

di ; disable interrupts
ld hl, 38 ; HL = length of code
add hl, bc ; BC = entry point (start) from BASIC
ld bc, 0xbf3b ; register select
ld a, 64 ; mode group
out (c), a ;
ld a, 1 ;
ld b, 0xff ; choose register port
out (c), a ; turn palette mode on
xor a ; first register

setreg:

ld b, 0xbf ; choose register port
out (c), a ; select register
ex af, af' ; save current register select
ld a, (hl) ; get data
ld b, 0xff ; choose data port
out (c), a ; set it
ex af, af' ; restore current register
inc hl ; advance pointer
inc a ; increase register
cp 64 ; are we nearly there yet?
jr nz, setreg ; repeat until all 64 have been done
ei ; enable interrupts
ret ; return

; this is where the actual data is stored. The following is an example palette.

registers:

db 0x00, 0x02, 0x18, 0x1b, 0xc0, 0xc3, 0xd8, 0xdb ; INK
db 0x00, 0x02, 0x18, 0x1b, 0xc0, 0xc3, 0xd8, 0xdb ; PAPER
db 0x00, 0x03, 0x1c, 0x1f, 0xe0, 0xe3, 0xfc, 0xff ; +BRIGHT
db 0x00, 0x03, 0x1c, 0x1f, 0xe0, 0xe3, 0xfc, 0xff ;
db 0xdb, 0xd8, 0xc3, 0xc0, 0x1b, 0x18, 0x02, 0x00 ; +FLASH
db 0xdb, 0xd8, 0xc3, 0xc0, 0x1b, 0x18, 0x02, 0x00 ;
db 0xff, 0xfc, 0xe3, 0xe0, 0x1f, 0x1c, 0x03, 0x00 ; +BRIGHT/
db 0xff, 0xfc, 0xe3, 0xe0, 0x1f, 0x1c, 0x03, 0x00 ; +FLASH

terminating_byte:

db 0x0d
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node021.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 1 Scrolling</TITLE>
<META NAME="description" CONTENT="Layer 1 Scrolling">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node22.html">
<LINK REL="previous" HREF="node11.html">
<LINK REL="next" HREF="node22.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node22.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node20.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html507"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html509"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node22.html">Layer 1 Clipping</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node20.html">Palette file format</A>
 &nbsp; <B>  <A ID="tex2html508"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html510"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00322000000000000000">
Layer 1 Scrolling</A>
</H2>
Layer 1 has two sets of scrolling registers. One for the the legacy
modes (ZX Spectrum, Alternate Page, Timex Hi-Resoulution, and Timex
Hi-colour) and a second set for the two ZX Spextrum Next specific
LoRes modes.  All modes scroll as if they were <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> screens
located at global coordinates (32, 32) to (287, 223), The registers
for the legacy modes are $26 and $27 and the registers for the LoRes
modes are $32 and $33.

<P>
Register (R/W) $26 (26) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ULA Horizontal Scroll Control

<UL>
<LI>bits 7-0 = ULA X Offset (0-255) (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $27 (27) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ULA Vertical Scroll Control

<UL>
<LI>bits 7-0 = ULA Y Offset (0-191) (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $32 (32) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Horizontal Scroll Control)

<UL>
<LI>bits 7-0 = X Offset (0-255) ($00 on reset)
</LI>
</UL>
Layer 1,0 (LoRes) scrolls in "half-pixels" at the same resolution and
smoothness as Layer 2.

<P>
Register (R/W) $33 (33) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Vertical Scroll Control)

<UL>
<LI>bits 7-0 = Y Offset (0-191) ($00 on reset)
</LI>
</UL>
Layer 1,0 (LoRes) scrolls in "half-pixels" at the same resolution and
smoothness as Layer 2.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node22.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node20.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html507"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html509"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node22.html">Layer 1 Clipping</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node20.html">Palette file format</A>
 &nbsp; <B>  <A ID="tex2html508"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html510"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node022.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 1 Clipping</TITLE>
<META NAME="description" CONTENT="Layer 1 Clipping">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node23.html">
<LINK REL="previous" HREF="node21.html">
<LINK REL="next" HREF="node23.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node23.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node21.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html511"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html513"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node23.html">ZX Spectrum Mode</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node21.html">Layer 1 Scrolling</A>
 &nbsp; <B>  <A ID="tex2html512"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html514"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00323000000000000000">
Layer 1 Clipping</A>
</H2>
All of the modes in the Layer 1 share a single clipping register,
$1A. The clip index may alternately be set using register $1C. This
is expecially useful for reading the current clipping coordinates as
reads on the clipping register do not change the index. Note that
clipping coordinates are based on a full display area for the mode of
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution even though not all modes have that
resolution.

<P>
Register (R/W) $1A (1A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 0 (ULA/LoRes) Clip Window Definition

<UL>
<LI>bits 7-0 = Coord. of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write = X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write = X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write = Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write = Y2 position
  </td></tr></table>
</LI>
</UL>
The values are 0,255,0,191 after a Reset
<BR>
Reads do not advance the clip position

<P>
Register (R/W) $1C (1C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Clip Window Control
<BR>
Read

<UL>
<LI>bits 7-6 = Layer 3 Clip Index
</LI>
<LI>bits 5-4 = Layer 0/1 Clip Index
</LI>
<LI>bits 3-2 = Sprite clip index
</LI>
<LI>bits 1-0 = Layer 2 Clip Index
</LI>
</UL>
Write

<UL>
<LI>bits 7-4 = Reserved, must be 0
</LI>
<LI>bit 3 - reset Layer 3 clip index
</LI>
<LI>bit 2 - reset Layer 0/1 clip index
</LI>
<LI>bit 1 - reset sprite clip index.
</LI>
<LI>bit 0 - reset Layer 2 clip index.
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node23.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node21.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html511"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html513"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node23.html">ZX Spectrum Mode</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node21.html">Layer 1 Scrolling</A>
 &nbsp; <B>  <A ID="tex2html512"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html514"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node023.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Spectrum Mode</TITLE>
<META NAME="description" CONTENT="ZX Spectrum Mode">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node24.html">
<LINK REL="previous" HREF="node22.html">
<LINK REL="next" HREF="node24.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node24.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node22.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html515"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html517"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node24.html">Alternate Page Mode</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node22.html">Layer 1 Clipping</A>
 &nbsp; <B>  <A ID="tex2html516"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html518"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00324000000000000000">
ZX Spectrum Mode</A>
</H2>

<P>
Timex mode 0

<P>
This is the default ULA mode and has its origins in the original ZX
Spectrum. It uses <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> pixels located at global coordinates
(32, 32) to (287, 223) with <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img14.svg"
 ALT="$8\times8$"></SPAN> colour attribute areas mapped
into a <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img15.svg"
 ALT="$32\times24$"></SPAN> grid. If Timex modes are not enabled, this and the
LoRes mode are the only ones available, so you would switch back to
this mode by writing 000xxxxx to Next register $15 (21, the sprites
and layers register). If another Timex mode is enabled, then this is
mode 0 so you would write 0 to port $ff to enable it. This is a
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> video mode. The bitmap 1 area is used for selection
between ink and paper colours with one bit per pixel and the attribute
1 area for colour attributes.

<P>
The easiest way to visualize the mapping of this mode is to think of
the <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> area as being divided into a <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img15.svg"
 ALT="$32\times24$"></SPAN> grid of
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img14.svg"
 ALT="$8\times8$"></SPAN> characters.  IF we consider X and Y as the position in the
grid and R to the the row within the character.  For ink/paper
selection, 0=paper, 1=ink and the entries are stored left to right as
lsb to msb within the bye.  The address for a pixel value is:
<!-- MATH
 $0R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img16.svg"
 ALT="$0R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$"></SPAN>. Each <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img14.svg"
 ALT="$8\times8$"></SPAN> cell has
its own colour attribute where the address for an attribute cell is
<!-- MATH
 $0110R_4R_3R_2R_1R_0C_4C_3C_2C_1C_0$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img17.svg"
 ALT="$0110R_4R_3R_2R_1R_0C_4C_3C_2C_1C_0$"></SPAN> in other words mapped lineally
column-wise starting at the beginning of the attribute 1 area.

<P>
Code:
<PRE>
  ;; from any other Timex mode:
  ld a,$00
  ld c,$ff
  out (c),a

  ;; from LoRes mode:
  ld bc,$243B ; next register select port
  ld a,$15
  out (c),a
  ld bc,$253B ; next register r/w port
  in a,(c)
  and $7f
  out (c),a
</PRE>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node24.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node22.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html515"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html517"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node24.html">Alternate Page Mode</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node22.html">Layer 1 Clipping</A>
 &nbsp; <B>  <A ID="tex2html516"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html518"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node024.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Alternate Page Mode</TITLE>
<META NAME="description" CONTENT="Alternate Page Mode">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node25.html">
<LINK REL="previous" HREF="node23.html">
<LINK REL="next" HREF="node25.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node25.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node23.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html519"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html521"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node25.html">Timex Hi-Colour Mode</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node23.html">ZX Spectrum Mode</A>
 &nbsp; <B>  <A ID="tex2html520"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html522"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00325000000000000000">
Alternate Page Mode</A>
</H2>

<P>
Timex mode 1

<P>
This mode is the same as ZX Spectrum mode except it is at an alternate
addresses. Alternate page mode is selected by enabling Timex modes by
writing 00xxxx1xx to Next register $08 (8, Peripheral 3 setting) then
writing 1 to the Timex ULA port ($ff).  It is identical to ZX
Spectrum mode except the pixel are mapped to the bitmap 2 area giving
use pixel addresses of <!-- MATH
 $1R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img18.svg"
 ALT="$1R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$"></SPAN> and
the attributes to the attribute 2 area with addresses of
<!-- MATH
 $1110R_4R_3R_2R_1R_0C_4C_3C_2C_1C_0$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img19.svg"
 ALT="$1110R_4R_3R_2R_1R_0C_4C_3C_2C_1C_0$"></SPAN>.

<P>
Code:

<P>
<PRE>
;; disable LoRes mode:
ld bc,$243B ; next register select port
ld a,$15
out (c),a
ld bc,$253B ; next register r/w port
in a,(c)
and $7f
out (c),a
;; set Timex mode
ld bc,$243B ; next register select port
ld a,$08
out (c),a
ld bc,$253B ; next register r/w port
in a,(c)
or $04
out (c),a
;; set alternate page mode
ld c,$ff
ld a,$01
out (c),a
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node025.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Timex Hi-Colour Mode</TITLE>
<META NAME="description" CONTENT="Timex Hi-Colour Mode">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node26.html">
<LINK REL="previous" HREF="node24.html">
<LINK REL="next" HREF="node26.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node26.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node24.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html523"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html525"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node26.html">Timex Hi-Resolution Mode</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node24.html">Alternate Page Mode</A>
 &nbsp; <B>  <A ID="tex2html524"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html526"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00326000000000000000">
Timex Hi-Colour Mode</A>
</H2>

<P>
Timex mode 2

<P>
This mode is a <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> video mode located at global coordinates
(32, 32) to (287, 223) with <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img20.svg"
 ALT="$8\times1$"></SPAN> colour attribute mapping on a
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img21.svg"
 ALT="$32\times192$"></SPAN> grid. It is selected by writing 2 to the Timex ULA port
($ff).  Pixel mapping in this mode is the same as in ZX Spectrum mode
using the bitmap 1 area based on
<!-- MATH
 $0R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img16.svg"
 ALT="$0R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$"></SPAN>.  The colour attributes use
the bitmap 2 area with <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img20.svg"
 ALT="$8\times1$"></SPAN> colour attribute areas corresponding
to the addresses <!-- MATH
 $1R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img18.svg"
 ALT="$1R_4R_3Y_2Y_1Y_0R_2R_1R_0C_4C_3C_2C_1C_0$"></SPAN>.

<P>
Code:
<PRE>
;; disable LoRes mode:
ld bc,$243B ; next register select port
ld a,$15
out (c),a
ld bc,$253B ; next register r/w port
in a,(c)
and $7f
out (c),a
;; set Timex mode
ld bc,$243B ; next register select port
ld a,$08
out (c),a
ld bc,$253B ; next register r/w port
in a,(c)
or $04
out (c),a
;; set hi-colour mode
ld c,$ff
ld a,$02
out (c),a
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node026.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Timex Hi-Resolution Mode</TITLE>
<META NAME="description" CONTENT="Timex Hi-Resolution Mode">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node27.html">
<LINK REL="previous" HREF="node25.html">
<LINK REL="next" HREF="node27.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node27.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node25.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html527"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html529"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node27.html">Lo-Resolution Mode</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node25.html">Timex Hi-Colour Mode</A>
 &nbsp; <B>  <A ID="tex2html528"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html530"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00327000000000000000">
Timex Hi-Resolution Mode</A>
</H2>

<P>
Timex mode 6

<P>
This is a monochrome <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> video mode located at global
coordinates (32, 32) to (287, 223) with each pixel being half
width. It is selected by writing to the Timex ULA port ($ff with
values that also select which two colours (or colour entries in
ULANext mode) you use.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="232"></A>
<TABLE>
<CAPTION><STRONG>Table 2.5:</STRONG>
Hi-Resolution Colours</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img23.svg"
 ALT="\begin{table}\centering
\csvautotabular{video/hires.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
Pixels are mapped into both the bitmap 1 and bitmap 2 areas where
8-pixel wide character columns alternate between the two bitmap areas.
The pixels within a byte being rendered left to right lsb to msb as in
other Spectrum video modes.  The addresses for each row within a
character are based on a <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img24.svg"
 ALT="$64\times32$"></SPAN> grid of <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img14.svg"
 ALT="$8\times8$"></SPAN> characters
which using a <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img25.svg"
 ALT="$64\times24$"></SPAN> R, C, and Y scheme gives us addresses of
the form <!-- MATH
 $C_0R_4R_3Y_2Y_1Y_0R_2R_1R_0C_5C_4C_3C_2C_1$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img26.svg"
 ALT="$C_0R_4R_3Y_2Y_1Y_0R_2R_1R_0C_5C_4C_3C_2C_1$"></SPAN>.

<P>
Code:
<PRE>
;; disable LoRes mode:
ld bc,$243B ; next register select port
ld a,$15
out (c),a
ld bc,$253B ; next register r/w port
in a,(c)
and $7f
out (c),a
;; set Timex mode
ld bc,$243B ; next register select port
ld a,$08
out (c),a
ld bc,$253B ; next register r/w port
in a,(c)
or $04
out (c),a
;; set hi-res mode, black on white
ld c,$ff
ld a,$06
out (c),a
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node027.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Lo-Resolution Mode</TITLE>
<META NAME="description" CONTENT="Lo-Resolution Mode">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node26.html">
<LINK REL="next" HREF="node28.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node28.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node26.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html531"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html533"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node28.html">Layer 2</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node26.html">Timex Hi-Resolution Mode</A>
 &nbsp; <B>  <A ID="tex2html532"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html534"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00328000000000000000">
Lo-Resolution Mode</A>
</H2>
This is a Spectrum Next specific video mode with a resolution of
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img27.svg"
 ALT="$128\times96$"></SPAN> located at global coordinates (32, 32) to (287, 223)
with each pixel being double height and double width replacing the old
Radistan mode.  It can either allow for 16 colours, in which case it
uses either the bitmap 1 area or the bitmap 2 area, or 256 colours
using both bitmap 1 and bitmap 2. The colour of each pixel can be
selected independently with data ordered linearly in a row major
fashion. In the case of 16 colour mode, the nybbles describing the
colours are X major (MSN LSN). Scrolling is by half pixels and uses
different registers ($32 and $33) from the rest of the ULA group
modes. LoRes mode is enabled by writing <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img28.svg"
 ALT="$100xxxxx$"></SPAN> to Next register
$15 (the sprites and layers register) with Next register $6A used to
decide whether it is 16 or 256 colours.

<P>
Register (R/W) $15 (15) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite and Layer System Setup

<UL>
<LI>bit 7 = LoRes mode (0 on reset)
</LI>
<LI>bit 6 = Sprite priority (1 = sprite 0 on top, 0 = sprite 127 on
  top) (0 on reset)
</LI>
<LI>bit 5 = Enable sprite clipping in over border mode (0 on reset)
</LI>
<LI>bits 4-2 = set layers priorities (000 on reset)
  
<UL>
<LI>000 - S L U
</LI>
<LI>001 - L S U
</LI>
<LI>010 - S U L
</LI>
<LI>011 - L U S
</LI>
<LI>100 - U S L
</LI>
<LI>101 - U L S
</LI>
<LI>110 - S(U+L) ULA and Layer 2 combined, colours clamped to 7
</LI>
<LI>111 - S(U+L-5) ULA and Layer 2 combined, colours clamped to [0,7]
  
</LI>
</UL>
</LI>
<LI>bit 1 = Enable Sprites Over border (0 on reset)
</LI>
<LI>bit 0 = Enable Sprites (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $32 (32) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Horizontal Scroll Control)

<UL>
<LI>bits 7-0 = X Offset (0-255) ($00 on reset)
</LI>
</UL>
Layer 1,0 (LoRes) scrolls in "half-pixels" at the same resolution and
smoothness as Layer 2.

<P>
Register (R/W) $33 (33) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Vertical Scroll Control)

<UL>
<LI>bits 7-0 = Y Offset (0-191) ($00 on reset)
</LI>
</UL>
Layer 1,0 (LoRes) scrolls in "half-pixels" at the same resolution and
smoothness as Layer 2.

<P>
Register (R/W) $6A (6A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Control

<UL>
<LI>bits 7-6 = reserved, must be 0
</LI>
<LI>bit 5 = Enable Radistan (16-colour) (0 on reset)
</LI>
<LI>bit 4 = Radistan DFILE switch (xor with bit 0 of port $ff) (0
  on reset)
</LI>
<LI>bits 3-0 = Radistsan palette offset (0 on reset)
</LI>
<LI>bits 1-0 = ULAplus palette offset (0 on reset)
</LI>
</UL>

<P>
Code: 256 colour
<PRE>
;; enable LoRes mode:
nextreg $15,$80
;; 256-colour mode
ld bc,$243B ; next register select port
ld a,$6A
out (c),a
ld bc,$253B ; next register r/w port
in a,(c)
and $EF ; lores radistan control
out (c),a
</PRE>

<P>
Code: 16 colour
<PRE>
;; enable LoRes mode:
nextreg $15,$80
;; 16-colour mode
nextreg $6A,$10
</PRE>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node28.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node26.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html531"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html533"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node28.html">Layer 2</A>
<B> Up:</B> <A
 HREF="node10.html">Layer 1</A>
<B> Previous:</B> <A
 HREF="node26.html">Timex Hi-Resolution Mode</A>
 &nbsp; <B>  <A ID="tex2html532"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html534"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node028.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 2</TITLE>
<META NAME="description" CONTENT="Layer 2">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node36.html">
<LINK REL="previous" HREF="node10.html">
<LINK REL="next" HREF="node29.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node29.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node27.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html535"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html537"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node29.html">Configuration</A>
<B> Up:</B> <A
 HREF="node3.html">Video</A>
<B> Previous:</B> <A
 HREF="node27.html">Lo-Resolution Mode</A>
 &nbsp; <B>  <A ID="tex2html536"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html538"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00330000000000000000">
Layer 2</A>
</H1>
Layer 2 is a for bitmapped graphics. It supports modes with
<!-- MATH
 $256\times192\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img7.svg"
 ALT="$256\times192\times256$"></SPAN> resolution at global coordinates (32, 32) to
(287, 223) mapped linearly left to right/top to bottom,
<!-- MATH
 $320\times256\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img8.svg"
 ALT="$320\times256\times256$"></SPAN> resolution at global coordinates (0, 0) to
(318, 255) mapped top to bottom/left to right, and
<!-- MATH
 $640\times256\times16$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img9.svg"
 ALT="$640\times256\times16$"></SPAN> resolution at global coordinates (0, 0) to
(319, 255) with half width pixels mapped so that the nybbles in a byte
are adjacent columns (MSN on the left) and bytes running top to
bottom/left to right. It can be mapped starting at any 16k memory
blocks. The <!-- MATH
 $256\times192\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img7.svg"
 ALT="$256\times192\times256$"></SPAN> mode requires 3 consecutive blocks
(48k) while the others use 5 consecutive blocks (80k).

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Configuration " LINK NODE29}
<LI><A ID="tex2html540"
  HREF="node30.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN>, Write only overlaid on ROM</A>
<LI><A ID="tex2html541"
  HREF="node31.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution</A>
<LI><A ID="tex2html542"
  HREF="node32.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img2.svg"
 ALT="$320\times 256$"></SPAN> resolution</A>
<LI><A ID="tex2html543"
  HREF="node33.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img3.svg"
 ALT="$640\times 256$"></SPAN> resolution</A>
</UL>
<BR>
@{" Scrolling " LINK NODE34}
@{" Clipping " LINK NODE35}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node029.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Configuration</TITLE>
<META NAME="description" CONTENT="Configuration">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node34.html">
<LINK REL="previous" HREF="node28.html">
<LINK REL="next" HREF="node30.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node30.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node28.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node28.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html546"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html548"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node30.html">Layer 2 , Write</A>
<B> Up:</B> <A
 HREF="node28.html">Layer 2</A>
<B> Previous:</B> <A
 HREF="node28.html">Layer 2</A>
 &nbsp; <B>  <A ID="tex2html547"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html549"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00331000000000000000">
Configuration</A>
</H2>
Layer 2 is enabled using port $123B or register $69. The mode is
selected using register $70. How layer 2 memory is overlaid on main
memory is controled by port $123B and register $70. The location in
memory is controlled by register $12 with a shadow area pointed to by
register $13 for double buffering. Finally port $123B is used to
select either the main RAM area or the shadow RAM area for rendering
the layer.

<P>
Port $123B (123B) Layer 2
<BR>
Bit 4 = 0
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = Video RAM bank select
  <table width="90%">  <tr><td valign="top">&nbsp;00 = first 16k
  </td></tr>
<tr><td valign="top">&nbsp;01 = second 16k
  </td></tr>
<tr><td valign="top">&nbsp;10 = third 16k
  </td></tr>
<tr><td valign="top">&nbsp;11 = first 48k
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 4 = 0</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Shadow layer 2 select</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Enable layer 2 read paging</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Layer 2 visible (mirrored in register $69)</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Enable layer 2 write paging
</td></tr></table>

Bit 4 = 1
<table width="90%"><tr><td valign="top">&nbsp;bits 7-5 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 4 = 1</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 2-0 = 16k bank relative offset
</td></tr></table>

<P>
Register (R/W) $12 (12) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Active RAM bank

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = RAM bank (point to bank 8 after a Reset, NextZXOS
  modifies to 9)
</LI>
</UL>

<P>
Register (R/W) $13 (13) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Shadow RAM bank

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = RAM bank (point to bank 11 after a Reset, NextZXOS
  modifies to 12)
</LI>
</UL>

<P>
Register (R/W) $69 (69) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Display Control 1

<UL>
<LI>bit 7 = Layer 2 Enable (Port $123B bit 1 alias)
</LI>
<LI>bit 6 = ULA Shadow display enable (Port $7FFD bit 3 alias)
</LI>
<LI>bits 5-0 = Timex alias (Port $FF alias)
</LI>
</UL>

<P>
Register (R/W) $70 (70) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Control

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bits 5-4 = Resolution (00 on soft reset)
  
<UL>
<LI>00 = <!-- MATH
 $256\times192\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img7.svg"
 ALT="$256\times192\times256$"></SPAN>
</LI>
<LI>01 = <!-- MATH
 $320\times256\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img8.svg"
 ALT="$320\times256\times256$"></SPAN>
</LI>
<LI>10 = <!-- MATH
 $640\times256\times16$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img9.svg"
 ALT="$640\times256\times16$"></SPAN>
</LI>
<LI>11 = Do not use
  
</LI>
</UL>
</LI>
<LI>bits 3-0 = Palette offset ($0 on soft reset)
</LI>
</UL>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><A ID="tex2html550"
  HREF="node30.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN>, Write only overlaid on ROM</A>
<LI><A ID="tex2html551"
  HREF="node31.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution</A>
<LI><A ID="tex2html552"
  HREF="node32.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img2.svg"
 ALT="$320\times 256$"></SPAN> resolution</A>
<LI><A ID="tex2html553"
  HREF="node33.html">Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img3.svg"
 ALT="$640\times 256$"></SPAN> resolution</A>
</UL></UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node30.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node28.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node28.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html546"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html548"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node30.html">Layer 2 , Write</A>
<B> Up:</B> <A
 HREF="node28.html">Layer 2</A>
<B> Previous:</B> <A
 HREF="node28.html">Layer 2</A>
 &nbsp; <B>  <A ID="tex2html547"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html549"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node030.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 2 , Write only overlaid on ROM</TITLE>
<META NAME="description" CONTENT="Layer 2 , Write only overlaid on ROM">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node31.html">
<LINK REL="previous" HREF="node29.html">
<LINK REL="next" HREF="node31.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node31.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node29.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node29.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html554"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html556"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node31.html">Layer 2 resolution</A>
<B> Up:</B> <A
 HREF="node29.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node29.html">Configuration</A>
 &nbsp; <B>  <A ID="tex2html555"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html557"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00331010000000000000">
Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN>, Write only overlaid on ROM</A>
</H4>
<PRE>
p_layer2: defl $123b
start:
  ld bc,p_layer2
  ld a,$03       ; enable, wo, 1st 16k
  out (c),a
  call wrtpage
  ld bc,p_layer2
  ld a,$43       ; enable, wo, 2nd 16k
  out (c),a
  call wrtpage
  ld bc,p_layer2
  ld a,$83       ; enable, wo, 3rd 16k
  out (c),a
  call wrtpage
  ret
wrtpage:  
  ld hl,$0000
  ld bc,$0040    ; 40*256 writes
loop:
  ld (hl),b
  inc hl
  djnz loop
  dec c
  jr nz,loop
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node031.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 2 resolution</TITLE>
<META NAME="description" CONTENT="Layer 2 resolution">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node32.html">
<LINK REL="previous" HREF="node30.html">
<LINK REL="next" HREF="node32.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node32.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node29.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node30.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html558"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html560"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node32.html">Layer 2 resolution</A>
<B> Up:</B> <A
 HREF="node29.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node30.html">Layer 2 , Write</A>
 &nbsp; <B>  <A ID="tex2html559"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html561"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00331020000000000000">
Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution</A>
</H4>
<PRE>
r_mmu_7:  defl $57
r_disp1:  defl $69
r_layer2: defl $70
start:
  nextreg r_disp1,$80  ; enable layer 2
  nextreg r_layer2,$00 ; 256x192x256
  ld a,$12             ; page 18=bank 9
loop1:
  nextreg r_mmu_7,a    ; map page into slot 7
  ld bc,$0020          ; 20*256 = 8k
  ld hl,$E000          ; address of slot 7
loop2:
  ld (hl),b
  inc hl
  djnz loop2
  dec c
  jp NZ,loop2
  inc a
  cp $18               ; stop at page 24
  jp NZ,loop1
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node032.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 2 resolution</TITLE>
<META NAME="description" CONTENT="Layer 2 resolution">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node33.html">
<LINK REL="previous" HREF="node31.html">
<LINK REL="next" HREF="node33.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node33.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node29.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node31.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html562"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html564"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node33.html">Layer 2 resolution</A>
<B> Up:</B> <A
 HREF="node29.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node31.html">Layer 2 resolution</A>
 &nbsp; <B>  <A ID="tex2html563"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html565"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00331030000000000000">
Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img2.svg"
 ALT="$320\times 256$"></SPAN> resolution</A>
</H4>
<PRE>
r_mmu_7:  defl $57
r_disp1:  defl $69
r_layer2: defl $70
start:
  nextreg r_disp1,$80  ; enable layer 2
  nextreg r_layer2,$10 ; 320x256x256
  ld a,$12             ; page 18=bank 9
loop1:
  nextreg r_mmu_7,a    ; map page into slot 7
  ld bc,$0020          ; 20*256 = 8k
  ld hl,$E000          ; start of slot 7
loop2:
  ld (hl),b
  inc hl
  djnz loop2
  dec c
  jp NZ,loop2
  inc a
  cp $1C               ; stop at page 28
  jp NZ,loop1
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node033.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 2 resolution</TITLE>
<META NAME="description" CONTENT="Layer 2 resolution">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node32.html">
<LINK REL="next" HREF="node34.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node34.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node29.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node32.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html566"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html568"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node34.html">Scrolling</A>
<B> Up:</B> <A
 HREF="node29.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node32.html">Layer 2 resolution</A>
 &nbsp; <B>  <A ID="tex2html567"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html569"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00331040000000000000">
Layer 2 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img3.svg"
 ALT="$640\times 256$"></SPAN> resolution</A>
</H4>
<PRE>
r_mmu_7:  defl $57
r_disp1:  defl $69
r_layer2:  defl $70
start:
  nextreg r_disp1, $80   ; enable layer 2
  nextreg r_layer2, $20  ; 640x256x16
  ld a, $12    ; page 18=bank 9
loop1:
  nextreg r_mmu_7, a  ; map page into slot 7
  ld bc, $0020    ; 20*256 = 8k
  ld hl, $E000    ; start address for slot 7
loop2:
  ld (hl), b
  inc hl
  djnz loop2
  dec c
  jp NZ, loop2
  inc a
  cp $1C      ; stop at page 28
  jp NZ, loop1
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node034.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Scrolling</TITLE>
<META NAME="description" CONTENT="Scrolling">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node35.html">
<LINK REL="previous" HREF="node29.html">
<LINK REL="next" HREF="node35.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node35.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node28.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node33.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html570"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html572"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node35.html">Clipping</A>
<B> Up:</B> <A
 HREF="node28.html">Layer 2</A>
<B> Previous:</B> <A
 HREF="node33.html">Layer 2 resolution</A>
 &nbsp; <B>  <A ID="tex2html571"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html573"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00332000000000000000">
Scrolling</A>
</H2>
Scrolling Layer 2 is controlled by registers $16 and $17. (Is there
a third scrolling register for layer 2?)

<P>
Register (R/W) $16 (16) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Horizontal Scroll Control

<UL>
<LI>bits 7-0 = X Offset (0-255)(0 on reset)
</LI>
</UL>

<P>
Register (R/W) $17 (17) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Vertical Scroll Control

<UL>
<LI>bits 7-0 = Y Offset (0-191)(0 on reset)
</LI>
</UL>

<P>
<BR><HR>

</BODY>
</HTML>
node035.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Clipping</TITLE>
<META NAME="description" CONTENT="Clipping">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node34.html">
<LINK REL="next" HREF="node36.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node36.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node28.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node34.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html574"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html576"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
<B> Up:</B> <A
 HREF="node28.html">Layer 2</A>
<B> Previous:</B> <A
 HREF="node34.html">Scrolling</A>
 &nbsp; <B>  <A ID="tex2html575"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html577"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00333000000000000000">
Clipping</A>
</H2>
The Clip area for is based on the local coordinate system for the mode
in question and is set using register $18 with the option of
selection which write in active using register $1C.

<P>
Register (R/W) $18 (18) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Clip Window Definition

<UL>
<LI>bits 7-0 = Coords of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write - X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write - X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write - Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write - Y2 position
  </td></tr></table>
</LI>
</UL>
Reads do not advance the clip position
<BR>
The values are 0,255,0,191 after a Reset

<P>
Register (R/W) $1C (1C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Clip Window Control
<BR>
Read

<UL>
<LI>bits 7-6 = Layer 3 Clip Index
</LI>
<LI>bits 5-4 = Layer 0/1 Clip Index
</LI>
<LI>bits 3-2 = Sprite clip index
</LI>
<LI>bits 1-0 = Layer 2 Clip Index
</LI>
</UL>
Write

<UL>
<LI>bits 7-4 = Reserved, must be 0
</LI>
<LI>bit 3 - reset Layer 3 clip index
</LI>
<LI>bit 2 - reset Layer 0/1 clip index
</LI>
<LI>bit 1 - reset sprite clip index.
</LI>
<LI>bit 0 - reset Layer 2 clip index.
</LI>
</UL>

<P>
<BR><HR>

</BODY>
</HTML>
node036.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Layer 3 (Tilemap) Mode</TITLE>
<META NAME="description" CONTENT="Layer 3 (Tilemap) Mode">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node46.html">
<LINK REL="previous" HREF="node28.html">
<LINK REL="next" HREF="node37.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node37.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node35.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html578"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html580"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node37.html">General Description</A>
<B> Up:</B> <A
 HREF="node3.html">Video</A>
<B> Previous:</B> <A
 HREF="node35.html">Clipping</A>
 &nbsp; <B>  <A ID="tex2html579"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html581"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00340000000000000000">
Layer 3 (Tilemap) Mode</A>
</H1>

<P>
Started with documentation by Phoebus Dokos, February 25,
2019. Partially rewritten for clarity and to add core 3.00.00
features.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" General Description " LINK NODE37}
@{" Data Structures " LINK NODE38}
@{" Tilemap " LINK NODE39}
@{" Tile Definitions " LINK NODE40}
</UL>
<BR>
@{" Memory Organization &amp; Display Layer " LINK NODE41}
@{" Combining ULA &amp; Tilemap " LINK NODE42}
@{" Programming Tilemap mode " LINK NODE43}
@{" Changes Since 2.00.26 " LINK NODE44}
@{" Future Direction " LINK NODE45}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node037.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>General Description</TITLE>
<META NAME="description" CONTENT="General Description">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node38.html">
<LINK REL="previous" HREF="node36.html">
<LINK REL="next" HREF="node38.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node38.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node36.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node36.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html591"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html593"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node38.html">Data Structures</A>
<B> Up:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
<B> Previous:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
 &nbsp; <B>  <A ID="tex2html592"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html594"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00341000000000000000">
General Description</A>
</H2>
The tilemap is a hardware character oriented display. It uses a set of
user defined 4-bit, 16-colour, or 1-bit, 2-colour <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img14.svg"
 ALT="$8\times8$"></SPAN>
tiles. The tiles can be dispplayed in two resolutions: <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img29.svg"
 ALT="$40\times32$"></SPAN>
tiles (<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img2.svg"
 ALT="$320\times 256$"></SPAN> pixels) and <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img30.svg"
 ALT="$80\times32$"></SPAN> tiles (<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img3.svg"
 ALT="$640\times 256$"></SPAN>
pixels).

<P>
The display area on screen is the same as the sprite layer, meaning it
overlaps the standard <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> area by 32 pixels on all
sides. Vertically this is larger than the physical HDMI display, which
will cut off the top and bottom character rows making the visible area
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img31.svg"
 ALT="$40\times30$"></SPAN> or <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img32.svg"
 ALT="$80\times30$"></SPAN>, but the full area is visible on VGA.

<P>
The obvious application for the tilemap is for a fast, clearly
readable and wide multicoloured character display. Less obvious
perhaps is that it can also be used to make fast and wide resolution
full colour backgrounds with easily animated components such as have
historically been used in many games.

<P>
The tilemap is defined by two data structures and configured using
four NextRegs. The NextRegs are $6b (107), Tilemap Control; $6c
(108), Default Tilemap Attribute, $6c (110); Tilemap Base Address;
and $6d (111) Tile Definitions Base Address.

<P>
<BR><HR>

</BODY>
</HTML>
node038.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Data Structures</TITLE>
<META NAME="description" CONTENT="Data Structures">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node41.html">
<LINK REL="previous" HREF="node37.html">
<LINK REL="next" HREF="node39.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node39.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node36.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node37.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html595"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html597"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node39.html">Tilemap</A>
<B> Up:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
<B> Previous:</B> <A
 HREF="node37.html">General Description</A>
 &nbsp; <B>  <A ID="tex2html596"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html598"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00342000000000000000">
Data Structures</A>
</H2>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
@{" Tilemap " LINK NODE39}
@{" Tile Definitions " LINK NODE40}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node039.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Tilemap</TITLE>
<META NAME="description" CONTENT="Tilemap">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node40.html">
<LINK REL="previous" HREF="node38.html">
<LINK REL="next" HREF="node40.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node40.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html601"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html603"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node40.html">Tile Definitions</A>
<B> Up:</B> <A
 HREF="node38.html">Data Structures</A>
<B> Previous:</B> <A
 HREF="node38.html">Data Structures</A>
 &nbsp; <B>  <A ID="tex2html602"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html604"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00342010000000000000">
Tilemap</A>
</H4>

<P>
The first data structure is the tilemap itself which indicates what
characters occupy each cell on screen. Each tilemap entry is either
one or two bytes.

<P>
If entries are two bytes each, the first byte for each entry is bits
0-7 of the tile number, while the second byte is an attribute byte
which is interpreted acctording to the mode set in the tilemap control
register ($6b). For <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img29.svg"
 ALT="$40\times32$"></SPAN> resolution, a full size tilemap will
occupy 2560 bytes, and for <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img30.svg"
 ALT="$80\times32$"></SPAN> resolution the space taken is
twice that at 5120 bytes. The tilemap entries are stored in X-major
order and each two-byte tilemap entry consists of a tile number byte
(bits 0-7 of the tile number) followed an attribute byte:

<P>
Tilemap Attribute Byte 4-bit
<table width="90%"><tr><td valign="top">&nbsp;bits 7-4 : most significant 4-bits of palette entry</td></tr>
<tr><td valign="top">&nbsp;bit 3 : x mirror</td></tr>
<tr><td valign="top">&nbsp;bit 2 : y mirror</td></tr>
<tr><td valign="top">&nbsp;bit 1 : rotate</td></tr>
<tr><td valign="top">&nbsp;bit 0 : ULA over tilemap (in 512 tile mode, bit 8 of the tile
  number)
</td></tr></table>

<P>
Tilemap Attribute Byte 1-bit
<table width="90%"><tr><td valign="top">&nbsp;bits 7-1 : most significan 7-bits of palette entry</td></tr>
<tr><td valign="top">&nbsp;bit 0 : ULA over tilemap (in 512 tile mode, bit 8 of the tile
  number)
</td></tr></table>

<P>
The character displayed is indicated by the “tile number” which can be
thought of as an ASCII code. The tile number is normally eight bits
allowing up to 256 unique tiles to be displayed but this can be
extended to nine bits for 512 unique tiles if 512 tile mode is enabled
via the Tilemap Control register ($6b).

<P>
The other bits are tile attributes that modify how the tile image is
drawn. Their function is the same as the equivalent sprite attributes
for sprites. Bits apply rotation then mirroring, and colour can be
shifted with a palette offset. If 512 tile mode is not enabled, bit 8
will determine if the tile is above or below the ULA display on a per
tile basis.

<P>
When using 1-byte tilemap entries, the map consists of the tile
numbers for tile in the map with the tilemap attribute byte for every
tile coming from the default tilemap attribute register ($6c).

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node40.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html601"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html603"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node40.html">Tile Definitions</A>
<B> Up:</B> <A
 HREF="node38.html">Data Structures</A>
<B> Previous:</B> <A
 HREF="node38.html">Data Structures</A>
 &nbsp; <B>  <A ID="tex2html602"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html604"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node040.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Tile Definitions</TITLE>
<META NAME="description" CONTENT="Tile Definitions">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node39.html">
<LINK REL="next" HREF="node41.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node41.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node39.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html605"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html607"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node41.html">Memory Organization &amp; Display</A>
<B> Up:</B> <A
 HREF="node38.html">Data Structures</A>
<B> Previous:</B> <A
 HREF="node39.html">Tilemap</A>
 &nbsp; <B>  <A ID="tex2html606"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html608"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00342020000000000000">
Tile Definitions</A>
</H4>
The second data structure is the tile definitions themselves. To find
the difinition for a specific tile you would look at (base address) +
(tile number) * (definition size).

<P>
For 4-bit, 16-colour, tiles, each <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img14.svg"
 ALT="$8\times8$"></SPAN> tile takes up 32
bytes. Each pixel uses four bits to select one of 16 colours. A tile
is defined in X major order with packing in the X direction in the
same way that 4-bit sprites are defined. The 4-bit colour of each
pixel is augmented by the 4-bit palette offset from the tilemap in the
most significant bits to form an 8-bit colour index that is looked up
in the tilemap palette to determine the final 9-bit colour sent to the
display. Ane of the 16 colours for each tile is the transparency
color.

<P>
For 1-bit, 2-colour, tiles, each <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img14.svg"
 ALT="$8\times8$"></SPAN> tile takes up 8
bytes. Each pixel uses one bit to select one of two colours. A tile is
defined in X major order with packing in the X direction. The 1-bit
colour of each pixel is augmented by the 7-bit palette offset from the
tilemap in the most significant bits to form an 8-bit colour index
that is looked up in the tilemap palette to determine the final 9-bit
colour sent to the display. Transparency for each tile is according to
the global transparency colour.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node41.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node38.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node39.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html605"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html607"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node41.html">Memory Organization &amp; Display</A>
<B> Up:</B> <A
 HREF="node38.html">Data Structures</A>
<B> Previous:</B> <A
 HREF="node39.html">Tilemap</A>
 &nbsp; <B>  <A ID="tex2html606"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html608"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node041.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Memory Organization &amp; Display Layer</TITLE>
<META NAME="description" CONTENT="Memory Organization &amp; Display Layer">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node42.html">
<LINK REL="previous" HREF="node38.html">
<LINK REL="next" HREF="node42.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node42.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node36.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node40.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html609"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html611"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node42.html">Combining ULA &amp; Tilemap</A>
<B> Up:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
<B> Previous:</B> <A
 HREF="node40.html">Tile Definitions</A>
 &nbsp; <B>  <A ID="tex2html610"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html612"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00343000000000000000">
Memory Organization &amp; Display Layer</A>
</H2>
The tilemap is a logical extension of the ULA and its data structures
are contained in 16k banks 5 and 7 (first half only). If both the ULA
and tilemap are enabled, this means that the tilemap's map and tile
definitions should be arranged within the 24k to avoid overlap with
the display ram used by the ULA.

<P>
The tilemap exists on the same display layer as the ULA. The graphics
generated by the ULA and tilemap are combined before being forwarded
to the SLU layer system as layer U.

<P>
<BR><HR>

</BODY>
</HTML>
node042.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Combining ULA &amp; Tilemap</TITLE>
<META NAME="description" CONTENT="Combining ULA &amp; Tilemap">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node43.html">
<LINK REL="previous" HREF="node41.html">
<LINK REL="next" HREF="node43.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node43.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node36.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node41.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html613"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html615"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node43.html">Programming Tilemap mode</A>
<B> Up:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
<B> Previous:</B> <A
 HREF="node41.html">Memory Organization &amp; Display</A>
 &nbsp; <B>  <A ID="tex2html614"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html616"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00344000000000000000">
Combining ULA &amp; Tilemap</A>
</H2>
The combination of the ULA and tilemap is done in one of two modes:
the standard mode or the stencil mode.

<P>
The standard mode uses bit 8 of a tile's tilemap entry to determine if
a tile is above or below the ULA. The source of the final pixel
generated is then the topmost non-transparent pixel. If the ULA or
tilemap is disabled then they are treated as transparent.

<P>
The stencil mode will only be applied if both the ULA and tilemap are
enabled. In the stencil mode, the final pixel will be transparent if
either the ULA or tilemap are transparent. Otherwise the final pixel
is a logical AND of the corresponding colour bits. The stencil mode
allows one layer to act as a cut-out for the other.

<P>
<BR><HR>

</BODY>
</HTML>
node043.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Programming Tilemap mode</TITLE>
<META NAME="description" CONTENT="Programming Tilemap mode">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node42.html">
<LINK REL="next" HREF="node44.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node44.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node36.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node42.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html617"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html619"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node44.html">Changes Since 2.00.26</A>
<B> Up:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
<B> Previous:</B> <A
 HREF="node42.html">Combining ULA &amp; Tilemap</A>
 &nbsp; <B>  <A ID="tex2html618"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html620"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00345000000000000000">
Programming Tilemap mode</A>
</H2>

<P>
Register (R/W) $6B (6B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Control

<UL>
<LI>bit 7 = Layer 3 Enable (0 on reset)
</LI>
<LI>bit 6 = Layer 3 Size control (0 on reset)
  
<UL>
<LI>0 = 40x32
</LI>
<LI>1 = 80x32
  
</LI>
</UL>
</LI>
<LI>bit 5 = Disable Arrtibute Entry (0 on reset)
</LI>
<LI>bit 4 = palette select (0 on reset)
</LI>
<LI>bit 3 = Enable Text mode (1-bit tilemap) (0 on reset)
</LI>
<LI>bit 2 = Reserved, must be 0
</LI>
<LI>bit 1 = Activate 512 tile mode (0 on reset)
</LI>
<LI>bit 0 = Enable Layer 3 on top of ULA (0 on reset)
</LI>
</UL>

<P>
Bits 7 &amp; 6 enable the tilemap and select resolution. Bit 4 selects one
of two tilemap palettes used for final colour lookup. Bit 5 changes
the structure of the tilemap so that it contains only 8-bit tilemap
entries instead of 16-bit tilemap entries. If 8-bit, the tilemap only
contains tile numbers and the attributes are instead taken from
nextreg $6C.

<P>
Bit 5 determines whether the attribute byte for each tile come from
the tilemap (0) or from the default tile attribute register (1).

<P>
Bit 4 selects either the primary tilemap palette (0) or the secondary
tilemap palette (1).

<P>
Bit 3 selects whether to use 4-bit, 16-colour, or 1-bit 2-colour
tiles.

<P>
Bit 1 activates 512 tile mode. In this mode, the “ULA over tilemap”
bit in a tile’s attribute is re-purposed as the ninth bit of the tile
number, allowing up to 512 unique tiles to be displayed. In this mode,
the ULA is always on top of the tilemap.

<P>
Bit 0 forces the tilemap to be on top of the ULA. It can be useful in
512 tile mode to change the relative display order of the ULA and
tilemap.

<P>
Register (R/W) $6C (6C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Default Layer 3 Attribute*

<UL>
<LI>bits 7-4 = Palette Offset ($00 on reset)
</LI>
<LI>bit 3 = X mirror (0 on reset)
</LI>
<LI>bit 2 = Y mirror (0 on reset)
</LI>
<LI>bit 1 = Rotate (0 on reset)
</LI>
<LI>bit 0 = Bit 8 of the tile number (512 tile mode) (0 on reset)
</LI>
<LI>bit 0 = ULA over tilemap (256 tile mode) (0 on reset)
</LI>
</UL>
*Active tile attribute if bit 5 of nextreg $6B is set.

<P>
If bit 5 of nextreg $6B is set, the tilemap structure is modified to
contain only 8-bit tile numbers instead of the usual 16-bit tilemap
entries. In this case, the tile attributes used are taken from this
register instead.

<P>
Register (R/W) $6E (6E) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 Tilemap Base Address

<UL>
<LI>bit 7 = Bank Select (3.01.08)
<table width="90%"><tr><td valign="top">&nbsp;0 = Bank 5</td></tr>
<tr><td valign="top">&nbsp;1 = Bank 7
</td></tr></table>

</LI>
<LI>bit 6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = MSB of address of the tilemap in Bank 5 (16k) or 7 (8k)
($2C on reset)
</LI>
</UL>
Soft Reset default $2C - This is because the address is $6C00 so the
MSB is $6C. But the stored value is only the lower 6 bits so it's an
offset into the 16k Bank 5. To calculate therefore subtract $40
leaving you with $2C.

<P>
The value written is an offset into the 16k Bank 5 or the 8k lower
half of Bank 7 allowinf the tilemap to be placed at any multiple of
256 bytes.

<P>
This register determines the tilemapís base address in bank 5. The
base address is the MSB of an offset into the 16k bank, allowing the
tilemap to begin at any multiple of 256 bytes in the bank. Writing a
physical MSB address in $40-$7f or $c0-$ff, corresponding to
traditional ULA physical addresses, is permitted. The value read back
should be treated as a fully significant 8-bit value.

<P>
The tilemap will be <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img29.svg"
 ALT="$40\times32$"></SPAN> or <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img30.svg"
 ALT="$80\times32$"></SPAN> in size depending on
the resolution selected in nextreg $6B. Each entry in the tilemap is
normally two bytes but can be one byte if attributes are eliminated by
setting bit 5 of nextreg $6B.

<P>
Register (R/W) $6F (6F) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 Tile Definitions Base Address

<UL>
<LI>bit 7 = Select bank (3.01.08)
<table width="90%"><tr><td valign="top">&nbsp;0 = Bank 5</td></tr>
<tr><td valign="top">&nbsp;1 = Bank 7
</td></tr></table>

</LI>
<LI>bit 6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = MSB of address of the tile definitions in Bank 5 (16k) or 7
(8k) ($0C on reset)
</LI>
</UL>
Soft Reset default $0C - This is because the address is $4C00 so the
MSB is $4C. But the stored value is only the lower 6 bits so it's an
offset into the 16k Bank 5. To calculate therefore subtract $40
leaving you with $0C.

<P>
The value written is an offset into the 16k Bank 5 or the 8k lower
half of Bank 7 allowing the tilemap to be placed at any multiple of
256 bytes.

<P>
This register determines the base address of tile definitions in bank
5. As with nextreg $6E, the base address is the MSB of the an offset
into the 16k bank, allowing tile definitions to begin at any multiple
of 256 bytes in the bank. Writing a physical MSB address in $40-$7f
or $c0-$ff, corresponding to traditional ULA physical addresses, is
permitted. The value read back should be treated as a fully
significant 8-bit value.

<P>
Each tile definition is 32 bytes in size and is located at address:
<BR>
Tile Def Base Addr + 32 * (Tile Number)

<P>
<A NAME="372"></A>
Register (R/W) $4C (4C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Level 3 Transparency Index

<UL>
<LI>bits 7-4 = Reserved, must be 0
</LI>
<LI>bits 3-0 = Index value ($0F on reset)
</LI>
</UL>

<P>
Defines the transparent colour index for 4-bit tiles. The 4-bit pixels
of a tile definition are compared to this value to determine if they
are transparent. In the case of 1-bit tiles transparency is determined
by comparing the final pixel colour against the global transparency
colour.

<P>
For palette information see palette section.

<P>
<A NAME="378"></A>
Register (R/W) $1B (1B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Clip Window Definition

<UL>
<LI>bits 7-0 = Coord. of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write = X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write = X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write = Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write = Y2 position
  </td></tr></table>
</LI>
</UL>
The values are 0,159,0,255 after a Reset
<BR>
Reads do not advance the clip position
<BR>
The X coords are internally doubled.

<P>
The tilemap display surface extends 32 pixels around the central
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> display. The origin of the clip window is the top left
corner of this area 32 pixels to the left and 32 pixels above the
central <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> display. The X coordinates are internally
doubled to cover the full 320 pixel width of the surface. The clip
window indicates the portion of the tilemap display that is
non-transparent and its indicated extent is inclusive; it will extend
from X1*2 to X2*2+1 horizontally and from Y1 to Y2 vertically.

<P>
<A NAME="386"></A>
Register (R/W) $2F (2F) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Horizontal Scroll Control MSB

<UL>
<LI>bits 7-2 = Reserved, must be 0
</LI>
<LI>bits 1-0 = X Offset MSB ($00 on reset)
</LI>
</UL>
Meaningful Range is 0-319 in 40 char mode, 0-639 in 80 char mode

<P>
Register (R/W) $30 (30) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Horizontal Scroll Control LSB

<UL>
<LI>bits 7-0 = X Offset LSB ($00 on reset)
</LI>
</UL>
Meaningful range is 0-319 in 40 char mode, 0-639 in 80 char mode

<P>
Register (R/W) $31 (31) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Vertical Scroll Control

<UL>
<LI>bits 7-0 = Y Offset (0-255) )$00 on reset)
</LI>
</UL>

<P>
Register (R/W) $68 (68) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ULA Control
<table width="90%">
bit 7 = Disable ULA output (0 on reset)
bit 6-5 = Color blending control for layering modes 6 &amp; 7 (3.01.01)

<UL>
<LI>00 = ULA as blend colour
</LI>
<LI>01 = No blending
</LI>
<LI>10 = ULA/Tilemap mix result as blend colour
</LI>
<LI>11 = Tilemap as blend colour
</LI>
</UL>
bit 4 = Cancel entries in 8x5 matrix for extended keys (3.01.04)
bit 3 = Enable ULAplus (0 on reset)
bit 2 = Enable ULA half pixel scroll (0 on reset)<tr><td valign="top">&nbsp;may change
bit 1 = Reserved (must be 0)
bit 0 = Enable stencil mode (0 on reset)</td></tr>
<tr><td valign="top">&nbsp;When ULA and Layer 3 are enabled, if either are transparent,
  the result is transparent, otherwise the result is the logical AND
  of both colours.
</td></tr></table>

<P>
Bit 0 can be set to choose stencil mode for the combined output of the
ULA and tilemap. Bit 6 determines what colour is used in SLU modes 6 &amp;
7 where the ULA is combined with Layer 2 to generate highlighting
effects.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
@{" Changes Since 2.00.26 " LINK NODE44}
@{" Future Direction " LINK NODE45}
</UL></UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node44.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node36.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node42.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html617"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html619"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node44.html">Changes Since 2.00.26</A>
<B> Up:</B> <A
 HREF="node36.html">Layer 3 (Tilemap) Mode</A>
<B> Previous:</B> <A
 HREF="node42.html">Combining ULA &amp; Tilemap</A>
 &nbsp; <B>  <A ID="tex2html618"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html620"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node044.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Changes Since 2.00.26</TITLE>
<META NAME="description" CONTENT="Changes Since 2.00.26">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node45.html">
<LINK REL="previous" HREF="node43.html">
<LINK REL="next" HREF="node45.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node45.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node43.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node43.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html623"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html625"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node45.html">Future Direction</A>
<B> Up:</B> <A
 HREF="node43.html">Programming Tilemap mode</A>
<B> Previous:</B> <A
 HREF="node43.html">Programming Tilemap mode</A>
 &nbsp; <B>  <A ID="tex2html624"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html626"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00345010000000000000">
Changes Since 2.00.26</A>
</H4>

<P>

<OL>
<LI>512 Tile Mode. In 2.00.26, the 512 tile mode was automatically
  selected when the ULA was disabled. With the ULA disabled, the
  tilemap attribute bit “ULA on top” was re-purposed to be bit 8 of
  the tile number. In 2.00.27, selection of the 512 tile mode is moved
  to bit 1 of Tilemap Control nextreg $6B. This way 512 tile mode can
  be independently chosen without disabling the ULA. The “ULA on top”
  bit is still taken as bit 8 of the tile number and in the 512 mode,
  the tilemap is always displayed underneath the ULA.
</LI>
<LI>Tilemap Always On Top of ULA. In 2.00.27, bit 0 of Tilemap
  Control nextreg $6B is used to indicate that the tilemap should
  always be displayed on top of the ULA. This allows the tilemap to
  display over the ULA when in 512 mode.
</LI>
<LI>1-bit tilemaps. In 3.00.00, a number of modifications were made
  to accomidate 1-bit tilemaps.
</LI>
</OL>

<P>
<BR><HR>

</BODY>
</HTML>
node045.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Future Direction</TITLE>
<META NAME="description" CONTENT="Future Direction">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node44.html">
<LINK REL="next" HREF="node46.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node46.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node43.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node44.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html627"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html629"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node46.html">Sprites</A>
<B> Up:</B> <A
 HREF="node43.html">Programming Tilemap mode</A>
<B> Previous:</B> <A
 HREF="node44.html">Changes Since 2.00.26</A>
 &nbsp; <B>  <A ID="tex2html628"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html630"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00345020000000000000">
Future Direction</A>
</H4>

<P>
The following compatible changes may be applied at a later date:

<P>

<OL>
<LI>Addition of a bit to Tilemap Control to select a reduced tilemap
  area of size <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img15.svg"
 ALT="$32\times24$"></SPAN> or <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img25.svg"
 ALT="$64\times24$"></SPAN> that covers the ULA
  screen.
</LI>
<LI>Addition of a bit to Tilemap Control to select split addressing
  where the tilemap’s tiles and attributes as well as the tile
  definitions are split between the two 8k halves of the 16k ULA ram
  in the same way that the two Timex display files are split. The
  intention is to make it easier for the tilemap to co-exist with all
  the display modes of the ULA.
</LI>
</OL>
<BR><HR>

</BODY>
</HTML>
node046.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Sprites</TITLE>
<META NAME="description" CONTENT="Sprites">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node36.html">
<LINK REL="next" HREF="node47.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node47.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node45.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html631"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html633"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node47.html">Sprite Patterns</A>
<B> Up:</B> <A
 HREF="node3.html">Video</A>
<B> Previous:</B> <A
 HREF="node45.html">Future Direction</A>
 &nbsp; <B>  <A ID="tex2html632"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html634"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00350000000000000000">
Sprites</A>
</H1>

<P>
February 25, 2019  Victor Trucco

<P>
The Spectrum Next has a hardware sprite system with the following
characteristics:

<P>

<UL>
<LI>Total of 128 sprites
</LI>
<LI>Display surface is <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img2.svg"
 ALT="$320\times 256$"></SPAN> overlapping the ULA screen by
  32 pixels on each side
</LI>
<LI>Minimum of 100 sprites per scanline*
</LI>
<LI>Choice of 512 colours for each pixel
</LI>
<LI>Site of each sprite is <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> pixels but sprites can be
  magnified <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN>, <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img35.svg"
 ALT="$4\times$"></SPAN> or <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN> horizontally and
  vertically
</LI>
<LI>Sprites can be mirrored and rotated
</LI>
<LI>Sprites can be grouped together to form larger sprites under the
  control of a single anchor
</LI>
<LI>A 16K pattern memory can contain 64 8-bit sprite images or 128
  4-bit sprite images and combinations in-between
</LI>
<LI>A per sprite palette offset allows sprites to share images but
  colour them differently
</LI>
<LI>A nextreg interface allows the copper to move sprites during the
  video frame
</LI>
</UL>

<P>
*A minimum of 100 <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> sprites is guaranteed to be displayed
in any scanline. Any additional sprites will not be displayed with the
hardware ensuring sprites are not partially plotted.

<P>
The actual limit is determined by how many 28MHz clock cycles there
are in a scanline. The sprite hardware is able to plot one pixel cycle
and uses one cycle to qualify each sprite. Since the number of cycles
there are in a scanline varies with video timing (HDMI, VGA), the
number of pixels that can be plotted also varies but the minimum will
be 1600 pixels per line including overhead cycles needed to qualify
100 sprites. Since sprites magified horizontally involve plotting more
pixels, <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN>, <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img35.svg"
 ALT="$4\times$"></SPAN>, and <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN> sprites will take more
cycles to plot and the presence of these sprites in a line will reduce
the total number of sprites that can be plotted.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Sprite Patterns " LINK NODE47}
@{" Pattern Number " LINK NODE48}
@{" 8-Bit Sprite Patterns " LINK NODE49}
@{" 4-Bit Sprite Patterns " LINK NODE50}
</UL>
</UL>
<BR>
@{" Sprite Palette " LINK NODE51}
@{" Sprite Attributes " LINK NODE52}
@{" Relative Sprites " LINK NODE53}
@{" Programming Sprites " LINK NODE54}
@{" Global Control of Sprites " LINK NODE55}
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node47.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node45.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html631"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html633"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node47.html">Sprite Patterns</A>
<B> Up:</B> <A
 HREF="node3.html">Video</A>
<B> Previous:</B> <A
 HREF="node45.html">Future Direction</A>
 &nbsp; <B>  <A ID="tex2html632"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html634"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node047.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Sprite Patterns</TITLE>
<META NAME="description" CONTENT="Sprite Patterns">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node51.html">
<LINK REL="previous" HREF="node46.html">
<LINK REL="next" HREF="node48.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node48.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html644"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html646"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node48.html">Pattern Number</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node46.html">Sprites</A>
 &nbsp; <B>  <A ID="tex2html645"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html647"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00351000000000000000">
Sprite Patterns</A>
</H2>
Sprite patterns are the images that each sprite can take on. The
images are stored in a 16K memory internal to the FPGA and are
identified by pattern number. A particular sprite chooses a pattern by
storing a pattern number in its attributes.

<P>
All sprites are <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> pixels in size but the come in two
flavours: 4-bit and 8-bit. The bit width describes how many bits are
used to code the colour of each pixel.

<P>
An 8-bit sprite uses a full byte to colour each of its pixels so that
each pixel can be one of 256 colours. In this case, a <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN>
sprite requires 256 bytes of pattern memory to store its image.

<P>
A 4-bit sprite uses a nibble to colour each of its pixels so that each
pixel can be one of 16 colours. In this case, a <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> sprite
requires just 128 bytes of pattern memory to store its image.

<P>
The 16K pattern memory can contain any combination of these images,
whether they are 128 bytes or 256 bytes and their locations in the
pattern memory are described by a pattern number. This pattern number
is 7 bits with bits named as follows:

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
@{" Pattern Number " LINK NODE48}
@{" 8-Bit Sprite Patterns " LINK NODE49}
@{" 4-Bit Sprite Patterns " LINK NODE50}
</UL></UL></UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node48.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html644"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html646"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node48.html">Pattern Number</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node46.html">Sprites</A>
 &nbsp; <B>  <A ID="tex2html645"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html647"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node048.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Pattern Number</TITLE>
<META NAME="description" CONTENT="Pattern Number">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node47.html">
<LINK REL="next" HREF="node49.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node49.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node47.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node47.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html651"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html653"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node49.html">8-Bit Sprite Patterns</A>
<B> Up:</B> <A
 HREF="node47.html">Sprite Patterns</A>
<B> Previous:</B> <A
 HREF="node47.html">Sprite Patterns</A>
 &nbsp; <B>  <A ID="tex2html652"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html654"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00351010000000000000">
Pattern Number</A>
</H4>
<PRE>
N5 N4 N3 N2 N1 N0 N6
</PRE>
N6, despite the name, is the least significant bit.

<P>
This 7-bit pattern number can identify 128 patterns in the 16k pattern
memory, each of which are 128 bytes in size. The full 7-bits are
therefore used for 4-bit sprites.

<P>
For 8-bit sprites, N6=0 always. The remaining 6 bits can identify 64
patterns, each of which is 256 bytes in size.

<P>
The N5:N0,N6 bits are stored in a particular sprite’s attributes to
identify which image a sprite uses.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" 8-Bit Sprite Patterns " LINK NODE49}
@{" 4-Bit Sprite Patterns " LINK NODE50}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node049.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>8-Bit Sprite Patterns</TITLE>
<META NAME="description" CONTENT="8-Bit Sprite Patterns">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node50.html">
<LINK REL="previous" HREF="node48.html">
<LINK REL="next" HREF="node50.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node50.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node48.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html657"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html659"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node50.html">4-Bit Sprite Patterns</A>
<B> Up:</B> <A
 HREF="node48.html">Pattern Number</A>
<B> Previous:</B> <A
 HREF="node48.html">Pattern Number</A>
 &nbsp; <B>  <A ID="tex2html658"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html660"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00351011000000000000">
8-Bit Sprite Patterns</A>
</H5>

<P>
The <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> pixel image uses 8-bits for each pixel so that each
pixel can be one of 256 colours. One colour indicates transparency and
this is programmed into the Sprite Transparency Index register
(nextreg $4B). By default the transparent value is $E3.

<P>
As an example of an 8-bit sprite, let’s have a look at figure 1.1.

<P>

<DIV class="CENTER"><A ID="425"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 2.1:</STRONG>
Pattern Example</CAPTION>
<TR><TD>
<DIV class="CENTER">  <IMG STYLE=""
 SRC="./sprite_1.png"
 ALT="Image sprite_1">
  </DIV></TD></TR>
</TABLE>
</DIV>

<P>
Using the default palette, which is initialised with RGB332 colours
from 0-255, the hexadecimal values for this pattern arranged in a
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> array are shown below:

<P>
<PRE>
04040404040404E3E3E3E3E3E3E3E3E3
04FFFFFFFFFF04E3E3E3E3E3E3E3E3E3
04FFFBFBFBFF04E3E3E3E3E3E3E3E3E3
04FFFBF5F5FBFF04E3E3E3E3E3E3E3E3
04FFFBF5A8A8FBFF04E3E3E3E3E3E3E3
04FFFFFBA844A8FBFF04E3E3E3E3E3E3
040404FFFBA844A8FBFF04E3E3E3E3E3
E3E3E304FFFBA84444FBFF04E304E3E3
E3E3E3E304FFFB444444FBFF044D04E3
E3E3E3E3E304FFFB44444444FA4D04E3
E3E3E3E3E3E304FFFB44FFF54404E3E3
E3E3E3E3E3E3E304FF44F5A804E3E3E3
E3E3E3E3E3E3E3E304FA4404A804E3E3
E3E3E3E3E3E3E3044D4D04E304F504E3
E3E3E3E3E3E3E3E30404E3E3E304FA04
E3E3E3E3E3E3E3E3E3E3E3E3E3E30404
</PRE>
Here $E3 is used as the transparent index.

<P>
These 256 bytes would be stored in pattern memory in left to right,
top to bottom order.

<P>
<BR><HR>

</BODY>
</HTML>
node050.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>4-Bit Sprite Patterns</TITLE>
<META NAME="description" CONTENT="4-Bit Sprite Patterns">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node49.html">
<LINK REL="next" HREF="node51.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node51.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node48.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node49.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html661"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html663"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node51.html">Sprite Palette</A>
<B> Up:</B> <A
 HREF="node48.html">Pattern Number</A>
<B> Previous:</B> <A
 HREF="node49.html">8-Bit Sprite Patterns</A>
 &nbsp; <B>  <A ID="tex2html662"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html664"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00351012000000000000">
4-Bit Sprite Patterns</A>
</H5>

<P>
The <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> pixel image uses 4-bits for each pixel so that each
pixel can be one of 16 colours. One colour indicates transparency and
this is programmed into the lower 4-bits of the Sprite Transparency
Index register (nextreg $4B). By default the transparency value is
$3. Note that the same register is shared with 8-bit patterns to
identify the transparent index.

<P>
Since each pixel only occupies 4-bits, two pixels are stored in each
byte. The leftmost pixel is stored in the upper 4-bits and the
rightmost pixel is stored in the lower 4-bits.

<P>
As an example we will use the same sprite image as was given in the
8-bit pattern example. Here only the lower 4 bits of each pixel is
retained to confine each pixel’s color to 4-bits:

<P>
<PRE>
4444444333333333
4FFFFF4333333333
4FBBBF4333333333
4FB55BF433333333
4FB588BF43333333
4FFB848BF4333333
444FB848BF433333
3334FB844BF43433
33334FB444BF4D43
333334FB4444AD43
3333334FB4F54433
33333334F4584333
333333334A448433
33333334DD434543
33333333443334A4
3333333333333344
</PRE>

<P>
$3 is used as the transparent index.

<P>
These 128 bytes would be stored in pattern memory in left to right,
top to bottom order.

<P>
The actual colour that will appear on screen will depend on the
palette, described below. The default palette will not likely generate
suitable colours for 4-bit sprites.

<P>
<BR><HR>

</BODY>
</HTML>
node051.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Sprite Palette</TITLE>
<META NAME="description" CONTENT="Sprite Palette">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node52.html">
<LINK REL="previous" HREF="node47.html">
<LINK REL="next" HREF="node52.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node52.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node50.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html665"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html667"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node52.html">Sprite Attributes</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node50.html">4-Bit Sprite Patterns</A>
 &nbsp; <B>  <A ID="tex2html666"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html668"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00352000000000000000"></A>
<A NAME="433"></A>
<BR>
Sprite Palette
</H2>
Each pixel of a sprite image is 8-bit for 8-bit patterns or 4-bit for
4-bit patterns. The pixel value is known as a pixel colour index. This
colour index is combined with the sprite’s palette offset. The palette
offset is a 4-bit value added to the top 4-bits of the pixel colour
index. The purpose of the palette offset is to allow a sprite to
change the colour of an image.

<P>
The final sprite colour index generated by the sprite hardware is then
the sum of the pixel index and the 4-bit palette offset. In pictures
using binary math:

<P>
<PRE>
8-bit Sprite
PPPP0000
+ IIIIIIII
----------
SSSSSSSS

4-bit Sprite
PPPP0000
+ 0000IIII
----------
SSSSSSSS = PPPPIIII
</PRE>

<P>
Where “PPPP” is the 4-bit palette offset from the sprite’s attributes
and the “I”s represent the pixel value from the sprite pattern. The
final sprite index is represented by the 8-bit value “SSSSSSSS”.

<P>
For 4-bit sprites the palette offset can be thought of as selecting
one of 16 different 16-colour palettes.

<P>
This final 8-bit sprite index is then passed through the sprite
palette which acts like a lookup table that returns the 9-bit RGB333
colour associated with the sprite index.

<P>
At power up, the sprite palette is initialized such that the sprite
index passes through unchanged and is therefore interpretted as an
RGB332 colour. The missing third blue bit is generated as the logical
OR of the two other blue bits. In short, for 8-bit sprites, the sprite
index also acts like the colour when using the default palette.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node52.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node50.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html665"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html667"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node52.html">Sprite Attributes</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node50.html">4-Bit Sprite Patterns</A>
 &nbsp; <B>  <A ID="tex2html666"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html668"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node052.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Sprite Attributes</TITLE>
<META NAME="description" CONTENT="Sprite Attributes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node53.html">
<LINK REL="previous" HREF="node51.html">
<LINK REL="next" HREF="node53.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node53.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node51.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html669"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html671"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node53.html">Relative Sprites</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node51.html">Sprite Palette</A>
 &nbsp; <B>  <A ID="tex2html670"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html672"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00353000000000000000">
Sprite Attributes</A>
</H2>
A sprite’s attributes is a list of properties that determine how and
where the sprite is drawn.

<P>
Each sprite is described by either 4 or 5 attribute bytes listed
below:

<P>
Sprite Attribute 0
<PRE>
X X X X X X X X
</PRE>
The least significant eight bits of the sprite’s X coordinate. The
ninth bit is found in sprite attribute 2.

<P>
Sprite Attribute 1
<PRE>
Y Y Y Y Y Y Y Y
</PRE>
The least significant eight bits of the sprite’s Y coordinate. The
ninth bit is optional and is found in attribute 4.

<P>
Sprite Attribute 2
<PRE>
P P P P XM YM R X8/PR
</PRE>
P = 4-bit Palette Offset
<BR>
XM = 1 to mirror the sprite image horizontally
<BR>
YM = 1 to mirror the sprite image vertically
<BR>
R = 1 to rotate the sprite image 90 degrees clockwise
<BR>
X8 = Ninth bit of the sprite’s X coordinate
<BR>
PR = 1 to indicate P is relative to the anchor’s palette offset
(relative sprites only)
<BR>
Rotation is applied before mirroring.
<BR>
Relative sprites, described below, replace X8 with PR.

<P>

<DIV class="CENTER"><A ID="445"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 2.2:</STRONG>
All Rotate and Mirror Flags</CAPTION>
<TR><TD>
<DIV class="CENTER">  <IMG STYLE=""
 SRC="./flags.png"
 ALT="Image flags">
  </DIV></TD></TR>
</TABLE>
</DIV>

<P>
Sprite Attribute 3
<PRE>
V E N5 N4 N3 N2 N1 N0
</PRE>
V = 1 to make the sprite visible
<BR>
E = 1 to enable attribute byte 4
<BR>
N = Sprite pattern to use 0-63
<BR>
If E=0, the sprite is fully described by sprite attributes 0-3. The
sprite pattern is an 8-bit one identified by pattern N=0-63. The
sprite is an anchor and cannot be made relative. The sprite is
displayed as if sprite attribute 4 is zero.
<BR>
If E=1, the sprite is further described by sprite attribute 4.

<P>
Sprite Attribute 4
<DL class="COMPACT">
<DT>A.</DT>
<DD>Extended Anchor Sprite
<PRE>
H N6 T X X Y Y Y8
</PRE>
H = 1 if the sprite pattern is 4-bit
<BR>
N6 = 7th pattern bit if the sprite pattern is 4-bit
<BR>
T = 0 if relative sprites are composite type else 1 for unified type
<BR>
XX = Magnification in the X direction (00 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img37.svg"
 ALT="$1\times$"></SPAN>, 01 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN>,
10 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img38.svg"
 ALT="$4\times4$"></SPAN>, 11 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN>)
<BR>
YY = Magnification in the Y direction (00 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img37.svg"
 ALT="$1\times$"></SPAN>, 01 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN>,
10 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img35.svg"
 ALT="$4\times$"></SPAN>, 11 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN>)
<BR>
Y8 = Ninth bit of the sprite’s Y coordinate
<BR>
H,N6 must not equal 0,1 as this combination is used to indicate a
relative sprite.

<P>
</DD>
<DT>B.</DT>
<DD>Relative Sprite, Composite Type
<PRE>
0 1 N6 X X Y Y PO
</PRE>
N6 = 7th pattern bit if the sprite pattern is 4-bit
<BR>
XX = Magnification in the X direction (00 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img37.svg"
 ALT="$1\times$"></SPAN>, 01 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN>,
10 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img35.svg"
 ALT="$4\times$"></SPAN>, 11 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN>)
<BR>
YY = Magnification in the Y direction (00 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img37.svg"
 ALT="$1\times$"></SPAN>, 01 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN>,
10 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img35.svg"
 ALT="$4\times$"></SPAN>, 11 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN>)
<BR>
PO = 1 to indicate the sprite pattern number is relative to the
anchor’s

<P>
</DD>
<DT>C.</DT>
<DD>Relative Sprite, Unified Type
<PRE>
0 1 N6 0 0 0 0 PO
</PRE>
N6 = 7th pattern bit if the sprite pattern is 4-bit
<BR>
PO = 1 to indicate the sprite pattern number is relative to the
anchor’s
</DD>
</DL>
The display surface for sprites is <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img2.svg"
 ALT="$320\times 256$"></SPAN>. The X coordinate of
the sprite is nine bits, ranging over 0-511, and the Y coordinate is
optionally nine bits again ranging over 0-511 or is eight bits ranging
over 0-255. The full extent 0-511 wraps on both axes, meaning a sprite
16 pixels wide plotted at X coordinate 511 would see its first pixel
not displayed (coordinate 511) and the following pixels displayed in
coordinates 0-14.

<P>
The full display area is visible in VGA. However, the HDMI display is
vertically shorter so the top eight pixel rows (Y = 0-7) and the
bottom eight pixel rows (Y = 248-255) will not be visible on an HDMI
display.

<P>
Sprites can be fully described by sprite attributes 0-3 if the E bit
in sprite attribute 3 is zero. These sprites are compatible with the
original sprite module from core versions prior to 2.00.26.

<P>
If the E bit is set then a fifth sprite attribute, sprite attribute 4,
becomes active. This attribute introduces scaling, 4-bit patterns, and
relative sprites. Scaling is self-explanatory and 4-bit patterns were
described in the last section. Relative sprites are described in the
next section.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node53.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node51.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html669"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html671"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node53.html">Relative Sprites</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node51.html">Sprite Palette</A>
 &nbsp; <B>  <A ID="tex2html670"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html672"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node053.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Relative Sprites</TITLE>
<META NAME="description" CONTENT="Relative Sprites">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node54.html">
<LINK REL="previous" HREF="node52.html">
<LINK REL="next" HREF="node54.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node54.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node52.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html673"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html675"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node54.html">Programming Sprites</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node52.html">Sprite Attributes</A>
 &nbsp; <B>  <A ID="tex2html674"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html676"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00354000000000000000">
Relative Sprites</A>
</H2>
Normal sprites (sprites that are not relative) are known as anchor
sprites. As the sprite module draws sprites in the order 0-127 (there
are 128 sprites), it internally stores characteristics of the last
anchor sprite seen. If following sprites are relative, they inherit
some of these characteristics, which allows relative sprites to have,
among other things, coordinates relative to the anchor. This means
moving the anchor sprite also causes its relatives to move with it.

<P>
There are two types of relative sprites supported known as “Composite
Sprites” and “Unified Sprites”. The type is determined by the anchor
in the T bit of sprite attribute 4.

<P>
<DL class="COMPACT">
<DT>A.</DT>
<DD>Composite Sprites
<BR>
The sprite module records the following information from the anchor:
  
<UL>
<LI>Anchor.visible
</LI>
<LI>Anchor.Y
</LI>
<LI>Anchor.palette_offset
</LI>
<LI>Anchor.N (pattern number)
</LI>
<LI>Anchor.H (indicates if the sprite uses 4-bit patterns)
  
</LI>
</UL>
  These recorded items are not used by composite sprites:
  
<UL>
<LI>Anchor.rotate
</LI>
<LI>Anchor.xmirror
</LI>
<LI>Anchor.ymirror
</LI>
<LI>Anchor.xscale
</LI>
<LI>Anchor.yscale
  
</LI>
</UL>
  The anchor determines if all its relative sprites use 4-bit patterns or not.

<P>
The visibility of a particular relative sprite is the result of
  ANDing the anchor’s visibility with the relative sprite’s
  visibility. In other words, if the anchor is invisible then so are
  all its relatives.

<P>
Relative sprites only have 8-bit X and Y coordinates (the ninth bits
  are taken for other purposes). These are signed offsets from the
  anchor’s X,Y coordinate. Moving the anchor moves all its relatives
  along with it.

<P>
If the relative sprite has its PR bit set in sprite attribute 2,
  then the anchor’s palette offset is added to the relative sprite’s
  to determine the active palette offset for the relative
  sprite. Otherwise the relative sprite uses its own palette offset as
  usual.

<P>
If the relative sprite has its PO bit set in sprite attribute 4,
  then the anchor’s pattern number is added to the relative sprite’s
  to determine the pattern used for display. Otherwise the relative
  sprite uses its own pattern number as usual. The intention is to
  supply a method to easily animate a large sprite by manipulating the
  pattern number in the anchor.

<P>
A composite sprite is like a collection of independent sprites tied
  to an anchor.

<P>
</DD>
<DT>B.</DT>
<DD>Unified Sprites

<P>
Unified sprites are a further extension of the
  composite type. The same information is recorded from the anchor and
  the same behaviour as described under composite sprites applies.

<P>
The difference is the collection of anchor and relatives is treated
  as if it were a single <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> sprite. The anchor’s rotation,
  mirror, and scaling bits apply to all its relatives. Rotating the
  anchor causes all the relatives to rotate around the
  anchor. Mirroring the anchor causes the relatives to mirror around
  the anchor. The sprite hardware will automatically adjust X,Y coords
  and rotation, scaling and mirror bits of all relatives according to
  settings in the anchor.

<P>
Unified sprites should be defined as if all its parts are
  <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN> in size with the anchor controlling the look of the
  whole.

<P>
A unified sprite is like a big version of an individual <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img33.svg"
 ALT="$16\times16$"></SPAN>
  sprite controlled by the anchor.
</DD>
</DL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node54.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node52.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html673"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html675"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node54.html">Programming Sprites</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node52.html">Sprite Attributes</A>
 &nbsp; <B>  <A ID="tex2html674"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html676"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node054.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Programming Sprites</TITLE>
<META NAME="description" CONTENT="Programming Sprites">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node55.html">
<LINK REL="previous" HREF="node53.html">
<LINK REL="next" HREF="node55.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node55.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node53.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html677"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html679"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node55.html">Global Control of Sprites</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node53.html">Relative Sprites</A>
 &nbsp; <B>  <A ID="tex2html678"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html680"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00355000000000000000">
Programming Sprites</A>
</H2>

<P>
Sprites are created via three io registers and a nextreg interface.

<P>
Port $303B (303B) Sprite Slot/Flags
<BR>
Write: Sprite Slot Select
<BR>
select sprite slot for Sprite Attribute and Sprite Pattern ports which
independently auto-increment
<BR>
Read: Sprite status
<table width="90%"><tr><td valign="top">&nbsp;bits 7-2 = reserved</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Max sprites per line</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Collision flag
</td></tr></table>

<P>
<PRE>
X S S S S S S S
N6 X N N N N N N
</PRE>
A write to this port has two effects.

<P>
One is it selects one of 128 sprites for writing sprite attributes via
port $57.

<P>
The other is it selects one of 128 4-bit patterns in pattern memory
for writing sprite patterns via port $5B. The N6 bit shown is the
least significant in the 7-bit pattern number and should always be
zero when selecting one of 64 8-bit patterns indicated by N.

<P>
Port $57 (57) Sprite Attributes
<BR>
Byte 1
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = LSB of X coordinate (bit 8 is in byte 3)
</td></tr></table>

Byte 2
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = LSB of Y coordinate (bit 8 is in byte 5)
</td></tr></table>

Byte 3
<table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Palette Offset</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Enable X Mirror</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Enable Y Mirror</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Enable Roration</td></tr>
<tr><td valign="top">&nbsp;bit 0 = By Sprite Type
  <table width="90%">  <tr><td valign="top">&nbsp;Anchor = MSB of X coordinate
  </td></tr>
<tr><td valign="top">&nbsp;Relative = Enable relative palette offset
  </td></tr></table>
</td></tr></table>

Byte 4
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Enable visibility</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Enable Byte 5</td></tr>
<tr><td valign="top">&nbsp;bit 5-0 = Pattern Index (&ldquo;name&rdquo;)
</td></tr></table>

Byte 5 (optional)
<BR>
Anchor
<table width="90%"><tr><td valign="top">&nbsp;bit 7-6 = type and pattern
  <table width="90%">  <tr><td valign="top">&nbsp;00 = 8-bit color
  </td></tr>
<tr><td valign="top">&nbsp;01 = relative
  </td></tr>
<tr><td valign="top">&nbsp;10 = 4-bit color, lower half of pattern (bytes 0-127)
  </td></tr>
<tr><td valign="top">&nbsp;11 = 4-bit color, upper half of pattern (byets 128-255)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Attached relative sprite type
  <table width="90%">  <tr><td valign="top">&nbsp;0 = composite
  </td></tr>
<tr><td valign="top">&nbsp;1 = big sprite
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 4-3 = X-axis scale factor
  <table width="90%">  <tr><td valign="top">&nbsp;00 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img37.svg"
 ALT="$1\times$"></SPAN>
  </td></tr>
<tr><td valign="top">&nbsp;01 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN> 
  </td></tr>
<tr><td valign="top">&nbsp;10 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img35.svg"
 ALT="$4\times$"></SPAN> 
  </td></tr>
<tr><td valign="top">&nbsp;11 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN></td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 2-1 = Y-axis scale factor</td></tr>
<tr><td valign="top">&nbsp;bit 0 = MSB of Y coordinate
</td></tr></table>

Composite Relative
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = 01</td></tr>
<tr><td valign="top">&nbsp;bit 5 = N6
<BR>
8-bit
  <table width="90%">  <tr><td valign="top">&nbsp;Reserved, must be 0
  </td></tr></table>

  4-bit
  <table width="90%">  <tr><td valign="top">&nbsp;0 = lower half of pattern (bytes 0-127)
  </td></tr>
<tr><td valign="top">&nbsp;1 = upper half of pattern (bytes 128-255)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 4-3 = X-axis scale factor</td></tr>
<tr><td valign="top">&nbsp;bit 2-1 = Y-axis scale factor</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Enable relative pattern offset
</td></tr></table>

Big-sprite Relative
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = 01</td></tr>
<tr><td valign="top">&nbsp;bit 5 = N6
<BR>
8-bit
  <table width="90%">  <tr><td valign="top">&nbsp;Reserved, must be 0
  </td></tr></table>

  4-bit
  <table width="90%">  <tr><td valign="top">&nbsp;0 = lower half of pattern (bytes 0-127)
  </td></tr>
<tr><td valign="top">&nbsp;1 = upper half of pattern (bytes 128-255)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 4-1 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Enable relative pattern offset
</td></tr></table>

<P>
Once a sprite is selected via port $303B, its attributes can be
written to this port one byte after another. Sprites can have either
four or five attribute bytes and the internal attribute pointer will
move onto the next sprite after those four or five attribute bytes are
written. This means you can select a sprite via port $303B and write
attributes for as many sequential sprites as desired. The attribute
pointer will roll over from sprite 127 to sprite 0.

<P>
Port $5B (5B) Sprite Pattern
<BR>
Load data into sprite pattern memory auto-incrementing. Port $303B
can be used to set the starting sprite pattern number.

<P>
Once a pattern number is selected via port $303B, the 256-byte or
128-byte pattern can be written to this port. The internal pattern
pointer auto-increments after each write so as many sequential
patterns as desired can be written. The internal pattern pointer will
roll over from pattern 127 to pattern 0 (4-bit patterns) or from
pattern 63 to pattern 0 (8-bit patterns) automatically.

<P>
Port $303B (R)

<P>
<PRE>
0 0 0 0 0 0 M C
</PRE>
M = 1 if the maximum number of sprites per line was exceeded
<BR>
C = 1 if any two displayed sprites collide on screen
<BR>
Reading this port automatically resets the M and C bits.

<P>
Besides the i/o interface, there is a nextreg interface to sprite
attributes. The nextreg interface allows the copper to manipulate
sprites and grants the program random access to a sprite’s individual
attribute bytes.

<P>
Register (R/W) $34 (34) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Number
<BR>
Lockstep (NextReg $09 bit 4 set)
<table width="90%">
bit 7 = Pattern address offset (Add 128 to pattern address)
bits 6-0 = Sprite number 0-127, Pattern number 0-63<tr><td valign="top">&nbsp;effectively performs an out to port $303B
</td></tr></table>

No Lockstep (NextReg $09 bit 4 clear)

<UL>
<LI>bit 7 = Reserved, must be 0
</LI>
<LI>bits 6-0 = Sprite number 0-127
</LI>
</UL>
This register selects which sprite has its attributes connected to the
sprite attribute registers

<P>
Register (W) $35 (35) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 0

<UL>
<LI>bits 7-0 = Sprite X coordinate LSB (MSB in NextReg $37)
</LI>
</UL>

<P>
Register (W) $75 (75) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 0 (Auto-incrementing)
<BR>
See nextreg $35

<P>
Register (W) $36 (36) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 1

<UL>
<LI>bits 7-0 = Sprite Y coordinate LSB (MSB in NextReg $39)
</LI>
</UL>

<P>
Register (W) $76 (76) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 1 (Auto-incrementing)
<BR>
See nextreg $36

<P>
Register (W) $37 (37) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 2

<UL>
<LI>bits 7-4 = 4-bit Palette offset
</LI>
<LI>bit 3 = Enable horizontal mirror (reverse)
</LI>
<LI>bit 2 = Enable vertical mirror (reverse)
</LI>
<LI>bit 1 = Enable 90<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img39.svg"
 ALT="$^O$"></SPAN> Clockwise Rotation
</LI>
</UL>
Normal Sprites

<UL>
<LI>bit 0 = X coordinate MSB
</LI>
</UL>
Relative Sprites

<UL>
<LI>bit 0 = Palette offset is relative to anchor sprite
</LI>
</UL>
Rotation is applied before mirroring

<P>
Register (W) $77 (77) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 2 (Auto-incrementing)
<BR>
See nextreg $37

<P>
Register (W) $38 (38) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 3

<UL>
<LI>bit 7 = Enable Visiblity
</LI>
<LI>bit 6 = Enable Attribute 4 (0 = Attribute 4 effectively $00)
</LI>
<LI>bits 5-0 = Sprite Pattern Number
</LI>
</UL>

<P>
Register (W) $78 (78) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 3 (Auto-incrementing)
<BR>
See nextreg $38

<P>
Register (W) $39 (39) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 4
<BR>
Normal Sprites

<UL>
<LI>bit 7 = 4-bit pattern switch (0 = 8-bit sprite, 1 = 4-bit sprite)
</LI>
<LI>bit 6 = Pattern number bit-7 for 4-bit, 0 for 8-bit
</LI>
<LI>bit 5 = Type of attached relative sprites (0 = Composite, 1 =
  Unified)
</LI>
<LI>bits 4-3 = X scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bits 2-1 = Y scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bit 0 = MSB of Y coordinate
</LI>
</UL>
Relative, Composite Sprites

<UL>
<LI>bit 7-6 = 01
</LI>
<LI>bit 5 = Pattern number bit-7 for 4-bit, 0 for 8-bit
</LI>
<LI>bits 4-3 = X scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bits 2-1 = Y scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bit 0 = Pattern number is relative to anchor
</LI>
</UL>
Relative, Unified Sprites

<UL>
<LI>bit 7-6 = 01
</LI>
<LI>bit 5 = Pattern number bit-7 for 4-bit, 0 for 8-bit
</LI>
<LI>bits 4-1 = 0000
</LI>
<LI>bit 0 = Pattern number is relative to anchor
</LI>
</UL>

<P>
Register (W) $79 (79) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 4 (Auto-incrementing)
<BR>
See nextreg $39

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node55.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node53.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html677"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html679"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node55.html">Global Control of Sprites</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node53.html">Relative Sprites</A>
 &nbsp; <B>  <A ID="tex2html678"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html680"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node055.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Global Control of Sprites</TITLE>
<META NAME="description" CONTENT="Global Control of Sprites">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node54.html">
<LINK REL="next" HREF="node56.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node56.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node54.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html681"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html683"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node56.html">Audio</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node54.html">Programming Sprites</A>
 &nbsp; <B>  <A ID="tex2html682"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html684"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00356000000000000000">
Global Control of Sprites</A>
</H2>

<P>
The following nextreg are also of interest for sprites.

<P>
Register (R/W) $09 (09) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 4 setting:
<table width="90%">
bit 7 = PSG 2 Mono Enable (0 on hard reset)
bit 6 = PSG 1 Mono Enable (0 on hard reset)
bit 5 = PSG 0 Mono Enable (0 on hard reset)
bit 4 = Sprite ID lockstep enable (1 = Nextreg $34 and IO Port
  $303B are in lockstep, 0 on reset)
bit 3 = divMMC mapRAM bit Control (reset bit 7 of port $E3)
bit 2 = HDMI audio mute (0 on hard reset)
bits 1-0 = scanlines
  
<UL>
<LI>00 = scanlines off
</LI>
<LI>01 = scanlines 12.5%
</LI>
<LI>10 = scanlines 25%
</LI>
<LI>11 = scanlines 50%
  
</LI>
</UL><tr><td valign="top">&nbsp;In Sprite lockstep, NextREG $34 and Port $303B are in
  lockstep
</td></tr></table>

<P>
Register (R/W) $15 (15) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite and Layer System Setup

<UL>
<LI>bit 7 = LoRes mode (0 on reset)
</LI>
<LI>bit 6 = Sprite priority (1 = sprite 0 on top, 0 = sprite 127 on
  top) (0 on reset)
</LI>
<LI>bit 5 = Enable sprite clipping in over border mode (0 on reset)
</LI>
<LI>bits 4-2 = set layers priorities (000 on reset)
  
<UL>
<LI>000 - S L U
</LI>
<LI>001 - L S U
</LI>
<LI>010 - S U L
</LI>
<LI>011 - L U S
</LI>
<LI>100 - U S L
</LI>
<LI>101 - U L S
</LI>
<LI>110 - S(U+L) ULA and Layer 2 combined, colours clamped to 7
</LI>
<LI>111 - S(U+L-5) ULA and Layer 2 combined, colours clamped to [0,7]
  
</LI>
</UL>
</LI>
<LI>bit 1 = Enable Sprites Over border (0 on reset)
</LI>
<LI>bit 0 = Enable Sprites (0 on reset)
</LI>
</UL>

<P>
The sprite module draws sprites in the order 0-127 in each
scanline. Bit 6 determines whether sprite 0 is topmost or sprite 127
is topmost.

<P>
Bits 4:2 determine layer priority and how sprites overlay or are
obscured by other layers.

<P>
<A NAME="579"></A>
Register (R/W) $19 (19) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Clip Window Definition

<UL>
<LI>bits 7-0 = Cood. of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write - X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write - X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write - Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write - Y2 position
  </td></tr></table>
</LI>
</UL>
The values are 0,255,0,191 after a Reset
<BR>
Reads do not advance the clip position

<P>
When the clip window is enabled for sprites in "over border" mode, the
X coords are internally doubled and the clip window origin is moved to
the sprite origin inside the border.

<P>
When the clip window is enabled for sprites in “over border” mode, the
X coords are internally doubled and the clip window origin is moved to
the sprite origin inside the border.

<P>
Sprites will only be visible inside the clipping window. When not in
over-border mode (bit 1 of nextreg $15) the clipping window is given
in ULA screen coordinates with 0,0 correspoding to the top left corner
of the ULA screen. In over-border mode, the clipping window’s origin
is moved to the sprite coordinate origin 32 pixels to the left and 32
pixels above the ULA screen origin.

<P>
Regardless, sprite position is always in sprite coordinates with 32,32
corresponding to the top left corner of the ULA screen.

<P>
Register (R/W) $1C (1C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Clip Window Control
<BR>
Read

<UL>
<LI>bits 7-6 = Layer 3 Clip Index
</LI>
<LI>bits 5-4 = Layer 0/1 Clip Index
</LI>
<LI>bits 3-2 = Sprite clip index
</LI>
<LI>bits 1-0 = Layer 2 Clip Index
</LI>
</UL>
Write

<UL>
<LI>bits 7-4 = Reserved, must be 0
</LI>
<LI>bit 3 - reset Layer 3 clip index
</LI>
<LI>bit 2 - reset Layer 0/1 clip index
</LI>
<LI>bit 1 - reset sprite clip index.
</LI>
<LI>bit 0 - reset Layer 2 clip index.
</LI>
</UL>

<P>
<A NAME="594"></A>
Register (R/W) $4B (4B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Transparency Index

<UL>
<LI>bits 7-0 = Index value ($E3 if reset)
</LI>
</UL>
For 4-bit sprites only the bottom 4-bits are relevant.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node56.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node46.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node54.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html681"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html683"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node56.html">Audio</A>
<B> Up:</B> <A
 HREF="node46.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node54.html">Programming Sprites</A>
 &nbsp; <B>  <A ID="tex2html682"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html684"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node056.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Audio</TITLE>
<META NAME="description" CONTENT="Audio">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node61.html">
<LINK REL="previous" HREF="node3.html">
<LINK REL="next" HREF="node57.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node57.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node55.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html685"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html687"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node57.html">ZX Spectrum 1-bit</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node55.html">Global Control of Sprites</A>
 &nbsp; <B>  <A ID="tex2html686"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html688"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00400000000000000000">
Audio</A>
</H1>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" ZX Spectrum 1-bit " LINK NODE57}
@{" Sampled 8-bit " LINK NODE58}
@{" Turbosound " LINK NODE59}
@{" Pi Audio " LINK NODE60}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node057.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Spectrum 1-bit</TITLE>
<META NAME="description" CONTENT="ZX Spectrum 1-bit">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node58.html">
<LINK REL="previous" HREF="node56.html">
<LINK REL="next" HREF="node58.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node58.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node56.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node56.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html693"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html695"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node58.html">Sampled 8-bit</A>
<B> Up:</B> <A
 HREF="node56.html">Audio</A>
<B> Previous:</B> <A
 HREF="node56.html">Audio</A>
 &nbsp; <B>  <A ID="tex2html694"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html696"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00410000000000000000">
ZX Spectrum 1-bit</A>
</H1>

<P>
The baseline sound of the ZX Spectrum was produced by toggling the Ear
bit (bit 4) of $fe (254) The ULA port to produce 1-bit audio.  It is
enabled by bit 4 of Next register $08 (8).  While this does work on
the ZX Spectrum Next, there are other much better methods and this is
only supported for backward compatibility.

<P>
Code:
<PRE>
;; enable internal speaker
ld bc,$243B
ld a,$08
out (c),a
ld bc,$253B
in a,(c)
or $10
out (c),a
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node058.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Sampled 8-bit</TITLE>
<META NAME="description" CONTENT="Sampled 8-bit">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node59.html">
<LINK REL="previous" HREF="node57.html">
<LINK REL="next" HREF="node59.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node59.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node56.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node57.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html697"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html699"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node59.html">Turbosound</A>
<B> Up:</B> <A
 HREF="node56.html">Audio</A>
<B> Previous:</B> <A
 HREF="node57.html">ZX Spectrum 1-bit</A>
 &nbsp; <B>  <A ID="tex2html698"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html700"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00420000000000000000">
Sampled 8-bit</A>
</H1>

<P>
The ZX Next has four 8-bit D/A audio channels connected to provide
sampled stereo sound. Channels A and B are the left channels, while C
and D are the right channels. In order use 8-bit sound, it must first
be enabled by setting bit 3 on nextreg $08. In order to emulate
legacy hardware there are a number of ports that can be used to
control the four channels additionally these are mirrored to three
nextregs to enable driving audio using the copper.  Channel A is
mapped to ports $0f, $3f, and $f1; channel B to ports $1f and $f3
and nextreg $2C; channel C to ports $4f, and $f9 and nextreg $2E;
and channel D to: $5f and $fb; with port $df connected to both
channel A and C and nextreg $2D connected to both channel A and D.

<P>
Code:
<PRE>
;; enable SpecDrum/Convox audio
ld bc,$243B
ld a,$08
out (c),a
ld bc,$253B
in a,(c)
or $08
out (c),a
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node059.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Turbosound</TITLE>
<META NAME="description" CONTENT="Turbosound">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node58.html">
<LINK REL="next" HREF="node60.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node60.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node56.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node58.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html701"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html703"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node60.html">Pi Audio</A>
<B> Up:</B> <A
 HREF="node56.html">Audio</A>
<B> Previous:</B> <A
 HREF="node58.html">Sampled 8-bit</A>
 &nbsp; <B>  <A ID="tex2html702"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html704"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00430000000000000000">
Turbosound</A>
</H1>

<P>
TurboSound consists of the implementation of three AY-3-8912 chips. To
enable TurboSound set bit 1 of Next Register $08 (8). Once enabled
the sound chips and registers of the sound chips are selected using
port $fffd (65533) TurboSound Next Control while the registers are
accessed using $bffd () Sound Chip Register Access.  To enable access
to a particular chip write 111111xx to the control register where
01=AY1, 10=AY2, and 11=AY3.  Access to particular registers of the
selected chip is selected by writing the register number to the
control register. You can then access a chip register using the access
port.

<P>
Code:
<PRE>
;; enable TurboSound audio
ld bc,$243B
ld a,$08
out (c),a
ld bc,$253B
in a,(c)
or $02
out (c),a
</PRE>

<P>
Each of the three AY chips has three channels, A, B, and C whose
mapping is controlled by bit 5 of Next register 0x08 (8).

<P>
Register (R/W) $00 (00) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel A fine tune
Register (R/W) $01 (01) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel A coarse tune (4 bits)

<P>
Register (R/W) $02 (02) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel B fine tune

<P>
Register (R/W) $03 (03) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel B coarse tune (4 bits)

<P>
Register (R/W) $04 (04) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel C fine tune

<P>
Register (R/W) $05 (05) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel C coarse tune (4 bits)

<P>
Register (R/W) $06 (06) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Noise period (5 bits)

<P>
Register (R/W) $07 (07) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Tone Enable

<UL>
<LI>bit 5 = Channel C tone enable (0=enable, 1=disable)
</LI>
<LI>bit 4 = Channel B tone enable (0=enable, 1=disable)
</LI>
<LI>bit 3 = Channel A tone enable (0=enable, 1=disable)
</LI>
<LI>bit 2 = Channel C noise enable (0=enable, 1=disable)
</LI>
<LI>bit 1 = Channel B noise enable (0=enable, 1=disable)
</LI>
<LI>bit 0 = Channel A noise enable (0=enable, 1=disable)
</LI>
</UL>

<P>
Register (R/W) $08 (08) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel A amplitude

<UL>
<LI>bit 4 = enable fixed amplitude
  
<UL>
<LI>0 = fixed amplitude
</LI>
<LI>1 = use envelope generator (bits 0-3 ignored)
  
</LI>
</UL>
</LI>
<LI>bits 3-0 = value of fixed amplitude
</LI>
</UL>

<P>
Register (R/W) $09 (09) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel B amplitude

<UL>
<LI>bit 4 = enable fixed amplitude
  
<UL>
<LI>0 = fixed amplitude
</LI>
<LI>1 = use envelope generator (bits 0-3 ignored)
  
</LI>
</UL>
</LI>
<LI>bits 3-0 = value of fixed amplitude
</LI>
</UL>

<P>
Register (R/W) $0A (0A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel C amplitude

<UL>
<LI>bit 4 = enable fixed amplitude
  
<UL>
<LI>0 = fixed amplitude
</LI>
<LI>1 = use envelope generator (bits 0-3 ignored)
  
</LI>
</UL>
</LI>
<LI>bits 3-0 = value of fixed amplitude
</LI>
</UL>

<P>
Register (R/W) $0B (0B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Envelope period fine

<P>
Register (R/W) $0C (0C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Envelope period coarse

<P>
Register (R/W) $0D (0D) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Envelope shape

<UL>
<LI>bit 3 = Continue
  
<UL>
<LI>0 = drop to amplitude 0 after 1 cycle
</LI>
<LI>1 = use ‘Hold’ value
  
</LI>
</UL>
</LI>
<LI>bit 2 = Attack
  
<UL>
<LI>0 = generator counts down
</LI>
<LI>1 = generator counts up
  
</LI>
</UL>
</LI>
<LI>bit 1 = Alternate
<BR>
hold = 0
  
<UL>
<LI>0 = generator resets after each cycle
</LI>
<LI>1=generator reverses direction each cycle
  
</LI>
</UL>
  hold=1
  
<UL>
<LI>0 = hold final value
</LI>
<LI>1 = hold initial value
  
</LI>
</UL>
</LI>
<LI>bit 0 = Hold
  
<UL>
<LI>0 = cycle continuously
</LI>
<LI>1 = perform one cycle and hold
  
</LI>
</UL>
</LI>
</UL>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Pi Audio " LINK NODE60}
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node60.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node56.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node58.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html701"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html703"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node60.html">Pi Audio</A>
<B> Up:</B> <A
 HREF="node56.html">Audio</A>
<B> Previous:</B> <A
 HREF="node58.html">Sampled 8-bit</A>
 &nbsp; <B>  <A ID="tex2html702"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html704"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node060.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Pi Audio</TITLE>
<META NAME="description" CONTENT="Pi Audio">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node59.html">
<LINK REL="next" HREF="node61.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node61.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node59.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node59.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html706"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html708"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node61.html">Memory</A>
<B> Up:</B> <A
 HREF="node59.html">Turbosound</A>
<B> Previous:</B> <A
 HREF="node59.html">Turbosound</A>
 &nbsp; <B>  <A ID="tex2html707"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html709"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00431000000000000000">
Pi Audio</A>
</H2>
If connected the Pi Zero is configured to use the ZX Next as a
soundcard over an  I<SUP>2</SUP>S interface making the Raspberry Pi a fully
configurable audio source for the ZX Spectrum Next.
<BR><HR>

</BODY>
</HTML>
node061.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Memory</TITLE>
<META NAME="description" CONTENT="Memory">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node80.html">
<LINK REL="previous" HREF="node56.html">
<LINK REL="next" HREF="node62.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node62.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node60.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html710"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html712"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node62.html">Memory Management</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node60.html">Pi Audio</A>
 &nbsp; <B>  <A ID="tex2html711"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html713"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00500000000000000000">
Memory</A>
</H1>
The ZX Spectrum Next commonly has with either 1MB or 2MB SRAM
memory. This is more the 64kB directly addressable by its Z80N CPU. It
is therefore necessary to use some form of memory paging to address
all of the memory. This is accomplished using 8k pages or 16k
banks. 256k of the total memory is used by the ROM images and device
specific RAM leaving either 768k (pages 0-95/banks 0-47) or 1792k
(pages 0-223/banks 0-111) that can be paged in as RAM. Pages 10, 11,
and 14 are a little odd in that rather than coming from the normal
SRAM, they come from BRAM internal to the FPGA.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Memory Management " LINK NODE62}
@{" Default Layout " LINK NODE63}
@{" RAM " LINK NODE64}
@{" ZX Spectrum Next Native " LINK NODE65}
@{" ZX Spectrum 128 " LINK NODE66}
</UL>
@{" ROM " LINK NODE70}
@{" ZX Next native " LINK NODE71}
@{" ZX Spectrum 128k " LINK NODE72}
@{" divMMC " LINK NODE74}
@{" Multiface " LINK NODE75}
</UL>
</UL>
<BR>
@{" Interactions between paging methods " LINK NODE76}
@{" Memory Map " LINK NODE77}
@{" Global Memory Map " LINK NODE78}
@{" Z80 Visible Memory Map " LINK NODE79}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node062.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Memory Management</TITLE>
<META NAME="description" CONTENT="Memory Management">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node76.html">
<LINK REL="previous" HREF="node61.html">
<LINK REL="next" HREF="node63.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node63.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node61.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node61.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html728"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html730"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node63.html">Default Layout</A>
<B> Up:</B> <A
 HREF="node61.html">Memory</A>
<B> Previous:</B> <A
 HREF="node61.html">Memory</A>
 &nbsp; <B>  <A ID="tex2html729"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html731"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00510000000000000000">
Memory Management</A>
</H1>

<P>
There are a number of different systems for controling memory papping
into the 64k memory space of the Z80N CPU in the ZX Next: ZX Next
native memory paging, ZX Spectrum 128, ZX Spectrum +3, divMMC, and
Multiface.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Default Layout " LINK NODE63}
@{" RAM " LINK NODE64}
@{" ZX Spectrum Next Native " LINK NODE65}
@{" ZX Spectrum 128 " LINK NODE66}
@{" Spectrum 128 Standard Paging " LINK NODE67}
@{" Paging out ROM " LINK NODE68}
@{" Spectrum 128 Special Paging " LINK NODE69}
</UL>
</UL>
<BR>
@{" ROM " LINK NODE70}
@{" ZX Next native " LINK NODE71}
@{" ZX Spectrum 128k " LINK NODE72}
@{" ROM paging and selection " LINK NODE73}
</UL>
@{" divMMC " LINK NODE74}
@{" Multiface " LINK NODE75}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node063.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Default Layout</TITLE>
<META NAME="description" CONTENT="Default Layout">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node64.html">
<LINK REL="previous" HREF="node62.html">
<LINK REL="next" HREF="node64.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node64.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node62.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node62.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html745"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html747"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node64.html">RAM</A>
<B> Up:</B> <A
 HREF="node62.html">Memory Management</A>
<B> Previous:</B> <A
 HREF="node62.html">Memory Management</A>
 &nbsp; <B>  <A ID="tex2html746"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html748"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00511000000000000000">
Default Layout</A>
</H2>
The default mapping of memory banks is the same as on 128k Spectrum
models with a ROM0 (128k editor and menu system) mapped in at
$0000-$3FFF, bank 5 at $4000-$7FFF, bank 2 at $8000-$BFFF, and
bank 0 at $C000-$FFFF.

<P>
<BR><HR>

</BODY>
</HTML>
node064.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>RAM</TITLE>
<META NAME="description" CONTENT="RAM">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node70.html">
<LINK REL="previous" HREF="node63.html">
<LINK REL="next" HREF="node65.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node65.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node62.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node63.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html749"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html751"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node65.html">ZX Spectrum Next Native</A>
<B> Up:</B> <A
 HREF="node62.html">Memory Management</A>
<B> Previous:</B> <A
 HREF="node63.html">Default Layout</A>
 &nbsp; <B>  <A ID="tex2html750"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html752"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00512000000000000000">
RAM</A>
</H2>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
@{" ZX Spectrum Next Native " LINK NODE65}
@{" ZX Spectrum 128 " LINK NODE66}
@{" Spectrum 128 Standard Paging " LINK NODE67}
@{" Paging out ROM " LINK NODE68}
@{" Spectrum 128 Special Paging " LINK NODE69}
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node065.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Spectrum Next Native</TITLE>
<META NAME="description" CONTENT="ZX Spectrum Next Native">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node66.html">
<LINK REL="previous" HREF="node64.html">
<LINK REL="next" HREF="node66.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node66.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node64.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node64.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html758"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html760"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node66.html">ZX Spectrum 128</A>
<B> Up:</B> <A
 HREF="node64.html">RAM</A>
<B> Previous:</B> <A
 HREF="node64.html">RAM</A>
 &nbsp; <B>  <A ID="tex2html759"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html761"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00512010000000000000">
ZX Spectrum Next Native</A>
</H4>
Registers $50 to $57 control the which SRAM pages are in each of the
eight memory slots.  Registers $50 and $51 support the special value
$FF which indicates that the currently selected ROM is to be mapped
into slots 0 and/or 1 ($0000-$3FFF).

<P>
Register (R/W) $50 (50) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 0 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $0000 to $1FFF ($ff on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.
<BR>
A 255 value causes the ROM to become visible.
Register (R/W) $51 (51) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 1 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $2000 to $3FFF ($ff on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.
<BR>
A 255 value causes the ROM to become visible.

<P>
Register (R/W) $52 (52) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 2 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $4000 to $5FFF ($0A on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $53 (53) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 3 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $6000 to $7FFF ($0B on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $54 (54) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 4 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $8000 to $9FFF ($04 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $55 (55) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 5 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $A000 to $BFFF ($05 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $56 (56) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 6 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $C000 to $DFFF ($00 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $57 (57) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 7 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $E000 to $FFFF ($01 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Writing to ports $1FFD, $7FFD and $DFFD writes $FF to MMU0 and
MMU1 and writes appropriate values to MMU6 and MMU7 to map in the
selected 16k bank.

<P>
+3 special modes override the MMUs if used.

<P>
In addition the ZX Next has special controls which allow the data area
for Layer 2 to be overlaied on memory in a fashion that permits
selective read or write access. For details see the section on Layer 2
video.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node66.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node64.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node64.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html758"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html760"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node66.html">ZX Spectrum 128</A>
<B> Up:</B> <A
 HREF="node64.html">RAM</A>
<B> Previous:</B> <A
 HREF="node64.html">RAM</A>
 &nbsp; <B>  <A ID="tex2html759"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html761"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node066.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Spectrum 128</TITLE>
<META NAME="description" CONTENT="ZX Spectrum 128">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node65.html">
<LINK REL="next" HREF="node67.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node67.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node64.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node65.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html762"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html764"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node67.html">Spectrum 128 Standard Paging</A>
<B> Up:</B> <A
 HREF="node64.html">RAM</A>
<B> Previous:</B> <A
 HREF="node65.html">ZX Spectrum Next Native</A>
 &nbsp; <B>  <A ID="tex2html763"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html765"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00512020000000000000">
ZX Spectrum 128</A>
</H4>
In addition to the native memory management, the ZX Next supports a
memory management system that is an expanded, and backward compatible,
version of the the system used on earlier ZX Spectrum models. This
system uses registers $1FFD, $7FFD, and $DFFD.

<P>
Port $1FFD (1FFD) Plus 3 Memory Paging Control
<table width="90%"><tr><td valign="top">&nbsp;bits 7-3 = Unused, nust be 0</td></tr>
<tr><td valign="top">&nbsp;bit 2 = High bit of ROM selection (low bit is in Port $7FFD)
  <table width="90%">  <tr><td valign="top">&nbsp;00 = ROM0 = 128k editor and menu system
  </td></tr>
<tr><td valign="top">&nbsp;01 = ROM1 = 128k syntax checker
  </td></tr>
<tr><td valign="top">&nbsp;10 = ROM2 = +3DOS
  </td></tr>
<tr><td valign="top">&nbsp;11 = ROM3 = 48k BASIC
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Special mode: Low bit of memory configuration number</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Paging mode
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Normal
  </td></tr>
<tr><td valign="top">&nbsp;1 = Special
  </td></tr></table>
</td></tr></table>

You should echo writes to $5B67

<P>
Port $7FFD (7FFD) Memory Paging Control
<table width="90%"><tr><td valign="top">&nbsp;bits 6-7 = reserved</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Lock memory paging</td></tr>
<tr><td valign="top">&nbsp;bit 4 = low bit of ROM Select (high bit is in Port $1FFD) 
  <table width="90%">  <tr><td valign="top">&nbsp;00 = ROM0 = 128k editor and menu system
  </td></tr>
<tr><td valign="top">&nbsp;01 = ROM1 = 128k syntax checker
  </td></tr>
<tr><td valign="top">&nbsp;10 = ROM2 = +3DOS
  </td></tr>
<tr><td valign="top">&nbsp;11 = ROM3 = 48k BASIC
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Shadow screen toggle</td></tr>
<tr><td valign="top">&nbsp;bits 2-0 = LSB of Bank number for slot 4 (MSB is in Port $DFFD)
</td></tr></table>

Disable with bit 5 port $7FFD

<P>
Port $DFFD (DFFD) Next Memory Bank Select
<table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bits 3-0 = MSB of bank number for slot 4 (LSB is in Port $7FFD)
</td></tr></table>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Spectrum 128 Standard Paging " LINK NODE67}
@{" Paging out ROM " LINK NODE68}
@{" Spectrum 128 Special Paging " LINK NODE69}
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node67.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node64.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node65.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html762"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html764"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node67.html">Spectrum 128 Standard Paging</A>
<B> Up:</B> <A
 HREF="node64.html">RAM</A>
<B> Previous:</B> <A
 HREF="node65.html">ZX Spectrum Next Native</A>
 &nbsp; <B>  <A ID="tex2html763"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html765"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node067.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Spectrum 128 Standard Paging</TITLE>
<META NAME="description" CONTENT="Spectrum 128 Standard Paging">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node68.html">
<LINK REL="previous" HREF="node66.html">
<LINK REL="next" HREF="node68.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node68.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node66.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node66.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html769"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html771"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node68.html">Paging out ROM</A>
<B> Up:</B> <A
 HREF="node66.html">ZX Spectrum 128</A>
<B> Previous:</B> <A
 HREF="node66.html">ZX Spectrum 128</A>
 &nbsp; <B>  <A ID="tex2html770"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html772"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00512021000000000000">
Spectrum 128 Standard Paging</A>
</H5>

<P>
128-style memory management can only alter the bank addressed at
$c000 (16k-slot 4, or 8k-slots 7-8). The active 16k-bank at $c000 is
selected by writing the 3 LSBs of the 16k-bank number to the bottom 3
bits of Memory Paging Control ($7FFD), and the 4 MSBs to the bottom 4
bits of Next Memory Bank Select ($DFFD). (The reason for the division
is that the original Spectrum 128, having only 128k of memory, only
needed 3 bits.)

<P>
If you are using the standard interrupt handler or OS routines, then
any time you write to Memory Paging Control ($7FFD) you should also
store the value at $5B5C. Any time you write to Plus 3 Memory Paging
Control ($1FFD) you should also store the value at $5B67. There is
no corresponding system variable for the Next-only Next Memory Bank
Select ($DFFD) and standard OS routines may not support the extended
banks properly.

<P>
<BR><HR>

</BODY>
</HTML>
node068.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Paging out ROM</TITLE>
<META NAME="description" CONTENT="Paging out ROM">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node69.html">
<LINK REL="previous" HREF="node67.html">
<LINK REL="next" HREF="node69.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node69.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node66.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node67.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html773"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html775"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node69.html">Spectrum 128 Special Paging</A>
<B> Up:</B> <A
 HREF="node66.html">ZX Spectrum 128</A>
<B> Previous:</B> <A
 HREF="node67.html">Spectrum 128 Standard Paging</A>
 &nbsp; <B>  <A ID="tex2html774"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html776"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00512022000000000000">
Paging out ROM</A>
</H5>

<P>
ROM can be paged out by enabling AllRam mode, or by using Next memory
management. Beware that some programs may assume that they can find
ROM service routines at fixed addresses between $0000-$3fff. More
importantly, if the default interrupt mode (IM 1) is set, the Z80 will
jump the program counter to $0038 every frame expecting to find an
interrupt handler there. If it does not, pain and suffering will
likely result. DI is your friend. On the plus side, this does allow
you to write your own interrupt handler without the nuisance of using
IM 2.

<P>
<BR><HR>

</BODY>
</HTML>
node069.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Spectrum 128 Special Paging</TITLE>
<META NAME="description" CONTENT="Spectrum 128 Special Paging">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node68.html">
<LINK REL="next" HREF="node70.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node70.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node66.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node68.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html777"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html779"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node70.html">ROM</A>
<B> Up:</B> <A
 HREF="node66.html">ZX Spectrum 128</A>
<B> Previous:</B> <A
 HREF="node68.html">Paging out ROM</A>
 &nbsp; <B>  <A ID="tex2html778"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html780"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00512023000000000000">
Spectrum 128 Special Paging</A>
</H5>

<P>
&ldquo;Special paging mode&rdquo; (also called &ldquo;AllRam mode&rdquo; or &ldquo;CP/M mode&rdquo;)
is enabled by writing a value with the LSB set to Plus 3 Memory Paging
Control ($1FFD). Depending on the 3 low bits of this value a memory
configuration is selected as follows:

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="1761"></A>
<TABLE>
<CAPTION><STRONG>Table 4.1:</STRONG>
Special Paging Modes</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img40.svg"
 ALT="\begin{table}\centering
\csvautotabular{memory/zx128mm.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node070.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ROM</TITLE>
<META NAME="description" CONTENT="ROM">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node64.html">
<LINK REL="next" HREF="node71.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node71.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node62.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node69.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html781"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html783"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node71.html">ZX Next native</A>
<B> Up:</B> <A
 HREF="node62.html">Memory Management</A>
<B> Previous:</B> <A
 HREF="node69.html">Spectrum 128 Special Paging</A>
 &nbsp; <B>  <A ID="tex2html782"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html784"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00513000000000000000">
ROM</A>
</H2>

<P>
The ZX Spectrum Next had several ROMS: ROM0 (16k) - 128k editor and
menu system, ROM1 (16k) - 128k syntax checker, ROM2 (16k) - +3DOS,
ROM3 (16k) - 48k BASIC, divMMC/esxDOS ROM (8k), divMMC RAM (128k),
Multiface ROM (8k) and Alternate ROM (16k).

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
@{" ZX Next native " LINK NODE71}
@{" ZX Spectrum 128k " LINK NODE72}
@{" ROM paging and selection " LINK NODE73}
</UL>
@{" divMMC " LINK NODE74}
@{" Multiface " LINK NODE75}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node071.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Next native</TITLE>
<META NAME="description" CONTENT="ZX Next native">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node72.html">
<LINK REL="previous" HREF="node70.html">
<LINK REL="next" HREF="node72.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node72.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node70.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node70.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html790"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html792"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node72.html">ZX Spectrum 128k</A>
<B> Up:</B> <A
 HREF="node70.html">ROM</A>
<B> Previous:</B> <A
 HREF="node70.html">ROM</A>
 &nbsp; <B>  <A ID="tex2html791"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html793"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00513010000000000000">
ZX Next native</A>
</H4>

<P>
Slots 0 and 1 select use by ROM by selecting page $FF. Which what ROM
is mapped in is determined by the other memory management system. If
the rest of the system selected the 48k ROM, Nextreg $8C determines
whether the actual 48k ROM, or the ZX Next Alternate ROM is in use. In
addition, it is possible to enable writing to the Alternate ROM.

<P>
Register (R/W) $8C (8C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Alternate ROM
<BR>
Immediate

<UL>
<LI>bit 7 = Alt ROM Enable (0 on hard reset)
</LI>
<LI>bit 6 = Alt ROM visible ONLY during writes (0 on hard reset)
</LI>
<LI>bit 5 = Reserved, must be 0
</LI>
<LI>bit 4 = 48k ROM Lock (0 on hard reset)
</LI>
</UL>
After Soft Reset (copied into bits 7-4)

<UL>
<LI>bit 3 = Alt ROM Enable (0 on hard reset)
</LI>
<LI>bit 2 = Alt ROM visible ONLY during writes (0 on hard reset)
</LI>
<LI>bit 1 = Reserved, must be 0
</LI>
<LI>bit 0 = 48k ROM Lock (0 on hard reset)
</LI>
</UL>

<P>
<BR><HR>

</BODY>
</HTML>
node072.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Spectrum 128k</TITLE>
<META NAME="description" CONTENT="ZX Spectrum 128k">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node74.html">
<LINK REL="previous" HREF="node71.html">
<LINK REL="next" HREF="node73.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node73.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node70.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node71.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html794"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html796"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node73.html">ROM paging and selection</A>
<B> Up:</B> <A
 HREF="node70.html">ROM</A>
<B> Previous:</B> <A
 HREF="node71.html">ZX Next native</A>
 &nbsp; <B>  <A ID="tex2html795"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html797"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00513020000000000000">
ZX Spectrum 128k</A>
</H4>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" ROM paging and selection " LINK NODE73}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node073.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ROM paging and selection</TITLE>
<META NAME="description" CONTENT="ROM paging and selection">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node72.html">
<LINK REL="next" HREF="node74.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node74.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node72.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node72.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html799"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html801"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node74.html">divMMC</A>
<B> Up:</B> <A
 HREF="node72.html">ZX Spectrum 128k</A>
<B> Previous:</B> <A
 HREF="node72.html">ZX Spectrum 128k</A>
 &nbsp; <B>  <A ID="tex2html800"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html802"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H5><A ID="SECTION00513021000000000000">
ROM paging and selection</A>
</H5>

<P>
$0000-$3fff is usually mapped to ROM. This area can only be fully
remapped using Next memory management. ROM is not considered one of
the numbered banks; it is mapped to the two 8k-banks by default, or by
setting their 8k-bank numbers to 255.

<P>
The 128k Spectrum has 2 ROM pages. Which of these is mapped is
selected by altering Bit 4 of Memory Paging Control ($7FFD). The
+2a/+3 has 4 ROM pages; the extra bit needed to select between these
is bit 2 of Plus 3 Memory Paging Control ($1FFD). This maintains
compatibility with the original machines' ROM paging as long as the
ROM is not paged out.

<P>
<BR><HR>

</BODY>
</HTML>
node074.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>divMMC</TITLE>
<META NAME="description" CONTENT="divMMC">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node75.html">
<LINK REL="previous" HREF="node72.html">
<LINK REL="next" HREF="node75.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node75.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node70.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node73.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html803"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html805"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node75.html">Multiface</A>
<B> Up:</B> <A
 HREF="node70.html">ROM</A>
<B> Previous:</B> <A
 HREF="node73.html">ROM paging and selection</A>
 &nbsp; <B>  <A ID="tex2html804"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html806"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00513030000000000000">
divMMC</A>
</H4>

<P>
The divMMC ROM mapping can take priority when it is enabled by port
$E3 or, when automapping has been enabled by nextreg $06, when it
has been automapped due to reading one of the appropriate
addresses. Port $E3 also controls whether the divMMC maps the esxDOS
ROM or divMMC RAM page 3 into slot 0 and which divMMC RAM page is
mapped into slot 1.

<P>
Port $E3 (E3) divMMC Control
<BR>
Disable with bit 2 of Nextreg $09
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = conmem, enable divMMC memory</td></tr>
<tr><td valign="top">&nbsp;bit 6 = mapram, enable divMMC allRAM mode</td></tr>
<tr><td valign="top">&nbsp;bits 3-0 = bank, selected divMMC ram bank for $2000-$3FFF region
conmem can be used to manually control divMMC mapping. When enabled
<BR>$0000-$1FFF contains esxDOS ROM or esxDOS page 3
<BR>$2000-$3FFF contains esxDOS RAM page selected by bits 3-0
divMMC automatically maps itself in when instruction fetches hit
specific addresses in the ROM. When this happens, the esxDOS ROM (or divMMC
bank 3 if mapram is set) appears in $0000-$1FFF and the selected divMMC
bank appears as RAM in $2000-$3FFF
bit 6 can only be set, once set only a power cycle can reset it.
nextreg $09 bit 3 can be set to reset this bit.
</td></tr></table>

divMMC automapping is normally disabled by NextZXOS see nextreg $06 bit 4.
<BR>
Register (R/W) $06 (06) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 2 Settings

<UL>
<LI>bit 7 = F8 CPU Speed Hotkey Enable (1 on reset)
</LI>
<LI>bit 6 = Enable classic audio mode (beep and tape to internal speaker,
  other audio to ear and HDMI, 3.01.02)
</LI>
<LI>bit 5 = F3 50Hz/60Hz Hotkey Enable (1 on reset)
</LI>
<LI>bit 4 = divMMC Automap/NMI Enable (0 on hard reset)
</LI>
<LI>bit 3 = NMI Button Enable (0 on hard reset)
</LI>
<LI>bit 2 = PS/2 Mode (0 = keyboard, 1 = mouse)
</LI>
<LI>bits 1-0 = PSG Mode (00 = YM, 01 = AY, 11 = hold all PSGs in Reset)
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node75.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node70.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node73.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html803"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html805"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node75.html">Multiface</A>
<B> Up:</B> <A
 HREF="node70.html">ROM</A>
<B> Previous:</B> <A
 HREF="node73.html">ROM paging and selection</A>
 &nbsp; <B>  <A ID="tex2html804"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html806"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node075.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Multiface</TITLE>
<META NAME="description" CONTENT="Multiface">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node74.html">
<LINK REL="next" HREF="node76.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node76.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node70.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node74.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html807"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html809"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node76.html">Interactions between paging methods</A>
<B> Up:</B> <A
 HREF="node70.html">ROM</A>
<B> Previous:</B> <A
 HREF="node74.html">divMMC</A>
 &nbsp; <B>  <A ID="tex2html808"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html810"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00513040000000000000">
Multiface</A>
</H4>

<P>
Need to find useful docs on the Multiface memory.

<P>
9f 1-In, 128-In2
<BR>
1f 1-Out
<BR>
bf 128-In, 3-Out
<BR>
3f 128-Out, 3-In, 3-button
<BR>
7f3f 3-7ffd
<BR>
1f3f 3-1ffd

<P>
<BR><HR>

</BODY>
</HTML>
node076.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Interactions between paging methods</TITLE>
<META NAME="description" CONTENT="Interactions between paging methods">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node77.html">
<LINK REL="previous" HREF="node62.html">
<LINK REL="next" HREF="node77.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node77.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node61.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node75.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html811"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html813"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node77.html">Memory Map</A>
<B> Up:</B> <A
 HREF="node61.html">Memory</A>
<B> Previous:</B> <A
 HREF="node75.html">Multiface</A>
 &nbsp; <B>  <A ID="tex2html812"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html814"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00520000000000000000">
Interactions between paging methods</A>
</H1>

<P>
Changes made in 128 style and Next style memory management are
synchronized. The most recent change always has priority. This means
that

<P>
using 128-style memory management to select a new 16k-bank in 16k-slot
4 will update the MMU registers for the two 8k-slots with the
corresponding 8k-bank numbers.  enabling AllRam mode will update all
of the 8k-bank values with the appropriate 8k-slot numbers. These may
then be overwritten using Next memory management without needing to
alter the value at port $1FFD.  Since the 128-style memory management
ports are not readable, there is no synchronization applicable in the
other direction.
<BR><HR>

</BODY>
</HTML>
node077.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Memory Map</TITLE>
<META NAME="description" CONTENT="Memory Map">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node76.html">
<LINK REL="next" HREF="node78.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node78.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node61.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node76.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html815"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html817"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node78.html">Global Memory Map</A>
<B> Up:</B> <A
 HREF="node61.html">Memory</A>
<B> Previous:</B> <A
 HREF="node76.html">Interactions between paging methods</A>
 &nbsp; <B>  <A ID="tex2html816"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html818"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00530000000000000000">
Memory Map</A>
</H1>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Global Memory Map " LINK NODE78}
@{" Z80 Visible Memory Map " LINK NODE79}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node078.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Global Memory Map</TITLE>
<META NAME="description" CONTENT="Global Memory Map">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node79.html">
<LINK REL="previous" HREF="node77.html">
<LINK REL="next" HREF="node79.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node79.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node77.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node77.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html821"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html823"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node79.html">Z80 Visible Memory Map</A>
<B> Up:</B> <A
 HREF="node77.html">Memory Map</A>
<B> Previous:</B> <A
 HREF="node77.html">Memory Map</A>
 &nbsp; <B>  <A ID="tex2html822"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html824"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00531000000000000000">
Global Memory Map</A>
</H2>

<P>
<TABLE class="PAD  BORDER" style="">
<TR><TH CLASS="LEFT"><SPAN  CLASS="textbf">Physical Address</SPAN></TH>
<TH CLASS="LEFT"><SPAN  CLASS="textbf">Size</SPAN></TH>
<TH CLASS="LEFT"><SPAN  CLASS="textbf">Description</SPAN></TH>
</TR>
<TR><TD CLASS="LEFT">$000000-$00FFFF</TD>
<TD CLASS="LEFT">64k</TD>
<TD CLASS="LEFT">ZX Spectrum ROM (ROM0-3)</TD>
</TR>
<TR><TD CLASS="LEFT">$010000-$011FFF</TD>
<TD CLASS="LEFT">8k</TD>
<TD CLASS="LEFT">EsxDOS ROM</TD>
</TR>
<TR><TD CLASS="LEFT">$012000-$013FFF</TD>
<TD CLASS="LEFT">8k</TD>
<TD CLASS="LEFT">Multiface ROM</TD>
</TR>
<TR><TD CLASS="LEFT">$014000-$017FFF</TD>
<TD CLASS="LEFT">16k</TD>
<TD CLASS="LEFT">EsxDOS Extra ROM</TD>
</TR>
<TR><TD CLASS="LEFT">$018000-$01BFFF</TD>
<TD CLASS="LEFT">16k</TD>
<TD CLASS="LEFT">Alternate ROM</TD>
</TR>
<TR><TD CLASS="LEFT">$01C000-$01FFFF</TD>
<TD CLASS="LEFT">16k</TD>
<TD CLASS="LEFT">Multiface RAM</TD>
</TR>
<TR><TD CLASS="LEFT">$020000-$03FFFF</TD>
<TD CLASS="LEFT">128k</TD>
<TD CLASS="LEFT">DivMMC RAM</TD>
</TR>
<TR><TD CLASS="LEFT">$040000-$0FFFFF</TD>
<TD CLASS="LEFT">768k</TD>
<TD CLASS="LEFT">Standard RAM</TD>
</TR>
<TR><TD CLASS="LEFT">$100000-$1FFFFF</TD>
<TD CLASS="LEFT">1024k</TD>
<TD CLASS="LEFT">Expanded RAM</TD>
</TR>
</TABLE>

<P>
Normal RAM is divided into 8k pages or 16k banks which may be mapped
into the 64k memory space by the memory management hardware of the
Next. Some of these pages have special properties.

<P>
Pages 10, 11 and 14 are used by Layer 1/0 (ULA) video modes with 10
used by standard Spectrum ULA video, 10 and 11 used by Timex Hi-res
and Hi-colour modes, 11 used by Timex alternate video and page 14 used
by the ULA shadow mode. Pages 10 an 11 are usable by Layer 3 (Tilemap)
video.

<P>
<BR><HR>

</BODY>
</HTML>
node079.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Z80 Visible Memory Map</TITLE>
<META NAME="description" CONTENT="Z80 Visible Memory Map">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node78.html">
<LINK REL="next" HREF="node80.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node80.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node77.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node78.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html825"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html827"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Up:</B> <A
 HREF="node77.html">Memory Map</A>
<B> Previous:</B> <A
 HREF="node78.html">Global Memory Map</A>
 &nbsp; <B>  <A ID="tex2html826"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html828"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00532000000000000000">
Z80 Visible Memory Map</A>
</H2>
<BR><HR>

</BODY>
</HTML>
node080.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>zxnDMA</TITLE>
<META NAME="description" CONTENT="zxnDMA">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node97.html">
<LINK REL="previous" HREF="node61.html">
<LINK REL="next" HREF="node81.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node81.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node79.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html829"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html831"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node81.html">Overview</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node79.html">Z80 Visible Memory Map</A>
 &nbsp; <B>  <A ID="tex2html830"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html832"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00600000000000000000">
zxnDMA</A>
</H1>
 February 25, 2019  Phoebus Dokos  Off  Hardware, Resources,

<P>
The ZX Spectrum Next DMA (zxnDMA)

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Overview " LINK NODE81}
@{" Accessing the zxnDMA " LINK NODE82}
@{" Description " LINK NODE83}
@{" Modes of Operation " LINK NODE84}
@{" Programming the zxnDMA " LINK NODE85}
@{" zxnDMA Registers " LINK NODE86}
@{" WR0 – Write Register Group 0 " LINK NODE87}
@{" WR1 – Write Register Group 1 " LINK NODE88}
@{" WR2 – Write Register Group 2 " LINK NODE89}
@{" WR3 – Write Register Group 3 " LINK NODE90}
@{" WR4 – Write Register Group 4 " LINK NODE91}
@{" WR5 – Write Register Group 5 " LINK NODE92}
@{" WR6 – Command Register " LINK NODE93}
@{" Operating speed " LINK NODE94}
@{" The DMA and Interrupts " LINK NODE95}
</UL>
<BR>
@{" Programming examples " LINK NODE96}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node081.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Overview</TITLE>
<META NAME="description" CONTENT="Overview">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node82.html">
<LINK REL="previous" HREF="node80.html">
<LINK REL="next" HREF="node82.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node82.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html849"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html851"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node82.html">Accessing the zxnDMA</A>
<B> Up:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Previous:</B> <A
 HREF="node80.html">zxnDMA</A>
 &nbsp; <B>  <A ID="tex2html850"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html852"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00610000000000000000">
Overview</A>
</H1>

<P>
The ZX Spectrum Next DMA (zxnDMA) is a single channel dma device that
implements a subset of the Z80 DMA functionality. The subset is large
enough to be compatible with common uses of the similar Datagear
interface available for standard ZX Spectrum computers and
compatibles. It also adds a burst mode capability that can deliver
audio at programmable sample rates to the DAC device.

<P>
<BR><HR>

</BODY>
</HTML>
node082.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Accessing the zxnDMA</TITLE>
<META NAME="description" CONTENT="Accessing the zxnDMA">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node83.html">
<LINK REL="previous" HREF="node81.html">
<LINK REL="next" HREF="node83.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node83.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node81.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html853"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html855"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node83.html">Description</A>
<B> Up:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Previous:</B> <A
 HREF="node81.html">Overview</A>
 &nbsp; <B>  <A ID="tex2html854"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html856"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00620000000000000000">
Accessing the zxnDMA</A>
</H1>
The zxnDMA is mapped to a single Read/Write IO Port 0x6B which is the
same one used by the Datagear but unlike the Datagear it doesn't also
map itself to a second port 0x0B similar to the MB-02 interface.

<P>
<PRE>
PORT $6b: zxnDMA
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node083.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Description</TITLE>
<META NAME="description" CONTENT="Description">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node84.html">
<LINK REL="previous" HREF="node82.html">
<LINK REL="next" HREF="node84.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node84.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node82.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html857"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html859"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node84.html">Modes of Operation</A>
<B> Up:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Previous:</B> <A
 HREF="node82.html">Accessing the zxnDMA</A>
 &nbsp; <B>  <A ID="tex2html858"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html860"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00630000000000000000">
Description</A>
</H1>
The normal Z80 DMA (Z8410) chip is a pipelined device and because of
that it has numerous off-by-one idiosyncrasies and requirements on the
order that certain commands should be carried out. These issues are
not duplicated in the zxnDMA. You can continue to program the zxnDMA
as if it is were a Z8410 DMA device but it can also be programmed in a
simpler manner.

<P>
The single channel of the zxnDMA chip consists of two ports named A
and B. Transfers can occur in either direction between ports A and B,
each port can describe a target in memory or IO, and each can be
configured to autoincrement, autodecrement or stay fixed after a byte
is transferred.

<P>
A special feature of the zxnDMA can force each byte transfer to take a
fixed amount of time so that the zxnDMA can be used to deliver sampled
audio.

<P>
<BR><HR>

</BODY>
</HTML>
node084.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Modes of Operation</TITLE>
<META NAME="description" CONTENT="Modes of Operation">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node85.html">
<LINK REL="previous" HREF="node83.html">
<LINK REL="next" HREF="node85.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node85.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node83.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html861"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html863"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node85.html">Programming the zxnDMA</A>
<B> Up:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Previous:</B> <A
 HREF="node83.html">Description</A>
 &nbsp; <B>  <A ID="tex2html862"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html864"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00640000000000000000">
Modes of Operation</A>
</H1>
The zxnDMA can operate in a z80-dma compatibility mode.

<P>
The z80-dma compatibility mode is selected by setting bit 6 of nextreg
$06. In this mode, all transfers involve length+1 bytes which is the
same behaviour as the z80-dma chip. In zxn-dma mode, the transfer
length is exactly the number of bytes programmed. This mode is mainly
present to accommodate existing spectrum software that uses the
z80-dma and for cp/m programs that may have a z80-dma option.

<P>
The zxnDMA can also operate in either burst or continuous modes.

<P>
Continuous mode means the DMA chip runs to completion without allowing
the CPU to run. When the CPU starts the DMA, the DMA operation will
complete before the CPU executes its next instruction.

<P>
Burst mode nominally means the DMA lets the CPU run if either port is
not ready. This condition can't happen in the zxnDMA chip except when
operated in the special fixed time transfer mode. In this mode, the
zxnDMA will let the CPU run while it waits for the fixed time to
expire between bytes transferred.

<P>
Note that there is no byte transfer mode as in the Z80 DMA.

<P>
<BR><HR>

</BODY>
</HTML>
node085.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Programming the zxnDMA</TITLE>
<META NAME="description" CONTENT="Programming the zxnDMA">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node86.html">
<LINK REL="previous" HREF="node84.html">
<LINK REL="next" HREF="node86.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node86.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node84.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html865"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html867"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Up:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Previous:</B> <A
 HREF="node84.html">Modes of Operation</A>
 &nbsp; <B>  <A ID="tex2html866"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html868"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00650000000000000000">
Programming the zxnDMA</A>
</H1>
Like the Z80 DMA chip, the zxnDMA has seven write registers named
WR0-WR6 that control the device. Each register WR0-WR6 can have zero
or more parameters associated with it.

<P>
In a first write to the zxnDMA port, the write value is compared
against a bitmask to determine which of the WR0-WR6 is the
target. Remaining bits in the written value can contain data as well
as a list of associated parameter bits. The parameter bits determine
if further writes are expected to deliver parameter values. If there
are multiple parameter bits set, the expected order of parameter
values written is determined by parameter bit position from right to
left (bit 0 through bit 7). Once all parameters are written, the
zxnDMA again expects a regular register write selecting WR0-WR6.

<P>
The table X.Y describes the registers and the bitmask required to
select them on the zxnDMA.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="1943"></A>
<TABLE>
<CAPTION><STRONG>Table 5.1:</STRONG>
zxnDMA Registers</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img41.svg"
 ALT="\begin{table}\centering
\csvautotabular{zxndma/registers.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node086.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>zxnDMA Registers</TITLE>
<META NAME="description" CONTENT="zxnDMA Registers">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node96.html">
<LINK REL="previous" HREF="node85.html">
<LINK REL="next" HREF="node87.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node87.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node85.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html869"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html871"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node87.html">WR0 – Write Register</A>
<B> Up:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Previous:</B> <A
 HREF="node85.html">Programming the zxnDMA</A>
 &nbsp; <B>  <A ID="tex2html870"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html872"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00660000000000000000">
zxnDMA Registers</A>
</H1>
These are described below following the same convention used by Zilog
for its DMA chip:

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
@{" WR0 – Write Register Group 0 " LINK NODE87}
@{" WR1 – Write Register Group 1 " LINK NODE88}
@{" WR2 – Write Register Group 2 " LINK NODE89}
@{" WR3 – Write Register Group 3 " LINK NODE90}
@{" WR4 – Write Register Group 4 " LINK NODE91}
@{" WR5 – Write Register Group 5 " LINK NODE92}
@{" WR6 – Command Register " LINK NODE93}
@{" Operating speed " LINK NODE94}
@{" The DMA and Interrupts " LINK NODE95}
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node087.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WR0 – Write Register Group 0</TITLE>
<META NAME="description" CONTENT="WR0 – Write Register Group 0">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node88.html">
<LINK REL="previous" HREF="node86.html">
<LINK REL="next" HREF="node88.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node88.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html882"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html884"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node88.html">WR1 – Write Register</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
 &nbsp; <B>  <A ID="tex2html883"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html885"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660010000000000000">
WR0 – Write Register Group 0</A>
</H4>
<PRE>
D7  D6  D5  D4  D3  D2  D1  D0  BASE REGISTER BYTE
 0   |   |   |   |   |   |   |
     |   |   |   |   |   0   0  Do not use
     |   |   |   |   |   0   1  Transfer (Prefer this for Z80 DMA compatibility)
     |   |   |   |   |   1   0  Do not use (Behaves like Transfer, Search on Z80
     |   |   |   |   |                       DMA)
     |   |   |   |   |   1   1  Do not use (Behaves like Transfer, Search/Trans-
     |   |   |   |   |                      fer on Z80 DMA)
     |   |   |   |   0 = Port B -&gt; Port A (Byte transfer direction)
     |   |   |   |   1 = Port A -&gt; Port B
     |   |   |   V
D7  D6  D5  D4  D3  D2  D1  D0  PORT A STARTING ADDRESS (LOW BYTE)
     |   |   V
D7  D6  D5  D4  D3  D2  D1  D0  PORT A STARTING ADDRESS (HIGH BYTE)
     |   V
D7  D6  D5  D4  D3  D2  D1  D0  BLOCK LENGTH (LOW BYTE)
     V
D7  D6  D5  D4  D3  D2  D1  D0  BLOCK LENGTH (HIGH BYTE)
</PRE>
Several registers are accessible from WR0. The first write to WR0 is
to the base register byte. Bits D6:D3 are optionally set to indicate
that associated registers in this group will be written next. The
order the writes come in are from D3 to D6 (right to left). For
example, if bits D6 and D3 are set, the next two writes will be
directed to PORT A STARTING ADDRESS LOW followed by BLOCK LENGTH HIGH.

<P>
<BR><HR>

</BODY>
</HTML>
node088.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WR1 – Write Register Group 1</TITLE>
<META NAME="description" CONTENT="WR1 – Write Register Group 1">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node89.html">
<LINK REL="previous" HREF="node87.html">
<LINK REL="next" HREF="node89.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node89.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node87.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html886"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html888"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node89.html">WR2 – Write Register</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node87.html">WR0 – Write Register</A>
 &nbsp; <B>  <A ID="tex2html887"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html889"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660020000000000000">
WR1 – Write Register Group 1</A>
</H4>
<PRE>
D7  D6  D5  D4  D3  D2  D1  D0  BASE REGISTER BYTE
 0   |   |   |   |   1   0   0
     |   |   |   |
     |   |   |   0 = Port A is memory
     |   |   |   1 = Port A is IO
     |   |   |
     |   0   0 = Port A address decrements
     |   0   1 = Port A address increments
     |   1   0 = Port A address is fixed
     |   1   1 = Port A address is fixed
     |
     V
D7  D6  D5  D4  D3  D2  D1  D0  PORT A VARIABLE TIMING BYTE
 0   0   0   0   0   0   |   |
                         0   0 = Cycle Length = 4
                         0   1 = Cycle Length = 3
                         1   0 = Cycle Length = 2
                         1   1 = Do not use
</PRE>
The cycle length is the number of cycles used in a read or write
 operation. The first cycle asserts signals and the last cycle
 releases them. There is no half cycle timing for the control signals.

<P>
<BR><HR>

</BODY>
</HTML>
node089.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WR2 – Write Register Group 2</TITLE>
<META NAME="description" CONTENT="WR2 – Write Register Group 2">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node90.html">
<LINK REL="previous" HREF="node88.html">
<LINK REL="next" HREF="node90.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node90.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node88.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html890"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html892"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node90.html">WR3 – Write Register</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node88.html">WR1 – Write Register</A>
 &nbsp; <B>  <A ID="tex2html891"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html893"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660030000000000000">
WR2 – Write Register Group 2</A>
</H4>
<PRE>
D7  D6  D5  D4  D3  D2  D1  D0  BASE REGISTER BYTE
 0   |   |   |   |   0   0   0
     |   |   |   |
     |   |   |   0 = Port B is memory
     |   |   |   1 = Port B is IO
     |   |   |
     |   0   0 = Port B address decrements
     |   0   1 = Port B address increments
     |   1   0 = Port B address is fixed
     |   1   1 = Port B address is fixed
     |
     V
D7  D6  D5  D4  D3  D2  D1  D0  PORT B VARIABLE TIMING BYTE
 0   0   |   0   0   0   |   |
         |               0   0 = Cycle Length = 4
         |               0   1 = Cycle Length = 3
         |               1   0 = Cycle Length = 2
         |               1   1 = Do not use
         |
         V
D7  D6  D5  D4  D3  D2  D1  D0  ZXN PRESCALAR (FIXED TIME TRANSFER)
</PRE>
The ZXN PRESCALAR is a feature of the zxnDMA implementation. If
non-zero, a delay will be inserted after each byte is transferred such
that the total time needed for each transfer is determined by the
prescalar. This works in both the continuous mode and the burst
mode. If the DMA is operated in burst mode, the DMA will give up any
waiting time to the CPU so that the CPU can run while the DMA is idle.

<P>
The rate of transfer is given by the formula &ldquo;Frate = 875kHz /
prescalar&rdquo; or, rearranged, &ldquo;prescalar = 875kHz / Frate&rdquo;. The formula
is framed in terms of a sample rate (Frate) but Frate can be inverted
to set a transfer time for each byte instead. The 875kHz constant is a
nominal value assuming a 28MHz system clock; the system clock actually
varies from this depending on the video timing selected by the user
(HDMI, VGA0-6) so for complete accuracy the constant should be
prorated according to documentation for nextreg $11.

<P>
In a DMA audio setting, selecting a sample rate of 16kHz would mean
setting the prescalar value to 55. This sample period is constant
across changes in CPU speed.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node90.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node88.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html890"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html892"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node90.html">WR3 – Write Register</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node88.html">WR1 – Write Register</A>
 &nbsp; <B>  <A ID="tex2html891"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html893"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node090.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WR3 – Write Register Group 3</TITLE>
<META NAME="description" CONTENT="WR3 – Write Register Group 3">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node91.html">
<LINK REL="previous" HREF="node89.html">
<LINK REL="next" HREF="node91.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node91.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node89.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html894"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html896"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node91.html">WR4 – Write Register</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node89.html">WR2 – Write Register</A>
 &nbsp; <B>  <A ID="tex2html895"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html897"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660040000000000000">
WR3 – Write Register Group 3</A>
</H4>
<PRE>
D7  D6  D5  D4  D3  D2  D1  D0  BASE REGISTER BYTE
 1   |   0   0   0   0   0   0
     |
     1 = DMA Enable
</PRE>
The Z80 DMA defines more fields but they are ignored by the zxnDMA.

<P>
The two other registers defined by the Z80 DMA in this group on D4 and
D3 are implemented by the zxnDMA but they do nothing.

<P>
It is preferred to start the DMA by writing an Enable DMA command to
WR6.

<P>
<BR><HR>

</BODY>
</HTML>
node091.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WR4 – Write Register Group 4</TITLE>
<META NAME="description" CONTENT="WR4 – Write Register Group 4">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node92.html">
<LINK REL="previous" HREF="node90.html">
<LINK REL="next" HREF="node92.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node92.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node90.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html898"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html900"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node92.html">WR5 – Write Register</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node90.html">WR3 – Write Register</A>
 &nbsp; <B>  <A ID="tex2html899"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html901"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660050000000000000">
WR4 – Write Register Group 4</A>
</H4>
<PRE>
D7  D6  D5  D4  D3  D2  D1  D0  BASE REGISTER BYTE
 1   |   |   0   |   |   0   1
     |   |       |   |
     0   0 = Do not use (Behaves like Continuous mode, Byte mode on Z80 DMA)
     0   1 = Continuous mode
     1   0 = Burst mode
     1   1 = Do not use
                 |   |
                 |   V
D7  D6  D5  D4  D3  D2  D1  D0  PORT B STARTING ADDRESS (LOW BYTE)
                 |
                 V
D7  D6  D5  D4  D3  D2  D1  D0  PORT B STARTING ADDRESS (HIGH BYTE)
</PRE>
The Z80 DMA defines three more registers in this group through D4 that
define interrupt behaviour. Interrups and pulse generation are not
implemented in the zxnDMA nor are these registers available for
writing.

<P>
<BR><HR>

</BODY>
</HTML>
node092.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WR5 – Write Register Group 5</TITLE>
<META NAME="description" CONTENT="WR5 – Write Register Group 5">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node93.html">
<LINK REL="previous" HREF="node91.html">
<LINK REL="next" HREF="node93.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node93.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node91.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html902"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html904"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node93.html">WR6 – Command Register</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node91.html">WR4 – Write Register</A>
 &nbsp; <B>  <A ID="tex2html903"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html905"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660060000000000000">
WR5 – Write Register Group 5</A>
</H4>
<PRE>
D7  D6  D5  D4  D3  D2  D1  D0  BASE REGISTER BYTE
 1   0   |   |   0   0   1   0
         |   |
         |   0 = /ce only
         |   1 = /ce &amp; /wait multiplexed
         |
         0 = Stop on end of block
         1 = Auto restart on end of block
</PRE>
The /ce &amp; /wait mode is implemented in the zxnDMA but is not currently
used. This mode has an external device using the DMA's /ce pin to
insert wait states during the DMA's transfer.

<P>
The auto restart feature causes the DMA to automatically reload its
source and destination addresses and reset its byte counter to zero to
repeat the last transfer when a previous one is finished.

<P>
<BR><HR>

</BODY>
</HTML>
node093.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WR6 – Command Register</TITLE>
<META NAME="description" CONTENT="WR6 – Command Register">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node94.html">
<LINK REL="previous" HREF="node92.html">
<LINK REL="next" HREF="node94.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node94.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node92.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html906"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html908"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node94.html">Operating speed</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node92.html">WR5 – Write Register</A>
 &nbsp; <B>  <A ID="tex2html907"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html909"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660070000000000000">
WR6 – Command Register</A>
</H4>
<PRE>
D7  D6  D5  D4  D3  D2  D1  D0  BASE REGISTER BYTE
 1   ?   ?   ?   ?   ?   1   1
     |   |   |   |   |
     1   0   0   0   0 = \$C3 = Reset
     1   0   0   0   1 = \$C7 = Reset Port A Timing
     1   0   0   1   0 = \$CB = Reset Port B Timing
     0   1   1   1   1 = \$BF = Read Status Byte
     0   0   0   1   0 = \$8B = Reinitialize Status Byte
     0   1   0   0   1 = \$A7 = Initialize Read Sequence
     1   0   0   1   1 = \$CF = Load
     1   0   1   0   0 = \$D3 = Continue
     0   0   0   0   1 = \$87 = Enable DMA
     0   0   0   0   0 = \$83 = Disable DMA
 +-- 0   1   1   1   0 = \$BB = Read Mask Follows
 |
D7  D6  D5  D4  D3  D2  D1  D0  READ MASK
 0   |   |   |   |   |   |   |
     |   |   |   |   |   |   V
D7  D6  D5  D4  D3  D2  D1  D0  Status Byte
     |   |   |   |   |   |
     |   |   |   |   |   V
D7  D6  D5  D4  D3  D2  D1  D0  Byte Counter Low
     |   |   |   |   |
     |   |   |   |   V
D7  D6  D5  D4  D3  D2  D1  D0  Byte Counter High
     |   |   |   |
     |   |   |   V
D7  D6  D5  D4  D3  D2  D1  D0  Port A Address Low
     |   |   |
     |   |   V
D7  D6  D5  D4  D3  D2  D1  D0  Port A Address High
     |   |
     |   V
D7  D6  D5  D4  D3  D2  D1  D0  Port B Address Low
     |
     V
D7  D6  D5  D4  D3  D2  D1  D0  Port B Address High
</PRE>
Unimplemented Z80 DMA commands are ignored.

<P>
Prior to starting the DMA, a LOAD command must be issued to copy the
Port A and Port B addresses into the DMA's internal pointers. Then an
ìEnable DMAî command is issued to start the DMA.

<P>
The ìContinueî command resets the DMA’s byte counter so that a
following ìEnable DMAî allows the DMA to repeat the last transfer but
using the current internal address pointers. I.e. it continues from
where the last copy operation left off.

<P>
Registers can be read via an IO read from the DMA port after setting
the read mask. (At power up the read mask is set to $7f). Register
values are the current internal dma counter values. So ìPort Address A
Lowî is the lower 8-bits of Port A’s next transfer address. Once the
end of the read mask is reached, further reads loop around to the
first one.

<P>
The format of the DMA status byte is as follows:

<P>
00E1101T

<P>
E is set to 0 if the total block length has been transferred
at least once.

<P>
T is set to 1 if at least one byte has been transferred.

<P>
<BR><HR>

</BODY>
</HTML>
node094.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Operating speed</TITLE>
<META NAME="description" CONTENT="Operating speed">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node95.html">
<LINK REL="previous" HREF="node93.html">
<LINK REL="next" HREF="node95.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node95.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node93.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html910"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html912"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node95.html">The DMA and Interrupts</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node93.html">WR6 – Command Register</A>
 &nbsp; <B>  <A ID="tex2html911"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html913"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660080000000000000">
Operating speed</A>
</H4>

<P>
The zxnDMA operates at the same speed as the CPU, that is 3.5MHz, 7MHz
or 14MHz. This is a contended clock that is modified by the ULA and
the auto-slowdown by Layer2.

<P>
Auto-slowdown occurs without user intervention if speed exceeds 7Mhz
and the active Layer2 display is being generated (higher speed
operation resumes when the active Layer2 display is not
generated). Programmers do NOT need to account for speed differences
regarding DMA transfers as this happens automatically.

<P>
Because of this, the cycle lengths for Ports A and B can be set to
their minimum values without ill effects. The cycle lengths specified
for Ports A and B are intended to selectively slow down read or write
cycles for hardware that cannot operate at the DMA's full speed.

<P>
<BR><HR>

</BODY>
</HTML>
node095.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>The DMA and Interrupts</TITLE>
<META NAME="description" CONTENT="The DMA and Interrupts">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node94.html">
<LINK REL="next" HREF="node96.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node96.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node86.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node94.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html914"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html916"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node96.html">Programming examples</A>
<B> Up:</B> <A
 HREF="node86.html">zxnDMA Registers</A>
<B> Previous:</B> <A
 HREF="node94.html">Operating speed</A>
 &nbsp; <B>  <A ID="tex2html915"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html917"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00660090000000000000">
The DMA and Interrupts</A>
</H4>

<P>
The zxnDMA cannot currently generate interrupts.

<P>
The other side of this is that while the DMA controls the bus, the Z80
cannot respond to interrupts. On the Z80, the nmi interrupt is edge
triggered so if an nmi occurs the fact that it occurred is stored
internally in the Z80 so that it will respond when it is woken up. On
the other hand, maskable interrupts are level triggered. That is, the
Z80 must be active to regularly sample the /INT line to determine if a
maskable interrupt is occurring. On the Spectrum and the ZX Next, the
ULA (and line interrupt) are only asserted for a fixed amount of time
&nbsp;30 cycles at 3.5MHz. If the DMA is executing a transfer while the
interrupt is asserted, the CPU will not be able to see this and it
will most likely miss the interrupt. In burst mode, the CPU will never
miss these interrupts, although this may change if multiple channels
are implemented.

<P>
<BR><HR>

</BODY>
</HTML>
node096.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Programming examples</TITLE>
<META NAME="description" CONTENT="Programming examples">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node86.html">
<LINK REL="next" HREF="node97.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node97.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node80.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node95.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html918"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html920"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Up:</B> <A
 HREF="node80.html">zxnDMA</A>
<B> Previous:</B> <A
 HREF="node95.html">The DMA and Interrupts</A>
 &nbsp; <B>  <A ID="tex2html919"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html921"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00670000000000000000">
Programming examples</A>
</H1>

<P>
A simple way to program the DMA is to walk down the list of registers
WR0-WR5, sending desired settings to each. Then start the DMA by
sending a LOAD command followed by an ENABLE_DMA command to WR6. Once
more familiar with the DMA, you will discover that the amount of
information sent can be reduced to what changes between transfers.

<P>

<OL>
<LI>Assembly

<P>
Short example program to DMA memory to the screen then DMA a sprite
  image from memory to sprite RAM, and then showing said sprite scroll
  across the screen.
<PRE>
;------------------------------------------------------------------------------
device zxspectrum48
;------------------------------------------------------------------------------
; DEFINE testing
;------------------------------------------------------------------------------
; DMA (Register 6)
;
;------------------------------------------------------------------------------
;zxnDMA programming example
;------------------------------------------------------------------------------
;(c) Jim Bagley
;------------------------------------------------------------------------------
DMA_RESET equ $c3
DMA_RESET_PORT_A_TIMING equ $c7
DMA_RESET_PORT_B_TIMING equ $cb
DMA_LOAD equ $cf ; %11001111
DMA_CONTINUE equ $d3
DMA_DISABLE_INTERUPTS equ $af
DMA_ENABLE_INTERUPTS equ $ab
DMA_RESET_DISABLE_INTERUPTS equ $a3
DMA_ENABLE_AFTER_RETI equ $b7
DMA_READ_STATUS_BYTE equ $bf
DMA_REINIT_STATUS_BYTE equ $8b
DMA_START_READ_SEQUENCE equ $a7
DMA_FORCE_READY equ $b3
DMA_DISABLE equ $83
DMA_ENABLE equ $87
DMA_WRITE_REGISTER_COMMAND equ $bb
DMA_BURST equ %11001101
DMA_CONTINUOUS equ %10101101
ZXN_DMA_PORT equ $6b
SPRITE_STATUS_SLOT_SELECT equ $303B
SPRITE_IMAGE_PORT equ $5b
SPRITE_INFO_PORT equ $57
;------------------------------------------------------------------------------

IFDEF testing
org $6000
ELSE
org $2000
ENDIF

start
ld hl,$0000
ld de,$4000
ld bc,$800
call TransferDMA ; copy some random data to the screen pointing
; to ROM for now, for the purpose of showing
; how to do a DMA copy.
ld a,0 ; sprite image number we want to update
ld bc,SPRITE_STATUS_SLOT_SELECT
out (c),a ; set the sprite image number
ld bc,1*256 ; number to transfer (1)
ld hl,testsprite ; from
call TransferDMASprite ; transfer to sprite ram

nextreg 21,1 ; turn sprite on. for more info on this check
; out https://www.specnext.com/tbblue-io-port-system/
ld de,0
ld (xpos),de ; set initial X position ( doesn't need it for
; this demo, but if you run the .loop again it
; will continue from where it was
ld a,$20
ld (ypos),a ; set initial Y position

.loop
ld a,0 ; sprite number we want to position
ld bc,SPRITE_STATUS_SLOT_SELECT
out (c),a
ld de,(xpos)
ld hl,(ypos) ; ignores H so doing this rather than
; ld a,(ypos):ld l,a
ld bc,(image) ; not flipped or palette shifted
call SetSprite

halt

ld de,(xpos)
inc de
ld (xpos),de
ld a,d
cp $01
jr nz,.loop ; if high byte of xpos is not 1 (right of
; screen )
ld a,e
cp $20+1
jr nz,.loop ; if low byte is not $21 just off the right of
; the screen, $20 is off screen but as the
; INC DE is just above and not updated sprite
; after it, it needs to be $21
xor a
ret ; return back to basic with OK

xpos dw 0 ; x position
ypos db 0 ; y position
; these next two BITS and IMAGE are swapped
; as bits needs to go into B register image
; db 0+$80 ; use image 0 (for the image we
; transfered)+$80 to set the sprite to active
bits db 0 ; not flipped or palette shifted

c1 = %11100000
c2 = %11000000
c3 = %10100000
c4 = %10000000
c5 = %01100000
c6 = %01000000
c7 = %00100000
c8 = %00000000

testsprite
db c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1
db c1,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c1
db c1,c2,c3,c3,c3,c3,c3,c3,c3,c3,c3,c3,c3,c3,c2,c1
db c1,c2,c3,c4,c4,c4,c4,c4,c4,c4,c4,c4,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c5,c5,c5,c5,c5,c5,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c6,c6,c6,c6,c6,c6,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c6,c7,c7,c7,c7,c6,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c6,c7,c8,c8,c7,c6,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c6,c7,c8,c8,c7,c6,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c6,c7,c7,c7,c7,c6,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c6,c6,c6,c6,c6,c6,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c5,c5,c5,c5,c5,c5,c5,c5,c4,c3,c2,c1
db c1,c2,c3,c4,c4,c4,c4,c4,c4,c4,c4,c4,c4,c3,c2,c1
db c1,c2,c3,c3,c3,c3,c3,c3,c3,c3,c3,c3,c3,c3,c2,c1
db c1,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c2,c1
db c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1,c1

;-------------------------------------------------
; de = X
; l = Y
; b = bits
; c = sprite image
SetSprite
push bc
ld bc,SPRITE_INFO_PORT
out (c),e ; Xpos
out (c),l ; Ypos
pop hl
ld a,d
and 1
or h
out (c),a
ld a,l:or $80
out (c),a ; image
ret

;--------------------------------
; hl = source
; de = destination
; bc = length
;--------------------------------
TransferDMA
di
ld (DMASource),hl
ld (DMADest),de
ld (DMALength),bc
ld hl,DMACode
ld b,DMACode_Len
ld c,ZXN_DMA_PORT
otir
ei
ret

DMACode db DMA_DISABLE
db %01111101 ; R0-Transfer mode, A -&gt; B, write adress
; + block length
DMASource dw 0 ; R0-Port A, Start address
; (source address)
DMALength dw 0 ; R0-Block length (length in bytes)
db %01010100 ; R1-write A time byte, increment, to
; memory, bitmask
db %00000010 ; 2t
db %01010000 ; R2-write B time byte, increment, to
; memory, bitmask
db %00000010 ; R2-Cycle length port B
db DMA_CONTINUOUS ; R4-Continuous mode (use this for block
; transfer), write dest adress
DMADest dw 0 ; R4-Dest address (destination address)
db %10000010 ; R5-Restart on end of block, RDY active
; LOW
db DMA_LOAD ; R6-Load
db DMA_ENABLE ; R6-Enable DMA

DMACode_Len equ $-DMACode

;------------------------------------------------------------------------------
; hl = source
; bc = length
; set port to write to with TBBLUE_REGISTER_SELECT
; prior to call
;------------------------------------------------------------------------------
TransferDMAPort
di
ld (DMASourceP),hl
ld (DMALengthP),bc
ld hl,DMACodeP
ld b,DMACode_LenP
ld c,ZXN_DMA_PORT
otir
ei
ret

DMACodeP db DMA_DISABLE
db %01111101 ; R0-Transfer mode, A -&gt; B, write adress
; + block length
DMASourceP dw 0 ; R0-Port A, Start address (source address)
DMALengthP dw 0 ; R0-Block length (length in bytes)
db %01010100 ; R1-read A time byte, increment, to
; memory, bitmask
db %00000010 ; R1-Cycle length port A
db %01101000 ; R2-write B time byte, increment, to
; memory, bitmask
db %00000010 ; R2-Cycle length port B
db %10101101 ; R4-Continuous mode (use this for block
; transfer), write dest adress
dw $253b ; R4-Dest address (destination address)
db %10000010 ; R5-Restart on end of block, RDY active
; LOW
db DMA_LOAD ; R6-Load
db DMA_ENABLE ; R6-Enable DMA

DMACode_LenP equ $-DMACodeP
;------------------------------------------------------------------------------
; hl = source
; bc = length
;------------------------------------------------------------------------------
TransferDMASprite
di
ld (DMASourceS),hl
ld (DMALengthS),bc
ld hl,DMACodeS
ld b,DMACode_LenS
ld c,ZXN_DMA_PORT
otir
ei
ret

DMACodeS db DMA_DISABLE
db %01111101 ; R0-Transfer mode, A -&gt; B, write adress
; + block length
DMASourceS dw 0 ; R0-Port A, Start address (source address)
DMALengthS dw 0 ; R0-Block length (length in bytes)
db %01010100 ; R1-read A time byte, increment, to
; memory, bitmask
db %00000010 ; R1-Cycle length port A
db %01101000 ; R2-write B time byte, increment, to
; memory, bitmask
db %00000010 ; R2-Cycle length port B
db %10101101 ; R4-Continuous mode (use this for block
; transfer), write dest adress
dw SPRITE_IMAGE_PORT ; R4-Dest address (destination address)
db %10000010 ; R5-Restart on end of block, RDY active
; LOW
db DMA_LOAD ; R6-Load
db DMA_ENABLE ; R6-Enable DMA
DMACode_LenS equ $-DMACodeS
;------------------------------------------------------------------------------
; de = dest, a = fill value, bc = lenth
;------------------------------------------------------------------------------
DMAFill
di
ld (FillValue),a
ld (DMACDest),de
ld (DMACLength),bc
ld hl,DMACCode
ld b,DMACCode_Len
ld c,ZXN_DMA_PORT
otir
ei
ret

FillValue db 22
DMACCode db DMA_DISABLE
db %01111101
DMACSource dw FillValue
DMACLength dw 0
db %00100100,%00010000,%10101101
DMACDest dw 0
db DMA_LOAD,DMA_ENABLE
DMACCode_Len equ $-DMACCode

;------------------------------------------------------------------------------
; End of file
;------------------------------------------------------------------------------

IFDEF testing
savesna "dmatest.sna",start
ELSE
fin
savebin "DMATEST",start,fin-start
ENDIF
</PRE>
</LI>
</OL>
<BR><HR>

</BODY>
</HTML>
node097.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Copper and Display Timing</TITLE>
<META NAME="description" CONTENT="Copper and Display Timing">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node123.html">
<LINK REL="previous" HREF="node80.html">
<LINK REL="next" HREF="node98.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node98.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node96.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html922"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html924"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node98.html">Introduction</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node96.html">Programming examples</A>
 &nbsp; <B>  <A ID="tex2html923"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html925"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00700000000000000000">
Copper and Display Timing</A>
</H1>
From: KevB (aka 9bitcolour)

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
<LI><UL>
@{" Introduction " LINK NODE98}
@{" Overview " LINK NODE99}
</UL>
</UL>
</UL>
<BR>
@{" Timing " LINK NODE100}
@{" Machines " LINK NODE101}
@{" Display " LINK NODE102}
@{" Resolution " LINK NODE103}
@{" Dot Clock " LINK NODE104}
@{" Coordinates " LINK NODE105}
@{" Compare " LINK NODE106}
@{" Overscan " LINK NODE107}
</UL>
<BR>
@{" Instructions " LINK NODE108}
@{" NOOP " LINK NODE109}
@{" MOVE " LINK NODE110}
@{" WAIT " LINK NODE111}
@{" Example " LINK NODE112}
</UL>
<BR>
@{" Control " LINK NODE113}
@{" STOP " LINK NODE114}
@{" RESET " LINK NODE115}
@{" START " LINK NODE116}
@{" FRAME " LINK NODE117}
</UL>
<BR>
@{" Configuration " LINK NODE118}
@{" Refresh Rate " LINK NODE119}
@{" Video Modes " LINK NODE120}
@{" Machine Type " LINK NODE121}
@{" Summary " LINK NODE122}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node098.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Introduction</TITLE>
<META NAME="description" CONTENT="Introduction">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node99.html">
<LINK REL="previous" HREF="node97.html">
<LINK REL="next" HREF="node99.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node99.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html951"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html953"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node99.html">Overview</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
 &nbsp; <B>  <A ID="tex2html952"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html954"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00700010000000000000">
Introduction</A>
</H4>

<P>
The ZX Spectrum Next includes a co-processor named &ldquo;COPPER&rdquo;. It
functions in a similar way to the Copper found in the Commodore Amiga
Agnus custom chip.  It's role is to free the Z80 of tasks that require
the writing of hardware registers at precise pixel co-ordinates.

<P>
<BR><HR>

</BODY>
</HTML>
node099.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Overview</TITLE>
<META NAME="description" CONTENT="Overview">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node98.html">
<LINK REL="next" HREF="node100.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node100.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node98.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html955"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html957"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node100.html">Timing</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node98.html">Introduction</A>
 &nbsp; <B>  <A ID="tex2html956"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html958"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00700020000000000000">
Overview</A>
</H4>

<P>
The ZX Spectrum Next COPPER has three instructions: NOOP, MOVE, WAIT. 

<P>
NOOP is used to fine tune timing. MOVE writes data to a specific range
of hardware registers. WAIT waits for a pixel position on the video
display.

<P>
These instructions are stored in 2k (2048 BYTES) of dedicated
write-only program RAM also known as a &ldquo;Copper list&rdquo;.

<P>
Each instruction is 16 bits (WORD) in size allowing for a maximum of
1024 instructions to be stored in the program RAM. The COPPER uses an
internal 10 bit program counter (PC) which wraps to zero at the end of
the list. The PC can be reset to zero, this is the default value after
a hard/soft reset.

<P>
The instructions are stored in big endian format and transferred to
the 2k program RAM using the Z80 or DMA (bits 15..8 followed by bits
7..0).

<P>
Three write-only hardware registers control access to the program RAM
as well as the operating modes.

<P>
System performance is not affected when the COPPER is executing instructions.

<P>
The hardware registers and COPPER program RAM are not connected to the
main memory BUS. The overall design of this system together with the
use of alternate clock edges means that contention between the COPPER,
Z80 and DMA has been eliminated.

<P>
The COPPER has a base clock speed of 13.5Mhz for HDMI and 14Mhz for VGA.

<P>
The bandwidth is around 14 million single cycle NOOP/WAIT instructions
and 7 million two cycle MOVE instructions per second.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node100.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node98.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html955"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html957"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node100.html">Timing</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node98.html">Introduction</A>
 &nbsp; <B>  <A ID="tex2html956"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html958"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node100.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Timing</TITLE>
<META NAME="description" CONTENT="Timing">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node108.html">
<LINK REL="previous" HREF="node97.html">
<LINK REL="next" HREF="node101.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node101.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node99.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html959"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html961"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node101.html">Machines</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node99.html">Overview</A>
 &nbsp; <B>  <A ID="tex2html960"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html962"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00710000000000000000">
Timing</A>
</H1>

<P>
To fully understand the COPPER, you must first understand the display
timing for each of the machines and video modes found in the ZX
Spectrum Next.

<P>
There are several display timing configurations due to the four
machine types, two refresh rates, two video systems (VGA/HDMI) and
Timex HIRES mode.

<P>
Details of these timings are outlined in this chapter.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
@{" Machines " LINK NODE101}
@{" Display " LINK NODE102}
@{" Resolution " LINK NODE103}
@{" Dot Clock " LINK NODE104}
@{" Coordinates " LINK NODE105}
@{" Compare " LINK NODE106}
@{" Overscan " LINK NODE107}
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node101.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Machines</TITLE>
<META NAME="description" CONTENT="Machines">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node102.html">
<LINK REL="previous" HREF="node100.html">
<LINK REL="next" HREF="node102.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node102.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html970"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html972"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node102.html">Display</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node100.html">Timing</A>
 &nbsp; <B>  <A ID="tex2html971"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html973"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00710010000000000000">
Machines</A>
</H4>

<P>
The ZX Spectrum Next has four machine types (48k, 128k, Pentagon, and
HDMI). The machine timing and HDMI determine the number of T-states
per line which determines the base dot clock frequency and Z80/DMA
clock speed.

<P>
This guide groups machine types by their timing for convenience. The
HDMI video mode overrides the default machine timing so it is included
as an extra machine type which does not exist in the official
documentation.

<P>
<BR><HR>

</BODY>
</HTML>
node102.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Display</TITLE>
<META NAME="description" CONTENT="Display">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node103.html">
<LINK REL="previous" HREF="node101.html">
<LINK REL="next" HREF="node103.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node103.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node101.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html974"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html976"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node103.html">Resolution</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node101.html">Machines</A>
 &nbsp; <B>  <A ID="tex2html975"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html977"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00710020000000000000">
Display</A>
</H4>

<P>
The ZX Spectrum Next doesn't have video modes based on resolution that
you would expect to find on graphics card based hardware. There is one
fixed resolution of <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> which can be doubled to
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> in Timex HIRES mode. What it does have is the ability
to set the refresh rate from 50Hz to 60Hz and horizontal dot
clock. This in turn together with the VGA and HDMI timing affects the
vertical line count giving several combinations in total.

<P>
VGA modes 0..6 are included as one single VGA mode as the internal
machine timing is constant across those seven refresh rate steps.

<P>
More details can be found in Video modes.

<P>
<BR><HR>

</BODY>
</HTML>
node103.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Resolution</TITLE>
<META NAME="description" CONTENT="Resolution">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node104.html">
<LINK REL="previous" HREF="node102.html">
<LINK REL="next" HREF="node104.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node104.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node102.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html978"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html980"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node104.html">Dot Clock</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node102.html">Display</A>
 &nbsp; <B>  <A ID="tex2html979"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html981"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00710030000000000000">
Resolution</A>
</H4>

<P>
There are two main horizontal resolutions: standard <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> and
Timex HIRES <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN>. Details of LORES <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img27.svg"
 ALT="$128\times96$"></SPAN> are not
included to simplify this guide.

<P>
The frame buffer height is fixed at 192 pixels and surrounded by a
large border and overscan as well as horizontal and vertical blanking
periods.

<P>
There are five vertical line counts: 261, 262, 311, 312, 320. Several
pixels are hidden in the overscan and blanking periods beyond the
visible border.

<P>
The result is <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> pixel resolutions with
a large border.

<P>
The colour of the visible border beyond the frame buffer can be
manipulated. Visual changes will not show during the overscan and
blanking periods.

<P>
<BR><HR>

</BODY>
</HTML>
node104.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Dot Clock</TITLE>
<META NAME="description" CONTENT="Dot Clock">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node105.html">
<LINK REL="previous" HREF="node103.html">
<LINK REL="next" HREF="node105.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node105.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node103.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html982"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html984"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node105.html">Coordinates</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node103.html">Resolution</A>
 &nbsp; <B>  <A ID="tex2html983"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html985"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00710040000000000000">
Dot Clock</A>
</H4>

<P>
The dot clock on the ZX Spectrum Next runs at 13.5Mhz for HDMI and
around 14Mhz for VGA. The COPPER clock runs at the same frequency as
the dot clock. For v3.00 the copper runs at twice the frequency of the
dot clock.

<P>
The number of dot clocks per line is calculated by multiplying the
number of 3.5Mhz Z80 T-states per line by four. Example: 228Ts * 4 =
912 dot clocks.

<P>
The number of dot clocks per second is calculated by the following:

<P>
T-states per line * 4 * line count * refresh rate

<P>
In standard <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution the duration of one pixel is two
dot clocks. In Timex HIRES <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> resolution the duration of
one pixel is one dot clock.

<P>
Details of the dot clock counts can be found in tables 5.1 and 5.2.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2086"></A>
<TABLE>
<CAPTION><STRONG>Table 6.1:</STRONG>
Vertical Line Counts and Dot Clock Combinations</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img42.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/perline.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2090"></A>
<TABLE>
<CAPTION><STRONG>Table 6.2:</STRONG>
Dot Clocks per Second</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img43.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/persec.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node105.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Coordinates</TITLE>
<META NAME="description" CONTENT="Coordinates">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node106.html">
<LINK REL="previous" HREF="node104.html">
<LINK REL="next" HREF="node106.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node106.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node104.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html986"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html988"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node106.html">Compare</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node104.html">Dot Clock</A>
 &nbsp; <B>  <A ID="tex2html987"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html989"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00710050000000000000">
Coordinates</A>
</H4>

<P>
The top left pixel of the frame buffer is line 0 and horizontal dot
clock 0. This is also known as &ldquo;0,0&rdquo;.

<P>
The bottom right pixel of the frame buffer in standard <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN>
resolution is line 191 and horizontal dot clocks 510+511.

<P>
The bottom right pixel of the frame buffer in Timex HIRES
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> resolution is line 191 and horizontal dot clock 511.

<P>
The line one pixel above the frame buffer is the last line of the
video frame and equal to the total line count minus one (312-1 for
example).

<P>
The line one pixel below the frame buffer is line 192.

<P>
The COPPER horizontal dot clock compare is locked to every eight
pixels in standard <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution and every sixteen pixels
in Timex HIRES <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> resolution. The NOOP instruction can be
used to fine tune timing in single dot clock steps.

<P>
<BR><HR>

</BODY>
</HTML>
node106.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Compare</TITLE>
<META NAME="description" CONTENT="Compare">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node107.html">
<LINK REL="previous" HREF="node105.html">
<LINK REL="next" HREF="node107.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node107.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node105.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html990"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html992"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node107.html">Overscan</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node105.html">Coordinates</A>
 &nbsp; <B>  <A ID="tex2html991"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html993"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00710060000000000000">
Compare</A>
</H4>

<P>
The COPPER uses a 9 bit vertical line compare allowing it to handle
the various line counts.

<P>
The COPPER horizontal compare is 6 bits meaning that it can wait for
64 positions across each line. The range of this value is limited by
the machine timing as that determines the number of dot clocks per
line.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2096"></A>
<TABLE>
<CAPTION><STRONG>Table 6.3:</STRONG>
Maximum Horizontal COPPER Compare</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img44.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/maxhcmp.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
Each horizontal compare is in steps of 16 dot clocks to cover the full
range across a raster line.

<P>
16 dot clocks = 4 pixels in lo <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img27.svg"
 ALT="$128\times96$"></SPAN> resolution

<P>
16 dot clocks = 8 pixels in standard <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution

<P>
16 dot clocks = 16 pixels in high <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> resolution

<P>
There is some slack to consider after the maximum horizontal compare
value. The slack is calculated using the following:

<P>
dot clocks per line - maximum horizontal compare * 16

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2100"></A>
<TABLE>
<CAPTION><STRONG>Table 6.4:</STRONG>
Slack Dot Clocks After Maximum Compare</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img45.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/aftermaxcmp.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
Table 5.5 provides details of the horizontal display, left/right
border, blanking and COPPER dot clock/pixel position compare values:

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2104"></A>
<TABLE>
<CAPTION><STRONG>Table 6.5:</STRONG>
Horizontal Timing</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img46.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/htime.csv}
\par
\raggedright -- Dot clock compare is out of range.
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
Table 5.6 provides a detailed list of vertical display, top/bottom
border and blanking as well as maximum COPPER line compare. It also
provides the ULA VBLANK interrupt line number.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2108"></A>
<TABLE>
<CAPTION><STRONG>Table 6.6:</STRONG>
Vertical Timing</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img47.svg"
 ALT="\begin{table}\centering\tiny
\csvautotabular{copper/vtime.csv}
\par
\raggedright -- Line compare is out of range
\par
* ULA VBLANK interrupt.
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
Note: The HDMI overscan and blanking period is larger than that of a
VGA monitor which can auto-adjust alignment. The following data is
based on visible results from various monitors thus subject to
refinement.

<P>
Pixels are visible during DISPLAY/BORDER and hidden during BLANKING.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node107.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node105.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html990"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html992"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node107.html">Overscan</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node105.html">Coordinates</A>
 &nbsp; <B>  <A ID="tex2html991"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html993"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node107.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Overscan</TITLE>
<META NAME="description" CONTENT="Overscan">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node106.html">
<LINK REL="next" HREF="node108.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node108.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node100.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node106.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html994"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html996"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node108.html">Instructions</A>
<B> Up:</B> <A
 HREF="node100.html">Timing</A>
<B> Previous:</B> <A
 HREF="node106.html">Compare</A>
 &nbsp; <B>  <A ID="tex2html995"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html997"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00710070000000000000">
Overscan</A>
</H4>

<P>
The visible area of the display can extend to resolutions exceeding
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN>.

<P>
The 50/60 Hz refresh rate mode dictates the vertical limit.

<P>
VGA and HDMI differ with VGA providing more visible pixels beyond the
range of HDMI. Table 5.7 provides ideal
extended pixel resolutions:

<P>
Maximum Extended VGA Resolutions

<P>
50Hz = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img48.svg"
 ALT="$352\times288$"></SPAN> (standard 256 resolution)

<P>
60Hz = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img49.svg"
 ALT="$352\times240$"></SPAN> (standard 256 resolution)

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2113"></A>
<TABLE>
<CAPTION><STRONG>Table 6.7:</STRONG>
Ideal Extended Resolutions for Both VGA and HDMI</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img50.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/idealres.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
Table 5.8 provides COPPER horizontal position and vertical
line compare parameters for ideal extended resolutions:

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2117"></A>
<TABLE>
<CAPTION><STRONG>Table 6.8:</STRONG>
Ideal Extended Resolution Display Parameters</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img51.svg"
 ALT="\begin{table}\centering\small
\csvautotabular{copper/idealparam.csv}
\par
\ra...
... The fractional part is specified in dot clocks (NOOP instructions).
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node108.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Instructions</TITLE>
<META NAME="description" CONTENT="Instructions">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node113.html">
<LINK REL="previous" HREF="node100.html">
<LINK REL="next" HREF="node109.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node109.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node107.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html998"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1000"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node109.html">NOOP</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node107.html">Overscan</A>
 &nbsp; <B>  <A ID="tex2html999"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1001"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00720000000000000000">
Instructions</A>
</H1>

<P>
This section describes the behaviour of the COPPER instructions as
well as the bit definitions and execution time.

<P>
The three 16 bit COPPER instructions are comprised of the following
bit definitions:

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2122"></A>
<TABLE>
<CAPTION><STRONG>Table 6.9:</STRONG>
Instruction Bit Definition</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img52.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/instrbit.csv}
\par
\raggedrigh...
...line compare
\par
R 7 bit Next register 0x00..0x7F
\par
D 8 bit data
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
@{" NOOP " LINK NODE109}
@{" MOVE " LINK NODE110}
@{" WAIT " LINK NODE111}
@{" Example " LINK NODE112}
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node109.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>NOOP</TITLE>
<META NAME="description" CONTENT="NOOP">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node110.html">
<LINK REL="previous" HREF="node108.html">
<LINK REL="next" HREF="node110.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node110.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node108.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node108.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1006"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1008"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node110.html">MOVE</A>
<B> Up:</B> <A
 HREF="node108.html">Instructions</A>
<B> Previous:</B> <A
 HREF="node108.html">Instructions</A>
 &nbsp; <B>  <A ID="tex2html1007"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1009"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00720010000000000000">
NOOP</A>
</H4>

<P>
NOOP (no-operation) executes in one dot clock. It is useful for fine
tuning timing, initialising COPPER RAM and 'NOP' out COPPER program
instructions.

<P>
It can be used to align colour and display changes to half pixel
positions in standard <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution. Its duration is equal
to one Timex HIRES pixel.

<P>
This guide uses the name 'NOOP' to avoid confusion with the Z80 opcode
NOP.

<P>
<BR><HR>

</BODY>
</HTML>
node110.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>MOVE</TITLE>
<META NAME="description" CONTENT="MOVE">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node111.html">
<LINK REL="previous" HREF="node109.html">
<LINK REL="next" HREF="node111.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node111.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node108.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node109.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1010"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1012"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node111.html">WAIT</A>
<B> Up:</B> <A
 HREF="node108.html">Instructions</A>
<B> Previous:</B> <A
 HREF="node109.html">NOOP</A>
 &nbsp; <B>  <A ID="tex2html1011"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1013"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00720020000000000000">
MOVE</A>
</H4>

<P>
MOVE executes in two dot clocks. It moves 8 bits of data into any of
the Next hardware registers in the range $00 (0) .. $7F (127).

<P>
The WORD value $0000 is reserved for the NOOP instruction so no
register access is carried out for that special case. Register $00 is
read-only so not affected by the restriction of not being able to
write zero to it.

<P>
This instruction can perform 7 million register writes per second for
VGA and 6.75 million register writes per second for HDMI.

<P>
<BR><HR>

</BODY>
</HTML>
node111.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>WAIT</TITLE>
<META NAME="description" CONTENT="WAIT">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node112.html">
<LINK REL="previous" HREF="node110.html">
<LINK REL="next" HREF="node112.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node112.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node108.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node110.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1014"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1016"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node112.html">Example</A>
<B> Up:</B> <A
 HREF="node108.html">Instructions</A>
<B> Previous:</B> <A
 HREF="node110.html">MOVE</A>
 &nbsp; <B>  <A ID="tex2html1015"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1017"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00720030000000000000">
WAIT</A>
</H4>

<P>
WAIT executes in one dot clock. It performs a compare with the current
vertical line number and the current horizontal dot clock.

<P>
WAIT will hold until the current raster line matches the 9 bit value
stored in bits 8..0. When the line compare matches, WAIT will still
hold if the current horizontal dot clock is less than the value in
bits 14..9.

<P>
This compare logic means that out of order vertical line compares will
cause the COPPER to wait until the next video frame as the test is for
an exact match of the line number. The COPPER will continue to the
next instruction after an out of order horizontal pixel position
compare as the test checks for the current dot clock being greater
than or equal to the compare value.

<P>
WAIT will stop the COPPER when a compare is made against an out of
range vertical line or horizontal dot clock position as they will
never occur

<P>
A standard way to terminate a COPPER program is to wait for line 511
and horizontal position 63. This encodes into the instruction WORD
$FFFF.

<P>
The horizontal dot clock position compare includes an adjustment
meaning that the compare completes three dot clocks early in standard
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1.svg"
 ALT="$256\times 192$"></SPAN> resolution and two dot clocks early in Timex HIRES
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img22.svg"
 ALT="$512\times192$"></SPAN> resolution. In practice, a pixel position can be
specified with clocks to spare to write a register value before the
pixel is displayed. This saves software having to auto-adjust
positions to arrive early. It also means that a wait for 0,0 can
affect the first pixel of the frame buffer before it is displayed and
set the scroll registers without visual artefacts.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node112.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node108.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node110.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1014"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1016"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node112.html">Example</A>
<B> Up:</B> <A
 HREF="node108.html">Instructions</A>
<B> Previous:</B> <A
 HREF="node110.html">MOVE</A>
 &nbsp; <B>  <A ID="tex2html1015"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1017"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node112.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Example</TITLE>
<META NAME="description" CONTENT="Example">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node111.html">
<LINK REL="next" HREF="node113.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node113.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node108.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node111.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1018"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1020"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node113.html">Control</A>
<B> Up:</B> <A
 HREF="node108.html">Instructions</A>
<B> Previous:</B> <A
 HREF="node111.html">WAIT</A>
 &nbsp; <B>  <A ID="tex2html1019"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1021"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00720040000000000000">
Example</A>
</H4>

<P>
The following example provides a simple COPPER program to move data to
a hardware register at two specific pixel positions. The BYTES for the
program are listed in the left column:

<P>
<PRE>
         PAL8 equ   0x41           ; 8 bit palette hardware register

$80,$00       WAIT  0,0            ; wait for pixel position 0,0 (H,V)
$00,$00       NOOP                 ; fine tune timing by one dot clock
$41,$E0       MOVE  PAL8,11100000b ; write RED to palette register

$C0,$BF       WAIT  32,191         ; wait for pixel position 256,191
$00,$00       NOOP                 ; fine tune timing by one dot clock
$41,$00       MOVE  PAL8,00000000b ; write BLACK to palette register

$FF,$FF       WAIT  63,511         ; wait for an out of range position
</PRE>

<P>
<BR><HR>

</BODY>
</HTML>
node113.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Control</TITLE>
<META NAME="description" CONTENT="Control">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node118.html">
<LINK REL="previous" HREF="node108.html">
<LINK REL="next" HREF="node114.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node114.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node112.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1022"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1024"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node114.html">STOP</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node112.html">Example</A>
 &nbsp; <B>  <A ID="tex2html1023"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1025"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00730000000000000000">
Control</A>
</H1>

<P>
The COPPER is controlled by the following three write-only registers:

<P>
<table width="90%"><tr><td valign="top">&nbsp;$60 (96)   Copper data</td></tr>
<tr><td valign="top">&nbsp;$61 (97)   Copper control LO BYTE</td></tr>
<tr><td valign="top">&nbsp;$62 (98)   Copper control HI BYTE
</td></tr></table>

<P>
The COPPER instructions are written one BYTE at a time to the program
RAM using register $60 (Copper data).

<P>
An index system is used to select the destination write address within
the 2K program RAM. Eleven bits are needed to represent the
index. Registers $61 and $62 hold this 11 bit index.

<P>
The index increments each time one BYTE is written to register
$60. The index wraps to zero when the last BYTE of program RAM is
written.

<P>
The instruction data is normally written in big endian format although
there is no rule stating that partial instruction BYTES cannot be
written. It is safe to write to the COPPER program RAM while the
COPPER is executing as long the instruction data written does not
create a mall formed instruction which comprises of one half of the
current executing instruction and one half the new instruction - this
could result in unexpected behaviour.

<P>
The Z80 and DMA can be used to write the instruction data.

<P>
Writing to program RAM while the COPPER is running has no impact on
system performance as the RAM is contention free. COPPER timing is not
affected by the Z80 or DMA writing to the program RAM. Program RAM is
write-only.

<P>
The contents of the 2k program RAM are preserved during a hard/soft reset.

<P>
Register $61 holds the lower 8 bits of the index. Register $62 holds
the upper 3 bits of the index as well as two control bits which set
the COPPER operating mode.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2135"></A>
<TABLE>
<CAPTION><STRONG>Table 6.10:</STRONG>
Register Bit Definitions</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img53.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/regbit.csv}
\par
\raggedright D 8 bit data
\par
I 11 bit index
\par
C 2 bit control
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
The COPPER has an internal 10 bit program counter (PC). Each
instruction advances the program counter by one after completion. The
program counter wraps to zero after the last instruction at location
1023. This causes the copper list to loop.

<P>
The program counter defaults to zero during a hard/soft reset.

<P>
The control bits require a change to update the operating mode. This
feature preserves COPPER operation when setting the program RAM index
address.

<P>
The program counter is preserved when stopping the COPPER. Two of the
four control settings reset the internal PC to zero.

<P>
Table 5.11 describes the control bits:

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2139"></A>
<TABLE>
<CAPTION><STRONG>Table 6.11:</STRONG>
Control Mode Definitions</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img54.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/controlmodes.csv}
\par
\ragged...
...ntrol mode names used in this guide differ from
the official names.
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
Here is a detailed description of the control bits:

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
@{" STOP " LINK NODE114}
@{" RESET " LINK NODE115}
@{" START " LINK NODE116}
@{" FRAME " LINK NODE117}
</UL></UL></UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node114.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node112.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1022"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1024"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node114.html">STOP</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node112.html">Example</A>
 &nbsp; <B>  <A ID="tex2html1023"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1025"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node114.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>STOP</TITLE>
<META NAME="description" CONTENT="STOP">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node115.html">
<LINK REL="previous" HREF="node113.html">
<LINK REL="next" HREF="node115.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node115.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node113.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node113.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1030"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1032"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node115.html">RESET</A>
<B> Up:</B> <A
 HREF="node113.html">Control</A>
<B> Previous:</B> <A
 HREF="node113.html">Control</A>
 &nbsp; <B>  <A ID="tex2html1031"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1033"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00730010000000000000">
STOP</A>
</H4>

<P>
This is the default operating mode set during a hard/soft reset. The
COPPER is idle in this state and will STOP if currently executing when
entering this mode. It is safe to write to any location within the 2K
program RAM when the COPPER is stopped.

<P>
Entering STOP mode preserves the internal program counter so that the
COPPER may continue when restarted.

<P>
<BR><HR>

</BODY>
</HTML>
node115.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>RESET</TITLE>
<META NAME="description" CONTENT="RESET">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node116.html">
<LINK REL="previous" HREF="node114.html">
<LINK REL="next" HREF="node116.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node116.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node113.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node114.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1034"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1036"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node116.html">START</A>
<B> Up:</B> <A
 HREF="node113.html">Control</A>
<B> Previous:</B> <A
 HREF="node114.html">STOP</A>
 &nbsp; <B>  <A ID="tex2html1035"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1037"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00730020000000000000">
RESET</A>
</H4>

<P>
The program counter is RESET to zero when entering this mode. The
COPPER is started if idle otherwise entering this mode acts as a jump
to location zero when the COPPER is running.

<P>
<BR><HR>

</BODY>
</HTML>
node116.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>START</TITLE>
<META NAME="description" CONTENT="START">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node117.html">
<LINK REL="previous" HREF="node115.html">
<LINK REL="next" HREF="node117.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node117.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node113.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node115.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1038"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1040"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node117.html">FRAME</A>
<B> Up:</B> <A
 HREF="node113.html">Control</A>
<B> Previous:</B> <A
 HREF="node115.html">RESET</A>
 &nbsp; <B>  <A ID="tex2html1039"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1041"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00730030000000000000">
START</A>
</H4>

<P>
Entering this mode causes an idle COPPER to start executing
instructions from the current program counter. Entering this mode
while the COPPER is running has no effect other than to disable FRAME
mode if active.

<P>
<BR><HR>

</BODY>
</HTML>
node117.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>FRAME</TITLE>
<META NAME="description" CONTENT="FRAME">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node116.html">
<LINK REL="next" HREF="node118.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node118.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node113.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node116.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1042"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1044"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node118.html">Configuration</A>
<B> Up:</B> <A
 HREF="node113.html">Control</A>
<B> Previous:</B> <A
 HREF="node116.html">START</A>
 &nbsp; <B>  <A ID="tex2html1043"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1045"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00730040000000000000">
FRAME</A>
</H4>

<P>
The program counter is RESET to zero when entering this mode. The
COPPER is started if idle otherwise entering this mode acts as a jump
to location zero when the COPPER is running.

<P>
Entering this state enables FRAME mode. The program counter will be
reset to zero each frame at 0,0.

<P>
<BR><HR>

</BODY>
</HTML>
node118.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Configuration</TITLE>
<META NAME="description" CONTENT="Configuration">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node113.html">
<LINK REL="next" HREF="node119.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node119.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node97.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node117.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1046"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1048"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node119.html">Refresh Rate</A>
<B> Up:</B> <A
 HREF="node97.html">Copper and Display Timing</A>
<B> Previous:</B> <A
 HREF="node117.html">FRAME</A>
 &nbsp; <B>  <A ID="tex2html1047"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1049"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00740000000000000000">
Configuration</A>
</H1>

<P>
Hardware registers provide timing and configuration data allowing
software to build and configure COPPER programs that function
correctly across the various video modes and machine types. It is not
essential to detect the machine type but it should be noted that
software should not assume that it is running on a specific machine as
the COPPER hardware is available across all four machine types.

<P>
Three registers can be read to determine the machine configuration for
Ts per line, dot clocks, refresh rate, line count and maximum
horizontal dot clock/pixel position compare.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
@{" Refresh Rate " LINK NODE119}
@{" Video Modes " LINK NODE120}
@{" Machine Type " LINK NODE121}
@{" Summary " LINK NODE122}
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node119.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Refresh Rate</TITLE>
<META NAME="description" CONTENT="Refresh Rate">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node120.html">
<LINK REL="previous" HREF="node118.html">
<LINK REL="next" HREF="node120.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node120.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1054"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1056"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node120.html">Video Modes</A>
<B> Up:</B> <A
 HREF="node118.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node118.html">Configuration</A>
 &nbsp; <B>  <A ID="tex2html1055"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1057"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00740010000000000000">
Refresh Rate</A>
</H4>

<P>
The refresh rate must be taken into account and can change real-time
so should be monitored and auto-configured when the COPPER is active
as the line count will change with the refresh rate. This could lead
to the COPPER waiting for lines that never occur.

<P>
Register (R/W) $05 (05) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 1 Settings

<UL>
<LI>bits 7-6 = joystick 1 mode (MSB)
</LI>
<LI>bits 5-4 = joystick 2 mode (MSB)
</LI>
<LI>bit 3 = joystick 1 mode (LSB)
</LI>
<LI>bit 2 = 50/60 Hz mode (0 = 50Hz, 1 = 60Hz)
</LI>
<LI>bit 1 = joystick 2 mode (LSB)
</LI>
<LI>bit 0 = Enable Scandoubler
</LI>
</UL>
Joystick modes

<UL>
<LI>000 = Sinclair 2 (67890)
</LI>
<LI>001 = Kempston 2 (port $37)
</LI>
<LI>010 = Kempston 1 (port $1F)
</LI>
<LI>011 = Megadrive 1 (port $1F)
</LI>
<LI>100 = Cursor
</LI>
<LI>101 = Megadrive 2 (port $37)
</LI>
<LI>110 = Sinclair 1 (12345)
</LI>
<LI>111 = I/O Mode (3.01.04)
Both joysticks are places in I/O Mode if either is set to I/O
Mode. The underlying joystick type is not changed and reads of this
register will continue to return the last joystick type. Ehether the
joystick is in io mode or not is invisible but this state can be
cleared either through reset or by re-writing the gegister with
joystick type not equal to 111. Recovery time for a normal joystick
read after leaving I/O Mode is at most 64 scan lines.
</LI>
</UL>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node120.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1054"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1056"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node120.html">Video Modes</A>
<B> Up:</B> <A
 HREF="node118.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node118.html">Configuration</A>
 &nbsp; <B>  <A ID="tex2html1055"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1057"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node120.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Video Modes</TITLE>
<META NAME="description" CONTENT="Video Modes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node121.html">
<LINK REL="previous" HREF="node119.html">
<LINK REL="next" HREF="node121.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node121.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node119.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1058"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1060"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node121.html">Machine Type</A>
<B> Up:</B> <A
 HREF="node118.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node119.html">Refresh Rate</A>
 &nbsp; <B>  <A ID="tex2html1059"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1061"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00740020000000000000">
Video Modes</A>
</H4>

<P>
The video mode can only be changed during the boot process so one
initial read is required of this register during software start up
phase.

<P>
The machine timing is identical for the seven VGA modes although the
physical refresh rate of the video output speeds up for each mode in
turn by roughly 1Hz. The internal timing of the machine remains
constant and as close to the original hardware as possible. VGA is a
perfect Amstrad ZX Spectrum 128k +3 for example as far as timing is
concerned across the seven VGA modes.

<P>
The effect of this speed up means that mode 0 will execute in one
second of time whereas mode 6 will execute in a shorter time
period. Mode 0 is as close to 50/60 Hz as possible where mode 6 is
closer to 60/70 Hz. That would mean that one second of machine time
for mode 6 will execute in 0.83 seconds of human time when running 50
frames per second at 60Hz.

<P>
The eighth mode (mode 7) is used for HDMI timing. Machine
configuration is forced for this mode. Line counts, Ts and various
other settings are set to meet the rigid HDMI timing
specification. For mode 7, 50/60 Hz are rock solid but the original
hardware timing loses Ts across all machines to meet HDMI display
requirements.

<P>
Software that was previously written for specific hardware with
hard-coded software timing loops may fail. This is one of the risks of
coding timing loops counting Ts. We saw evidence of this with the
release of the 1985 Sinclair ZX Spectrum 128k+ and the later Amstrad
models as previous software written for the ZX Spectrum 48k/48k+ would
fail when trying to display colour attribute and border effects as the
number of Ts per line was changed from 224Ts (1982 original 48k) to
228Ts (128k models). The ZX Spectrum Next runs slower in HDMI
mode. Demos may fail to display correctly and games may slow down
although setting the Z80 to 7Mhz can solve the game slow down, demos
should be run in VGA mode for maximum compatibility.

<P>
Video timing also affects audio output as the sample rate can vary
depending on the output timing method.

<P>
The following register allows software to read the video timing mode:

<P>
Register (R/W) $11 (11) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Video Timing (writable in config mode only)
<table width="90%">
bits 7-3 = Reserved, must be 0
bits 2-0 = Mode (VGA = 0..6, HDMI = 7)
  
<UL>
<LI>000 = Base VGA timing, clk28 = 28000000
</LI>
<LI>001 = VGA setting 1, clk28 = 28571429
</LI>
<LI>010 = VGA setting 2, clk28 = 29464286
</LI>
<LI>011 = VGA setting 3, clk28 = 30000000
</LI>
<LI>100 = VGA setting 4, clk28 = 31000000
</LI>
<LI>101 = VGA setting 5, clk28 = 32000000
</LI>
<LI>110 = VGA setting 6, clk28 = 33000000
</LI>
<LI>111 = HDMI, clk28 = 27000000
  
</LI>
</UL><tr><td valign="top">&nbsp;50/60Hz selection depends on bit 2 of register $05</td></tr>
<tr><td valign="top">&nbsp;Only writable in config mode
</td></tr></table>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node121.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node119.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1058"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1060"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node121.html">Machine Type</A>
<B> Up:</B> <A
 HREF="node118.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node119.html">Refresh Rate</A>
 &nbsp; <B>  <A ID="tex2html1059"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1061"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node121.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Machine Type</TITLE>
<META NAME="description" CONTENT="Machine Type">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node122.html">
<LINK REL="previous" HREF="node120.html">
<LINK REL="next" HREF="node122.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node122.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node120.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1062"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1064"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node122.html">Summary</A>
<B> Up:</B> <A
 HREF="node118.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node120.html">Video Modes</A>
 &nbsp; <B>  <A ID="tex2html1063"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1065"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00740030000000000000">
Machine Type</A>
</H4>

<P>
The machine type register can be used to provide the number of Ts per
line, line count, dot clock and maximum horizontal COPPER wait.

<P>
The dot clock (DC) is the number of Ts per line * 4.

<P>
The maximum horizontal COPPER wait (H) is in multiples of 16 clocks.

<P>
Video mode 7 (HMDI) overrides the timing.

<P>
The following list shows the various parameters that can be gained
from reading the machine register combined with the refresh register
and video mode bits:

<P>
Register (R/W) $03 (03) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Machine Type
<BR>
A write to this register disables the boot rom in config mode
<BR>
bits 2-0 select machine type when in config mode
<table width="90%">
bit 7 = (W) Display Timing change enable (allow changes to
  bits 6-4) (0 on hard reset)
bits 6-4 = Display Timing
bit 3 = Display Timing user lock control
  <tr><td valign="top">&nbsp;Read
  
<UL>
<LI>0 = No user lock on display timing
</LI>
<LI>1 = User lock on display timing
  
</LI>
</UL>
  </td></tr>
<tr><td valign="top">&nbsp;Write
  
<UL>
<LI>1 = Apply user lock on display timing (0 on hard reset)
  
</LI>
</UL>
bits 2-0 = Machine Type (config mode only)
<BR>
determines roms loaded</td></tr>
<tr><td valign="top">&nbsp;Machine Types/Display Timings
  
<UL>
<LI>000 or 001 = ZX 48K
</LI>
<LI>010 = ZX 128K/+2 (Grey)
</LI>
<LI>011 = ZX +2A-B/+3e/Next Native
</LI>
<LI>100 = Pentagon 128K
  
</LI>
</UL></td></tr></table>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node122.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node120.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1062"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1064"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node122.html">Summary</A>
<B> Up:</B> <A
 HREF="node118.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node120.html">Video Modes</A>
 &nbsp; <B>  <A ID="tex2html1063"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1065"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node122.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Summary</TITLE>
<META NAME="description" CONTENT="Summary">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node121.html">
<LINK REL="next" HREF="node123.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node123.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node121.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1066"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1068"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node123.html">Interrupts</A>
<B> Up:</B> <A
 HREF="node118.html">Configuration</A>
<B> Previous:</B> <A
 HREF="node121.html">Machine Type</A>
 &nbsp; <B>  <A ID="tex2html1067"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1069"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00740040000000000000">
Summary</A>
</H4>

<P>
Table 5.13 provides a full list of video timing configuration
data:

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="2177"></A>
<TABLE>
<CAPTION><STRONG>Table 6.12:</STRONG>
Summary of Video Modes</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img55.svg"
 ALT="\begin{table}\centering
\csvautotabular{copper/videotiming.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node123.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Interrupts</TITLE>
<META NAME="description" CONTENT="Interrupts">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node134.html">
<LINK REL="previous" HREF="node97.html">
<LINK REL="next" HREF="node124.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node124.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node122.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1070"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1072"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node124.html">Interrupt Types</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node122.html">Summary</A>
 &nbsp; <B>  <A ID="tex2html1071"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1073"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00800000000000000000">
Interrupts</A>
</H1>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Interrupt Types " LINK NODE124}
<LI><A ID="tex2html1075"
  HREF="node125.html"><!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN></A>
<LI><A ID="tex2html1076"
  HREF="node126.html"><!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN></A>
<LI><A ID="tex2html1077"
  HREF="node127.html"><!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN></A>
</UL>
<BR>
@{" Interrupt Modes " LINK NODE128}
@{" IM0 " LINK NODE129}
@{" IM1 " LINK NODE130}
@{" IM2 " LINK NODE131}
</UL>
<BR>
@{" Z80 CTC " LINK NODE132}
@{" Programming " LINK NODE133}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node124.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Interrupt Types</TITLE>
<META NAME="description" CONTENT="Interrupt Types">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node128.html">
<LINK REL="previous" HREF="node123.html">
<LINK REL="next" HREF="node125.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node125.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node123.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node123.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1084"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1086"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> 
<B> Up:</B> <A
 HREF="node123.html">Interrupts</A>
<B> Previous:</B> <A
 HREF="node123.html">Interrupts</A>
 &nbsp; <B>  <A ID="tex2html1085"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1087"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00810000000000000000">
Interrupt Types</A>
</H1>
The Z80 has three different hardware interrupt signals:
<!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN>, <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN>, and <!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN>.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
<LI><A ID="tex2html1088"
  HREF="node125.html"><!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN></A>
<LI><A ID="tex2html1089"
  HREF="node126.html"><!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN></A>
<LI><A ID="tex2html1090"
  HREF="node127.html"><!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN></A>
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node125.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>zxnext_notes</TITLE>
<META NAME="description" CONTENT="zxnext_notes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node126.html">
<LINK REL="previous" HREF="node124.html">
<LINK REL="next" HREF="node126.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node126.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node124.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node124.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1091"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1093"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> 
<B> Up:</B> <A
 HREF="node124.html">Interrupt Types</A>
<B> Previous:</B> <A
 HREF="node124.html">Interrupt Types</A>
 &nbsp; <B>  <A ID="tex2html1092"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1094"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00810010000000000000">
<!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN></A>
</H4>
<!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN> is used to return the CPU to a known state. When
the <!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN> line is pulled low, a <!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN> is
generated. The CPU then does several things. I, and R are set to $00.
PC is set to $0000. SP becomes $FFFF. A and F are set to $FF.  The
interrupt mode is set to 0. And (maskable) interrupts are disabled by
clearing IFF1 and IFF2.

<P>
<BR><HR>

</BODY>
</HTML>
node126.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>zxnext_notes</TITLE>
<META NAME="description" CONTENT="zxnext_notes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node127.html">
<LINK REL="previous" HREF="node125.html">
<LINK REL="next" HREF="node127.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node127.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node124.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node125.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1095"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1097"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> 
<B> Up:</B> <A
 HREF="node124.html">Interrupt Types</A>
<B> Previous:</B> 
 &nbsp; <B>  <A ID="tex2html1096"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1098"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00810020000000000000">
<!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN></A>
</H4>
<!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> is the non-maskable interrupt. Upon receiving a
non-maskable interrupt (<!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> being pulled low) one of
two sequences occur depending on the calue of bit 3 of the interrupt
control register (nextreg $C0).

<P>
Register (R/W) $C0 (C0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Control (3.01.09)
<BR>($00 on reset)

<UL>
<LI>bits 7-5 = Programmable portion of IM2 vector *
</LI>
<LI>bit 4 = Reserved, must be 0
</LI>
<LI>bit 3 = Enable stackless <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> response
</LI>
<LI>bits 2-1 = Reserved, must be 0
</LI>
<LI>bit 0 = Maskable interrupt mode
<table width="90%"><tr><td valign="top">&nbsp;0 - pulse</td></tr>
<tr><td valign="top">&nbsp;1 - IM2
</td></tr></table>
</LI>
</UL>
* In IM2 mode vector generated is:

<UL>
<LI>bits 7-5 = nextreg $C0 bits 7-5
</LI>
<LI>bits 4-1 = Interrupt source
<table width="90%"><tr><td valign="top">&nbsp;0 - line interrupt (highest priority)</td></tr>
<tr><td valign="top">&nbsp;1 - UART 0 Rx</td></tr>
<tr><td valign="top">&nbsp;2 - UART 1 Rx</td></tr>
<tr><td valign="top">&nbsp;3&ndash;10 - CTC channels 0-7</td></tr>
<tr><td valign="top">&nbsp;11 - ULA</td></tr>
<tr><td valign="top">&nbsp;12 - UART 0 Tx</td></tr>
<tr><td valign="top">&nbsp;13 - UART 1 Tx (lowest priority)
</td></tr></table>

</LI>
<LI>bit 0 = 0
</LI>
</UL>

<P>
If bit 3 is clear (0) PC is pushed on the stack, IFF1 is copied to
IFF2, IFF1 is cleared (inhibiting maskable interrupts). The
<!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> should end with RETN which copies the contents of
IFF2 to IFF1 (returning the interrupt state to what it was before the
<!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN>) and PC is popped off the stack.

<P>
If bit 3 is set (1) PC is stored in the <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> return
address registers (nextregs $C2 and $C3), IFF1 is copied to IFF2,
IFF1 is cleared (inhibiting maskable interrupts). The
<!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> should end with RETN which copies the contents of
IFF2 to IFF1 (returning the interrupt state to what it was before the
<!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN>) and PC is compied from the <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN>
return address registers.

<P>
Register (R/W) $C2 (C2) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> Return Address LSB (3.01.09)
<BR>($00 on reset)

<P>
Register (R/W) $C3 (C3) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> Return Address MSB (3.01.09)
<BR>($00 on reset)

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node127.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node124.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node125.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1095"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1097"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> 
<B> Up:</B> <A
 HREF="node124.html">Interrupt Types</A>
<B> Previous:</B> 
 &nbsp; <B>  <A ID="tex2html1096"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1098"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node127.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>zxnext_notes</TITLE>
<META NAME="description" CONTENT="zxnext_notes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node126.html">
<LINK REL="next" HREF="node128.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node128.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node124.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node126.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1099"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1101"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node128.html">Interrupt Modes</A>
<B> Up:</B> <A
 HREF="node124.html">Interrupt Types</A>
<B> Previous:</B> 
 &nbsp; <B>  <A ID="tex2html1100"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1102"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00810030000000000000">
<!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN></A>
</H4>
The interrupt generally of most interest to programmers is
<!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN>. So much so that if programmers talk about
interrupts on the Z80, they are probebly only talking about
<!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN>. The processing of <!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN> is controlled
by IFF1 and IFF2 which are set using EI to enable interrupts and reset
using DI to disable interrupts. Interrupts can happen at any time and
should preserve register contents.  If none of your code uses the
alternate registers the EXX and EX AF,AF’ instructions can make this
faster and easier. Interrupt routined should end with EI and RETI to
reenable interrupts, potentially inform the interrupting device that
its interrupt has been serviced, and return from the interrupt
routine. In general the Spectrum machines do not make any distingtion
between RET and RETI, but future developments in the ZX Spectrum Next
may make the distinction important.

<P>
The ZX Spectrum Next has 14 internal sources for <!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN>
signals. This can be enabled and disabled using nextregs $C4 &ndash;
$C6. Which signals have been received can be read/cleared using
nexregs $C8 &ndash; $CA.

<P>
Interrupt Enable

<P>
Register (R/W) $C4 (C4) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Enable 0 (3.01.08)
<BR>($83 on reset)

<UL>
<LI>bit 7 = Expansion bus <!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN>
</LI>
<LI>bits 6-2 = Reserved must be zero
</LI>
<LI>bit 1 = Line
</LI>
<LI>bit 0 = ULA
</LI>
</UL>

<P>
Register (R/W) $C5 (C5) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Enable 1 (3.01.08)
<BR>($00 on reset)

<UL>
<LI>bit 7 = ctc channel 7 zc/to
</LI>
<LI>bit 6 = ctc channel 6 zc/to
</LI>
<LI>bit 5 = ctc channel 5 zc/to
</LI>
<LI>bit 4 = ctc channel 4 zc/to
</LI>
<LI>bit 3 = ctc channel 3 zc/to
</LI>
<LI>bit 2 = ctc channel 2 zc/to
</LI>
<LI>bit 1 = ctc channel 1 zc/to
</LI>
<LI>bit 0 = ctc channel 0 zc/to
</LI>
</UL>

<P>
Register (W) $C6 (C6) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Enable 2 (3.01.08)
<BR>($00 on reset)

<UL>
<LI>bit 7 = Reserved, must be 0
</LI>
<LI>bit 6 = UART1 Tx empty
</LI>
<LI>bit 5 = UART1 Rx half full *
</LI>
<LI>bit 4 = UART1 Rx available *
</LI>
<LI>bit 3 = Reserved, must be 0
</LI>
<LI>bit 2 = UART0 Tx empty
</LI>
<LI>bit 1 = UART0 Rx half full *
</LI>
<LI>bit 0 = UART0 Rx available *
</LI>
</UL>
* For each UART, Rx half full and Rx available are shared interrupts

<P>
Interupt Status

<P>
Register (R/W) $C8 (C8) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Status 0 (3.01.09)
<BR>($00 on reset)

<UL>
<LI>bits 7-2 = Reserved, must be zero
</LI>
<LI>bit 1 = Line
</LI>
<LI>bit 0 = ULA
</LI>
</UL>
* Set bits indicate the device generated an interrupt in the past
* Writes clear bits where bits are set except in IM2 mode

<P>
Register (R/W) $C9 (C9) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Status 1 (3.01.09)

<UL>
<LI>bit 7 = ctc channel 7 zc/to
</LI>
<LI>bit 6 = ctc channel 6 zc/to
</LI>
<LI>bit 5 = ctc channel 5 zc/to
</LI>
<LI>bit 4 = ctc channel 4 zc/to
</LI>
<LI>bit 3 = ctc channel 3 zc/to
</LI>
<LI>bit 2 = ctc channel 2 zc/to
</LI>
<LI>bit 1 = ctc channel 1 zc/to
</LI>
<LI>bit 0 = ctc channel 0 zc/to
</LI>
</UL>
* Set bits indicate the device generated an interrupt in the past
* Writes clear bits where bits are set except in IM2 mode

<P>
Register (R/W) $CA (CA) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Status 2 (3.01.09)
($00 on reset)

<UL>
<LI>bit 7 = Reserved, must be zero
</LI>
<LI>bit 6 = UART1 Tx empty
</LI>
<LI>bit 5 = UART1 Rx almost full *
</LI>
<LI>bit 4 = UART1 Rx available *
</LI>
<LI>bit 3 = Reserved must be zero
</LI>
<LI>bit 2 = UART0 Tx empty
</LI>
<LI>bit 1 = UART0 Rx almost full *
</LI>
<LI>bit 0 = UART0 Rx available *
</LI>
</UL>
* For each UART Rx half full and Rx available are shared interrupts
** Set bits indicate the device generated an interrupt in the past
** Writes clear bits where bits are set except in IM2 mode

<P>
Internal Interrupt Sources
<table width="90%"><tr><td valign="top">&nbsp;0 = Line (highest priority)</td></tr>
<tr><td valign="top">&nbsp;1 = UART 0 Rx</td></tr>
<tr><td valign="top">&nbsp;2 = UART 1 Rx</td></tr>
<tr><td valign="top">&nbsp;3-10 = CTC channels 0-7</td></tr>
<tr><td valign="top">&nbsp;11 = ULA</td></tr>
<tr><td valign="top">&nbsp;12 = UART 0 Tx</td></tr>
<tr><td valign="top">&nbsp;13 = UART 1 Tx (lowest priority)
</td></tr></table>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node128.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node124.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node126.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1099"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1101"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node128.html">Interrupt Modes</A>
<B> Up:</B> <A
 HREF="node124.html">Interrupt Types</A>
<B> Previous:</B> 
 &nbsp; <B>  <A ID="tex2html1100"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1102"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node128.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Interrupt Modes</TITLE>
<META NAME="description" CONTENT="Interrupt Modes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node132.html">
<LINK REL="previous" HREF="node124.html">
<LINK REL="next" HREF="node129.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node129.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node123.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node127.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1103"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1105"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node129.html">IM0</A>
<B> Up:</B> <A
 HREF="node123.html">Interrupts</A>
<B> Previous:</B> 
 &nbsp; <B>  <A ID="tex2html1104"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1106"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00820000000000000000">
Interrupt Modes</A>
</H1>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
@{" IM0 " LINK NODE129}
@{" IM1 " LINK NODE130}
@{" IM2 " LINK NODE131}
</UL></UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node129.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>IM0</TITLE>
<META NAME="description" CONTENT="IM0">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node130.html">
<LINK REL="previous" HREF="node128.html">
<LINK REL="next" HREF="node130.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node130.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node128.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node128.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1110"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1112"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node130.html">IM1</A>
<B> Up:</B> <A
 HREF="node128.html">Interrupt Modes</A>
<B> Previous:</B> <A
 HREF="node128.html">Interrupt Modes</A>
 &nbsp; <B>  <A ID="tex2html1111"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1113"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00820010000000000000">
IM0</A>
</H4>
When an interrupt is received by the CPU it disables interrupts and
executes the instruction placed on the bus by the interrupting device
and (no known use on the Next) It is enabled with the IM0 instruction
and enabling interrupts (EI).

<P>
<BR><HR>

</BODY>
</HTML>
node130.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>IM1</TITLE>
<META NAME="description" CONTENT="IM1">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node131.html">
<LINK REL="previous" HREF="node129.html">
<LINK REL="next" HREF="node131.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node131.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node128.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node129.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1114"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1116"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node131.html">IM2</A>
<B> Up:</B> <A
 HREF="node128.html">Interrupt Modes</A>
<B> Previous:</B> <A
 HREF="node129.html">IM0</A>
 &nbsp; <B>  <A ID="tex2html1115"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1117"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00820020000000000000">
IM1</A>
</H4>
When an interrupt is received, the CPU disables interrupts and jumps
to an interrupt handler at $0038 (normally in ROM). The ROM interrupt
handler updates the frame counter and scans the keyboard. This is the
default interrupt handling method for the ZX Spectrum and is probably
the method to use if you don’t need the ROMs for anything. It is
enabled using the IM1 instruction and enabling interrupts.

<P>
<BR><HR>

</BODY>
</HTML>
node131.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>IM2</TITLE>
<META NAME="description" CONTENT="IM2">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node130.html">
<LINK REL="next" HREF="node132.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node132.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node128.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node130.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1118"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1120"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node132.html">Z80 CTC</A>
<B> Up:</B> <A
 HREF="node128.html">Interrupt Modes</A>
<B> Previous:</B> <A
 HREF="node130.html">IM1</A>
 &nbsp; <B>  <A ID="tex2html1119"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1121"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00820030000000000000">
IM2</A>
</H4>
The ZX Spectrum Next has both a legacy method for handling IM2 and an
updated one which makes better use of the capabilities of IM2 which
was added in Core 3.01.09.

<P>
The ZX Spectrum Next has 14 interrupt devices which can all be given
independent interrupt vectors when using IM2. These interrupts are
controlled by nextregs $C0 &ndash; $CF.  The address of the vector for a
given interrupt is created by composing the I register (bits 15-0),
nextreg $C0 bits 7-5 (bits 7-5) and the interrupt number of the
interrupt device (bits 4-1). This means that even if you use all 14
internal interrupt sources, your interrupt vector table is no more
than 28 bytes which can be at any 32 byte boundry. It also means that
far less processing has to be done on interrupts which are
received. External interrupts are a little different. If no vector is
supplied by a device the implied LSB will be $FF.

<P>
While in IM2 mode, it is possible for interrupts to interrupt DMA
transfers. This capability is controlled by The DMA Interrupt enable
registers (nextregs $CC &ndash; $CE). When DMA is interrupted, one
instruction of the main program will be processed, then the interrupt
will be taken. On return, DMA will continue.

<P>
Register (R/W) $CC (CC) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DMA Interrupt Enable 0 (3.01.09)
($00 on reset)

<UL>
<LI>bits 7-2 = Reserved, must be 0
</LI>
<LI>bit 1 = Line
</LI>
<LI>bit 0 = ULA
</LI>
</UL>
* Set bits indicate the specified interrupt will interrupt a DMA
  operation when in IM2 mode

<P>
Register (R/W) $CD (CD) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DMA Interrupt Enable 1 (3.01.09)
($00 on reset)

<UL>
<LI>bit 7 = CTC channel 7 zc/to
</LI>
<LI>bit 6 = CTC channel 6 zc/to
</LI>
<LI>bit 5 = CTC channel 5 zc/to
</LI>
<LI>bit 4 = CTC channel 4 zc/to
</LI>
<LI>bit 3 = CTC channel 3 zc/to
</LI>
<LI>bit 2 = CTC channel 2 zc/to
</LI>
<LI>bit 1 = CTC channel 1 zc/to
</LI>
<LI>bit 0 = CTC channel 0 zc/to
</LI>
</UL>
* Set bits indicate the corresponding interrupt will interrupt a DMA
  operation when in IM2 mode

<P>
Register (R/W) $CE (CE) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DMA Interrupt Enable 2 (3.01.09)
($00 on reset)

<UL>
<LI>bit 7 = Reserved, must be 0
</LI>
<LI>bit 6 = UART1 Tx empty
</LI>
<LI>bit 5 = UART1 Rx half full
</LI>
<LI>bit 4 = UART1 Rx available
</LI>
<LI>bit 3 = Reserved, must be 0
</LI>
<LI>bit 2 = UART0 Tx empty
</LI>
<LI>bit 1 = UART0 Tx half full
</LI>
<LI>bit 0 = UART0 Tx available
</LI>
</UL>
* Set bits indicate the corresponding interrupt will interrupt a DMA
  operation when in IM2 mode.

<P>
In legacy mode, when the CPU receives an interrupt it disables
interrupts and jumps to an interrupt routine starting at the contents
of the jump table at I. The start of the interrupt routine is the
contents of I*$100+bus and I*$100+bus+1. Most devices that can
supply interrupts on the ZX Spectrum leave the data bus in a floating
state.  As a result the interpreted state of the data bus while
generally $FF is not entirely predictable.  The solution to place
your interrupt routine at an address where the MSB and LSB are the
same ($0101, $0202, … $FFFF) then place 257 copies of that value in
a block starting at I*$100 (you can set the value of the I register).

<P>
Code:
<PRE>
;; my program
org $8000
;; enable interrupt mode im2
ld i,$fe
im2
ei
;; program body
;; interrupt routine
handler:
;; preserve registers used
;; handle interrupt
;; restore registers
ei
reti
;; jump to interrupt routine
org $fdfd
jp handler
;; im2 jump table
org $fe00 ; not actually legal
defs $101,$fd
</PRE>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node132.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node128.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node130.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1118"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1120"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node132.html">Z80 CTC</A>
<B> Up:</B> <A
 HREF="node128.html">Interrupt Modes</A>
<B> Previous:</B> <A
 HREF="node130.html">IM1</A>
 &nbsp; <B>  <A ID="tex2html1119"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1121"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node132.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Z80 CTC</TITLE>
<META NAME="description" CONTENT="Z80 CTC">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node128.html">
<LINK REL="next" HREF="node133.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node133.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node123.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node131.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1122"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1124"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node133.html">Programming</A>
<B> Up:</B> <A
 HREF="node123.html">Interrupts</A>
<B> Previous:</B> <A
 HREF="node131.html">IM2</A>
 &nbsp; <B>  <A ID="tex2html1123"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1125"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00830000000000000000">
Z80 CTC</A>
</H1>
(3.01.08) Untested, assuming it acts like two Z80 CTCs.

<P>
Eight independent CTC channels are available on ports $183B through
$1F3B.  These perform counter/timer functions that can be used to
generate timer interrupts or to generate interrupts from physical
signals.

<P>
The CTC is a standard Zilog part.  Its datasheet can be found at
http://www.zilog.com/docs/z80/ps0181.pdf .  The Zilog documentation is
ambiguous around how soft resets are treated so the following
clarifies some points in the Next's implementation.

<P>

<OL>
<LI>Hard reset requires both a control word and a time constant to
  be written to a channel even if bit 2 = 0 in the first control word.
</LI>
<LI>Soft reset with bit 2 = 0 causes the entire control register to
  be modified.  Soft reset with bit 2 = 1 does not change the control
  register contents.  In both cases a time constant must follow to
  resume operation.
</LI>
<LI>Changing the trigger edge selection in bit 4 while the channel
  is in operation counts as a clock edge.  A pending timer trigger
  will be fired and, in counter mode, an edge will be received.
</LI>
<LI>ZC/TO is asserted for one clock cycle and not for the entire
  duration that the count is at zero.
</LI>
</OL>
At the moment, any interrupt generated by the CTC will assert the
z80's /INT line for 32 cpu cycles.  This is the same way that the ULA
and line interrupts operate.

<P>
At the moment, the ZC/TO output of each channel is fed into the
CLK/TRG input of the succeeding channel so that time and count periods
can be cascaded.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><UL>
<LI><UL>
@{" Programming " LINK NODE133}
</UL></UL></UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node133.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node123.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node131.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1122"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1124"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node133.html">Programming</A>
<B> Up:</B> <A
 HREF="node123.html">Interrupts</A>
<B> Previous:</B> <A
 HREF="node131.html">IM2</A>
 &nbsp; <B>  <A ID="tex2html1123"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1125"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node133.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Programming</TITLE>
<META NAME="description" CONTENT="Programming">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node132.html">
<LINK REL="next" HREF="node134.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node134.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node132.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node132.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1127"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1129"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node134.html">Serial Communication</A>
<B> Up:</B> <A
 HREF="node132.html">Z80 CTC</A>
<B> Previous:</B> <A
 HREF="node132.html">Z80 CTC</A>
 &nbsp; <B>  <A ID="tex2html1128"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1130"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H4><A ID="SECTION00830010000000000000">
Programming</A>
</H4>
Initial values are set by a write of a channel control word followed
by a time constant. In timer mode, the counter decrements every time
it is triggered. In counter mode it decrements every time the
prescaler counter reaches zero.

<P>
Channel Control Word
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Enable Interrupt</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Mode
  
<UL>
<LI>0 = Timer mode
</LI>
<LI>1 = Counter mode
  
</LI>
</UL></td></tr>
<tr><td valign="top">&nbsp;bit 5 = Prescalar value (Timer mode only)
  
<UL>
<LI>0 = 16
</LI>
<LI>1 = 256
  
</LI>
</UL></td></tr>
<tr><td valign="top">&nbsp;bit 4 = CLK/TRG edge selection
  
<UL>
<LI>0 = Falling Edge
</LI>
<LI>1 = Rising Edge
  
</LI>
</UL></td></tr>
<tr><td valign="top">&nbsp;bit 3 = Timer Trigger (Timer mode only)
  
<UL>
<LI>0 = Starts on loading of time constant
</LI>
<LI>1 = Starts on CLK/TRG
  
</LI>
</UL></td></tr>
<tr><td valign="top">&nbsp;bit 2 = Time constant follows</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Software reset</td></tr>
<tr><td valign="top">&nbsp;bit 0 = 0 (Control Word)
</td></tr></table>

<P>
If we are running at 28MHz (Mode 0) and wish to trigger an interrupt
every 1 sec, that is 28 million T-States/cycles we could program CTC 5
as a counter with a prescalar of 16 and a period of 175, CTC 6 as a
counter with a prescalar of 16 and a period of 125, and CTC 7 as a
timer with a period of 5.

<P>
CTC 5 triggers ZC5 every 280 cycles or 10 usec.

<P>
CTC 6 triggers ZC6 every 560,000 cycles or 20 msec.

<P>
CTC 7 triggers ZC7 and an interrupt every 28,000,000 cycles or 1 sec.

<P>
<PRE>
di
; set up interrupt routine
im 2
ld bc,$183B     ; CTC 0
ld hl,$FFFA     ; address pointing to start of interrupt routine
ld de,interrupt ; start of interrupt routine
ld (hl),de
ld i,$FF
ld a,l          ; Vector to address at on this interrupt
out (c),a
; set up CTC 5
ld b,$1D        ; CTC 5
ld a,$87
out (c),a       ; Interrupt mode, timer mode, time constant, soft, control
ld a,$05
out (c),a       ; once every 5 times 
; set up CTC 6
inc b           ; CTC 6
ld a,$47
out (c),a       ; 16x, counter mode, time constant, soft, control
ld a,$7D        ; 125 = once every 2000 times
out (c),a
; set up CTC 7
inc b           ; CTC 7
ld a,$47
out (c),a       ; 16x, counter mode, time constant, soft, control
ld a,$AF        ; 175 = once every 2800 times
ei
</PRE>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node134.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node132.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node132.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1127"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1129"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node134.html">Serial Communication</A>
<B> Up:</B> <A
 HREF="node132.html">Z80 CTC</A>
<B> Previous:</B> <A
 HREF="node132.html">Z80 CTC</A>
 &nbsp; <B>  <A ID="tex2html1128"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1130"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node134.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Serial Communication</TITLE>
<META NAME="description" CONTENT="Serial Communication">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node135.html">
<LINK REL="previous" HREF="node123.html">
<LINK REL="next" HREF="node135.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node135.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node133.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1131"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1133"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node135.html">Raspberry Pi0 Acceleration</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node133.html">Programming</A>
 &nbsp; <B>  <A ID="tex2html1132"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1134"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION00900000000000000000">
Serial Communication</A>
</H1>

<P>
The Spectrum Next has two independent fully featured UARTs. The UARTS
share I/O ports so it is important to select the correct one before
communicating with it. Each has its own 64 byte Tx buffer and 512 byte
Rx buffer. One UART can be connected to either the ESP of joystick
port while the other can be connected to the Raspberry Pi accelerator
or joystick port. The UARTS are controlled using ports $37, $133B,
$143B, $153B, and $163B. The UARTs are connected to the IM2
interrupt system.  Nextreg $c6 allows interrupts to be enabled for
the status of each UART. UART interrupts correspond to interrupts 1,
2, 12, and 13 (see Interrupts).

<P>
Port $37 (37) Kempston/Mega Drive Joystick 2
<BR>
Read
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = &rdquo;start&rdquo; button</td></tr>
<tr><td valign="top">&nbsp;bit 6 = A/X button</td></tr>
<tr><td valign="top">&nbsp;bit 5 = C/Z button</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Fire/C/Y button</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Up</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Down</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Left</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Right
</td></tr></table>

Disable with Nextreg $05
<BR>
Write ($00 on reset, 3.01.04)
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = Select I/O Mode
  <table width="90%">  <tr><td valign="top">&nbsp;00 = Bit Bang
  </td></tr>
<tr><td valign="top">&nbsp;01 = Clock
  </td></tr>
<tr><td valign="top">&nbsp;10 = UART
  </td></tr>
<tr><td valign="top">&nbsp;11 = Reserved (don't use)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Select Joystick Port for Read
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Left
  </td></tr>
<tr><td valign="top">&nbsp;1 = Right
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bits 3-1 = Reserved, must be $00</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Pin 7 state (both ports)
  
<UL>
<LI>Bit Bang - bit 0 on pin 7
</LI>
<LI>Clock - clock on pin 7
<BR>
0 = Slow clock (Fsys/2048 = 12.672 kHz)
<BR>
1 = Fast clock (Fsys/8 = 3.5 MHz)
</LI>
<LI>UART - Pin 7 = TX, Pin 9 = RX
    0 = ESP
<BR>
1 = Pi
  
</LI>
</UL></td></tr></table>

** A Runt clock may appear in the first cycle
<BR>
The I/O mode should be set by writing this port first followed by
enabling io mo de on the joysticks with a write to nextreg 0x05.

<P>
Port $133B (133B) UART tx
<BR>
Read: UART Status
<BR><table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bit 3 = UART at least half full (3.01.09)</td></tr>
<tr><td valign="top">&nbsp;bit 2 = UART full</td></tr>
<tr><td valign="top">&nbsp;bit 1 = UART transmit busy</td></tr>
<tr><td valign="top">&nbsp;bit 0 = UART receive has data
</td></tr></table>

Write: UART Transmit

<P>
Port $143B (143B) UART rx
<BR>
Read: UART Receive
<BR>
Write: UART Prescalar
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = select prescalar part
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Bits 6-0 of prescalar
  </td></tr>
<tr><td valign="top">&nbsp;1 = Bits 13-7 of prescalar
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bits 6-0 = Prescalar bits
</td></tr></table>

<P>
Port $153B (153B) UART select
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bit 6 = UART select (0 on soft reset) **
  <table width="90%">  <tr><td valign="top">&nbsp;0 = ESP
  </td></tr>
<tr><td valign="top">&nbsp;1 = Pi *
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Prescalar valid in this write</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bits 2-0 = Bits 16-14 of prescalar (0 on hard reset)
</td></tr></table>

* Pi GPIO must be configured for UART, see nextreg $A0
<BR>** Either UART can be redirected to the joystick ports, see port $037

<P>
Port $153B (153B) UART frame (upcoming)
<BR>($18 on hard reset)
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Immediately reset Rx and Tx to idle and empty FIFOs</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Assert break (Tx=0) when Tx reaches idle</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Enable hardware flow control *</td></tr>
<tr><td valign="top">&nbsp;bits 4-3 = Number of bits in a frame
  <table width="90%">  <tr><td valign="top">&nbsp;00 = 5 bits
  </td></tr>
<tr><td valign="top">&nbsp;01 = 6 bits
  </td></tr>
<tr><td valign="top">&nbsp;10 = 7 bits
  </td></tr>
<tr><td valign="top">&nbsp;11 = 8 bits
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Enable parity</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Parity
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Even parity
  </td></tr>
<tr><td valign="top">&nbsp;1 = Odd parity
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Number of stop bits
  <table width="90%">  <tr><td valign="top">&nbsp;0 = 1 stop bit
  </td></tr>
<tr><td valign="top">&nbsp;1 = 2 stop bits
  </td></tr></table>
</td></tr></table>

Register (R/W) $C0 (C0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Control (3.01.09)
<BR>($00 on reset)

<UL>
<LI>bits 7-5 = Programmable portion of IM2 vector *
</LI>
<LI>bit 4 = Reserved, must be 0
</LI>
<LI>bit 3 = Enable stackless <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> response
</LI>
<LI>bits 2-1 = Reserved, must be 0
</LI>
<LI>bit 0 = Maskable interrupt mode
<table width="90%"><tr><td valign="top">&nbsp;0 - pulse</td></tr>
<tr><td valign="top">&nbsp;1 - IM2
</td></tr></table>
</LI>
</UL>
* In IM2 mode vector generated is:

<UL>
<LI>bits 7-5 = nextreg $C0 bits 7-5
</LI>
<LI>bits 4-1 = Interrupt source
<table width="90%"><tr><td valign="top">&nbsp;0 - line interrupt (highest priority)</td></tr>
<tr><td valign="top">&nbsp;1 - UART 0 Rx</td></tr>
<tr><td valign="top">&nbsp;2 - UART 1 Rx</td></tr>
<tr><td valign="top">&nbsp;3&ndash;10 - CTC channels 0-7</td></tr>
<tr><td valign="top">&nbsp;11 - ULA</td></tr>
<tr><td valign="top">&nbsp;12 - UART 0 Tx</td></tr>
<tr><td valign="top">&nbsp;13 - UART 1 Tx (lowest priority)
</td></tr></table>

</LI>
<LI>bit 0 = 0
</LI>
</UL>

<P>
Register (W) $C6 (C6) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Enable 2 (3.01.08)
<BR>($00 on reset)

<UL>
<LI>bit 7 = Reserved, must be 0
</LI>
<LI>bit 6 = UART1 Tx empty
</LI>
<LI>bit 5 = UART1 Rx half full *
</LI>
<LI>bit 4 = UART1 Rx available *
</LI>
<LI>bit 3 = Reserved, must be 0
</LI>
<LI>bit 2 = UART0 Tx empty
</LI>
<LI>bit 1 = UART0 Rx half full *
</LI>
<LI>bit 0 = UART0 Rx available *
</LI>
</UL>
* For each UART, Rx half full and Rx available are shared interrupts

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node135.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node133.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1131"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1133"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node135.html">Raspberry Pi0 Acceleration</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node133.html">Programming</A>
 &nbsp; <B>  <A ID="tex2html1132"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1134"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node135.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Raspberry Pi0 Acceleration</TITLE>
<META NAME="description" CONTENT="Raspberry Pi0 Acceleration">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node136.html">
<LINK REL="previous" HREF="node134.html">
<LINK REL="next" HREF="node136.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node136.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node134.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1135"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1137"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node136.html">System Software</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node134.html">Serial Communication</A>
 &nbsp; <B>  <A ID="tex2html1136"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1138"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001000000000000000000">
Raspberry Pi0 Acceleration</A>
</H1>
The Spectrum Next has a header (with male pins) which can be attached
to a Raspberry Pi Zero. There is a modified version of DietPi called
NextPi which is the standard distro for the Raspberry Pi0
accelerator. Software for the general public should be written
assuming that it will be interfacing with a Pi0 running this distro.

<P>
If you are more adventurous, you may choose to use another distro, or
even another accelerator that uses the Raspberry Pi style (40 pin)
expansion bus.  Chief concers when doing this is that you have a
console presented on the UART that defaults to 115,200 bps, you don't
need to login, the machine is configured with a driver to treat the
 I<SUP>2</SUP>S interface as a sound card, and the presence of the nextpi
scripts.

<P>
The Raspberry Pi 0 has a Broadcom BCM2835 SoC with an ARMv6 core, a
Videocore 4 GPU, and its own 512 MB memory and HDMI output. It has its
own SD card from which it boots. For this application the Pi 0 ships
with a 1GB microSD card containing NextPi a customized version of
DietPi.

<P>
The Pi Zero, if installed, is a smart peripheral for the ZX Spectrum
Next. Available interfaces are: low level access to the GPIO pins,
higher level access to standardized I/O interfaces, and use of the Pi
Zero as a sound card.

<P>
When using the low level GPIO interface Pi Zero GPIO pins 2-27 can be
configured as either inputs or outputs using nextregs $90-$93. If
they are outputs, the output state can be set by writing to nextregs
$98-$9b. The current status of the GPIO pins can be read from
nextregs $98-$9b whether it is the state driven by the ZX Spectrum
Next or the state drive by some other peripherial attached to the bus
(normally the Raspberry Pi Zero).

<P>
Register (R/W) $90 (90) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 1/4

<UL>
<LI>bit 7 = Enable Pin 7 (0 on reset)
</LI>
<LI>bit 6 = Enable Pin 6 (0 on reset)
</LI>
<LI>bit 5 = Enable Pin 5 (0 on reset)
</LI>
<LI>bit 4 = Enable Pin 4 (0 on reset)
</LI>
<LI>bit 3 = Enable Pin 3 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 2 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 1 (cannot be enabled) (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 0 (cannot be enabled) (0 on reset)
</LI>
</UL>
Register (R/W) $91 (91) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 2/4

<UL>
<LI>bit 7 = Enable Pin 15 (0 on reset)
</LI>
<LI>bit 6 = Enable Pin 14 (0 on reset)
</LI>
<LI>bit 5 = Enable Pin 13 (0 on reset)
</LI>
<LI>bit 4 = Enable Pin 12 (0 on reset)
</LI>
<LI>bit 3 = Enable Pin 11 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 10 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 9 (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 8 (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $92 (92) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 3/4

<UL>
<LI>bit 7 = Enable Pin 23 (0 on reset)
</LI>
<LI>bit 6 = Enable Pin 22 (0 on reset)
</LI>
<LI>bit 5 = Enable Pin 21 (0 on reset)
</LI>
<LI>bit 4 = Enable Pin 20 (0 on reset)
</LI>
<LI>bit 3 = Enable Pin 19 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 18 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 17 (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 16 (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $93 (93) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 4/4

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bit 3 = Enable Pin 27 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 26 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 25 (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 24 (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $98 (98) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 1/4

<UL>
<LI>bit 7 = Pin 7 Data (1 on reset)
</LI>
<LI>bit 6 = Pin 6 Data (1 on reset)
</LI>
<LI>bit 5 = Pin 5 Data (1 on reset)
</LI>
<LI>bit 4 = Pin 4 Data (1 on reset)
</LI>
<LI>bit 3 = Pin 3 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 2 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 1 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 0 Data (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $99 (99) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 2/4

<UL>
<LI>bit 7 = Pin 15 Data (1 on reset)
</LI>
<LI>bit 6 = Pin 14 Data (1 on reset)
</LI>
<LI>bit 5 = Pin 13 Data (1 on reset)
</LI>
<LI>bit 4 = Pin 12 Data (1 on reset)
</LI>
<LI>bit 3 = Pin 11 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 10 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 9 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 8 Data (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $9A (9A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 3/4

<UL>
<LI>bit 7 = Pin 23 Data (1 on reset)
</LI>
<LI>bit 6 = Pin 22 Data (1 on reset)
</LI>
<LI>bit 5 = Pin 21 Data (1 on reset)
</LI>
<LI>bit 4 = Pin 20 Data (1 on reset)
</LI>
<LI>bit 3 = Pin 19 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 18 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 17 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 16 Data (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $9B (9B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 4/4

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bit 3 = Pin 27 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 26 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 25 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 24 Data (1 on reset)
</LI>
</UL>

<P>
Standardized I/O access with the Pi Zero can use the  I<SUP>2</SUP>C , SPI, or
UART interfaces and is configured using nextreg $a0. Any enabled port
will disable low level (write) access to the corresponding GPIO
pins.

<P>
Register (R/W) $A0 (A0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi Peripheral Enable

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bit 5 = Enable UART on GPIO 14, 15 (0 on reset)*
</LI>
<LI>bit 4 = Communication Type (0 on reset)
  
<UL>
<LI>0 = Rx to GPIO 15, Tx to GPIO 14 (Pi)
</LI>
<LI>1 = Rx to GPIO 14, Tx to GPIO 15 (Pi Hats)
  
</LI>
</UL>
</LI>
<LI>bit 3 = Enable  I<SUP>2</SUP>C on GPIO 2, 3 (0 on reset)*
</LI>
<LI>bits 2-1 = Reserved, must be 0
</LI>
<LI>bit 0 = Enable SPI on GPIO 7, 8, 9, 10, 11 (0 on reset)*
</LI>
</UL>
*Overrides GPIO Enables

<P>
The  I<SUP>2</SUP>C interface is controlled using ports $103b (SCL) and $113b
(SDA). This is the same  I<SUP>2</SUP>C interface that is used for the optional
Real Time Clock. Interfacing with the Pi Zero over  I<SUP>2</SUP>C is
complicated by the fact that it is a master/slave interface, but both
the ZX Spectrum Next and Pi Zero are configured to be bus masters.

<P>
Port $103B (103B)  I<SUP>2</SUP>C SCL (rtc, rpi)

<P>
Port $113B (113B)  I<SUP>2</SUP>C SDA (rtc, rpi)

<P>
The SPI interface is controlled using ports $e7 (/CS) and $eb
(/DATA). The SPI interface is shared between the SD card(s), the flash
memory, and the Pi Zero. Interfacing with the Pi Zero over SPI is
complicated by the fact it is a master/slave interface and both the ZX
Spectrum Next and Pi Zero are configured to be bus masters.

<P>
Port $E7 (E7) SPI <!-- MATH
 $\overline{\hbox{CS}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img56.svg"
 ALT="$\overline{\hbox{CS}}$"></SPAN> (SD card, flash, rpi)
<BR>
Disable with bit 2 of Nextreg $09

<P>
Port $EB (EB) SPI <!-- MATH
 $\overline{\hbox{DATA}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img57.svg"
 ALT="$\overline{\hbox{DATA}}$"></SPAN> (SD card, flash, rpi)
<BR>
Disable with bit 2 of Nextreg $09

<P>
The default means of communication between the ZX Next and the Pi is
through the UART interface (see serial communications chapter). In
order to communicate withe the Pi the Pi UART must be connected to the
Pi by setting nextreg $a0 bits 5 and 4 to 1, selecting the Pi UART by
setting port $153b bit 6 to 1 and ensuring that both ends are using
matching communication protocols (by default 115,200 bps, 8N1 and no
flow control). On the Pi end the UART is connected to the serial
console.

<P>
<PRE>
;; enable UART connection with Pi Zero
   ld c,$3b
   ld b,$15 ; UART control
;; select Pi on UART control
   in a,(c)
   or $40
   out (c),a
   ld b,$24 ; Next Register Select
   ld a,$a0
   out (c),a
   inc b ; Next Register Data
;; Enable UART on GPIO and select Pi
   in a,(c)
   or $30
   out (c),a
</PRE>

<P>
The  I<SUP>2</SUP>S sound interface between the ZX Spectrum Next and the Pi Zero
is controlled by nextregs $a2 and $a3. Normally, one would control
the Pi through some other channel such as the UART recieve audio from
the Pi to either use as a fulloy programmable sound card or to allow
loading of tape files on the ZX Spectrum Next.

<P>
Register (R/W) $A2 (A2) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi  I<SUP>2</SUP>S Audio Control

<UL>
<LI>bits 7-6 =  I<SUP>2</SUP>S State ($00 on reset)
  
<UL>
<LI>00 =  I<SUP>2</SUP>S Disabled
</LI>
<LI>01 =  I<SUP>2</SUP>S is mono, source R
</LI>
<LI>10 =  I<SUP>2</SUP>S is mono, source L
</LI>
<LI>11 =  I<SUP>2</SUP>S is stereo
  
</LI>
</UL>
</LI>
<LI>bit 5 = Reserved, must be 0
</LI>
<LI>bit 4 = Audio Flow Direction (0 on reset)
  
<UL>
<LI>0 = PCM_DOUT to Pi, PCM_DIN from Pi (Hats)
</LI>
<LI>1 = PCM_DOUT from Pi, PCM_DIN to Pi (Pi)
  
</LI>
</UL>
</LI>
<LI>bit 3 = Mute left (0 on reset)
</LI>
<LI>bit 2 = Mute right (0 on reset)
</LI>
<LI>bit 1 = Slave mode, Reserved must be 1 (remove in 3.01.05)
</LI>
<LI>bit 0 = Direct  I<SUP>2</SUP>S audio to EAR on port $FE (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $A3 (A3) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi  I<SUP>2</SUP>S Clock Divide (Master Mode) (removed in 3.01.05)

<UL>
<LI>bits 7-0 = Clock divide value ($0B on reset)
</LI>
</UL>
<!-- MATH
 $\hbox{Divider}=\frac{538461}{\hbox{Rate}}-1$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img58.svg"
 ALT="$\hbox{Divider}=\frac{538461}{\hbox{Rate}}-1$"></SPAN> or
<!-- MATH
 $\hbox{Rate}=\frac{538461}{\hbox{Divider}+1}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img59.svg"
 ALT="$\hbox{Rate}=\frac{538461}{\hbox{Divider}+1}$"></SPAN>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node136.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node134.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1135"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1137"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node136.html">System Software</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node134.html">Serial Communication</A>
 &nbsp; <B>  <A ID="tex2html1136"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1138"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node136.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>System Software</TITLE>
<META NAME="description" CONTENT="System Software">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node152.html">
<LINK REL="previous" HREF="node135.html">
<LINK REL="next" HREF="node137.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node137.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node135.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1139"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1141"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node137.html">CP/M</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node135.html">Raspberry Pi0 Acceleration</A>
 &nbsp; <B>  <A ID="tex2html1140"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1142"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001100000000000000000">
System Software</A>
</H1>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" CP/M " LINK NODE137}
@{" Utilities " LINK NODE138}
@{" BDOS " LINK NODE139}
@{" BIOS " LINK NODE140}
@{" System Initialization Functions " LINK NODE141}
@{" Character I/O Functions " LINK NODE142}
@{" Disk I/O Functions " LINK NODE143}
</UL>
@{" Memory Select and Move Functions " LINK NODE144}
@{" Clock Support Function " LINK NODE145}
</UL>
</UL>
<BR>
@{" NextZXOS " LINK NODE146}
@{" NextZXOS " LINK NODE147}
@{" +3DOS compatible API " LINK NODE148}
@{" esxDOS compatible API " LINK NODE149}
@{" Next Extensions " LINK NODE150}
@{" esxDOS compatible API " LINK NODE151}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node137.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>CP/M</TITLE>
<META NAME="description" CONTENT="CP/M">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node146.html">
<LINK REL="previous" HREF="node136.html">
<LINK REL="next" HREF="node138.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node138.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node136.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node136.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1158"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1160"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node138.html">Utilities</A>
<B> Up:</B> <A
 HREF="node136.html">System Software</A>
<B> Previous:</B> <A
 HREF="node136.html">System Software</A>
 &nbsp; <B>  <A ID="tex2html1159"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1161"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001110000000000000000">
CP/M</A>
</H1>
The ZX Spextrum Next has support for CP/M+ 3.0. CP/M was the most
popular microcomputer coperating system prior to the advent of MS-DOS.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Utilities " LINK NODE138}
@{" BDOS " LINK NODE139}
@{" BIOS " LINK NODE140}
@{" System Initialization Functions " LINK NODE141}
@{" Character I/O Functions " LINK NODE142}
@{" Disk I/O Functions " LINK NODE143}
</UL>
<BR>
@{" Memory Select and Move Functions " LINK NODE144}
@{" Clock Support Function " LINK NODE145}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node138.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Utilities</TITLE>
<META NAME="description" CONTENT="Utilities">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node139.html">
<LINK REL="previous" HREF="node137.html">
<LINK REL="next" HREF="node139.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node139.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1170"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1172"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node139.html">BDOS</A>
<B> Up:</B> <A
 HREF="node137.html">CP/M</A>
<B> Previous:</B> <A
 HREF="node137.html">CP/M</A>
 &nbsp; <B>  <A ID="tex2html1171"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1173"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001111000000000000000">
Utilities</A>
</H2>

<P>
From the Digital Research: CP/M 3 Command Reference Manual 1984

<P>
This section documents all standard CP/M+ 3 commands plus those extras
included with the ZX Spectrum Next CP/M system.

<P>
<SPAN CLASS="XLARGE"><SPAN  CLASS="textbf">COLOURS</SPAN></SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img60.svg"
 ALT="\begin{labeledpar}{Parameters:}{\textbf{Syntax:}}
\textbf{COLOURS [RGB] \textit{paper} \textit{ink}}
\end{labeledpar}">
<BR>

<P>
<SPAN  CLASS="textbf">Function:</SPAN> Sets the screen colours

<P>
<SPAN  CLASS="textbf">Parameters:</SPAN>
<BR>
<IMG STYLE=""
 SRC="img61.svg"
 ALT="\begin{labeledpar}{Parameters}{\textit{paper}}
Paper (background) colour
\end{labeledpar}">
<BR>
<BR>
<IMG STYLE=""
 SRC="img62.svg"
 ALT="\begin{labeledpar}{Parameters:}{\textit{ink}}
Ink (foreground) colour
\end{labeledpar}">
<BR>

<P>
<SPAN  CLASS="textbf">Options:</SPAN>
<BR>
<IMG STYLE=""
 SRC="img63.svg"
 ALT="\begin{labeledpar}{Parameters:}{RGB}
Causes ink and paper colours to be interpreted as 9-bit octal RGB numbers
\end{labeledpar}">
<BR>

<P>
<SPAN  CLASS="textbf">Notes:</SPAN> Sets the screen colours using standard ZX colours
or octal 9-bit RGB numbers.

<P>
<SPAN  CLASS="textbf">Examples:</SPAN>

<P>
colours 1 6

<P>
colours rgb 000 750

<P>
<SPAN CLASS="XLARGE"><SPAN  CLASS="textbf">COPYSYS</SPAN></SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img64.svg"
 ALT="\begin{labeledpar}{Parameters:}{\textbf{Syntax:}}
\textbf{COPYSYS}
\end{labeledpar}">
<BR>

<P>
<SPAN  CLASS="textbf">Function:</SPAN> Copy CP/M system

<P>
<SPAN  CLASS="textbf">Notes:</SPAN> COPYSYS copies the CP/M Plus system from a CP/M Plus
system diskette to another diskette.  The new diskette must have the
same format as the original system diskette.

<P>
<SPAN CLASS="XLARGE"><SPAN  CLASS="textbf">DATE</SPAN></SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img65.svg"
 ALT="\begin{labeledpar}{Parameters:}{\textbf{Syntax:}}
\textbf{DATE}\\
\textbf{DATE ...
...
\textbf{DATE \textit{time-specification}}\\
\textbf{DATE SET}
\end{labeledpar}">
<BR>

<P>
<SPAN  CLASS="textbf">Function:</SPAN> The DATE command lets you display and set the date
and time of day.

<P>
<SPAN  CLASS="textbf">Parameters:</SPAN>
<BR>
<IMG STYLE=""
 SRC="img66.svg"
 ALT="\begin{labeledpar}{Parameters}{\textit{time-specification}}
Time/date in the format MM/DD/YY HH:MM:SS
\end{labeledpar}">
<BR>

<P>
<SPAN  CLASS="textbf">Options:</SPAN>
<BR>
<IMG STYLE=""
 SRC="img67.svg"
 ALT="\begin{labeledpar}{Parameters:}{C}
Continuously show the date and time until a key is pressed
\end{labeledpar}">
<BR>
<BR>
<IMG STYLE=""
 SRC="img68.svg"
 ALT="\begin{labeledpar}{Parameters:}{CONTINUOUS}
Continuously show the date and time until a key is pressed
\end{labeledpar}">
<BR>
<BR>
<IMG STYLE=""
 SRC="img69.svg"
 ALT="\begin{labeledpar}{Parameters:}{SET}
Prompt the user for the current date and time
\end{labeledpar}">
<BR>

<P>
<SPAN  CLASS="textbf">Notes:</SPAN> The DATE command is a transient utility that lets you
display and set the date and time of day.  When you start CP/M 3, the
date and time are set to the creation date of your CP/M 3 system. Use
DATE to change this initial value to the current date and time.

<P>
<SPAN  CLASS="textbf">Examples:</SPAN>

<P>
DATE

<P>
DATE C

<P>
DATE CONTINUOUS

<P>
DATE 08/13/82 09:15:37

<P>
DATE SET

<P>
<SPAN  CLASS="textbf">DEVICE</SPAN>

<P>
=0.7cm Syntax:
<BR>
DEVICE
<BR>
DEVICE NAMES
<BR>
DEVICE VALUES
<BR>
DEVICE logical-dev {XON<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>NOXON<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>baud-rate},
<BR>
DEVICE physical-dev {XON<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>NOXON<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>baud-rate}
<BR>
DEVICE logical-dev=physical-dev {option} {,physical-dev {option},...}
<BR>
DEVICE logical-dev = NULL
<BR>
DEVICE CONSOLE {PAGE}
<BR>
DEVICE CONSOLE {COLUMNS=n, LINES=n}
<BR>
<P>
DEVICE displays current logical device assignments and physical device
names.

<P>
<SPAN  CLASS="textbf">DIR</SPAN> (built-in)

<P>
=0.7cm Syntax:
<BR>
DIR
<BR>
DIR d:
<BR>
DIR filespec
<BR>
DIR d: options
<BR>
DIR filespec,... filespec options

<P>
The DIR command displays the names of files catalogued in the
directory of an online disk that belong to current user number and
have the Directory (DIR) attribute. DIR accepts the * and ? wildcards
in the file specification.

<P>
The DIR command with options displays the names of files and the
characteristics associated with the files. DIR is a built-in
utility. DIR with options is a transient utility and must be loaded
into memory from the disk.

<P>
<SPAN  CLASS="textbf">DIRSYS/DIRS</SPAN> (built-in)

<P>
=0.7cm Syntax:
<BR>
DIRSYS
<BR>
DIRSYS d:
<BR>
DIRSYS filespec

<P>
The DIRSYS command lists the names of files in the current directory
that have the system (SYS) attribute. DIRSYS accept the * and ?
wildcards in the file specification. DIRSYS is a built-in utility.

<P>
<SPAN  CLASS="textbf">DUMP</SPAN>

<P>
=0.7cm Syntax:
<BR>
DUMP filespec

<P>
DUMP displays the contents of a file in and ASCII format.

<P>
<SPAN  CLASS="textbf">ECHO</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
ECHO string

<P>
Echo characters to the terminal

<P>
The following special character sequences may be used

<UL>
<LI>\a alert (bell) (ASCII 7)
</LI>
<LI>\b backspace (ASCII 8)
</LI>
<LI>\e escape (ASCII 27)
</LI>
<LI>\n line feed (ASCII 10)
</LI>
<LI>\r carriage return (ASCII 13)
</LI>
<LI>\l interpret further characters as lower-case
</LI>
<LI>\u interpret further characters as upper-case
</LI>
<LI>\\backslash ('\')
</LI>
</UL>

<P>
Note that CP/M converts all your typed characters to upper-case before
providing them to ECHO.COM. Therefore you will need to use
\l and \u to specify the case of
characters if it is important (in ESCape sequences, for example).

<P>
<SPAN  CLASS="textbf">ED</SPAN>

<P>
=0.7cm Syntax:
<BR>
ED
<BR>
ED input-filespec
<BR>
ED input-filespec {d: <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN> output-filespec}

<P>
Character file editor. To redirect or rename the new version of the
file specify the destination drive or destination filespec.

<P>
<SPAN  CLASS="textbf">ERASE/ERA</SPAN> (built-in)

<P>
=0.7cm Syntax:
<BR>
ERASE
<BR>
ERASE filespec
<BR>
ERASE filespec [CONFIRM]

<P>
The ERASE command removes one or more files from the directory of a
disk. Wildcard characters are accepted in the filespec. Directory and
data space are automatically reclaimed for later use by another
file. The ERASE command can be abbreviated to ERA.

<P>
[CONFIRM] option informs the system to prompt for verification before
erasing each file that matches the filespec. CONFIRM can be
abbreviated to C.

<P>
<SPAN  CLASS="textbf">EXIT</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
EXIT

<P>
The EXIT command leaves CP/M (rebooting the ZX Spectrum Next)

<P>
<SPAN  CLASS="textbf">EXPORT</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
EXPORT cpm-filespec nextzxos-filespec

<P>
NextZXOS file export utility

<P>
Export file to a NextZXOS drive.

<P>
<SPAN  CLASS="textbf">GENCOM</SPAN>

<P>
=0.7cm Syntax:
<BR>
GENCOM COM-Eilespec RSX-filespec... RSX-Eilespec {[LOADER <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>
  SCB=(Offset,value)]}
<BR>
GENCOM RSX-filespec ... RSX-filespec {[NULL <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>
  SCB=(Offset,value)l}
<BR>
GENCOM filename
<BR>
GENCOM filename [SCB=(offset,value)]

<P>
The GENCOM command attaches RSX files to a COM file, or creates a
dummy COM file containing only RSXS. It can also restore a previously
GENCOMed file to the original COM file without the header and RSXS,
add or replace RSXs in already GENCOMed files, and attach header
records to COM files without RSXS.

<P>
<SPAN  CLASS="textbf">GENCPM</SPAN>

<P>
=0.7cm Syntax:
<BR>
GENCPM {AUTO<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>AUTO DISPLAY}

<P>
GENCPM creates a memory image CPM3.SYS file, containing the CP/M 3
BDOS and customized BIOS. The GENCPM utility performs late resolution
of intermodule references between system modules. GENCPM can accept
its command input interactively from the console or from a file
GENCPM.DAT.

<P>
In the nonbanked system, GENCPM creates a CPM3.SYS file from the
BDOS3.SPR and BIOS3.SPR files. In the banked system, GENCPM creates
the CPM3.SYS file from the RESBDOS3.SPR, the BNKBDOS3.SPR and the
BNKBIOS3.SPR files. Remember to back up your CPM3.SYS file before
executing GENCPM, because GENCPM deletes any existing CPM3.SYS file
before it generates a new system.

<P>
<SPAN  CLASS="textbf">GET</SPAN>

<P>
=0.7cm Syntax:
<BR>
GET {CONSOLE INPUT FROM} FILE filespec options
<BR>
GET {CONSOLE INPUT FROM} CONSOLE

<P>
GET directs the system to take console input from a file for the next
system comand or user program entered at the console.

<P>
Console input is taken from a file until the program terminates. If
the file is exhausted before program input is terminated, the program
looks for subsequent input from the console. If the program terminates
before exhausting all its input, the system reverts back to the
console for console input.

<P>
<SPAN  CLASS="textbf">HELP</SPAN>

<P>
=0.7cm Syntax:
<BR>
HELP
<BR>
HELP topic
<BR>
HELP topic subtopic
<BR>
HELP topic [NOPAGE]
<BR>
HELP topic subtopic1...subtopic8
<BR>
HELP<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img71.svg"
 ALT="\(&gt;\)"></SPAN>topic
<BR>
HELP<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img71.svg"
 ALT="\(&gt;\)"></SPAN>.subtopic

<P>
HELP displays a list of topics and provides summarized information for
CP/M Plus commands.

<P>
Typing HELP topic displays information about that topic. Typing HELP
topic subtopic displays information about that subtopics One or two
letters is enough to identify the topics. After HELP displays
information for your topic, it displays the special prompt HELP<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img71.svg"
 ALT="\(&gt;\)"></SPAN>
on your screen, followed by a list of subtopics.

<P>

<UL>
<LI>Enter ? to display list of main topics.
</LI>
<LI>Enter a period and subtopic name to access subtopics.
</LI>
<LI>Enter a period to redisplay what you just read.
</LI>
<LI>Press RETURN to return to the CP/M Plus system prompt.
</LI>
<LI>[NOPAGE] option disables the 24 lines per page console display.
</LI>
<LI>Press any key to exit a display and return to the HELP<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img71.svg"
 ALT="\(&gt;\)"></SPAN> prompt.
</LI>
</UL>

<P>
<SPAN  CLASS="textbf">HEXCOM</SPAN>

<P>
=0.7cm Syntax:
<BR>
HEXCOM filename

<P>
The HEXCOM Command generates a command file (filetype COM) from a HEX
input file. it names the output tile with the same filename as the
input file but with filetype COM. HEXCOM always looks for a file with
filetype HEX.

<P>
<SPAN  CLASS="textbf">IMPORT</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
IMPORT nextzxos-filespec
<BR>
IMPORT nextzxos-filespec cpm-filespec

<P>
NextZXOS file import utility

<P>
List or import files from a NextZXOS drive.

<P>
<SPAN  CLASS="textbf">INITDIR</SPAN> (Not included)

<P>
=0.7cm Syntax:
<BR>
INITDIR d:

<P>
The INITDIR command initializes a disk directory to allow date and
time stamping of files on that disk. INITDIR can also recover
time/date directory space.

<P>
<SPAN  CLASS="textbf">NEXTREG</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
NEXTREG register {value}

<P>
NextReg Utility

<P>
Show or change a NextReg register (use at your own risk!)

<P>
<SPAN  CLASS="textbf">LIB</SPAN> (Not included)

<P>
=0.7cm Syntax:
<BR>
LIB filespec options
<BR>
LIB filespec options=filespec <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img72.svg"
 ALT="\(&lt;\)"></SPAN>modifier<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img71.svg"
 ALT="\(&gt;\)"></SPAN> f,filespec<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img72.svg"
 ALT="\(&lt;\)"></SPAN>modifier<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img71.svg"
 ALT="\(&gt;\)"></SPAN>

<P>
A library is a file that contains a collection of object modules.

<P>
Use the LIB utility to create libraries, and to append, replace,
select, or delete modules from an existing library. Use LIB to obtain
information about the contents of library files.  LIB creates and
maintains library files that contain object modules in Microsoft REL
file format.  These modules are produced by the Digital Research
relocatable macro-assembler program, RMAC, or other language
translator that produces modules in Microsoft REL file format.

<P>
You can use LINK-80 to link the object modules contained in a library
to other object files.  LINK-80 automatically selects from the library
only those modules needed by the program being linked, and then forms
an executable file with a filetype of Com.

<P>
<SPAN  CLASS="textbf">LINK</SPAN> (Not included)

<P>
=0.7cm Syntax:
<BR>
LINK filespec [options]
<BR>
LINK filespec [options],...filespec [options]
<BR>
LINK filespec [options]=filespec [options],...
<BR>
<P>
LINK combines relocatable object modules such as those produced by
RMAC and PL/I- 80 into a COM file ready for execution. Relocatable
files can contain external references and publics.  Relocatable files
can reference modules in library files. LINK searches the library
files and includes the referenced modules in the output file. See the
Programmer's Utilities Guide for the CP/M Family of Operating Systems
for a complete description of LINK-80.

<P>
Use LINK option switches to control execution parameters. Link options
follow the file specifications and are enclosed within square
brackets. Multiple switches are separated by commas.

<P>
<SPAN  CLASS="textbf">MAC</SPAN> (Not included)

<P>
=0.7cm Syntax:
<BR>
MAC filename [$options]

<P>
MAC, the CP/M Plus macro assembler, reads assembly language statements
from a file of type ASM, assembles the statements, and produces three
output files with the input filename and filetypes of HEX, PRN, and
SYM. Filename.HEX contains Intel hexadecimal format object
code. Filename.PRN contains an annotated source listing that you can
print or examine at the console. Filename.SYM contains a sorted list
of symbols defined in the program.

<P>
Use options to direct the input and output of MAC. Use a letter with
the option to indicate the source and destination drives, and console,
printer, or zero output. Valid drive names are A through 0. X, P, and
Z specify console, printer, and zero output, respectively.

<P>
<SPAN  CLASS="textbf">PATCH</SPAN>

<P>
=0.7cm Syntax:
<BR>
PATCH filename.typ n

<P>
The PATCH command displays or installs patch number n to the CP/M Plus
system or command files. The patch number n must be between 1 and 32
inclusive.

<P>
<SPAN  CLASS="textbf">PIP</SPAN>

<P>
=0.7cm Syntax:
<BR>
PIP Destination = Source
<BR>
PIP d:[Gn]=filespec [options]
<BR>
PIP filespec[Gn]=filespec [options]
<BR>
PIP filespec[Gn]device=filespec [options] device

<P>
The file copy program PIP copies files, combines files, and transfers
files between disks, printers, consoles, or other devices attached to
your computer. The first filespec is the destination. The second
filespec is the source. Use two or more source filespecs separated by
commas to combine two or more files into one file. [options] is any
combination of the available options. The [Gn] option in the
destination filespec tells PIP to copy your file to that user
number. PIP with no command tail displays an * prompt and awaits your
series of commands, entered and processed one line at a time. The
source or destination can optionally be any CP/M Plus logical device.

<P>
<SPAN  CLASS="textbf">PUT</SPAN>

<P>
=0.7cm Syntax:
<BR>
PUT CONSOLE {OUTPUT TO} FILE filespec {option}
<BR>
PUT PRINTER {OUTPUT TO} FILE filespec {option}
<BR>
PUT CONSOLE {OUTPUT TO} CONSOLE
<BR>
PUT PRINTER {OUTPUT TO} PRINTER

<P>
PUT puts console or printer output to a file for the next command
entered at the console, until the program terminates. Then console
output reverts to the console. Printer output is directed to a file
until the program terminates. Then printer output is put back to the
printer.

<P>
PUT with the SYSTEM option directs all subsequent console/printer
output to the specified file.  This option terminates when you enter
the PUT CONSOLE or PUT PRINTER command.

<P>
<SPAN  CLASS="textbf">RENAME/REN</SPAN> (built-in)

<P>
=0.7cm Syntax:
<BR>
RENAME
<BR>
RENAME new-filespec=old-filespec

<P>
RENAME lets you change the name of a file in the directory of a
disk. To change several filenames in one command use the * or ?
wildcards in the file specifications. You can abbreviate the RENAME
command to REN. REN prompts you for input.

<P>
<SPAN  CLASS="textbf">RMAC</SPAN> (Not included)

<P>
=0.7cm Syntax:
<BR>
RMAC filespec options

<P>
RMAC, a relocatable macro assembler, assembles ASM files into REL
files that you can link to create COM files.

<P>
RMAC options specify the destination of the output files. Replace d
with the destination drive letter for the output files.

<P>
<SPAN  CLASS="textbf">SAVE</SPAN>

<P>
=0.7cm Syntax:
<BR>
SAVE

<P>
SAVE copies the contents of memory to a file. To use SAVE, first issue
the SAVE command, then run your program which reads a file into
memory. Your program exits to the SAVE utility which prompts you for a
filespec to which it copies the contents of memory, and the beginning
and ending address of the memory to be SAVED.

<P>
<SPAN  CLASS="textbf">SET</SPAN>

<P>
=0.7cm Syntax:
<BR>
SET [options]
<BR>
SET d: [options]
<BR>
SET filespec [options]
<BR>
SET [option = modifier]
<BR>
SET filespec [option = modifier]

<P>
SET initiates password protection and time stamping of files. It also
sets the file and drive attributes Read/Write, Read/Only, DIR and
SYS. It lets you label a disk and passord protect the label. To enable
time stamping of files, you must first run INITDIR to format the disk
directory.

<P>
<SPAN  CLASS="textbf">SET Default password operation:</SPAN>

<P>
=0.7cm Syntax:
<BR>
SET [DEFAULT=password]

<P>
Instructs the system to use a default password if you do not enter a
password for a password-protected file.

<P>
<SPAN  CLASS="textbf">SET Time-stamp operations:</SPAN>

<P>
=0.7cm Syntax:
<BR>
SET d: [CREATE=ON<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>OFF]
<BR>
SET d: [ACCESS=ON<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>OFF]
<BR>
SET d: [UPDATE=ON<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN>OFF]

<P>
The above set commands allw YOU to keep a record of the time and date
of file creation and update or of the last access update of your
files.

<P>
<SPAN  CLASS="textbf">SET Drive operations:</SPAN>

<P>
=0.7cm Syntax:
<BR>
SET d: [RO]
<BR>
SET d: [RW]

<P>
Adds or removes write protection from a drive.

<P>
<SPAN  CLASS="textbf">SETDEF</SPAN>

<P>
=0.7cm Syntax:
<BR>
SETDEF
<BR>
SETDEF [TEMPORARY=d:]
<BR>
SETDEF d:i,d:i,d:i,d:i
<BR>
SETDEF [ORDER= (typ1, typn)]
<BR>
SETDEF [DISPLAY <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN> NO DISPLAY)
<BR>
SETDEF [PAGE <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN> NOPAGE]

<P>
SETDEF allows the user to display or define up to four drives for the
program search order, the drive for temporary files, and the filetype
search order. The SETDEF definitions affect only the loading of
programs and/or execution of SUBMIT (SUB) files. SETDEF turns on/off
the system Display and Console Page modes. When on, the system
displays the location and name of programs loaded or SUBmit files
executed, and stops after displaying one full console screen of
information.

<P>
<SPAN  CLASS="textbf">SHOW</SPAN>

<P>
=0.7cm Syntax:
<BR>
SHOW
<BR>
SHOW d:
<BR>
SHOW d: [SPACE]
<BR>
SHOW d: [LABEL]
<BR>
SHOW d: [USERS]
<BR>
SHOW d: [DIR]
<BR>
SHOW d: [DRIVE]

<P>
The SHOW command displays the following disk drive information:

<UL>
<LI>access mode and the amount of free disk space
</LI>
<LI>disk label
</LI>
<LI>current user number
</LI>
<LI>number of files for each user number on the disk
</LI>
<LI>number of free directory entries for the disk
</LI>
<LI>drive characteristics
</LI>
</UL>

<P>
<SPAN  CLASS="textbf">SID</SPAN>

<P>
=0.7cm Syntax:
<BR>
SID [pgm-filespec],{sym-filespec}

<P>
The SID symbolic debugger allows you to monitor and test programs
developed for the 8080 microprocessor. SID supports real-time
breakpoints, fully monitored execution, symbolic disassembly,
assembly, and memory display and fill functions. SID can dynamically
load SID utility programs to provide traceback and histogram
facilities.

<P>
<SPAN  CLASS="textbf">SUBMIT</SPAN>

<P>
=0.7cm Syntax:
<BR>
SUBMIT
<BR>
SUBMIT filespec
<BR>
SUBMIT filespec argument ... argument

<P>
The SUBMIT command lets you execute a group (batch) of commands from a
SUBmit file (a file with filetype of SUB).

<P>
SUB files:

<P>
The SUB file can contain the following types of lines:

<UL>
<LI>any valid CP/M Plus command
</LI>
<LI>any valid CP/M Plus command with SUBMIT parameters ($0-$9)
</LI>
<LI>any data input line
</LI>
<LI>any program input line with parameters ($0 to $9)
</LI>
</UL>

<P>
The command line cannot exceed 135 characters.

<P>
<SPAN  CLASS="textbf">TERMINFO</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
TERMINFO

<P>
This program provides information on the terminal facilities provided
by the BIOS on the ZX Spectrum Next.

<P>
<SPAN  CLASS="textbf">TERMSIZE</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
TERMSIZE top left height width

<P>
Terminal resize utility

<P>
Size can be up to 32x80 (defaults to 24x80, suitable for many
programs). If setting a reduced size, the top and left parameters can
be used to make the image more centered on your screen.

<P>
<SPAN  CLASS="textbf">TYPE/TYP</SPAN> (built-in)

<P>
=0.7cm Syntax:
<BR>
TYPE
<BR>
TYPE filespec
<BR>
TYPE filespec [PAGE]
<BR>
TYPE filespec [NOPAGE]

<P>
The TYPE command displays the contents of an ASCII character file on
your screen.

<P>
<SPAN  CLASS="textbf">UPGRADE</SPAN> (ZX Spectrum Next)

<P>
=0.7cm Syntax:
<BR>
UPGRADE

<P>
UPGRADE CP/M from C:/NEXTZXOS/CPMBASE.P3D

<P>
<SPAN  CLASS="textbf">USER/USE</SPAN> (built-in)

<P>
=0.7cm Syntax:
<BR>
USER
<BR>
USER n

<P>
The USER command sets the current user number. The disk directory can
be divided into distinct groups according to a User Number. User
numbers range from 0 through 15.

<P>
<SPAN  CLASS="textbf">XREF</SPAN> (Not included)

<P>
=0.7cm Syntax:
<BR>
XREF {d:} filename {$P}

<P>
XREF provides a cross-reference summary of variable usage in a
program. XREF requires the PRN and SYM files produced by MAC or RMAC
for input to the program. The SYM and PRN files must have the same
filename as the filename in the XREF command tail. XREF outputs a file
of type XRF.

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node139.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1170"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1172"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node139.html">BDOS</A>
<B> Up:</B> <A
 HREF="node137.html">CP/M</A>
<B> Previous:</B> <A
 HREF="node137.html">CP/M</A>
 &nbsp; <B>  <A ID="tex2html1171"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1173"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node139.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>BDOS</TITLE>
<META NAME="description" CONTENT="BDOS">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node140.html">
<LINK REL="previous" HREF="node138.html">
<LINK REL="next" HREF="node140.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node140.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node138.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1174"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1176"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node140.html">BIOS</A>
<B> Up:</B> <A
 HREF="node137.html">CP/M</A>
<B> Previous:</B> <A
 HREF="node138.html">Utilities</A>
 &nbsp; <B>  <A ID="tex2html1175"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1177"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001112000000000000000">
BDOS</A>
</H2>
From the CP/M 3 Programmers' Guide 1984

<P>
This section documents all BDOS system calls to include the parameters
that must be passes to them and the values that are returned to the
calling program.

<P>
<A NAME="3378"></A>
BDOS function 0: <SPAN  CLASS="textbf">SYSTEM RESET</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $00
</td></tr></table>

<P>
The System Reset function terminates the calling program and returns
control to the CCP via a warm start sequence. Calling this function
has the same effect as a jump to location $0000 of Page Zero.

<P>
Note that the disk subsystem is not reset by System Reset under CP/M
3. The calling program can pass a return code to the CCP by calling
Function 108, Get/Set Program Return Code, prior to making a System
Reset call or jumping to location $0000.

<P>
<A NAME="3382"></A>
BDOS function 1: <SPAN  CLASS="textbf">CONSOLE INPUT</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $01
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: ASCII Character
</td></tr></table>

<P>
The Console Input function reads the next character from the logical
console, CONIN:, to register A. Graphic characters, along with
carriage return, line-feed, and backspace, CTRL-H, are echoed to the
console. Tab characters, CTR-L-1, are expanded in columns of 8
characters. CTRL-S, CTRL-Q, and CTRL-P are normally intercepted as
described below. All other non-graphic characters are returned in
register A but are not echoed to the console.

<P>
When the Console Mode is in the default state Function 1 intercepts
the stop scroll, CTRL-S, start scroll, CTRL-Q, and start/stop printer
echo, CTRL-P, characters. Any characters that are typed following a
CTRL-S and preceding a CTRL-Q are also intercepted. However, if
start/stop scroll has been disabled by the Console Mode, the CTRL-S,
CTRL-Q, and CTRL-P characters are not intercepted. Instead, they are
returned in register A, but are not echoed to the console.

<P>
If printer echo has been invoked, all characters that are echoed to
the console are also sent to the list device, LST:.  Function 1 does
not return control to the calling program until a non-intercepted
character is typed, thus suspending execution if a character is not
ready.

<P>
<A NAME="3388"></A>
BDOS function 2: <SPAN  CLASS="textbf">CONSOLE OUTPUT</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $02</td></tr>
<tr><td valign="top">&nbsp;E: ASCII Character
</td></tr></table>

<P>
The Console Output function sends the ASCII character from register E
to the logical console device, CONOUT:. When the Console Mode is in
the default state (see Section 2.2.1), Function 2 expands tab
characters, CTRL-1, in columns of 8 characters, checks for stop
scroll, CTRL-S, start scroll, CTRL-Q, and echoes characters to the
logical list device, LST:, if printer echo, CTRL-P, has been invoked.

<P>
<A NAME="3392"></A>
BDOS function 3: <SPAN  CLASS="textbf">AUXILIARY INPUT</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $03
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: ASCII Character
</td></tr></table>

<P>
The Auxiliary Input function reads the next character from the logical
auxiliary input device, AUXIN:, into register A. Control does not
return to the calling program 'I the character is read.  unti

<P>
<A NAME="3398"></A>
BDOS function 4: <SPAN  CLASS="textbf">AUXILIARY OUTPUT</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $04</td></tr>
<tr><td valign="top">&nbsp;E: ASCII Character
</td></tr></table>

<P>
The Auxiliary Output function sends the ASCII character from register
E to the logical auxiliary output device, AUXOUT:.

<P>
<A NAME="3402"></A>
BDOS function 5: <SPAN  CLASS="textbf">LIST OUTPUT</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $05</td></tr>
<tr><td valign="top">&nbsp;E: ASCII Character
</td></tr></table>

<P>
The List Output function sends the ASCII character in register E to
the logical list device, LST:.

<P>
<A NAME="3406"></A>
BDOS function 6: <SPAN  CLASS="textbf">DIRECT CONSOLE I/O</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $06</td></tr>
<tr><td valign="top">&nbsp;E: function/data (see description)
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: char/status/no value (see description)
</td></tr></table>

<P>
CP/M 3 supports direct I/O to the logical console, CONIN:, for those
specialized applications where unadorned console input and output is
required. Use Direct Console I/O carefully because it bypasses all the
normal control character functions.  Programs that perform direct I/O
through the BIOS under previous releases of CP/M should be changed to
use direct I/O so that they can be fully supported under future
releases of MP/M and CP/M.

<P>
A program calls Function 6 by passing one of four different values in
register E.

<P>

<UL>
<LI>$FF Console input/status command returns an input character; if
  no character is ready, a value of zero is returned.
</LI>
<LI>$FE Console status command (On return, register A contains 00
  if no character is ready; otherwise it contains $FF.)
</LI>
<LI>$FD Console input command, returns an input character; this
  function will suspend the calling process until a character is
  ready.
</LI>
<LI>ASCII Function 6 assumes that register E contains a valid ASCII
  chararacter and sends it to the console.
</LI>
</UL>

<P>
<A NAME="3414"></A>
BDOS function 7: <SPAN  CLASS="textbf">AUXILIARY INPUT STATUS</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $07
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Auxiliary Input Status
</td></tr></table>

<P>
The Auxiliary Input Status function returns the value $FF in register
A if a character is ready for input from the logical auxiliary input
device, AUXIN:. If no character is ready for input, the value $00 is
returned.

<P>
<A NAME="3420"></A>
BDOS function 8: <SPAN  CLASS="textbf">AUXILIARY OUTPUT STATUS</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $08
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Auxiliary Output Status
</td></tr></table>

<P>
The Auxiliary Output Status function returns the value $FF in
register A if the logical auxiliary output device, AUXOUT:, is ready
to accept a character for output.  If the device is not ready for
output, the value $00 is returned.

<P>
<A NAME="3426"></A>
BDOS function 9: <SPAN  CLASS="textbf">PRINT STRING</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $09</td></tr>
<tr><td valign="top">&nbsp;DE: String Address
</td></tr></table>

<P>
The Print String function sends the character string addressed by
register pair DE to the logical console, CONOUT:, until it encounters
a delimiter in the string. Usually the delimiter is a dollar sign, $,
but it can be changed to any other value by Function 110, Get/Set
Output Delimiter. If the Console Mode is in the default state,
Function 9 expands tab characters, CTRL-I, in columns of 8
characters. It also checks for stop scroll, CTRL-S, start scroll,
CTRL-Q, and echoes to the logical list device, LST:, if printer echo,
CTRL-P, has been invoked.

<P>
<A NAME="3430"></A>
BDOS function 10: <SPAN  CLASS="textbf">READ CONSOLE BUFFER</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $0A</td></tr>
<tr><td valign="top">&nbsp;DE: Buffer Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;Console Characters in Buffer
</td></tr></table>

<P>
The Read Console Buffer function reads a line of edited console input
from the logical console, CONIN:, to a buffer that register pair DE
addresses. It terminates input and returns to the calling program when
it encounters a return, CTRL-M, or a line feed, CTRL-J,
character. Function 10 also discards all input characters after the
input buffer is filled. In addition, it outputs a bell character,
CTRL-G, to the console when it discards a character to signal the user
that the buffer is full. The input buffer addressed by DE has the
following format:

<P>
where mx is the maximum number of characters which the buffer holds,
and nc is the number of characters placed in the buffer. The
characters entered by the operator follow the nc value. The value mx
must be set prior to making a Function 10 call and may range in value
from 1 to 255. Setting mx to zero is equivalent to setting mx to
one. The value nc is returned to the calling program and may range
from zero to mx. If nc &lt; mx, then uninitialized positions follow the
last character, denoted by ??  in the figure. Note that a terminating
return or line feed character is not placed in the buffer and not
included in the count nc.

<P>
If register pair DE is set to zero, Function 10 assumes that an
initialized input buffer is located at the current DMA address (see
Function 26, Set DMA Address).  This allows a program to put a string
on the screen for the user to edit. To initialize the input buffer,
set characters c1 through cn to the initial value followed by a binary
zero terminator.

<P>
When a program calls Function 10 with an initialized buffer, Function
10 operates as if the user had typed in the string. When Function 10
encounters the binary zero terminator, it accepts input from the
console. At this point, the user can edit the initialized string or
accept it as it is by pressing the RETURN key. However, if the
initialized string contains a return, CTRL-M, or a linefeed, CTRL-J,
character, Function 10 returns to the calling program without giving
the user the opportunity to edit the string.

<P>
The level of console editing supported by Function 10 differs for the
banked and nonbanked versions of CP/M 3. Refer to the CPIM Plus (CPIM
Version 3) Operating System User's Guide for a detailed description of
console editing. In the nonbanked version, Function 10 recognizes the
following edit control characters.

<P>
Nonbanked CP/M 3

<UL>
<LI>rub/del Removes and echoes the last character; GENCPM can change
  this function to CTRL-H
</LI>
<LI>CTRL-C Reboots when at the beginning of line; the Console Mode
  can disable this function
</LI>
<LI>CTRL-E Causes physical end of line
</LI>
<LI>CTRL-H Backspaces one character position; GENCPM can change this
  function to rub/del
</LI>
<LI>CTRL-J (Line-feed) terminates input line
</LI>
<LI>CTRL-M (Return) terminates input line
</LI>
<LI>CTRL-P Echoes console output to the list device
</LI>
<LI>CTRL-R Retypes the current line after new line
</LI>
<LI>CTRL-U Removes current line after new line
</LI>
<LI>CTRL-X Backspaces to beginning of current line
</LI>
</UL>

<P>
The banked version of CP/M 3 expands upon the editing provided in the
non-banked version. The functionality of the two versions is similar
when the cursor is positioned at the end of the line. However, in the
banked version, the user can move the cursor anywhere in the current
line, insert characters, delete characters, and perform other editing
functions. In addition, the banked version saves the previous command
line; it can be recalled when the current line is empty. In the banked
version, Function 10 recognizes the following edit control characters.

<P>
Banked CP/M 3

<UL>
<LI>rub/del Removes and echoes the last character if at the end of
  the line; otherwise deletes the character to the left of the current
  cursor position; GENCPM can change this function to CTRL-H.
</LI>
<LI>CTRL-A Moves cursor one character to the left.
</LI>
<LI>CTRL-B Moves cursor to the beginning of the line when not at the
  beginning; otherwise moves cursor to the end of the line.
</LI>
<LI>CTRL-C Reboots when at the beginning of line; the Console Mode
  can disable this function.
</LI>
<LI>CTRL-E Causes physical end-of-line; if the cursor is positioned
  in the middle of a line, the characters at and to the right of the
  cursor are displayed on the next line.
</LI>
<LI>CTRL-F Moves cursor one character to the right.
</LI>
<LI>CTRL-G Deletes the character at the current cursor position when
  in the middle of the line; has no effect when the cursor is at the
  end of the line.
</LI>
<LI>CTRL-H Backspaces one character position when positioned at the
  end of the line,; otherwise deletes the character to the left of the
  cursor; GENCPM can change this function to rub/del.
</LI>
<LI>CTRL-J (Line-feed) terminates input; the cursor can be
  positioned anywhere in the line; the entire input line is
  accepted; sets the previous line buffer to the input line.
</LI>
<LI>CTRL-K Deletes all characters to the right of the cursor along
  with the character at the cursor.
</LI>
<LI>CTRL-M (Return) terminates input; the cursor can be positioned
  anywhere in the line; the entire input line is accepted; sets the
  previous line buffer to the input line.
</LI>
<LI>CTRL-P Echoes console output to the list device.
</LI>
<LI>CTRL-R Retypes the characters to the left of the cursor on the
  new line.
</LI>
<LI>CTRL-U Updates the previous line buffer to contain the
  characters to the left of the cursor; deletes current line, and
  advances to new line.
</LI>
<LI>CTRL-W Recalls previous line if current line is empty; otherwise
  moves cursor to end-of-line.
</LI>
<LI>CTRL-X Deletes all characters to the left of the cursor.
</LI>
</UL>

<P>
For banked systems, Function 10 uses the console width field defined
in the System Control Block. If the console width is exceeded when the
cursor is positioned at the end of the line, Function 10 automatically
advances to the next line. The beginning of the line can be edited by
entering a CTRL-R.

<P>
When a character is typed while the cursor is positioned in the middle
of the line, the typed character is inserted into the line. Characters
at and to the right of the cursor are shifted to the right. If the
console width is exceeded, the characters disappear off the right of
the screen. However, these characters are not lost. They reappear if
characters are deleted out of the line, or if a CTRL-E is typed.

<P>
<A NAME="3440"></A>
BDOS function 11: <SPAN  CLASS="textbf">GET CONSOLE STATUS</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $0B
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Console Status
</td></tr></table>

<P>
The Get Console Status function checks to see if a character has been
typed at the logical console, CONIN:. If the Console Mode is in the
default state, Function 11 returns the value $01 in register A when a
character is ready. If a character is not ready, it returns a value of
$00.

<P>
If the Console Mode is in CTRL-C Only Status mode, Function 11 returns
the value $01 in register A only if a CTRL-C has been typed at the
console.

<P>
<A NAME="3446"></A>
BDOS function 12: <SPAN  CLASS="textbf">RETURN VERSION NUMBER</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $0C
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: Version Number
</td></tr></table>

<P>
The Return Version Number function provides information that allows
version independent programming. It returns a two-byte value in
register pair HL: H contains $00 for CP/M and L contains $31, the
BDOS file system version number.  Function 12 is useful for writing
applications programs that must run on multiple versions of CP/M and
MP/M.

<P>
<A NAME="3452"></A>
BDOS function 13: <SPAN  CLASS="textbf">RESET DISK SYSTEM</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $0D
</td></tr></table>

<P>
The Reset Disk System function restores the file system to a reset
state where all the disk drives are set to read-write (see Functions
28 and 29), the default disk is set to drive A, and the default DMA
address is reset to $0080. This function can be used, for example, by
an application program that requires disk changes during
operation. Function 37, Reset Drive, can also be used for this
purpose.

<P>
<A NAME="3456"></A>
BDOS function 14: <SPAN  CLASS="textbf">SELECT DISK</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $0E</td></tr>
<tr><td valign="top">&nbsp;E: Selected Disk
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Flag</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Select Disk function designates the disk drive named in register E
as the default disk for subsequent BDOS file operations. Register E is
set to 0 for drive A, 1 for drive B, and so on through 15 for drive P
in a full 16-drive system. In addition, Function 14 logs in the
designated drive if it is currently in the reset state. Logging-in a
drive activates the drive's directory until the next disk system reset
or drive reset operation.

<P>
FCBs that specify drive code zero (dr = $00) automatically reference
the currently selected default drive. FCBs with drive code values
between 1 and 16, however, gnore the selected default drive and
directly reference drives A through P.

<P>
Upon return, register A contains a zero if the select operation was
successful. If a physical error was encountered, the select function
performs different actions depending on the BDOS error mode (see
Function 45). If the BDOS error mode is in the default mode, a message
identifying the error is displayed at the console, and the calling
program is terminated. Otherwise, the select function returns to the
calling program with register A set to $FF and register H set to one
of the following

<P>
physical error codes:

<UL>
<LI>01 Disk I/O Error
</LI>
<LI>04 Invalid drive
</LI>
</UL>

<P>
<A NAME="3464"></A>
BDOS function 15: <SPAN  CLASS="textbf">OPEN FILE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $0F</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical or Extended Error
</td></tr></table>

<P>
The Open File function activates the FCB for a file that exists in the
disk directory under the currently active user number or user
zero. The calling program passes the address of the FCB in register
pair DE, with byte 0 of the FCB specifying the drive, bytes 1 through
11 specifying the filename and filetype, and byte 12 specifying the
extent. Usually, byte 12 of the FCB is initialized to zero.

<P>
If the file is password protected in Read mode, the correct password
must be placed in the first eight bytes of the current DMA, or have
been previously established as the default password (see Function
106). If the current record field of the FCB, cr, is set to $FF,
Function 15 returns the byte count of the last record of the file in
the cr field. You can set the last record byte count for a file with
Function 30, Set File Attributes. Note that the current record field
of the FCB, cr, must be zeroed by the calling program before beginning
read or write operations if the file is to be accessed sequentially
from the first record.

<P>
If the current user is non-zero, and the file to be opened does not
exist under the current user number, the open function searches user
zero for the file. If the file exists under user zero, and has the
system attribute, t2', set, the file is opened under user zero. Write
operations are not supported for a file that is opened under user zero
in this manner.

<P>
If the open operation is successful, the user's FCB is activated for
read and write operations. The relevant directory information is
copied from the matching directory FCB into bytes d0 through dn of the
FCB. If the file is opened under user zero when the current user
number is not zero, interface attribute f8' is set to one in the user's
FCB. In addition, if the referenced file is password protected in
Write mode, and the correct password was not passed in the DMA, or did
not match the default password, interface attribute f7' is set to
one. Write operations are not supported for an activated FCB if
interface attribute f7' or f8' is true.

<P>
When the open operation is successful, the open function also makes an
Access date and time stamp for the opened file when the following
conditions are satisfied: the referenced drive has a directory label
that requests Access date and time stamping, and the FCB extent number
field is zero.

<P>
Upon return, the Open File function returns a directory code in
register A with the value $00 if the open was successful, or $FF,
255 decimal, if the file was not found.  Register H is set to zero in
both of these cases. If a physical or extended error was encountered,
the Open File function performs different actions depending on the
BDOS error mode (see Function 45). If the BDOS error mode is in the
default mode, a message identifying the error is displayed at the
console and the program is terminated. Otherwise, the Open File
function returns to the calling program with register A set to $FF,
and register H set to one of the following physical or extended error
codes:

<P>

<UL>
<LI>01 : Disk I/O Error
</LI>
<LI>04 : Invalid drive error
</LI>
<LI>07 : File password error
</LI>
<LI>09 : ? in the FCB filename or filetype field
</LI>
</UL>

<P>
<A NAME="3472"></A>
BDOS function 16: <SPAN  CLASS="textbf">CLOSE FILE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $10</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical or Extended Error
</td></tr></table>

<P>
The Close File function performs the inverse of the Open File
function. The calling program passes the address of an FCB in register
pair DE. The referenced FCB must have been previously activated by a
successful Open or Make function call (see Functions 15 and
22). Interface attribute f5' specifies how the file is to be closed as
shown below:

<P>

<UL>
<LI>f5' = 0 - Permanent close (default mode)
</LI>
<LI>f5' = 1 - Partial close
</LI>
</UL>

<P>
A permanent close operation indicates that the program has completed
file operations on the file. A partial close operation updates the
directory, but indicates that the file is to be maintained in the open
state.

<P>
If the referenced FCB contains new information because of write
operations to the FCB, the close function permanently records the new
information in the referenced disk directory. Note that the FCB does
not contain new information, and the directory update step is
bypassed if only read or update operations have been made to the
referenced FCB.

<P>
Upon return, the close function returns a directory code in register A
with the value $00 if the close was successful„ or $FF, 255
Decimal, if the file was not found.  Register H is set to zero in both
of these cases. If a physical or extended error is encountered, the
close function performs different actions depending on the BDOS error
mode (see Function 45). If the BDOS error mode is in the default mode,
a message identifying the error is displayed at the console, and the
calling program is terminated. Otherwise, the close function returns
to the calling program with register A set to $FF and register H set
to one of the following physical error codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read/only disk
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
<A NAME="3482"></A>
BDOS function 17: <SPAN  CLASS="textbf">SEARCH FOR FIRST</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $11</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;</td></tr>
<tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Search For First function scans the directory for a match with the
FCB addressed by register pair DE. Two types of searches can be
performed. For standard searches, the calling program initializes
bytes 0 through 12 of the referenced FCB, with byte 0 specifying the
drive directory to be searched, bytes 1 through 11 specifying the file
or files to be searched for„ and byte 12 specifying the
extent. Usually byte 12 is set to zero. An ASCII question mark, 63
decimal, 3F hex, in any of the bytes 1 through 12 matches all entries
on the directory in the corresponding position. This facility, called
ambiguous reference, can be used to search for multiple files on the
directory. When called in the standard mode, the Search function scans
for the first file entry in the specified directory that matches the
FCB, and belongs to the current user number.

<P>
The Search For First function also initializes the Search For Next
function. After the Search function has located the first directory
entry matching the referenced FCB, the Search For Next function can be
called repeatedly to locate all remaining matching entries. In terms
of execution sequence, however, the Search For Next call must either
follow a Search For First or Search For Next call with no other
intervening BDOS disk-related function calls.

<P>
If byte 0 of the referenced FCB is set to a question mark, the Search
function ignores the remainder of the referenced FCB, and locates the
first directory entry residing on the current default drive. All
remaining directory entries can be located by making multiple Search
For Next calls. This type of search operation is not usually made by
application programs, but it does provide complete flexibility to scan
all current directory values. Note that this type of search operation
must be performed to access a drive's directory label.

<P>
Upon return, the Search function returns a Directory Code in register
A with the value 0 to 3 if the search is successful, or $FF, 255
Decimal, if a matching directory entry is not found. Register H is set
to zero in both of these cases. For successful searches, the current
DMA is also filled with the directory record containing the matching
entry, and the relative starting position is A * 32 (that is, rotate
the A register left 5 bits, or ADD A five times). Although it is not
usually required for application programs, the directory information
can be extracted from the buffer at this position.

<P>
If the directory has been initialized for date and time stamping by
INITDIR, then an SFCB resides in every fourth directory entry, and
successful Directory Codes are restricted to the values 0 to 2. For
successful searches, if the matching directory record is an extent
zero entry, and if an SFCB resides at offset 96 within the current
DMA, contents of (DMA Address + 96) = $21, the SFCB contains the date
and time stamp information, and password mode for the file. This
information is located at the relative starting position of 97 + (A *
10) within the current DMA in the following format:

<P>

<UL>
<LI>0 - 3 Create or Access Date and Time Stamp Field
</LI>
<LI>4 - 7 Update Date and Time Stamp Field
</LI>
<LI>8 : Password Mode Field
</LI>
</UL>

<P>
If a physical error is encountered, the Search function performs
different actions depending on the BDOS error mode (see Function
45). If the BDOS error mode is in the default mode, a message
identifying the error is displayed at the console, and the calling
program is terminated. Otherwise, the Search function returns to the
calling program with register A set to $FF, and register H set to
one of the following physical error codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
<A NAME="3492"></A>
BDOS function 18: <SPAN  CLASS="textbf">SEARCH FOR NEXT</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $12
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Search For Next function is identical to the Search For First
function, except that the directory scan continues from the last entry
that was matched. Function 18 returns a Directory code in register A,
analogous to Function 17.

<P>
Note: in execution sequence, a Function 18 call must follow either a
Function 17 or another Function 18 call with no other intervening BDOS
disk-related function calls.

<P>
<A NAME="3498"></A>
BDOS function 19: <SPAN  CLASS="textbf">DELETE FILE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $13</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Extended or Physical Error
</td></tr></table>

<P>
The Delete File function removes files or XFCBs that match the FCB
addressed in register pair DE. The filename and filetype can contain
ambiguous references, that is, question marks in bytes f1' through t3',
but the dr byte cannot be ambiguous, as it can in the Search and
Search Next functions. Interface attribute f5' specifies the type of
delete operation that is performed.

<P>

<UL>
<LI>f5' = 0 - Standard Delete (default mode)
</LI>
<LI>f5' = 1 - Delete only XFCBs
</LI>
</UL>

<P>
If any of the files that the referenced FCB specify are password
protected, the correct password must be placed in the first eight
bytes of the current DMA buffer, or have been previously established
as the default password (see Function 106).

<P>
For standard delete operations, the Delete function removes all
directory entries belonging to files that match the referenced
FCB. All disk directory and data space owned by the deleted files is
returned to free space, and becomes available for allocation to other
files. Directory XFCBs that were owned by the deleted files are also
removed from the directory. If interface attribute f5' of the FCB is
set to 1, Function 19 deletes only the directory XFCBs that match the
referenced FCB.

<P>
Note: if any of the files that match the input FCB specification fall
the password check, or are Read-Only, then the Delete function does
not delete any files or XFCBS.  This applies to both types of delete
operations.

<P>
In nonbanked systems, file passwords and XFCBs are not
supported. Thus, if the Delete function is called with interface
attribute f5' set to true, the Delete function performs no action but
returns with register A set to zero.

<P>
Upon return, the Delete function returns a Directory Code in register
A with the value 0 if the delete is successful, or $FF, 255 Decimal,
if no file that matches the referenced FCB is found. Register H is set
to zero in both of these cases. If a physical, or extended error is
encountered, the Delete function performs different actions depending
on the BDOS error mode (see Function 45). If the BDOS error mode is
the default mode, a message identifying the error is displayed at the
console and the calling program is terminated. Otherwise, the Delete
function returns to the calling program with register A set to $FF
and register H set to one of the following physical or extended error
codes:

<P>

<UL>
<LI>01 : Disk I/O error
</LI>
<LI>02 : Read-Only disk
</LI>
<LI>03 : Read-Only file
</LI>
<LI>04 : Invalid drive error
</LI>
<LI>07 : File password error
</LI>
</UL>

<P>
<A NAME="3508"></A>
BDOS function 20: <SPAN  CLASS="textbf">READ SEQUENTIAL</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $14</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Read Sequential function reads the next 1 to 128 128-byte records
from a file into memory beginning at the current DMA address. The BDOS
Multi-Sector Count (see Function 44) determines the number of records
to be read. The default is one record. The FCB addressed by register
pair DE must have been previously activated by an Open or Make
function call.

<P>
Function 20 reads each record from byte cr of the extent, then
automatically increments the cr field to the next record position. If
the cr field overflows, then the function automatically opens the next
logical extent and resets the cr field to 0 in preparation for the
next read operation. The calling program must set the cr field to 0
following the Open call if the intent is to read sequentially from the
beginning of the file.  Upon return, the Read Sequential function sets
register A to zero if the read operation is successful. Otherwise,
register A contains an error code identifying the error as shown
below:

<P>

<UL>
<LI>01 Reading unwritten data (end-of-file)
</LI>
<LI>09 Invalid FCB
</LI>
<LI>10 Media change occurred
</LI>
<LI>255 Physical Error; refer to register H
</LI>
</UL>

<P>
Error Code 01 is returned if no data exists at the next record
position of the file.  Usually, the no data situation is encountered
at the end of a file. However, it can also occur if an attempt is made
to read a data block that has not been previously written, or an
extent which has not been created. These situations are usually
restricted to files created or appended with the BDOS random write
functions (see Functions 34 and 40).

<P>
Error Code 09 is returned if the FCB is invalidated by a previous BDOS
close call that returns an error.

<P>
Error Code 10 is returned if a media change occurs on the drive after
the referenced FCB is activated by a BDOS Open, or Make Call.

<P>
Error Code 255 is returned if a physical error is encountered and the
BDOS error mode is Return Error mode, or Return and Display Error mode
(see Function 45). If the error mode is the default mode, a message
identifying the physical error is displayed at the console, and the
calling program is terminated. When a physical error is returned to
the calling program, register H contains one of the following error
codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
On all error returns except for physical error returns, A = 255,
Function 20 sets register H to the number of records successfully read
before the error is encountered.  This value can range from 0 to 127
depending on the current BDOS Multi-Sector Count. It is always set to
zero when the Multi-Sector Count is equal to one.

<P>
<A NAME="3518"></A>
BDOS function 21: <SPAN  CLASS="textbf">WRITE SEQUENTIAL</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $15</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Write Sequential function writes 1 to 128 128-byte data records,
beginning at the current DMA address into the file named by the FCB
addressed in register pair DE. The BDOS Multi-Sector Count (see
Function 44) determines the number of 128 byte records that are
written. The default is one record. The referenced FCB must have been
previously activated by a BDOS Open or Make function call.

<P>
Function 21 places the record into the file at the position indicated
by the cr byte of the FCB, and then automatically increments the cr
byte to the next record position. If the cr field overflows, the
function automatically opens, or creates the next logical extent, and
resets the cr field to 0 in preparation for the next write operation.
If Function 21 is used to write to an existing file, then the newly
written records overlay those already existing in the file. The
calling program must set the cr field to 0 following an Open or Make
call if the intent is to write sequentially from the beginning of the
file.

<P>
Function 21 makes an Update date and time for the file if the
following conditions are satisfied: the referenced drive has a
directory label that requests date and time stamping, and the file has
not already been stamped for update by a previous Make or Write
function call.

<P>
Upon return, the Write Sequential function sets register A to zero if
the write operation is successful. Otherwise, register A contains an
error code identifying the error as shown below:

<P>

<UL>
<LI>01 No available directory space
</LI>
<LI>02 No available data block
</LI>
<LI>09 Invalid FCB
</LI>
<LI>10 Media change occurred
</LI>
<LI>255 Physical Error : refer to register H
</LI>
</UL>

<P>
Error Code 01 is returned when the write function attempts to create a
new extent that requires a new directory entry, and no available
directory entries exist on the selected disk drive.

<P>
Error Code 02 is returned when the write command attempts to allocate
a new data block to the file, and no unallocated data blocks exist on
the selected disk drive.

<P>
Error Code 09 is returned if the FCB is invalidated by a previous BDOS
close call that returns an error.

<P>
Error Code 10 is returned if a media change occurs on the drive after
the referenced FCB is activated by a BDOS Open or Make call.

<P>
Error Code 255 is returned if a physical error is encountered and the
BDOS error mode is Return Error mode, or Return and Display Error mode
(see Function 45). If the error mode is the default mode, a message
identifying the physical error is displayed at the console, and the
calling program is terminated. When a physical error is returned to
the calling program, register H contains one of the following error
codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read-Only disk
</LI>
<LI>03 Read-Only file or File open from user 0 when the current user
  number is non-zero or File password protected in Write mode
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
On all error returns, except for physical error returns, A = 255,
Function 21 sets register H to the number of records successfully
written before the error was encountered. This value can range from 0
to 127 depending on the current BDOS Multi-Sector Count. It is always
set to zero when the Multi-Sector Count is set to one.

<P>
<A NAME="3528"></A>
BDOS function 22: <SPAN  CLASS="textbf">MAKE FILE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $16</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical or Extended Error
</td></tr></table>

<P>
The Make File function creates a new directory entry for a file under
the current user number. It also creates an XFCB for the file if the
referenced drive has a directory label that enables password
protection on the drive, and the calling program assigns a password to
the file.

<P>
The calling program passes the address of the FCB in register pair DE,
with byte 0 of the FCB specifying the drive, bytes 1 through 11
specifying the filename and filctype, and byte 12 set to the extent
number. Usually, byte 12 is set to zero. Byte 32 of the FCB, the cr
field, must be initialized to zero, before or after the Make call, if
the intent is to write sequentially from the beginning of the file.

<P>
Interface attribute f6' specifies whether a password is to be assigned
to the created file.

<P>

<UL>
<LI>f6' = 0 - Do not assign password (default)
</LI>
<LI>f6' = 1 - Assign password to created file
</LI>
</UL>

<P>
When attribute f6' is set to 1, the calling program must place the
password in the first 8 bytes of the current DMA buffer, and set byte
9 of the DMA buffer to the password mode (see Function 102). Note that
the Make function only interrogates interface attribute f6' if
passwords are activated on the referenced drive. In nonbanked systems,
file passwords are not supported, and attribute f6' is never
interrogated.

<P>
The Make function returns with an error if the referenced FCB names a
file that currently exists in the directory under the current user
number.

<P>
If the Make function is successful, it activates the referenced FCB
for file operations by opening the FCB, and initializes both the
directory entry and the referenced FCB to an empty file. It also
initializes all file attributes to zero. In addition, Function 22
makes a Creation date and time stamp for the file if the following
conditions are satisfied: the referenced drive has a directory label
that requests Creation date and time stamping and the FCB extent
number field is equal to zero. Function 22 also makes an Update stamp
if the directory label requests update stamping and the FCB extent
field is equal to zero.

<P>
If the referenced drive contains a directory label that enables
password protection, and if interface attribute f6' has been set to 1,
the Make function creates an XFCB for the file. In addition, Function
22 also assigns the password, and password mode placed in the first
nine bytes of the DMA, to the XFCB.

<P>
Upon return, the Make function returns a directory code in register A
with the value 0 if the make operation is successful, or $FF, 255
decimal, if no directory space is available. Register H is set to zero
in both of these cases. If a physical or extended error is
encountered, the Make function performs different actions depending on
the BDOS error mode (see Function 45). If the BDOS error mode is the
default mode, a message identifying the error is displayed at the
console, and the calling program is terminated. Otherwise, the Make
function returns to the calling program with register A set to $FF,
and register H set to one of the following physical or extended error
codes:

<P>

<UL>
<LI>01 : Disk I/O error
</LI>
<LI>02 : Read-Only disk
</LI>
<LI>04 : Invalid drive error
</LI>
<LI>08 : File already exists
</LI>
<LI>09 : ? in filename or filetype field
</LI>
</UL>

<P>
<A NAME="3538"></A>
BDOS function 23: <SPAN  CLASS="textbf">RENAME FILE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $17</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical or Extended Error
</td></tr></table>

<P>
The Rename function uses the FCB, addressed by register pair DE, to
change all directory entries of the file specified by the filename in
the first 16 bytes of the FCB to the filename in the second 16
bytes. If the file specified by the first filename is password
protected, the correct password must be placed in the first eight
bytes of the current DMA buffer, or have been previously established
as the default password (see Function 106). The calling program must
also ensure that the filenames specified in the FCB are valid and
unambiguous, and that the new filename does not already exist on the
drive. Function 23 uses the dr code at byte 0 of the FCB to select the
drive. The drive code at byte 16 of the FCB is ignored.

<P>
Upon return, the Rename function returns a Directory Code in register
A with the value 0 if the rename is successful, or $0FF, 255 Decimal,
if the file named by the first filename in the FCB is not
found. Register H is set to zero in both of these cases.  If a
physical or extended error is encountered, the Rename function
performs different actions depending on the BDOS error mode (see
Function 45). If the BDOS error mode is the default mode, a message
identifying the error is displayed at the console and the program is
terminated. Otherwise, the Rename function returns to the calling
program with register A set to $0FF and register H set to one of the
following physical or extended error codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read-Only disk
</LI>
<LI>03 Read-Only file
</LI>
<LI>04 Invalid drive error
</LI>
<LI>07 File password error
</LI>
<LI>08 File already exists
</LI>
<LI>09 ? in filename or filetype field
</LI>
</UL>

<P>
<A NAME="3546"></A>
BDOS function 24: <SPAN  CLASS="textbf">RETURN LOGIN VECTOR</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $18
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: Login Vector
</td></tr></table>

<P>
Function 24 returns the login vector in register pair HL. The login
vector is a 16-bit value with the least significant bit of L
corresponding to drive A, and the highorder bit of H corresponding to
the 16th drive, labelled P. A 0 bit indicates that the drive is not
on-line, while a 1 bit indicates the drive is active. A drive is made
active by either an explicit BDOS Select Disk call, number 14, or an
implicit selection when a BDOS file operation specifies a non-zero dr
byte in the FCB. Function 24 maintains compatibilty with earlier
releases since registers A and L contain the same values upon return.

<P>
<A NAME="3552"></A>
BDOS function 25: <SPAN  CLASS="textbf">RETURN CURRENT DISK</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $19
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Current Disk
</td></tr></table>

<P>
Function 25 returns the currently selected default disk number in
register A. The disk numbers range from 0 through 15 corresponding to
drives A through P.

<P>
<A NAME="3558"></A>
BDOS function 26: <SPAN  CLASS="textbf">SET DMA ADDRESS</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $1A</td></tr>
<tr><td valign="top">&nbsp;DE: DMA Address
</td></tr></table>

<P>
DMA is an acronym for Direct Memory Address, which is often used in
connection with disk controllers that directly access the memory of
the computer to transfer data to and from the disk subsystem. Under
CP/M 3, the current DMA is usually defined as the buffer in memory
where a record resides before a disk write, and after a disk read
operation. If the BDOS Multi-Sector Count is equal to one (see
Function 44), the size of the buffer is 128 bytes. However, if the
BDOS Multi-Sector Count is greater than one, the size of the buffer
must equal N * 128, where N equals the Multi-Sector Count.

<P>
Some BDOS functions also use the current DMA to pass parameters, and
to return values. For example, BDOS functions that check and assign
file passwords require that the password be placed in the current
DMA. As another example, Function 46, Get Disk Free Space, returns its
results in the first 3 bytes of the current DMA. When the current DMA
is used in this context, the size of the buffer in memory is
determined by the specific requirements of the called function.

<P>
When a transient program is initiated by the CCP, its DMA address is
set to $0080. The BDOS Reset Disk System function, Function 13, also
sets the DMA address to $0080. The Set DMA function can change this
default value to another memory address. The DMA address is set to the
value passed in the register pair DE.  The DMA address remains at this
value until it is changed by another Set DMA Address, or Reset Disk
System call.

<P>
<A NAME="3562"></A>
BDOS function 27: <SPAN  CLASS="textbf">GET ADDR(ALLOC)</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $1B
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: ALLOC Address
</td></tr></table>

<P>
CP/M 3 maintains an allocation vector in main memory for each active
disk drive.  Some programs use the information provided by the
allocation vector to determine the amount of free data space on a
drive. Note, however, that the allocation information might be
inaccurate if the drive has been marked Read-Only.

<P>
Function 27 returns in register pair HL, the base address of the
allocation vector for the currently selected drive. If a physical
error is encountered when the BDOS error mode is one of the return
modes (see Function 45), Function 27 returns the value $FFFF in the
register pair HL.

<P>
In banked CP/M 3 systems, the allocation vector can be placed in bank
zero. In this case, a transient program cannot access the allocation
vector. However, the BDOS function, Get Disk Free Space (Function 46),
can be used to directly return the number of free 128-byte records on
a drive. The CP/M 3 utilities that display a drive's free space, DIR
and SHOW, use Function 46 for that purpose.

<P>
<A NAME="3568"></A>
BDOS function 28: <SPAN  CLASS="textbf">WRITE PROTECT DISK</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $1C
</td></tr></table>

<P>
The Write Protect Disk function provides temporary write protection
for the currently selected disk by marking the drive as Read-Only, No
program can write to a disk that is in the Read-Only state. A drive
reset operation must be performed for a Read-Only drive to restore it
to the Read-Write state (see Functions 13 and 37).

<P>
<A NAME="3572"></A>
BDOS function 29: <SPAN  CLASS="textbf">GET READ-ONLY VECTOR</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: l$D
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: R/O Vector Value
</td></tr></table>

<P>
Function 29 returns a bit vector in register pair HL that indicates
which drives have the temporary Read-Only bit set. The Read-Only bit
can be set only by a BDOS Write Protect Disk call.

<P>
The format of the bit vector is analogous to that of the login vector
returned by Function 24. The least significant bit corresponds to
drive A, while the most significant bit corresponds to drive P.

<P>
<A NAME="3578"></A>
BDOS function 30: <SPAN  CLASS="textbf">SET FILE ATTRIBUTES</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $1E</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical or Extended error
</td></tr></table>

<P>
By calling the Set File Attributes function, a program can modify a
file's attributes and set its last record byte count. Other BDOS
functions can be called to interrogate these file parameters, but only
Function 30 can change them. The file attributes that can be set or
reset by Function 30 are fl' through f4', Read-Only, t1', System, t2',
and Archive, t3'. The register pair DE addresses an FCB containing a
filename with the appropriate attributes set or reset. The calling
program must ensure that it does not specify an ambiguous filename. In
addition, if the specified file is password totected, the correct
password must be placed in the first eight bytes of the current DMA
buffer or have been previously established as the default password
(see Function 106).

<P>
Interface attribute f6' specifies whether the last record byte count
of the specified file is to be set:

<P>

<UL>
<LI>f6' = 0 - Do not set byte count (default mode)
</LI>
<LI>f6' = 1 - Set byte count
</LI>
</UL>

<P>
If interface attribute f6' is set, the calling program must set the cr
field of the referenced FCB to the byte count value. A program can
access a file's byte count value with the BDOS Open, Search, or Search
Next functions.

<P>
Function 30 searches the referenced directory for entries belonging to
the current user number that matches the FCB specified name and type
fields. The function then updates the directory to contain the
selected indicators, and if interface attribute f6' is set, the
specified byte count value. Note that the last record byte count is
maintained in byte 13 of a file's directory FCBS.

<P>
File attributes t1', t2', and t3' are defined by CP/M 3. (They are
described in Section 2.3.4.) Attributes fl' through f4' are not
presently used, but can be useful for application programs, because
they are not involved in the matching program used by the BDOS during
Open File and Close File operations. Indicators f5' through f8' are
reserved for use as interface attributes.

<P>
Upon return, Function 30 returns a Directory Code in register A with
the value 0 if the function is successful, or $FF, 255 Decimal, if
the file specified by the referenced FCB is not found. Register H is
set to zero in both of these cases. If a physical or extended error is
encountered', the Set File Attributes function performs different
actions depending on the BDOS error mode (see Function 45). If the
BDOS error mode is the default mode, a message identifying the error
is displayed at the console, and the program is terminated. Otherwise,
Function 30 returns to the calling program with reg'ls-Ler A set to
$FF, and register H set to one of the following physical or extended
error codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read-Only disk
</LI>
<LI>04 Select error
</LI>
<LI>07 File password error
</LI>
<LI>09 ? in filename or filetype field
</LI>
</UL>

<P>
<A NAME="3588"></A>
BDOS function 31: <SPAN  CLASS="textbf">GET ADDR(DPB PARMS)</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $1F
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: DPB Address
</td></tr></table>

<P>
Function 31 returns in register pair HL the address of the
BIOS-resident Disk Parameter Block, DPB, for the currently selected
drive. (Refer to the CP/M Plus (CP/M Version 3) Operating System
System Guide for the format of the DPB). The calling program can use
this address to extract the disk parameter values.

<P>
If a physical error is encountered when the BDOS error mode is one of
the return modes (see Function 45), Function 31 returns the value
$FFFF in the register pair HL.

<P>
<A NAME="3594"></A>
<A NAME="3595"></A>
BDOS function 32: <SPAN  CLASS="textbf">SET/GET USER CODE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $20
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;E: $FF (get) or User Code (set)</td></tr>
<tr><td valign="top">&nbsp;A: Current Code or (no value)
</td></tr></table>

<P>
A program can change, or interrogate the currently active user number
by calling Function 32. If register E = $FF, then the value of the
current user number is returned in register A, where the value is in
the range of 0 to 15. If register E is not $FF, then the current user
number is changed to the value of E, modulo 16.

<P>
<A NAME="3601"></A>
BDOS function 33: <SPAN  CLASS="textbf">READ RANDOM</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $21</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Read Random function is similar to the Read Sequential function
except that the read operation takes place at a particular random
record number, selected by the 24-bit value constructed from the three
byte, r0, r1, r2, field beginning at position 33 of the FCB. Note that
the sequence of 24 bits is stored with the least significant byte
first, rO, the middle byte next, rl, and the high byte last, r2. The
random record number can range from 0 to 262,143. This corresponds to
a maximum value of 3 in byte r2.

<P>
To read a file with Function 33, the calling program must first open
the base extent, extent 0. This ensures that the FCB is properly
initialized for subsequent random access operations. The base extent
may or may not contain any allocated data. Function 33 reads the
record specified by the random record field into the current DMA
address. The function automatically sets the logical extent and
current record values, but unlike the Read Sequential function, it
does not advance the current record number. Thus, a subsequent Read
Random call rereads the same record. After a random read operation, a
file can be accessed sequentially, starting from the current randomly
accessed position. However, the last randomly accessed record is
reread or rewritten when switching from random to sequential mode.

<P>
If the BDOS Multi-Sector Count is greater than one (see Function 44),
the Read Random function reads multiple consecutive records into
memory beginning at the current DMA. The rO, rl, and r2 field of the
FCB is automatically incremented to read each record. However, the
FCBs random record number is restored to the first record's value upon
return to the calling program.

<P>
Upon return, the Read Random function sets register A to zero if the
read operation was successful. Otherwise, register A contains one of
the following error codes:

<P>

<UL>
<LI>01 Reading unwritten data (end-of-file)
</LI>
<LI>03 Cannot close current extent
</LI>
<LI>04 Seek to unwritten extent
</LI>
<LI>06 Random record number out of range
</LI>
<LI>10 Media change occurred
</LI>
<LI>255 Physical Error : refer to register H
</LI>
</UL>

<P>
Error Code 01 is returned if no data exists at the next record
position of the file.  Usually, the no data situation is encountered
at the end of a file. However, it can also occur if an attempt is made
to read a data block that has not been previously written.

<P>
Error Code 03 is returned when the Read Random function cannot close
the current extent prior to moving to a new extent.

<P>
Error Code 04 is returned when a read random operation accesses an
extent that has not been created.

<P>
Error Code 06 is returned when byte 35, r2, of the referenced FCB is
greater than 3.

<P>
Error Code 10 is returned if a media change occurs on the drive after
the referenced FCB is activated by a BDOS Open or Make Call.

<P>
Error Code 255 is returned if a physical error is encountered, and the
BDOS error mode is one of the return modes (see Function 45). If the
error mode is the default mode, a message identifying the physical
error is displayed at the console, and the calling program is
terminated. When a physical error is returned to the calling program,
register H contains one of the following error codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
On all error returns except for physical errors, A = 255, the Read
Random function sets register H to the number of records successfully
read before the error is encountered. This value can range from 0 to
127 depending on the current BDOS Multi-Sector Count. It is always set
to zero when the Multi-Sector Count is equal to one.

<P>
<A NAME="3611"></A>
BDOS function 34: <SPAN  CLASS="textbf">WRITE RANDOM</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $22</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Write Random function is analogous to the Read Random function,
except that data is written to the disk from the current DMA
address. If the disk extent or data block where the data is to be
written is not already allocated, the BDOS automatically performs the
allocation before the write operation continues.

<P>
To write to a file using the Write Random function, the calling
program must first open the base extent, extent 0. This ensures that
the FCB is properly initialized for subsequent random access
operations. If the file is empty, the calling program must create the
base extent with the Make File function before calling Function
34. The base extent might or might not contain any allocated data, but
it does record the file in the directory, so that the file can be
displayed by the DIR utility.

<P>
The Write Random function sets the logical extent and current record
positions to correspond with the random record being written, but does
not change the random record number. Thus, sequential read or write
operations can follow a random write, with the current record being
reread or rewritten as the calling program switches from random to
sequential mode.

<P>
Function 34 makes an Update date and time stamp for the file if the
following conditions are satisfied: the referenced drive has a
directory label that requests Update date and time stamping if the
file has not already been stamped for update by a previous BDOS Make
or Write call.

<P>
If the BDOS Multi-Sector Count is greater than one (see Function 44),
the Write Random function reads multiple consecutive records into
memory beginning at the current DMA. The rO, rl, and r2 field of the
FCB is automatically incremented to write each record. However, the
FCB's random record number is restored to the first record's value
when it returns to the calling program. Upon return, the Write Random
function sets register A to zero if the write operation is
successful. Otherwise, register A contains one of the following error
codes:

<P>

<UL>
<LI>02 No available data block
</LI>
<LI>03 Cannot Close current extent
</LI>
<LI>05 No available directory space
</LI>
<LI>06 Random record number out of range
</LI>
<LI>10 Media change occurred
</LI>
<LI>255 Physical Error : refer to register H
</LI>
</UL>

<P>
Error Code 02 is returned when the write command attempts to allocate
a new data block to the file and no unallocated data blocks exist on
the selected disk drive.

<P>
Error Code 03 is returned when the Write Random function cannot close
the current extent prior to moving to a new extent.

<P>
Error Code 05 is returned when the write function attempts to create a
new extent that requires a new directory entry and no available
directory entries exist on the selected disk drive.

<P>
Error Code 06 is returned when byte 35, r2, of the referenced FCB is
greater than 3.

<P>
Error Code 10 is returned if a media change occurs on the drive after
the referenced FCB is activated by a BDOS Open or Make Call.

<P>
Error Code 255 is returned if a physical error is encountered and the
BDOS error mode is one of the return modes (see Function 45). If the
error mode is the default mode, a message identifying the physical
error is displayed at the console, and the calling program is
terminated. When a physical error is returned to the calling program,
it is identified by register H as shown below:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read-Only disk

<P>
</LI>
<LI>03 Read-Only file or File open from user 0 when the current user
  number is nonzero or File password protected in Write mode

<P>
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
On all error returns, except for physical errors, A = 255, the Write
Random function sets register H to the number of records successfully
written before the error is encountered. This value can range from 0
to 127 depending on the current BDOS Multi-Sector Count. It is always
set to zero when the Multi-Sector Count is equal to one.

<P>
<A NAME="3621"></A>
BDOS function 35: <SPAN  CLASS="textbf">COMPUTE FILE SIZE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $23</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Flag</td></tr>
<tr><td valign="top">&nbsp;H: Physical or Extended error</td></tr>
<tr><td valign="top">&nbsp;Random Record Field Set
</td></tr></table>

<P>
The Compute File Size function determines the virtual file size, which
is, in effect, the address of the record immediately following the end
of the file. The virtual size of a file corresponds to the physical
size if the file is written sequentially. If the file is written in
random mode, gaps might exist in the allocation, and the file might
contain fewer records than the indicated size. For example, if a
single record with record number 262,143, the CP/M 3 maximum is
written to a file using the Write Random function, then the virtual
size of the file is 262,144 records even though only 1 data block 'is
actually allocated.

<P>
To compute file size, the calling program passes in register pair DE
the address of an FCB in random mode format, bytes rO, rl and r2
present. Note that the FCB must contain an unambiguous filename and
filetype. Function 35 sets the random record field of the FCB to the
random record number + 1 of the last record in the file. If the r2
byte is set to 04, then the file contains the maximum record count
262,144.

<P>
A program can append data to the end of an existing file by calling
Function 35 to set the random record position to the end of file, and
then performing a sequence of random writes starting at the preset
record address.

<P>
Note: the BDOS does not require that the file be open to use Function
35. However, if the file has been written to, it must be closed before
calling Function 35. Otherwise, an incorrect file size might be
returned.

<P>
Upon return, Function 35 returns a zero in register A if the file
specified by the referenced FCB is found, or an $FF in register A if
the file is not found. Register H is set to zero in both of these
cases. If a physical error is encountered, Function 35 performs
different actions depending on the BDOS error mode (see Function 45).
If the BDOS error mode is the default mode, a message identifying the
error is displayed at the console and the program is
terminated. Otherwise, Function 35 returns to the calling program with
register A set to $FF, and register H set to one of the following
physical errors:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
<A NAME="3629"></A>
BDOS function 36: <SPAN  CLASS="textbf">SET RANDOM RECORD</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $24</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;Random Record Field Set
</td></tr></table>

<P>
The Set Random Record function returns the random record number of the
next record to be accessed from a file that has been read or written
sequentially to a particular point. This value is returned in the
random record field, bytes rO, rl, and r2, of the FCB addressed by the
register pair DE. Function 36 can be useful in two ways,

<P>
First, it is often necessary to initially read and scan a sequential
file to extract the positions of various key fields. As each key is
encountered, Function 36 is called to compute the random record
position for the data corresponding to this key. If the data unit size
is 128 bytes, the resulting record number minus one is placed into a
table with the key for later retrieval. After scanning the entire file
and tabularizing the keys and their record numbers, you can move
directly to a particular record by performing a random read using the
corresponding random record number that you saved earlier. The scheme
is easily generalized when variable record lengths are involved,
because the program need only store the buffer-relative byte position
along with the key and record number to find the exact starting
position of the keyed data at a later time.

<P>
A second use of Function 36 occurs when switching from a sequential
read or write over to random read or write. A file is sequentially
accessed to a particular point in the file, then Function 36 is called
to set the record number, and subsequent random read and write
operations continue from the next record in the file.

<P>
<A NAME="3635"></A>
BDOS function 37: <SPAN  CLASS="textbf">RESET DRIVE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $25</td></tr>
<tr><td valign="top">&nbsp;DE: Drive Vector
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: $00
</td></tr></table>

<P>
The Reset Drive function programmatically restores specified drives to
the reset state. A reset drive is not logged-in and is in Read-Write
status. The passed parameter in register pair DE is a 16-bit vector of
drives to be reset, where the least significant bit corresponds to the
first drive A, and the high-order bit corresponds to the sixteenth
drive, labelled P. Bit values of 1 indicate that the specified drive
is to be reset.

<P>
<A NAME="3641"></A>
BDOS function 38: <SPAN  CLASS="textbf">ACCESS DRIVE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $26
</td></tr></table>

<P>
This is an MP/M function that is not supported under CP/M 3. If
called, the file system returns a zero In register A indicating that
the access request is successful.

<P>
<A NAME="3645"></A>
BDOS function 39: <SPAN  CLASS="textbf">FREE DRIVE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $27
</td></tr></table>

<P>
This is an MP/M function that is not supported under CP/M 3. If
called, the file system returns a zero In register A indicating that
the free request is successful.

<P>
<A NAME="3649"></A>
BDOS function 40: <SPAN  CLASS="textbf">WRITE RANDOM WITH ZERO FILL</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $28</td></tr>
<tr><td valign="top">&nbsp;DE: FCB address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Write Random With Zero Fill function is identical to the Write
Random function (Function 34) with the exception that a previously
unallocated data block is filled with zeros before the record is
written. If this function has been used to create a file, records
accessed by a read random operation that contain all zeros identify
unwritten random record numbers. Unwritten random records in allocated
data blocks of files created using the Write Random function (Function
34) contain uninitialized data.

<P>
<A NAME="3655"></A>
BDOS function 41: <SPAN  CLASS="textbf">TEST AND WRITE RECORD</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $29</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Test and Write Record function is an MP/M function that is not
supported under CP/M 3. If called, Function 41 returns with register A
set to $FF and register H set to zero.

<P>
<A NAME="3661"></A>
BDOS function 42: <SPAN  CLASS="textbf">LOCK RECORD</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $2A</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: $00
</td></tr></table>

<P>
The Lock Record function is an MP/M II function that is supported
under CP/M 3 only to provide compatibility between CP/M 3 and MP/M. It
is intended for use in situations where more than one running program
has Read-Write access to a common file. Because CP/M 3 is a
single-user operating system in which only one program can run at a
time, this situation cannot occur. Thus, under CP/M 3, Function 42
performs no action except to return the value $00 in register A
indicating that the record lock operation is successful.

<P>
<A NAME="3667"></A>
BDOS function 43: <SPAN  CLASS="textbf">UNLOCK RECORD</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $2B</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: $00
</td></tr></table>

<P>
The Unlock Record function is an MP/M II function that is supported
under CP/M 3 only to provide compatibility between CP/M 3 and MP/M. It
is intended for use in situations where more than one running program
has Read-Write access to a common file. Because CP/M 3 is a
single-user operating system in which only one program can run at a
time, this situation cannot occur. Thus, under CP/M 3, Function 43
performs no action except to return the value $00 in register A
indicating that the record unlock operation is successful.

<P>
<A NAME="3673"></A>
BDOS function 44: <SPAN  CLASS="textbf">SET MULTI-SECTOR COUNT</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $2C</td></tr>
<tr><td valign="top">&nbsp;E: Number of Sectors
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Return Code
</td></tr></table>

<P>
The Set Multi-Sector Count function provides logical record blocking
under CP/M 3. It enables a program to read and write from 1 to 128
records of 128 bytes at a time during subsequent BDOS Read and Write
functions.

<P>
Function 44 sets the Multi-Sector Count value for the calling program
to the value passed in register E. Once set, the specified
Multi-Sector Count remains in effect until the calling program makes
another Set Multi-Sector Count function call and changes the
value. Note that the CCP sets the Multi-Sector Count to one when it
initiates a transient program.

<P>
The Multi-Sector Count affects BDOS error reporting for the BDOS Read
and Write functions. If an error interrupts these functions when the
Multi-Sector is greater than one, they return the number of records
successfully read or written in register H for all errors except for
physical errors (A = 255).

<P>
Upon return, register A is set to zero if the specified value is in
the range of 1 to 128. Otherwise, register A is set to $FF.

<P>
<A NAME="3679"></A>
BDOS function 45: <SPAN  CLASS="textbf">SET BDOS ERROR MODE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $2D</td></tr>
<tr><td valign="top">&nbsp;E: BDOS Error Mode
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;None
</td></tr></table>

<P>
Function 45 sets the BDOS error mode for the calling program to the
mode specified in register E. If register E is set to $FF, 255
decimal, the error mode is set to Return Error mode. If register E is
set to $FE, 254 decimal, the error mode is set to Return and Display
mode. If register E is set to any other value, the error mode is set
to the default mode.

<P>
The SET BDOS Error Mode function determines how physical and extended
errors (see Section 2.2.13) are handled for a program. The Error Mode
can exist in three modes: the default mode, Return Error mode, and
Return and Display Error mode.  In the default mode, the BDOS displays
a system message at the console that identifies the error and
terminates the calling program. In the return modes, the BDOS sets
register A to $FF, 255 decimal, places an error code that identifies
the physical or extended error in register H and returns to the
calling program. In Return and Display mode, the BDOS displays the
system message before returning to the calling program. No system
messages are displayed, however, when the BDOS is in Return Error
mode.

<P>
<A NAME="3685"></A>
BDOS function 46: <SPAN  CLASS="textbf">GET DISK FREE SPACE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $2E</td></tr>
<tr><td valign="top">&nbsp;E: Drive
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;First 3 bytes of current DMA buffer</td></tr>
<tr><td valign="top">&nbsp;A: Error Flag</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Get Disk Free Space function determines the number of free
sectors, 128 byte records, on the specified drive. The calling program
passes the drive number in register E, with 0 for drive A, 1 for B,
and so on, through 15 for drive P in a full 16drive system. Function
46 returns a binary number in the first 3 bytes of the current DMA
buffer. This number is returned in the following format:

<P>
fso fsl fs2

<P>
Disk Free Space Field Format

<P>
fso = low byte
<BR>
fsl = middle byte
<BR>
fs2 = high byte
<BR>
<P>
Note that the returned free space value might be inaccurate if the
drive has been marked Read-Only.

<P>
Upon return, register A is set to zero if the function is
successful. However, if the BDOS Error Mode is one of the return modes
(see Function 45), and a physical error is encountered, register A is
set to $FF, 255 decimal, and register H is set to one of the
following values:

<P>

<UL>
<LI>01 - Disk I/O error
</LI>
<LI>04 - Invalid drive error
</LI>
</UL>

<P>
<A NAME="3693"></A>
BDOS function 47: <SPAN  CLASS="textbf">CHAIN TO PROGRAM</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $2F</td></tr>
<tr><td valign="top">&nbsp;E: Chain Flag
</td></tr></table>

<P>
The Chain To Program function provides a means of chaining from one
program to the next without operator intervention. The calling program
must place a command line terminated by a null byte, OOH, in the
default DMA buffer. If register E is set to $FF, the CCP initializes
the default drive and user number to the current program values when
it passes control to the specified transient program. Otherwise, these
parameters are set to the default CCP values. Note that Function 108,
Get/Set Program Return Code, can be used to pass a two byte value to
the chained program.

<P>
Function 47 does not return any values to the calling program and any
encountered errors are handled by the CCP.

<P>
<A NAME="3697"></A>
BDOS function 48: <SPAN  CLASS="textbf">FLUSH BUFFERS</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $30
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Flag</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>
 E: Purge Flag

<P>
The Flush Buffers function forces the write of any write-pending
records contained in internal blocking/deblocking buffers. If register
E is set to $FF, this function also purges all active data
buffers. Programs that provide write with read verify support need to
purge internal buffers to ensure that verifying reads actually access
the disk instead of returning data that is resident in internal data
buffers. The CP/M 3 PIP utility is an example of such a program.

<P>
Upon return, register A is set to zero if the flush operation is
successful. If a physical error is encountered, the Flush Buffers
function performs different actions depending on the BDOS error mode
(see Function 45). If the BDOS error mode is in the default mode„ a
message identifying the error is displayed at the console and the
calling program is terminated. Otherwise, the Flush Buffers function
returns to the calling program with register A set to $FF and
register H set to the following physical error code:

<P>

<UL>
<LI>0 1 Disk I/O error
</LI>
<LI>02 Read/only disk
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
<A NAME="3705"></A>
<A NAME="3706"></A>
BDOS function 49: <SPAN  CLASS="textbf">GET/SET SYSTEM CONTROL BLOCK</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $31</td></tr>
<tr><td valign="top">&nbsp;DE: SCB PB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Returned Byte</td></tr>
<tr><td valign="top">&nbsp;HL: Returned Word
</td></tr></table>

<P>
Function 49 allows access to parameters located in the CP/M 3 System
Control Block (SCB). The SCB is a 100-byte data structure residing
within the BDOS that contains flags and data used by the BDOS, CCP and
other system components. Note that Function 49 is a CP/M 3 specific
function. Programs intended for both MP/M 11 and CP/M 3 should either
avoid the use of this function or isolate calls to this function in
CP/M 3 version-dependent sections.

<P>
To use Function 49, the calling program passes the address of a data
structure called the SCB parameter block in register pair DE. This
data structure identifies the byte or word of the SCB to be updated or
returned. The SCB parameter block is defined as:

<P>
<PRE>
SCBPB: DB OFFSET ; Offset within SCB
       DB SET ; 0FFH if setting a byte
       ; 0FEH if setting a word
       ; 001H - 0FDH are reserved
       ; 000H if a get operation
       DW VALUE ; Byte or word value to be set
</PRE>

<P>
The OFFSET parameter identifies the offset of the field within the SCB
to be updated or accessed. The SET parameter determines whether
Function 49 is to set a byte or word value in the SCB or if it is to
return a byte from the SCB. The VALUE parameter is used only in set
calls. In addition, only the first byte of VALUE is referenced in set
byte calls.

<P>
Use caution when you set SCB fields. Some of these parameters reflect
the current state of the operating system. If they are set to invalid
values, software errors can result. In general, do not use Function 49
to set a system parameter if another BDOS function can achieve the
same result. For example, Function 49 can be called to update the
Current DMA Address field within the SCB. This is not equivalent to
making a Function 26, Set DMA Address call, and updating the SCB
Current DMA field in this way would result in system errors. However,
you can use Function 49 to return the Current DMA address. The System
Control Block is summarized in <A HREF="#table:91">10.1</A>.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="table:91"></A><A ID="3716"></A>
<TABLE>
<CAPTION><STRONG>Table 10.1:</STRONG>
System Control Block</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img73.svg"
 ALT="\begin{table}\centering
\csvautotabular{system/cpm/scb.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
If Function 49 is called with the OFFSET parameter of the SCB
parameter block greater than $63, the function performs no action but
returns with registers A and HL set to zero.

<P>
<A NAME="3720"></A>
BDOS function 50: <SPAN  CLASS="textbf">DIRECT BIOS CALLS</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $32</td></tr>
<tr><td valign="top">&nbsp;DE: BIOS PB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;BIOS RETURN
</td></tr></table>

<P>
Function 50 provides a direct BIOS call through the BDOS to the
BIOS. The calling program passes the address of a data structure
called the BIOS Parameter Block (BIOSPB) in register pair DE. The
BIOSPB contains the BIOS function number and register contents as
shown below:

<P>
<PRE>
BIOSPB: db FUNC ; BIOS function no.
        db AREG ; A register contents
        dw BCREG ; BC register contents
        dw DEREG ; DE register contents
        dw HLREG ; HL register contents
</PRE>

<P>
System Reset (Function 0) is equivalent to Function 50 with a BIOS
function number of 1.

<P>
Note that the register pair BIOSPB fields (BCREG, DEREG, HLREG) arc
defined in low byte, high byte order. For example, in the BCREG field,
the first byte contains the C register value, the second byte contains
the B register value.  Under CP/M 3, direct BIOS calls via the BIOS
jump vector are only supported for the BIOS Console I/O and List
functions. You must use Function 50 to call any other

<P>
BIOS functions. In addition, Function 50 intercepts BIOS Function 27
(Select Memory) calls and returns with register A set to zero. Refer
to the CPIM Plus (CP/M Version 3) Operating System System Guide for
the definition of the BIOS functions and their register passing and
return conventions.

<P>
<A NAME="3728"></A>
BDOS function 59: <SPAN  CLASS="textbf">LOAD OVERLAY</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $3B</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
Only transient programs with an RSX header can use the Load Overlay
function because BDOS Function 59 is supported by the LOADER
module. The calling program must have a header to force the LOADER to
remain resident after the program is loaded (see Section 1.3).

<P>
Function 59 loads either an absolute or relocatable
module. Relocatable modules are identified by a filetype of
PRL. Function 59 does not call the loaded module.

<P>
The referenced FCB must be successfully opened before Function 59 is
called. The load address is specified in the first two random record
bytes of the FCB, rO and rl.  The LOADER returns an error if the load
address is less than $100, or if performing the requested load
operation would overlay the LOADER, or any other Resident System
Extensions that have been previously loaded.

<P>
When loading relocatable files, the LOADER requires enough room at the
load address for the complete PRL file including the header and bit
map (see Appendix B).  Otherwise an error is returned. Function 59
also returns an error on PRL file load requests if the specified load
address is not on a page boundary.

<P>
Upon return, Function 59 sets register A to zero if the load operation
is successful.  If the LOADER RSX is not resident in memory because
the calling program did not have a RSX header, the BDOS returns with
register A set to $FF and register H set to zero. If the LOADER
detects an invalid load address, or if insufficient memory is
available to load the overlay, Function 59 returns with register A set
to $FE. All other error returns are consistent with the error codes
returned by BDOS Function 20, Read Sequential.

<P>
<A NAME="3734"></A>
BDOS function 60: <SPAN  CLASS="textbf">CALL RESIDENT SYSTEM EXTENSION</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $3C</td></tr>
<tr><td valign="top">&nbsp;DE: RSX PB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
Function 60 is a special BDOS function that you use when you call
Resident System Extensions. The RSX subfunction is specified in a
structure called the RSX Parameter Block, defined as follows:

<P>
<PRE>
RSXPB: db FUNC ; RSX Function number
       db NUMPARMS ; Number of word Parameters
       dw PARMETER1 ; Parameter I
       dw PARMETER2 ; Parameter 2
       . . .
       dw PARMETERN ; Parameter n
</PRE>

<P>
RSX modules filter all BDOS calls and capture RSX function calls that
they can handle. If there is no RSX module present in memory that can
handle a specific RSX function call, the call is not trapped, and the
BDOS returns $FF in registers A and L. RSX function numbers from 0 to
127 are available for CP/M 3 compatible software use. RSX function
numbers 128 to 255 are reserved for system use.

<P>
<A NAME="3742"></A>
BDOS function 98: <SPAN  CLASS="textbf">FREE BLOCKS</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $62
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Error Flag</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Free Blocks function scans all the currently logged-in drives, and
for each drive returns to free space all temporarily-allocated data
blocks. A temporarily-allocated data block is a block that has been
allocated to a file by a BDOS write operation but has not been
permanently recorded in the directory by a BDOS close operation. The
CCP calls Function 98 when it receives control following a system warm
start. Be sure to close your file, particularly any file you have
written to, prior to calling Function 98.

<P>
In the nonbanked version of CP/M 3, Function 98 frees only temporarily
allocated blocks for systems that request double allocation vectors in
GENCPM.

<P>
Upon return, register A is set to zero if Function 98 is
successful. If a physical error is encountered, the Free Blocks
function performs different actions depending on the BDOS error mode
(see Function 45). If the BDOS error mode is in the default mode, a
message identifying the error is displayed at the console and the
calling program is terminated. Otherwise, the Free Blocks function
returns to the calling program with register A set to $FF and
register H set to the following physical error code:

<P>

<UL>
<LI>04 : Invalid drive error
</LI>
</UL>

<P>
<A NAME="3750"></A>
BDOS function 99: <SPAN  CLASS="textbf">TRUNCATE FILE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $63</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Extended or Physical Error
</td></tr></table>

<P>
The Truncate File function sets the last record of a file to the
random record number contained in the referenced FCB. The calling
program passes the address of the FCB in register pair DE, with byte 0
of the FCB specifying the drive, bytes 1 through 11 specifying the
filename and filetype, and bytes 33 through 35, rO, rl, and r2,
specifying the last record number of the file. The last record number
is a 24 bit value, stored with the least significant byte first, rO,
the middle byte next, rl, and the high byte last, r2. This value can
range from 0 to 262,143, which corresponds to a maximum value of 3 in
byte r2.

<P>
If the file specified by the referenced FCB is password protected, the
correct password must be placed in the first eight bytes of the
current DMA buffer, or have been previously established as the default
password (see Function 106).

<P>
Function 99 requires that the file specified by the FCB not be open,
particularly if the file has been written to. In addition, any
activated FCBs naming the file are not valid after Function 99 is
called. Close your file before calling Function 99, and then reopen it
after the call to continue processing on the file.

<P>
Function 99 also requires that the random record number field of the
referenced FCB specify a value less than the current file size. In
addition, if the file is sparse, the random record field must specify
a record in a region of the file where data exists.

<P>
Upon return, the Truncate function returns a Directory Code in
register A with the value 0 if the Truncate function is successful, or
$FF, 255 decimal, if the file is not found or the record number is
invalid. Register H is set to zero in both of these cases. If a
physical or extended error is encountered, the Truncate function
performs different actions depending on the BDOS error mode (see
Function 45). If the BDOS error mode is in the default mode, a message
identifying the error is displayed at the console and the program is
terminated. Otherwise, the Truncate function returns to the calling
program with register A set to $FF and register H set to one of the
following physical or extended error codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read-Only disk
</LI>
<LI>03 Read-Only file
</LI>
<LI>04 Invalid drive error
</LI>
<LI>07 File password error
</LI>
<LI>09 ? in filename or filetype field
</LI>
</UL>

<P>
<A NAME="3758"></A>
BDOS function 100: <SPAN  CLASS="textbf">SET DIRECTORY LABEL</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $64</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical or Extended Error
</td></tr></table>

<P>
The Set Directory Label function creates a directory label, or updates
the existing directory label for the specified drive. The calling
program passes in register pair DE the address of an FCB containing
the name, type, and extent fields to be assigned to the directory
label. The name and type fields of the referenced FCB are not used to
locate the directory label in the directory; they are simply copied
into the updated or created directory label. The extent field of the
FCB, byte 12, contains the user's specificat-on of the directory label
data byte. The definition of the directory label data byte is:

<P>
<table width="90%"><tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;7 - Require passwords for password-protected files (Not
  supported in nonbanked CP/M 3 systems)</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;6 - Perform access date and time stamping</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;5 - Perform update date and time stamping</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;4 - Perform create date and time stamping</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;0 - Assign a new password to the directory label
</td></tr></table>

<P>
If the current directory label is password protected, the correct
password must be placed in the first eight bytes of the current DMA,
or have been previously established as the default password (see
Function 106). If bit 0, the low-order bit, of byte 12 of the FCB is
set to 1, it indicates that a new password for the directory label has
been placed in the second eight bytes of the current DMA.

<P>
Note that Function 100 is implemented as an RSX, DIRLBL.RSX, in
nonbanked CP/M 3 systems. If Function 100 is called in nonbanked
systems when the DIRLBL.RSX is not resident an error code of $0FF is
returned.

<P>
Function 100 also requires that the referenced directory contain SFCBs
to activate date and time stamping on the drive. If an attempt is made
to activate date and time stamping when no SFCBs exist, Function 100
returns an error code of $FF in register A and performs no
action. The CP/M 3 INITDIR utility initializes a directory for date
and time stamping by placing an SFCB record in every fourth entry of
the directory.

<P>
Function 100 returns a Directory Code in register A with the value 0
if the directory label create or update is successful, or $FF, 255
decimal, if no space exists in the referenced directory to create a
directory label, or if date and time stamping was requested and the
referenced directory did not contain SFCBS. Register H is set to zero
in both of these cases. If a physical error or extended error is
encountered, Function 100 performs different actions depending on the
BDOS error mode (see Function 45). If the BDOS error mode is the
default mode, a message identifying the error is displayed at the
console and the calling program is terminated. Otherwise, Function 100
returns to the calling program with register A set to $FF and
register H set to one of the following physical or extended error
codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read-Only disk
</LI>
<LI>04 Invalid drive error
</LI>
<LI>07 File password error
</LI>
</UL>

<P>
<A NAME="3768"></A>
BDOS function 101: <SPAN  CLASS="textbf">RETURN DIRECTORY LABEL DATA</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $65</td></tr>
<tr><td valign="top">&nbsp;E: Drive
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Label Data Byte</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Return Directory Label Data function returns the data byte of the
directory label for the specified drive. The calling program passes
the drive number in register E with 0 for drive A, 1 for drive B, and
so on through 15 for drive P in a full sixteen drive system. The
format of the directory label data byte is shown below:

<P>
<table width="90%"><tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;7 - Require passwords for password protected files</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;6 - Perform access date and time stamping</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;5 - Perform update date and time stamping</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;4 - Perform create date and time stamping</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;0 - Directory label exists on drive
</td></tr></table>

<P>
Function 101 returns the directory label data byte to the calling
program in register A. Register A equal to zero indicates that no
directory label exists on the specified drive. If a physical error is
encountered by Function 101 when the BDOS Error mode is in one of the
return modes (see Function 45), this function returns with register A
set to $FF, 25S decimal, and register H set to one of the following:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>04 Invalid drive error
</LI>
</UL>

<P>
<A NAME="3778"></A>
BDOS function 102: <SPAN  CLASS="textbf">READ FILE DATE STAMPS AND PASSWORD MODE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $66</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
Function 102 returns the date and time stamp information and password
mode for the specified file in byte 12 and bytes 24 through 32 of the
specified FCB. The calling program passes in register pair DE, the
address of an FCB in which the drive, filename, and filetype fields
have been defined.

<P>
If Function 102 is successful, it sets the following fields in the
referenced FCB:

<P>
<table width="90%"><tr><td valign="top">&nbsp;byte 12 : Password mode field
<table width="90%"><tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;7 - Read mode</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;6 - Write mode</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;4 - Delete mode
</td></tr></table>
</td></tr></table>

<P>
Byte 12 equal to zero indicates the file has not been assigned a
password. In nonbanked systems, byte 12 is always set to zero.

<P>
<table width="90%"><tr><td valign="top">&nbsp;byte 24 - 27 Create or Access time stamp field</td></tr>
<tr><td valign="top">&nbsp;byte 28 - 31 Update time stamp field
</td></tr></table>

<P>
The date stamp fields are set to binary zeros if a stamp has not been
made. The format of the time stamp fields is the same as the format of
the date and time structure described in Function 104.

<P>
Upon return, Function 102 returns a Directory Code in register A with
the value zero if the function is successful, or $FF, 255 decimal, if
the specified file is not found. Register H is set to zero in both of
these cases. If a physical or extended error is encountered, Function
102 performs different actions depending on the BDOS error mode (see
Function 45). If the BDOS error mode is in the default mode, a message
identifying the error is displayed at the console and the calling
program is terminated. Otherwise, Function 102 returns to the calling
program with register A set to $FF and register H set to one of the
following physical or extended error codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>04 Invalid drive error
</LI>
<LI>09 ? in filename or filetype field
</LI>
</UL>

<P>
<A NAME="3792"></A>
BDOS function 103: <SPAN  CLASS="textbf">WRITE FILE XFCB</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $67</td></tr>
<tr><td valign="top">&nbsp;DE: FCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Directory Code</td></tr>
<tr><td valign="top">&nbsp;H: Physical Error
</td></tr></table>

<P>
The Write File XFCB function creates a new XFCB or updates the
existing XFCB for the specified file. The calling program passes in
register pair DE the address of an FCB in which the drive, name, type,
and extent fields have been defined. The extent field specifies the
password mode and whether a new password is to be assigned to the
file. The format of the extent byte is shown below:

<P>
FCB byte 12 (ex) : XFCB password mode
<table width="90%"><tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;7 - Read mode</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;6 - Write mode</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;5 - Delete mode</td></tr>
<tr><td align="right" valign="top">bit</td><td valign="top">&nbsp;0 - Assign new password to the file
</td></tr></table>

<P>
If the specified file is currently password protected, the correct
password must reside in the first eight bytes of the current DMA, or
have been previously established as the default password (see Function
106). If bit 0 is set to 1, the new password must reside in the second
eight bytes of the current DMA.

<P>
Upon return, Function 103 returns a Directory Code in register A with
the value zero if the XFCB create or update is successful, or $FF,
255 decimal, if no directory label exists on the specified drive, or
the file named in the FCB is not found, or no space exists in the
directory to create an XFCB. Function 103 also returns with $FF in
register A if passwords are not enabled by the referenced directory's
label. On nonbanked systems, this function always returns with
register A = $FF because passwords are not supported. Register H is
set to zero in all of these cases. If a physical or extended error is
encountered, Function 103 performs different actions depending on the
BDOS error mode (see Function 45). If the BDOS error mode is the
default mode, a message identifying the error is displayed at the
console and the calling program is terminated. Otherwise, Function 103
returns to the calling program with register A set to $FF and
register H set to one of the following physical or extended error
codes:

<P>

<UL>
<LI>01 Disk I/O error
</LI>
<LI>02 Read-Only disk
</LI>
<LI>04 Invalid drive error
</LI>
<LI>07 File password error
</LI>
<LI>09 ? in filename or filetype field
</LI>
</UL>

<P>
<A NAME="3802"></A>
BDOS function 104: <SPAN  CLASS="textbf">SET DATE AND TIME</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $68</td></tr>
<tr><td valign="top">&nbsp;DE: DAT Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;none
</td></tr></table>

<P>
The Set Date and Time function sets the system internal date and
time. The calling program passes the address of a 4-byte structure
containing the date and time specification in the register pair
DE. The format of the date and time (DAT) data structure is:

<P>
<table width="90%"><tr><td align="right" valign="top">byte</td><td valign="top">&nbsp;0 - 1 Date field</td></tr>
<tr><td align="right" valign="top">byte</td><td valign="top">&nbsp;2 Hour field</td></tr>
<tr><td align="right" valign="top">byte</td><td valign="top">&nbsp;3 Minute field
</td></tr></table>

<P>
The date is represented as a 16-bit integer with day 1 corresponding
to January 1, 1978. The time is represented as two bytes: hours and
minutes are stored as two BCD digits.

<P>
This function also sets the seconds field of the system date and time
to zero.

<P>
<A NAME="3810"></A>
BDOS function 105: <SPAN  CLASS="textbf">GET DATE AND TIME</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $69</td></tr>
<tr><td valign="top">&nbsp;DE: DAT Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: seconds</td></tr>
<tr><td valign="top">&nbsp;DAT set
</td></tr></table>

<P>
The Get Date and Time function obtains the system internal date and
time. The calling program passes in register pair DE, the address of a
4-byte data structure which receives the date and time values. The
format of the date and time, DAT, data structure is the same as the
format described in Function 104. Function 105 also returns the
seconds field of the system date and time in register A as a two digit
BCD value.

<P>
<A NAME="3816"></A>
BDOS function 106: <SPAN  CLASS="textbf">SET DEFAULT PASSWORD</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $6A</td></tr>
<tr><td valign="top">&nbsp;DE: Password Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;none
</td></tr></table>

<P>
The Set Default Password function allows a program to specify a
password value before a file protected by the password is
accessed. When the file system accesses a password-protected file, it
checks the current DMA, and the default password for the correct
value. If either value matches the file's password, full access to the
file is allowed. Note that this function performs no action in
nonbanked CP/M 3 systems because file passwords are not supported.

<P>
To make a Function 106 call, the calling program sets register pair DE
to the address of an 8-byte field containing the password.

<P>
<A NAME="3822"></A>
BDOS function 107: <SPAN  CLASS="textbf">RETURN SERIAL NUMBER</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $6B</td></tr>
<tr><td valign="top">&nbsp;DE: Serial Number Field
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;Serial number field set
</td></tr></table>

<P>
Function 107 returns the CP/M 3 serial number to the 6-byte field
addressed by register pair DE.

<P>
<A NAME="3828"></A>
<A NAME="3829"></A>
BDOS function 108: <SPAN  CLASS="textbf">GET/SET PROGRAM RETURN CODE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $6C</td></tr>
<tr><td valign="top">&nbsp;DE: $0FFFF (Get) or Program Return Code (Set)
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: Program Return Code or (no value)
</td></tr></table>

<P>
CP/M 3 allows programs to set a return code before terminating. This
provides a mechanism for programs to pass an error code or value to a
following job step in batch environments. For example, Program Return
Codes are used by the CCP in CP/M 3's conditional command line batch
facility. Conditional command lines are command lines that begin with
a colon, :. The execution of a conditional command depends on the
successful execution of the preceding command. The CCP tests the
return code of a terminating program to determine whether it
successfully completed or terminated in error. Program return codes
can also be used by programs to pass an error code or value to a
chained program (see Function 47, Chain To Program).

<P>
A program can set or interrogate the Program Return Code by calling
Function 108. If re 'ster pair DE = $FFFF, then the current Program
Return Code is returned in register pair HL. Otherwise, Function 108
sets the Program Return Code to the 'value contained in register pair
DE. Program Return Codes are defined in <A HREF="#table:92">10.2</A>

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="table:92"></A><A ID="3837"></A>
<TABLE>
<CAPTION><STRONG>Table 10.2:</STRONG>
Program Return Codes</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img74.svg"
 ALT="\begin{table}\centering
\csvautotabular{system/cpm/return_codes.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<A NAME="3841"></A>
<A NAME="3842"></A>
BDOS function 109: <SPAN  CLASS="textbf">GET/SET CONSOLE MODE</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $6D</td></tr>
<tr><td valign="top">&nbsp;DE: $FFFF (Get) or Console Mode (Set)
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: Console Mode or (no value)
</td></tr></table>

<P>
A program can set or interrogate the Console Mode by calling Function
109. If register pair DE = $FFFF, then the current Console Mode is
returned in register HL. Otherwise, Function 109 sets the Console Mode
to the value contained in register pair DE.

<P>
The Console Mode is a 16-bit system parameter that determines the
action of certain BDOS Console I/O functions. The definition of the
Console Mode is:

<P>
<table width="90%"><tr><td align="right" valign="top">bit 0</td><td valign="top">&nbsp;= 1 - CTRL-C only status for Function 1 1.
<BR>  = 0 - Normal status for Function 1 1.</td></tr>
<tr><td align="right" valign="top">bit 1</td><td valign="top">&nbsp;= 1- Disable stop scroll, CTRL-S, start scroll, CTRL-Q,
  support.
<BR>  = 0-Enable stop scroll, start scroll support.</td></tr>
<tr><td align="right" valign="top">bit 2</td><td valign="top">&nbsp;= 1- Raw console output mode. Disables tab expansion for
  Functions 2, 9 and 111. Also disables printer echo, CTIRL-P,
  support.
<BR>  = 0 - Normal console output mode.</td></tr>
<tr><td align="right" valign="top">bit 3</td><td valign="top">&nbsp;= 1 - Disable CTRL-C program termination
<BR>  = 0 - Enable CTRL-C program termination</td></tr>
<tr><td align="right" valign="top">bits 8,9</td><td valign="top">&nbsp;-Console status mode for RSXs that perform console
  input redirection from a file. These bits determine how the RSX
  responds to console status requests.
  <table width="90%">  <tr><td valign="top">&nbsp;bit 8 = 0, bit 9 = 0 - conditional status
  </td></tr>
<tr><td valign="top">&nbsp;bit 8 = 0, bit 9 = 1 - false status
  </td></tr>
<tr><td valign="top">&nbsp;bit 8 = 1, bit 9 = 0 - true status
  </td></tr>
<tr><td valign="top">&nbsp;bit 8 = 1, bit 9 = 1 - bypass redirection
  </td></tr></table>
</td></tr></table>

<P>
Note that the Console Mode bits are numbered from right to left.

<P>
The CCP initializes the Console Mode to zero when it loads a program
unless the program has an RSX that overrides the default value. Refer
to Section 2.2.1 for detailed information on Console Mode.

<P>
<A NAME="3852"></A>
<A NAME="3853"></A>
BDOS function 110: <SPAN  CLASS="textbf">GET/SET OUTPUT DELIMITER</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $6E</td></tr>
<tr><td valign="top">&nbsp;DE: $FFFF (Get) or</td></tr>
<tr><td valign="top">&nbsp;E: Output Delimiter (Set)
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;A: Output Delimiter or (no value)
</td></tr></table>

<P>
A program can set or interrogate the current Output Delimiter by
calling Function 110. If register pair DE = $FFFF, then the current
Output Delimiter is returned in register A. Otherwise, Function 110
sets the Output Delimiter to the value contained in register E.

<P>
Function 110 sets the string delimiter for Function 9, Print
String. The default delimiter value is a dollar sign, $. The CCP
restores the Output Delimiter to the default value when a transient
program is loaded.

<P>
<A NAME="3859"></A>
BDOS function 111: <SPAN  CLASS="textbf">PRINT BLOCK</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $6F</td></tr>
<tr><td valign="top">&nbsp;DE: CCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;none
</td></tr></table>

<P>
The Print Block function sends the character string located by the
Character Control Block, CCB, addressed in register pair DE, to the
logical console, CONOUT:. If the Console Mode is in the default state
(see Section 2.2.1), Function 111 expands tab characters, CTRL-I, in
columns of eight characters. It also checks for stop scroll, CTRL-S,
start scroll, CTRL-Q, and echoes to the logical list device, LST:, if
printer echo, CTRL-P, has been invoked.

<P>
The CCB format is:
<table width="90%"><tr><td align="right" valign="top">byte</td><td valign="top">&nbsp;0 - 1 Address of character string (word value)</td></tr>
<tr><td align="right" valign="top">byte</td><td valign="top">&nbsp;2 - 3 Length of character string (word value)
</td></tr></table>

<P>
<A NAME="3867"></A>
BDOS function 112: <SPAN  CLASS="textbf">LIST BLOCK</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $70</td></tr>
<tr><td valign="top">&nbsp;DE: CCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;none
</td></tr></table>

<P>
The List Block function sends the character string located by the
Character Control Block, CCB, addressed in register pair DE, to the
logical list device, LST:.

<P>
The CCB format is:
<table width="90%"><tr><td align="right" valign="top">byte</td><td valign="top">&nbsp;0 - 1 Address of character string (word value)</td></tr>
<tr><td align="right" valign="top">byte</td><td valign="top">&nbsp;2 - 3 Length of character string (word value)
</td></tr></table>

<P>
<A NAME="3875"></A>
BDOS function 152: <SPAN  CLASS="textbf">PARSE FILENAME</SPAN>

<P>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C: $98</td></tr>
<tr><td valign="top">&nbsp;DE: PFCB Address
</td></tr></table>

<P>
Returned Value:
<table width="90%"><tr><td valign="top">&nbsp;HL: Return code</td></tr>
<tr><td valign="top">&nbsp;Parsed file control block
</td></tr></table>

<P>
The Parse Filename function parses an ASCII file specification and
prepares a File Control Block, FCB. The calling program passes the
address of a data structure called the Parse Filename Control Block,
PFCB, in register pair DE. The PFCB contains the address of the input
ASCII filename string followed by the address of the target FCB as
shown below:

<P>
<PRE>
 PFCB: DW INPUT ; Address of input ASCII string
       DW FCB ; Address of target FCB
</PRE>

<P>
The maximum length of the input ASCII string to be parsed is 128
bytes. The target FCB must be 36 bytes in length.

<P>
Function 152 assumes the input string contains file specifications in
the following form:

<P>
{d:}filename{.typ}{;password}

<P>
where items enclosed in curly brackets are optional. Function 152 also
accepts isolated drive specifications d: in the input string. When it
encounters one, it sets the filename, filetype, and password fields in
the FCB to blank.

<P>
The Parse Filename function parses the first file specification it
finds in the input string. The function first eliminates leading
blanks and tabs. The function then assumes that the file specification
ends on the first delimiter it encounters that is out of context with
the specific field it is parsing. For instance, if it finds a colon,
and it is not the second character of the file specification, the
colon delimits the entire file specification.

<P>
Function 152 recognizes the following characters as detimiters:

<P>
<table width="90%"><tr><td valign="top">&nbsp;space</td></tr>
<tr><td valign="top">&nbsp;tab</td></tr>
<tr><td valign="top">&nbsp;return</td></tr>
<tr><td valign="top">&nbsp;nut]</td></tr>
<tr><td valign="top">&nbsp;; (semicolon) - except before password field</td></tr>
<tr><td valign="top">&nbsp;= (equal)</td></tr>
<tr><td valign="top">&nbsp;<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img72.svg"
 ALT="\(&lt;\)"></SPAN> (less than)</td></tr>
<tr><td valign="top">&nbsp;<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img71.svg"
 ALT="\(&gt;\)"></SPAN> (greater than)</td></tr>
<tr><td valign="top">&nbsp;. (period) - except after filename and before filetype</td></tr>
<tr><td valign="top">&nbsp;: (colon) - except before filename and after drive</td></tr>
<tr><td valign="top">&nbsp;, (comma)</td></tr>
<tr><td valign="top">&nbsp;<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img70.svg"
 ALT="\(\vert\)"></SPAN> (vertical bar)</td></tr>
<tr><td valign="top">&nbsp;[ (left square bracket)</td></tr>
<tr><td valign="top">&nbsp;] (right square bracket)
</td></tr></table>

<P>
If Function 152 encounters a non-graphic character in the range 1
through 31 not listed above, it treats the character as an error. The
Parse Filename function initializes the specified FCB shown in
<A HREF="#table:93">10.3</A>.

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="table:93"></A><A ID="3887"></A>
<TABLE>
<CAPTION><STRONG>Table 10.3:</STRONG>
FCB Format</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img75.svg"
 ALT="\begin{table}\centering
\csvautotabular{system/cpm/fcb.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
If an error occurs, Function 152 returns an $FFFF in register pair
HL.

<P>
On a successful parse, the Parse Filename function checks the next
item in the input string. It skips over trailing blanks and tabs and
looks at the next character. If the character is a null or carriage
return, it returns a 0 indicating the end of the input string. If the
character is a delimiter, it returns the address of the delimiter. If
the character is not a delimiter, it returns the address of the first
trailing blank or tab.

<P>
If the first non-blank or non-tab character in the input string is a
null, 0, or carriage return, the Parse Filename function returns a
zero indicating the end of string.

<P>
If the Parse Filename function is to be used to parse a subsequent
file specification in the input string, the returned address must be
advanced over the delimiter before placing it in the PFCB.

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node140.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node138.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1174"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1176"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node140.html">BIOS</A>
<B> Up:</B> <A
 HREF="node137.html">CP/M</A>
<B> Previous:</B> <A
 HREF="node138.html">Utilities</A>
 &nbsp; <B>  <A ID="tex2html1175"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1177"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node140.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>BIOS</TITLE>
<META NAME="description" CONTENT="BIOS">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node144.html">
<LINK REL="previous" HREF="node139.html">
<LINK REL="next" HREF="node141.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node141.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node139.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1178"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1180"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node141.html">System Initialization Functions</A>
<B> Up:</B> <A
 HREF="node137.html">CP/M</A>
<B> Previous:</B> <A
 HREF="node139.html">BDOS</A>
 &nbsp; <B>  <A ID="tex2html1179"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1181"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001113000000000000000">
BIOS</A>
</H2>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" System Initialization Functions " LINK NODE141}
@{" Character I/O Functions " LINK NODE142}
@{" Disk I/O Functions " LINK NODE143}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node141.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>System Initialization Functions</TITLE>
<META NAME="description" CONTENT="System Initialization Functions">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node142.html">
<LINK REL="previous" HREF="node140.html">
<LINK REL="next" HREF="node142.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node142.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1185"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1187"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node142.html">Character I/O Functions</A>
<B> Up:</B> <A
 HREF="node140.html">BIOS</A>
<B> Previous:</B> <A
 HREF="node140.html">BIOS</A>
 &nbsp; <B>  <A ID="tex2html1186"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1188"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION001113100000000000000">
System Initialization Functions</A>
</H3>
This section defines the BIOS system initialization routines BOOT,
WBOOT, DEVTBL, DEVINI, and DRVTBL.

<P>
<A NAME="3893"></A>
BIOS Function 0: BOOT

<P>
Get Control from Cold Start Loader and Initialize System
<BR>
Entry Parameters: None
<BR>
Returned Values: None

<P>
The BOOT entry point gets control from the Cold Start Loader in Bank 0
and is responsible for basic system initialization. Any remaining
hardware initialization that is not done by the boot ROMS, the Cold
Boot Loader, or the LDRBIOS should be performed by the BOOT routine.

<P>
<A NAME="3894"></A>
BIOS Function 1: WBOOT

<P>
Get Control When a Warm Start Occurs
<BR>
Entry Parameters: None
<BR>
Returned Values: None

<P>
The WBOOT entry point is entered when a warm start occurs. A warm
start is performed whenever a user program branches to location 0000H
or attempts to return to the CCP.

<P>
<A NAME="3895"></A>
BIOS Function 20: DEVTBL

<P>
Return Address of Character I/O Table
<BR>
Entry Parameters: None
<BR>
Returned Values: HL=address of Chrtbl

<P>
The DEVTBL and DEVINI entry points allow you to support device
assignment with a flexible, yet completely optional system. It
replaces the IOBYTE facility of CP/M 2.2.

<P>
<A NAME="3896"></A>
BIOS Function 21: DEVINI

<P>
Initialize Character I/O Device
<BR>
Entry Parameters: C=device number, 0-15
<BR>
Returned Values: None

<P>
The DEVINI routine initializes the physical character device specified
in register C to the baud rate contained in the appropriate entry of
the CHRTBL.

<P>
<A NAME="3897"></A>
BIOS Function 22: DRVTBL

<P>
Return Address of Disk Drive Table
<BR>
Entry Parameters: None
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;HL=Address of Drive Table of Disk Parameter Headers (DPH);
  Hashing can utilized if specified by the DPHs Referenced by this
  DRVTBL.</td></tr>
<tr><td valign="top">&nbsp;HL=$ffff if no Drive Table; GENCPM does not set up buffers.
  Hashing is supported.</td></tr>
<tr><td valign="top">&nbsp;HL=$fffe if no Drive Table; GENCPM does not set up buffers.
  Hashing is not supported.
</td></tr></table>

<P>
The first instruction of this subroutine must be an LXI H,&lt;address&gt;
where &lt;address&gt; is one of the above returned values. The GENCPM
utility accesses the address in this instruction to locate the drive
table and the disk parameter data structures to determine which system
configuration to use.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node142.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1185"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1187"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node142.html">Character I/O Functions</A>
<B> Up:</B> <A
 HREF="node140.html">BIOS</A>
<B> Previous:</B> <A
 HREF="node140.html">BIOS</A>
 &nbsp; <B>  <A ID="tex2html1186"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1188"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node142.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Character I/O Functions</TITLE>
<META NAME="description" CONTENT="Character I/O Functions">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node143.html">
<LINK REL="previous" HREF="node141.html">
<LINK REL="next" HREF="node143.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node143.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node141.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1189"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1191"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node143.html">Disk I/O Functions</A>
<B> Up:</B> <A
 HREF="node140.html">BIOS</A>
<B> Previous:</B> <A
 HREF="node141.html">System Initialization Functions</A>
 &nbsp; <B>  <A ID="tex2html1190"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1192"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION001113200000000000000">
Character I/O Functions</A>
</H3>
This section defines the CP/M 3 character I/O routines CONST, CONIN,
CONOUT, LIST, AUXOUT, AUXIN, LISTST, CONOST, AUXIST, and AUXOST.  CP/M
3 assumes all simple character I/O operations are performed in
eight-bit ASCII, upper and lowercase, with no parity. An ASCII CTRL-Z
($1a) denotes an end-of-file condition for an input device.

<P>
In CP/M 3, you can direct each of the five logical character devices
to any combination of up to twelve physical devices. Each of the five
logical devices has a 16-bit vector in the System Control Block (SCB)
. Each bit of the vector represents a physical device where bit 15
corresponds to device zero, and bit 4 is device eleven. Bits 0 through
3 are reserved for future system use.

<P>
<A NAME="3901"></A>
BIOS Function 2: CONST

<P>
Sample the Status of the Console Input Device
<BR>
Entry Parameters: None
<BR>
Returned value:
<table width="90%"><tr><td valign="top">&nbsp;A=$ff if a console character is ready to read</td></tr>
<tr><td valign="top">&nbsp;A=$00 if no console character is ready to read
</td></tr></table>

<P>
Read the status of the currently assigned console device and return
$ff in register A if a character is ready to read, and $ff in
register A if no console characters are ready.

<P>
<A NAME="3904"></A>
BIOS Function 3: CONIN

<P>
Read a Character from the Console
<BR>
Entry Parameters: None
<BR>
Returned Values: A=Console Character

<P>
Read the next console character into register A with no parity. If no
console character is ready, wait until a character is available before
returning.

<P>
<A NAME="3905"></A>
BIOS Function 4: CONOUT

<P>
Output Character to Console
<BR>
Entry Parameters: C=Console Character
<BR>
Returned Values: None

<P>
Send the character in register C to the console output device. The
character is in ASCII with no parity.

<P>
<A NAME="3906"></A>
BIOS Function 5: LIST

<P>
Output Character to List Device
<BR>
Entry Parameters: C=Character
<BR>
Returned Values: None

<P>
Send the character from register C to the listing device. The
character is in ASCII with no parity.

<P>
<A NAME="3907"></A>
BIOS Function 6: AUXOUT

<P>
Output a Character to the Auxiliary Output Device
<BR>
Entry Parameters: C=Character
<BR>
Returned Values: None

<P>
Send the character from register C to the currently assigned AUXOUT
device. The character is in ASCII with no parity.

<P>
<A NAME="3908"></A>
BIOS Function 7: AUXIN

<P>
Read a Character from the Auxiliary Input Device
<BR>
Entry Parameters: None
<BR>
Returned Values: A=Character

<P>
Read the next character from the currently assigned AUXIN device into
register A with no parity. A returned ASCII CTRL-Z ($1a) reports an
end-of-file.

<P>
<A NAME="3909"></A>
BIOS Function 15: LISTST

<P>
Return the Ready Status of the List Device
<BR>
Entry Parameters: None
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;A=$00 if list device is not ready to accept a character</td></tr>
<tr><td valign="top">&nbsp;A=$ff if list device is ready to accept a character
</td></tr></table>

<P>
<A NAME="3912"></A>
BIOS Function 17: CONOST

<P>
Return Output Status of Console
<BR>
Entry Parameters: None
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;A=$ff if ready</td></tr>
<tr><td valign="top">&nbsp;A=$00 if not ready
</td></tr></table>

<P>
The CONOST routine checks the status of the console. CONOST returns an
$ff if the console is ready to display another character. This entry
point allows for full polled handshaking communications support.

<P>
<A NAME="3915"></A>
BIOS Function 18: AUXIST

<P>
Return Input Status of Auxiliary Port
<BR>
Entry Parameters: None
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;A=$ff if ready</td></tr>
<tr><td valign="top">&nbsp;A=$00 if not ready
</td></tr></table>

<P>
The AUXIST routine checks the input status of the auxiliary port. This
entry point allows full polled handshaking for communications support
using an auxiliary port.

<P>
<A NAME="3918"></A>
BIOS Function 19: AUXOST

<P>
Return Output Status of Auxiliary Port
<BR>
Entry Parameters: None
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;A=$ff if ready</td></tr>
<tr><td valign="top">&nbsp;A=$00 if not ready
</td></tr></table>

<P>
The AUXOST routine checks the output status of the auxiliary
port. This routine allows full polled handshaking for communications
support using an auxiliary port.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node143.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node141.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1189"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1191"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node143.html">Disk I/O Functions</A>
<B> Up:</B> <A
 HREF="node140.html">BIOS</A>
<B> Previous:</B> <A
 HREF="node141.html">System Initialization Functions</A>
 &nbsp; <B>  <A ID="tex2html1190"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1192"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node143.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Disk I/O Functions</TITLE>
<META NAME="description" CONTENT="Disk I/O Functions">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node142.html">
<LINK REL="next" HREF="node144.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node144.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node142.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1193"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1195"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node144.html">Memory Select and Move</A>
<B> Up:</B> <A
 HREF="node140.html">BIOS</A>
<B> Previous:</B> <A
 HREF="node142.html">Character I/O Functions</A>
 &nbsp; <B>  <A ID="tex2html1194"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1196"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION001113300000000000000">
Disk I/O Functions</A>
</H3>
This section defines the CP/M 3 BIOS disk I/O routines HOME, SELDSK,
SETTRK, SETSEC, SETDMA, READ, WRITE, SECTRN, MULTIO, and FLUSH.

<P>
<A NAME="3922"></A>
BIOS Function 8: HOME

<P>
Select Track 00 of the Specified Drive
<BR>
Entry Parameters: None
<BR>
Returned Values: None

<P>
Return the disk head of the currently selected disk to the track 00
position. Usually, you can translate the HOME call into a call on
SETTRK with a parameter of 0.

<P>
<A NAME="3923"></A>
BIOS Function 9: SELDSK

<P>
Select the Specified Disk Drive
<BR>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;C=Disk Drive (0-15)</td></tr>
<tr><td valign="top">&nbsp;E=Initial Select Flag
</td></tr></table>

Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;HL=Address of Disk Parameter Header (DPH) if drive exists</td></tr>
<tr><td valign="top">&nbsp;HL=0000H if drive does not exist
</td></tr></table>

Select the disk drive specified in register C for further operations,
where register C contains 0 for drive A, 1 for drive B, and so on to
15 for drive P. On each disk select, SELDSK must return in HL the base
address of a 25-byte area called the Disk Parameter Header. If there
is an attempt to select a nonexistent drive, SELDSK returns HL=$0000
as an error indicator.  On entry to SELDSK, you can determine if it is
the first time the specified disk is selected. Bit 0, the least
significant bit in register E, is set to 0 if the drive has not been
previously selected. This information is of interest in systems that
read configuration information from the disk to set up a dynamic disk
definition table.

<P>
<A NAME="3928"></A>
BIOS Function 10: SETTRK

<P>
Set Specified Track Number
<BR>
Entry Parameters: BC=Track Number
<BR>
Returned Values: None

<P>
Register BC contains the track number for a subsequent disk access on
the currently selected drive. Normally, the track number is saved
until the next READ or WRITE occurs.

<P>
<A NAME="3929"></A>
BIOS Function 11: SETSEC

<P>
Set Specified Sector Number
<BR>
Entry Parameters: BC=Sector Number
<BR>
Returned Values: None

<P>
Register BC contains the sector number for the subsequent disk access
on the currently selected drive. This number is the value returned by
SECTRN. Usually, you delay actual sector selection until a READ or
WRITE operation occurs.

<P>
<A NAME="3930"></A>
BIOS Function 12: SETDMA

<P>
Set Address for Subsequent Disk I/O
<BR>
Entry Parameters: BC=Direct Memory Access Address
<BR>
Returned Values: None

<P>
Register BC contains the DMA (Direct Memory Access) address for the
subsequent READ or WRITE operation. For example, if B = $00 and C =
$80 when the BDOS calls SETDMA, then the subsequent read operation
reads its data starting at $80, or the subsequent write operation
gets its data from 80H, until the next call to SETDMA occurs.

<P>
<A NAME="3931"></A>
BIOS Function 13: READ

<P>
Read a Sector from the Specified Drive
<BR>
Entry Parameters: None
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;A=$00 if no errors occurred</td></tr>
<tr><td valign="top">&nbsp;A=$01 if nonrecoverable error condition occurred</td></tr>
<tr><td valign="top">&nbsp;A=$ff if media has changed
</td></tr></table>

Assume the BDOS has selected the drive, set the track, set the sector,
and specified the DMA address. The READ subroutine attempts to read
one sector based upon these parameters, then returns one of the error
codes in register A as described above.

<P>
If the value in register A is $00, then CP/M 3 assumes that the disk
operation completed properly. If an error occurs, the BIOS should
attempt several retries to see if the error is recoverable before
returning the error code.

<P>
If an error occurs in a system that supports automatic density
selection, the system should verify the density of the drive. If the
density has changed, return a $ff in the accumulator. This causes the
BDOS to terminate the current operation and relog in the disk.

<P>
<A NAME="3934"></A>
BIOS Function 14: WRITE

<P>
Write a Sector to the Specified Disk
<BR>
Entry Parameters: C=Deblocking Codes
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;A=$00 if no error occurred</td></tr>
<tr><td valign="top">&nbsp;A=$01 if physical error occurred</td></tr>
<tr><td valign="top">&nbsp;A=$02 if disk is Read-Only</td></tr>
<tr><td valign="top">&nbsp;A=$ff if media has changed
</td></tr></table>

<P>
Write the data from the currently selected DMA address to the
currently selected drive, track, and sector. Upon each call to WRITE,
the BDOS provides the following information in register C:
<table width="90%"><tr><td valign="top">&nbsp;0 = deferred write</td></tr>
<tr><td valign="top">&nbsp;1 = nondeferred write</td></tr>
<tr><td valign="top">&nbsp;2 = deferred write to the first sector of a new data block
</td></tr></table>

<P>
This information is provided for those BIOS implementations that do
blocking/deblocking in the BIOS instead of the BDOS.

<P>
<A NAME="3939"></A>
BIOS Function 16: SECTRN

<P>
Translate Sector Number Given Translate Table
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;BC=Logical Sector Number</td></tr>
<tr><td valign="top">&nbsp;DE=Translate Table Address
</td></tr></table>

Returned Values: HL=Physical Sector Number

<P>
SECTRN performs logical sequential sector address to physical sector
translation to improve the overall response of CP/M 3.

<P>
<A NAME="3942"></A>
BIOS Function 23: MULTIO

<P>
Set Count of Consecutive Sectors for READ or WRITE
<BR>
Entry Parameters: C=Multisector Count
<BR>
Returned Values: None

<P>
To transfer logically consecutive disk sectors to or from contiguous
memory locations, the BDOS issues a MULTIO call, followed by a series
of READ or WRITE calls. This allows the BIOS to transfer multiple
sectors in a single disk operation. The maximum value of the sector
count is dependent on the physical sector size, ranging from 128 with
128-byte sectors, to 4 with 4096-byte sectors. Thus, the BIOS can
transfer up to 16K directly to or from the TPA with a single
operation.

<P>
<A NAME="3943"></A>
BIOS Function 24: FLUSH

<P>
Force Physical Buffer Flushing for User-supported Deblocking
<BR>
Entry Parameters: None
<BR>
Returned Values:
<table width="90%"><tr><td valign="top">&nbsp;A=$00 if no error occurred</td></tr>
<tr><td valign="top">&nbsp;A=$001 if physical error occurred</td></tr>
<tr><td valign="top">&nbsp;A=$002 if disk is Read-Only
</td></tr></table>

<P>
The flush buffers entry point allows the system to force physical
sector buffer flushing when your BIOS is performing its own record
blocking and deblocking.  The BDOS calls the FLUSH routine to ensure
that no dirty buffers remain in memory.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node144.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node140.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node142.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1193"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1195"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node144.html">Memory Select and Move</A>
<B> Up:</B> <A
 HREF="node140.html">BIOS</A>
<B> Previous:</B> <A
 HREF="node142.html">Character I/O Functions</A>
 &nbsp; <B>  <A ID="tex2html1194"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1196"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node144.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Memory Select and Move Functions</TITLE>
<META NAME="description" CONTENT="Memory Select and Move Functions">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node140.html">
<LINK REL="next" HREF="node145.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node145.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node143.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1197"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1199"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node145.html">Clock Support Function</A>
<B> Up:</B> <A
 HREF="node137.html">CP/M</A>
<B> Previous:</B> <A
 HREF="node143.html">Disk I/O Functions</A>
 &nbsp; <B>  <A ID="tex2html1198"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1200"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001114000000000000000">
Memory Select and Move Functions</A>
</H2>
This section defines the memory management functions MOVE, XMOVE,
SELMEM, and SETBNK.

<P>
<A NAME="3947"></A>
BIOS Function 25: MOVE

<P>
Memory-to-Memory Block Move
<BR>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;HL=Destination address</td></tr>
<tr><td valign="top">&nbsp;DE=Source address</td></tr>
<tr><td valign="top">&nbsp;BC=Count
</td></tr></table>

Returned Values: HL and DE must point to next bytes following move
operation

<P>
The BDOS calls the MOVE routine to perform memory to memory block
moves to allow use of the Z80 LDIR instruction or special DMA
hardware, if available. Note that the arguments in HL and DE are
reversed from the Z8O machine instruction, necessitating the use of
XCHG instructions on either side of the LDIR. The BDOS uses this
routine for all large memory copy operations. On return, the HL and DE
registers are expected to point to the next bytes following the move.

<P>
Usually, the BDOS expects MOVE to transfer data within the currently
selected bank or common memory. However, if the BDOS calls the XMOVE
entry point before calling MOVE, the MOVE routine must perform an
interbank transfer.

<P>
<A NAME="3950"></A>
BIOS Function 27: SELMEM

<P>
Select Memory Bank
<BR>
Entry Parameters: A=Memory Bank
<BR>
Returned Values; None

<P>
The SELMEM entry point is only present in banked systems. The banked
version of the CP/M 3 BDOS calls SELMEM to select the current memory
bank for further instruction execution or buffer references. You must
preserve or restore all registers other than the accumulator, A, upon
exit.

<P>
<A NAME="3951"></A>
BIOS Function 28: SETBNK

<P>
Specify Bank for DMA Operation
<BR>
Entry Parameters: A=Memory Bank
<BR>
Returned Values: None

<P>
SETBNK only occurs in the banked version of CP/M 3. SETBNK specifies
the bank that the subsequent disk READ or WRITE routine must use for
memory transfers. The BDOS always makes a call to SETBNK to identify
the DMA bank before performing a READ or WRITE call. Note that the
BDOS does not reference banks other than 0 or 1 unless another bank is
specified by the BANK field of a Data Buffer Control Block (BCB).

<P>
<A NAME="3952"></A>
BIOS Function 29: XMOVE

<P>
Set Banks for Following MOVE
<BR>
Entry Parameters:
<table width="90%"><tr><td valign="top">&nbsp;B=destination bank</td></tr>
<tr><td valign="top">&nbsp;C=source bank
</td></tr></table>

Returned Values: None

<P>
XMOVE is provided for banked systems that support memory-to- memory
DMA transfers over the entire extended address range. Systems with
this feature can have their data buffers located in an alternate bank
instead of in common memory, as is usually required. An XMOVE call
affects only the following MOVE call. All subsequent MOVE calls apply
to the memory selected by the latest call to SELMEM. After a call to
the XMOVE function, the following call to the MOVE function is not
more than 128 bytes of data.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Clock Support Function " LINK NODE145}
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node145.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node137.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node143.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1197"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1199"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node145.html">Clock Support Function</A>
<B> Up:</B> <A
 HREF="node137.html">CP/M</A>
<B> Previous:</B> <A
 HREF="node143.html">Disk I/O Functions</A>
 &nbsp; <B>  <A ID="tex2html1198"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1200"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node145.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Clock Support Function</TITLE>
<META NAME="description" CONTENT="Clock Support Function">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node144.html">
<LINK REL="next" HREF="node146.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node146.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node144.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node144.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1202"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1204"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node146.html">NextZXOS</A>
<B> Up:</B> <A
 HREF="node144.html">Memory Select and Move</A>
<B> Previous:</B> <A
 HREF="node144.html">Memory Select and Move</A>
 &nbsp; <B>  <A ID="tex2html1203"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1205"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION001114100000000000000">
Clock Support Function</A>
</H3>
This section defines the clock support function TIME.

<P>
<A NAME="3956"></A>
BIOS Function 26: TIME

<P>
Get and Set Time
<BR>
Entry Parameters: C=Time Get/Set Flag
<BR>
Returned values: None

<P>
The BDOS calls the TIME function to indicate to the BIOS whether it
has just set the Time and Date fields in the SCB, or whether the BDOS
is about to get the Time and Date from the SCB. On entry to the TIME
function, a zero in register C indicates that the BIOS should update
the Time and Date fields in the SCB. A $ff in register C indicates
that the BDOS has just set the Time and Date in the SCB and the BIOS
should update its clock. Upon exit, you must restore register pairs HL
and DE to their entry values.
<BR><HR>

</BODY>
</HTML>
node146.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>NextZXOS</TITLE>
<META NAME="description" CONTENT="NextZXOS">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node147.html">
<LINK REL="previous" HREF="node137.html">
<LINK REL="next" HREF="node147.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node147.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node136.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node145.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1206"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1208"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Up:</B> <A
 HREF="node136.html">System Software</A>
<B> Previous:</B> <A
 HREF="node145.html">Clock Support Function</A>
 &nbsp; <B>  <A ID="tex2html1207"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1209"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001120000000000000000">
NextZXOS</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node147.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>NextZXOS</TITLE>
<META NAME="description" CONTENT="NextZXOS">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node146.html">
<LINK REL="next" HREF="node148.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node148.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node136.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node146.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1210"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1212"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node148.html">+3DOS compatible API</A>
<B> Up:</B> <A
 HREF="node136.html">System Software</A>
<B> Previous:</B> <A
 HREF="node146.html">NextZXOS</A>
 &nbsp; <B>  <A ID="tex2html1211"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1213"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001130000000000000000">
NextZXOS</A>
</H1>
A ZX Spectrum I/O system supported by the ZX Spectrum Next. This
Documentation is largely from Garry Lancaster's DOCs at
https://gitlab.com/thesmog358/tbblue/blob/master/docs/nextzxos/NextZXOS_and_esxDOS_APIs.pdf. Before
making any calls disable writes to Layer 2 in the $0000-$3fff area with port $123b.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" +3DOS compatible API " LINK NODE148}
@{" esxDOS compatible API " LINK NODE149}
@{" Next Extensions " LINK NODE150}
@{" esxDOS compatible API " LINK NODE151}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node148.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>+3DOS compatible API</TITLE>
<META NAME="description" CONTENT="+3DOS compatible API">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node149.html">
<LINK REL="previous" HREF="node147.html">
<LINK REL="next" HREF="node149.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node149.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1218"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1220"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node149.html">esxDOS compatible API</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node147.html">NextZXOS</A>
 &nbsp; <B>  <A ID="tex2html1219"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1221"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001131000000000000000">
+3DOS compatible API</A>
</H2>
Generally to make these calls, you need to set up: place ROM 2 at
$0000-$3fff, RAM bank 7 at $c000-$ffff, stack below $bfe0, and
set up the parameters for the call in the indicated registers. Call
the function at its address. Then, restore your system to its previous
configuration. In general the carry bit of F is cleared on error with
the error code in A. Calls generally affect the contnts of AF, BC, DE,
HL, and IX leaving AF', BC', DE', HL', IY, and SP intact. To simplify,
descriptions will assume this is true and only indicate exceptions to
the rule.

<P>
$0056 <SPAN  CLASS="textbf">IDE_STREAM_OPEN</SPAN>

<P>
Open stream to a channel

<P>
$0059 <SPAN  CLASS="textbf">IDE_STREAM_CLOSE</SPAN>

<P>
Close stream and attached channel

<P>
$005c <SPAN  CLASS="textbf">IDE_STREAM_IN</SPAN>

<P>
Get byte from current stream

<P>
$005f <SPAN  CLASS="textbf">IDE_STREAM_OUT</SPAN>

<P>
Write byte to current stream

<P>
$0062 <SPAN  CLASS="textbf">IDE_STREAM_PTR</SPAN>

<P>
Get or set pointer information for current stream

<P>
$00A0 <SPAN  CLASS="textbf">IDE_VERSION</SPAN>

<P>
Get IDEDOS version number

<P>
$00A3 <SPAN  CLASS="textbf">IDE_INTERFACE</SPAN>

<P>
Initialise card interfaces

<P>
$00A6 <SPAN  CLASS="textbf">IDE_INIT</SPAN>

<P>
Initialise IDEDOS

<P>
$00A9 <SPAN  CLASS="textbf">IDE_DRIVE</SPAN>

<P>
Get unit handle

<P>
$00AC <SPAN  CLASS="textbf">IDE_SECTOR_READ</SPAN>

<P>
Low-level sector read

<P>
$00AF <SPAN  CLASS="textbf">IDE_SECTOR_WRITE</SPAN>

<P>
Low-level sector write

<P>
$00B2 <SPAN  CLASS="textbf">IDE_FORMAT</SPAN>

<P>
Format a partition

<P>
$00B5 <SPAN  CLASS="textbf">IDE_PARTITION_FIND</SPAN>

<P>
Find named partition

<P>
$00B8 <SPAN  CLASS="textbf">IDE_PARTITION_NEW</SPAN>

<P>
Create partition

<P>
$00BB <SPAN  CLASS="textbf">IDE_PARTITION_INIT</SPAN>

<P>
Initialise partition

<P>
$00BE <SPAN  CLASS="textbf">IDE_PARTITION_ERASE</SPAN>

<P>
Delete a partition

<P>
$00C1 <SPAN  CLASS="textbf">IDE_PARTITION_RENAME</SPAN>

<P>
Rename a partition

<P>
$00C4 <SPAN  CLASS="textbf">IDE_PARTITON_READ</SPAN>

<P>
Read a partition entry

<P>
$00C7 <SPAN  CLASS="textbf">IDE_PARTITION_WRITE</SPAN>

<P>
Write a partition entry

<P>
$00CA <SPAN  CLASS="textbf">IDE_PARTITION_WINFO</SPAN>

<P>
Write type-specific partition information

<P>
$00CD <SPAN  CLASS="textbf">IDE_PARTITION_OPEN</SPAN>

<P>
Open a partition

<P>
$00D0 <SPAN  CLASS="textbf">IDE_PARTITION_CLOSE</SPAN>

<P>
Close a partition

<P>
$00D3 <SPAN  CLASS="textbf">IDE_PARTITION_GETINFO</SPAN>

<P>
Get byte from type-specific partition information

<P>
$00D6 <SPAN  CLASS="textbf">IDE_PARTITION_SETINFO</SPAN>

<P>
Set byte in type-specific partition information

<P>
<A NAME="3984"></A>
$00D9 (217) <SPAN  CLASS="textbf">IDE_SWAP_OPEN</SPAN>

<P>
Open a swap partition (file)

<P>
$00DC <SPAN  CLASS="textbf">IDE_SWAP_CLOSE</SPAN>

<P>
Close a swap partition

<P>
$00DF <SPAN  CLASS="textbf">IDE_SWAP_OUT</SPAN>

<P>
Write block to swap partition

<P>
$00E2 <SPAN  CLASS="textbf">IDE_SWAP_IN</SPAN>

<P>
Read block from swap partition

<P>
<A NAME="3989"></A>
$00E5 (231) <SPAN  CLASS="textbf">IDE_SWAP_EX</SPAN>

<P>
Exchange block with swap partition

<P>
Deprecated, use IDE_SWAP_IN and IDE_SWAP_OUT

<P>
$00E8 <SPAN  CLASS="textbf">IDE_SWAP_POS</SPAN>

<P>
Get current block number in swap partition

<P>
$00EB <SPAN  CLASS="textbf">IDE_SWAP_MOVE</SPAN>

<P>
Set current block number in swap partition

<P>
$00EE <SPAN  CLASS="textbf">IDE_SWAP_RESIZE</SPAN>

<P>
Change block size of swap partition

<P>
<A NAME="3994"></A>
$00F1 (241) <SPAN  CLASS="textbf">IDE_DOS_MAP</SPAN>

<P>
Map drive to partition or physical device

<P>
<A NAME="3996"></A>
$00F4 (244) <SPAN  CLASS="textbf">IDE_DOS_UNMAP</SPAN>

<P>
Unmap drive

<P>
<A NAME="3998"></A>
$00F7 (247) <SPAN  CLASS="textbf">IDE_DOS_MAPPING</SPAN>

<P>
Get drive mapping

<P>
$00FA <SPAN  CLASS="textbf">IDE_DOS_UNPERMANENT</SPAN>

<P>
Remove permanent drive mapping

<P>
<A NAME="4001"></A>
$00FD (253) <SPAN  CLASS="textbf">IDE_SNAPLOAD</SPAN>

<P>
Load a snapshot

<P>
$0100 <SPAN  CLASS="textbf">DOS_INITIALISE</SPAN>

<P>
Initialise +3DOS

<P>
$0103 <SPAN  CLASS="textbf">DOS_VERSION</SPAN>

<P>
Get +3DOS issue and version numbers

<P>
<A NAME="4005"></A>
$0106 (262) <SPAN  CLASS="textbf">DOS_OPEN</SPAN>

<P>
Create and/or open a file

<P>
$0109 <SPAN  CLASS="textbf">DOS_CLOSE</SPAN>

<P>
Close a file

<P>
$010C <SPAN  CLASS="textbf">DOS_ABANDON</SPAN>

<P>
Abandon a file

<P>
$010F <SPAN  CLASS="textbf">DOS_REF_HEAD</SPAN>

<P>
Point at the header data for this file

<P>
$0112 <SPAN  CLASS="textbf">DOS_READ</SPAN>

<P>
Read bytes into memory

<P>
$0115 <SPAN  CLASS="textbf">DOS_WRITE</SPAN>

<P>
Write bytes from memory

<P>
$0118 <SPAN  CLASS="textbf">DOS_BYTE_READ</SPAN>

<P>
Read a byte

<P>
$011B <SPAN  CLASS="textbf">DOS_BYTE_WRITE</SPAN>

<P>
Write a byte

<P>
<A NAME="4014"></A>
$011E (286) <SPAN  CLASS="textbf">DOS_CATALOG</SPAN>

<P>
Catalog disk directory

<P>
<A NAME="4016"></A>
$0121 (289) <SPAN  CLASS="textbf">DOS_FREE_SPACE</SPAN>

<P>
Free space on disk

<P>
$0124 <SPAN  CLASS="textbf">DOS_DELETE</SPAN>

<P>
Delete a file

<P>
$0127 <SPAN  CLASS="textbf">DOS_RENAME</SPAN>

<P>
Rename a file

<P>
$012A <SPAN  CLASS="textbf">DOS_BOOT</SPAN>

<P>
Boot an operating system or other program

<P>
$012D <SPAN  CLASS="textbf">DOS_SET_DRIVE</SPAN>

<P>
Set/get default drive

<P>
$0130 <SPAN  CLASS="textbf">DOS_SET_USER</SPAN>

<P>
Set/get default user number

<P>
<A NAME="4023"></A>
$0133 (307) <SPAN  CLASS="textbf">DOS_GET_POSITION</SPAN>

<P>
Get file pointer for random access

<P>
$0136 <SPAN  CLASS="textbf">DOS_SET_POSITION</SPAN>

<P>
Set file pointer for random access

<P>
<A NAME="4026"></A>
$0139 (313) <SPAN  CLASS="textbf">DOS_GET_EOF</SPAN>

<P>
Get end of file position for random access

<P>
$013C <SPAN  CLASS="textbf">DOS_GET_1346</SPAN>

<P>
Get memory usage in pages 1&nbsp; 3&nbsp; 4&nbsp; 6

<P>
$013F <SPAN  CLASS="textbf">DOS_SET_1346</SPAN>

<P>
Re-allocate memory usage in pages 1&nbsp; 3&nbsp; 4&nbsp; 6

<P>
$0142 <SPAN  CLASS="textbf">DOS_FLUSH</SPAN>

<P>
Bring disk up to date

<P>
$0145 <SPAN  CLASS="textbf">DOS_SET_ACCESS</SPAN>

<P>
Change open file's access mode

<P>
$0148 <SPAN  CLASS="textbf">DOS_SET_ATTRIBUTES</SPAN>

<P>
Change a file's attributes

<P>
$014B <SPAN  CLASS="textbf">DOS_OPEN_DRIVE</SPAN>

<P>
Open a drive as a single file

<P>
$014E <SPAN  CLASS="textbf">DOS_SET_MESSAGE</SPAN>

<P>
Enable/disable error messages

<P>
$0151 <SPAN  CLASS="textbf">DOS_REF_XDPB</SPAN>

<P>
Point at XDPB for low level disk access

<P>
$0154 <SPAN  CLASS="textbf">DOS_MAP_B</SPAN>

<P>
Map B: onto unit 0 or 1

<P>
$0157 <SPAN  CLASS="textbf">DD_INTERFACE</SPAN>

<P>
Is the floppy disk driver interface present?

<P>
$015A <SPAN  CLASS="textbf">DD_INIT</SPAN>

<P>
Initialise disk driver

<P>
$015D <SPAN  CLASS="textbf">DD_SETUP</SPAN>

<P>
Specify drive parameters

<P>
$0160 <SPAN  CLASS="textbf">DD_SET_RETRY</SPAN>

<P>
Set try/retry count

<P>
$0163 <SPAN  CLASS="textbf">DD_READ_SECTOR</SPAN>

<P>
Read a sector

<P>
$0166 <SPAN  CLASS="textbf">DD_WRITE_SECTOR</SPAN>

<P>
Write a sector

<P>
$0169 <SPAN  CLASS="textbf">DD_CHECK_SECTOR</SPAN>

<P>
Check a sector

<P>
$016C <SPAN  CLASS="textbf">DD_FORMAT</SPAN>

<P>
Format a track

<P>
$016F <SPAN  CLASS="textbf">DD_READ_ID</SPAN>

<P>
Read a sector identifier

<P>
$0172 <SPAN  CLASS="textbf">DD_TEST_UNSUITABLE</SPAN>

<P>
Test media suitability

<P>
$0175 <SPAN  CLASS="textbf">DD_LOGIN</SPAN>

<P>
Log in disk, initialise XDPB

<P>
$0178 <SPAN  CLASS="textbf">DD_SEL_FORMAT</SPAN>

<P>
Pre-initialise XDPB for DD FORMAT

<P>
$017B <SPAN  CLASS="textbf">DD_ASK_1</SPAN>

<P>
Is unit 1 (external drive) present?

<P>
$017E <SPAN  CLASS="textbf">DD_DRIVE_STATUS</SPAN>

<P>
Fetch drive status

<P>
$0181 <SPAN  CLASS="textbf">DD_EQUIPMENT</SPAN>

<P>
What type of drive?

<P>
$0184 <SPAN  CLASS="textbf">DD_ENCODE</SPAN>

<P>
Set intercept routine for copy protection

<P>
$0187 <SPAN  CLASS="textbf">DD_L_XDPB</SPAN>

<P>
Initialise an XDPB from a disk specification

<P>
$018A <SPAN  CLASS="textbf">DD_L_DPB</SPAN>

<P>
Initialise a DPB from a disk specification

<P>
$018D <SPAN  CLASS="textbf">DD_L_SEEK</SPAN>

<P>
uPD765A seek driver

<P>
$0190 <SPAN  CLASS="textbf">DD_L_READ</SPAN>

<P>
uPD765A read driver

<P>
$0193 <SPAN  CLASS="textbf">DD_L_WRITE</SPAN>

<P>
uPD765A write driver

<P>
$0196 <SPAN  CLASS="textbf">DD_L_ON_MOTOR</SPAN>

<P>
Motor on, wait for motor-on time

<P>
$0199 <SPAN  CLASS="textbf">DD_L_T_OFF_MOTOR</SPAN>

<P>
Start the motor-off ticker

<P>
$019C <SPAN  CLASS="textbf">DD_L_OFF_MOTOR</SPAN>

<P>
Turn the motor off

<P>
$01a2 <SPAN  CLASS="textbf">IDE_IDENTIFY</SPAN>

<P>
Return IDE drive identity information

<P>
$01a5 <SPAN  CLASS="textbf">IDE_PARTITIONS</SPAN>

<P>
Get number of open partitions

<P>
<A NAME="4063"></A>
$01b1 (433) <SPAN  CLASS="textbf">IDE_PATH</SPAN>

<P>
Create, delete, change or get directory

<P>
<A NAME="4065"></A>
$01b4 (436) <SPAN  CLASS="textbf">IDE_CAPACITY</SPAN>

<P>
Get card capacity

<P>
<A NAME="4067"></A>
$01b7 (439) <SPAN  CLASS="textbf">IDE_GET_LFN</SPAN>

<P>
Get long filename

<P>
Obtain a long file name and other file information.

<P>
<A NAME="4069"></A>
$01ba (442) <SPAN  CLASS="textbf">IDE_BROWSER</SPAN>

<P>
File browser

<P>
<A NAME="4071"></A>
$01bd (445) <SPAN  CLASS="textbf">IDE_BANK</SPAN>

<P>
Allocate or free 8K pages in ZX or DivMMC memory

<P>
$01c0 <SPAN  CLASS="textbf">IDE_BASIC</SPAN>

<P>
Execute a BASIC command line

<P>
$01c3 <SPAN  CLASS="textbf">IDE_WINDOW_LINEIN</SPAN>

<P>
Input line from current window stream

<P>
$01c6 <SPAN  CLASS="textbf">IDE_WINDOW_STRING</SPAN>

<P>
Output string to current window stream

<P>
$01c9 <SPAN  CLASS="textbf">IDE_INTEGER_VAR</SPAN>

<P>
Get or set NextBASIC integer variable

<P>
$01cc <SPAN  CLASS="textbf">IDE_RTC</SPAN>

<P>
Query the real-time-clock module

<P>
$01cf <SPAN  CLASS="textbf">IDE_DRIVER</SPAN>

<P>
Access the driver API

<P>
$01d2 <SPAN  CLASS="textbf">IDE_MOUNT</SPAN>

<P>
Unmount/remount SD cards

<P>
$01d2 <SPAN  CLASS="textbf">IDE_MOUNT</SPAN>

<P>
Unmount/remount SD cards

<P>
$01d5 <SPAN  CLASS="textbf">IDE_MODE</SPAN>

<P>
Query NextBASIC display mode info, or change mode

<P>
$01d8 <SPAN  CLASS="textbf">IDE_TOKENISER</SPAN>

<P>
Convert BASIC between plain text &amp; tokenised forms

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node149.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1218"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1220"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node149.html">esxDOS compatible API</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node147.html">NextZXOS</A>
 &nbsp; <B>  <A ID="tex2html1219"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1221"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node149.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>esxDOS compatible API</TITLE>
<META NAME="description" CONTENT="esxDOS compatible API">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node150.html">
<LINK REL="previous" HREF="node148.html">
<LINK REL="next" HREF="node150.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node150.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node148.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1222"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1224"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node150.html">Next Extensions</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node148.html">+3DOS compatible API</A>
 &nbsp; <B>  <A ID="tex2html1223"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1225"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001132000000000000000">
esxDOS compatible API</A>
</H2>

<P>
<BR><HR>

</BODY>
</HTML>
node150.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Next Extensions</TITLE>
<META NAME="description" CONTENT="Next Extensions">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node151.html">
<LINK REL="previous" HREF="node149.html">
<LINK REL="next" HREF="node151.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node151.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node149.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1226"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1228"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node151.html">esxDOS compatible API</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node149.html">esxDOS compatible API</A>
 &nbsp; <B>  <A ID="tex2html1227"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1229"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001133000000000000000">
Next Extensions</A>
</H2>

<P>
$0085 <SPAN  CLASS="textbf">DISK_FILEMAP</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img76.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_disk_filemap(uint8_t handle,struct esx_filemap *fmap)
\end{lstlisting}">
<BR>

<P>
Obtain a map of card addresses describing the space occupies by the
file. Can be called multiple times if the buffer is filled, continuing
from previous.

<P>
<SPAN  CLASS="textbf">DISK_STREAM_BYTES</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img77.svg"
 ALT="\begin{lstlisting}[language=C]
void *esx_disk_stream_bytes(void *dst,uint16_t len)
\end{lstlisting}">
<BR>

<P>
$0087 <SPAN  CLASS="textbf">DISK_STREAM_END</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img78.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_disk_stream_end(void)
\end{lstlisting}">
<BR>

<P>
Stop current streaming operation.

<P>
<SPAN  CLASS="textbf">DISK_STREAM_SECTORS</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img79.svg"
 ALT="\begin{lstlisting}[language=C]
void *esx_disk_stream_sectors(void *dst,uint8_t sectors)
\end{lstlisting}">
<BR>

<P>
$0086 <SPAN  CLASS="textbf">DISK_STREAM_START</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img80.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_disk_stream_start(struct esx_filemap_entry *entry)
\end{lstlisting}">
<BR>

<P>
Start reading from the card in streaming mode.

<P>
<SPAN  CLASS="textbf">DOS_CATALOG</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img81.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_dos_catalog(struct esx_cat *cat)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">DOS_CATALOG_NEXT</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img82.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_dos_catalog_next(struct esx_cat *cat)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">DOS_GETSET_DRIVE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img83.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_dos_get_drive(void)
unsigned char esx_dos_set_drive(unsigned char drive)
\end{lstlisting}">
<BR>

<P>
<BR><HR>

</BODY>
</HTML>
node151.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>esxDOS compatible API</TITLE>
<META NAME="description" CONTENT="esxDOS compatible API">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node150.html">
<LINK REL="next" HREF="node152.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node152.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node150.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1230"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1232"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node152.html">Ports</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node150.html">Next Extensions</A>
 &nbsp; <B>  <A ID="tex2html1231"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1233"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001134000000000000000">
esxDOS compatible API</A>
</H2>

<P>
The esxDOS-compatible API is a bit simpler to use than the
+3DOS-compatible API.

<P>
To make a call, you only need to set up the entry parameters as
indicated and perform a RST $08; DEFB hook_code. On return, registers
AF,BC,DE,HL will all be changed. IX,IY and the alternate registers are
never changed (except for M_P3DOS).

<P>
(Note that the standard 48K BASIC ROM must be paged in to the bottom
of memory, but this is the usual situation after starting a machine
code program with a USR function call).

<P>
Notice that error codes are different from those returned by +3DOS
calls, and also the carry flag is SET for an error condition when
returning from an esxDOS call (instead of RESET, as is the case for
+3DOS).

<P>
If desired, you can use the M_GETERR hook to generate a BASIC error
report for any error returned, or even use it to generate your own
custom BASIC error report.

<P>
All of the calls where a filename is specified will accept long
filenames (LFNs) and most will accept wildcards (for an operation such
as F_OPEN where a single file is always used, the first matching
filename will be used).

<P>
$00A9 <SPAN  CLASS="textbf">F_CHDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img84.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_chdir(unsigned char *pathname)
\end{lstlisting}">
<BR>

<P>
Change directory.

<P>
$00AF <SPAN  CLASS="textbf">F_CHMOD</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img85.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_chmod(unsigned char *filename, uint8_t attr_mask, uint8_t attr)
\end{lstlisting}">
<BR>

<P>
Modify file attributes.

<P>
$009B<SPAN  CLASS="textbf">F_CLOSE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img86.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_close(unsigned char handle)
\end{lstlisting}">
<BR>

<P>
Close a file or directory.

<P>
<SPAN  CLASS="textbf">F_CLOSEDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img87.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_closedir(unsigned char handle)
\end{lstlisting}">
<BR>

<P>
$00A0 <SPAN  CLASS="textbf">F_FGETPOS</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img88.svg"
 ALT="\begin{lstlisting}[language=C]
uint32_t esx_f_fgetpos(unsigned char handle)
\end{lstlisting}">
<BR>

<P>
Get current file position.

<P>
$00A1 <SPAN  CLASS="textbf">F_FSTAT</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img89.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_fstat(unsigned char handle, struct esx_stat *es)
\end{lstlisting}">
<BR>

<P>
Get file information/status.

<P>
$00A2 <SPAN  CLASS="textbf">F_FTRUNC</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img90.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_ftrunc(unsigned char handle, uint32_t size)
\end{lstlisting}">
<BR>

<P>
Truncate/extend file.

<P>
<SPAN  CLASS="textbf">F_GET_CANONICAL_PATH</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img91.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_get_canonical_path(char *pathname, char *canonical)
\end{lstlisting}">
<BR>

<P>
$00A8 <SPAN  CLASS="textbf">F_GETCWD</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img92.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_getcwd(unsigned char *buf)
\end{lstlisting}">
<BR>

<P>
Get current working directory.

<P>
<SPAN  CLASS="textbf">F_GETCWD_DRIVE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img93.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_getcwd_drive(unsigned char drive, char *buf)
\end{lstlisting}">
<BR>

<P>
$00B1 <SPAN  CLASS="textbf">F_GETFREE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img94.svg"
 ALT="\begin{lstlisting}[language=C]
uint32_t esx_f_getfree(void)
\end{lstlisting}">
<BR>

<P>
Gets free space on drive.

<P>
$00AA <SPAN  CLASS="textbf">F_MKDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img95.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_mkdir(unsigned char *pathname)
\end{lstlisting}">
<BR>

<P>
Create directory.

<P>
$009A <SPAN  CLASS="textbf">F_OPEN</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img96.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_open(unsigned char *filename,unsigned char mode)
\end{lstlisting}">
<BR>

<P>
Open a file.

<P>
$00A3 <SPAN  CLASS="textbf">F_OPENDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img97.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_opendir(unsigned char *dirnam...
...gned char esx_f_opendir_ex(unsigned char *dirname,uint8_t mode)
\end{lstlisting}">
<BR>

<P>
Open directory.

<P>
$009A <SPAN  CLASS="textbf">F_OPEN</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img98.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_open_p3(unsigned char *filename,unsigned char mode,struct esx_p3_hdr *h)
\end{lstlisting}">
<BR>

<P>
Open a file.

<P>
$009D <SPAN  CLASS="textbf">F_READ</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img99.svg"
 ALT="\begin{lstlisting}[language=C]
uint16_t esx_f_read(unsigned char handle, void *dst, size_t nbytes)
\end{lstlisting}">
<BR>

<P>
Read bytes from file.

<P>
$00A4 <SPAN  CLASS="textbf">F_READDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img100.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_readdir(unsigned char handle,struct esx_dirent *dirent)
\end{lstlisting}">
<BR>

<P>
Read next directory entry.

<P>
$00B0 <SPAN  CLASS="textbf">F_RENAME</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img101.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_rename(unsigned char *old, unsigned char *new)
\end{lstlisting}">
<BR>

<P>
Rename or move a file.

<P>
$00A7 <SPAN  CLASS="textbf">F_REWINDDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img102.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_rewinddir(unsigned char handle)
\end{lstlisting}">
<BR>

<P>
Rewind directory position to the start of the directory.

<P>
$00AB <SPAN  CLASS="textbf">F_RMDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img103.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_rmdir(unsigned char *pathname)
\end{lstlisting}">
<BR>

<P>
Remove directory.

<P>
$009F <SPAN  CLASS="textbf">F_SEEK</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img104.svg"
 ALT="\begin{lstlisting}[language=C]
uint32_t esx_f_seek(unsigned char handle, uint32_t distance, unsigned char whence)
\end{lstlisting}">
<BR>

<P>
Seek to position in file.

<P>
$00A6 <SPAN  CLASS="textbf">F_SEEKDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img105.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_seekdir(unsigned char handle,uint32_t pos)
\end{lstlisting}">
<BR>

<P>
Set current directory position.

<P>
$00AC <SPAN  CLASS="textbf">F_STAT</SPAN>

<P>
Get unopened file information/status.

<P>
$009C <SPAN  CLASS="textbf">F_SYNC</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img106.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_sync(unsigned char handle)
\end{lstlisting}">
<BR>

<P>
Sync file changes to disk.

<P>
$00A5 <SPAN  CLASS="textbf">F_TELLDIR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img107.svg"
 ALT="\begin{lstlisting}[language=C]
uint32_t esx_f_telldir(unsigned char handle)
\end{lstlisting}">
<BR>

<P>
Get current directory position.

<P>
$00AE <SPAN  CLASS="textbf">F_TRUNC</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img108.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_trunc(unsigned char *filename,uint32_t size)
\end{lstlisting}">
<BR>

<P>
Truncate/extend unopened file.

<P>
$00AD <SPAN  CLASS="textbf">F_UNLINK</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img109.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_f_unlink(unsigned char *filename)
\end{lstlisting}">
<BR>

<P>
Delete file.

<P>
$009E <SPAN  CLASS="textbf">F_WRITE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img110.svg"
 ALT="\begin{lstlisting}[language=C]
uint16_t esx_f_write(unsigned char handle, void *src, size_t nbytes)
\end{lstlisting}">
<BR>

<P>
Write bytes to file.

<P>
<SPAN  CLASS="textbf">IDE_BANK_ALLOC</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img111.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_bank_alloc(unsigned char banktype)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_BANK_AVAIL</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img112.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_bank_avail(unsigned char banktype)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_BANK_FREE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img113.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_bank_free(unsigned char banktype, unsigned char page)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_BANK_RESERVE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img114.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_bank_reserve(unsigned char banktype,unsigned char page)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_BANK_TOTAL</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img115.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_bank_total(unsigned char banktype)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_BROWSER</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img116.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_browser(uint8_t browsercaps, void *filetypes, char *help,char *dst_sfn, char *dst_lfn)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_GET_LFN</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img117.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_get_lfn(struct esx_lfn *dir, struct esx_cat_entry *query)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_MODE_GET</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img118.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_mode_get(struct esx_mode *mode)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">IDE_MODE_SET</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img119.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_ide_mode_set(struct esx_mode *mode)
\end{lstlisting}">
<BR>

<P>
$0088 <SPAN  CLASS="textbf">M_DOSVER</SPAN>

<P>
Get API version/mode information.

<P>
$0092 <SPAN  CLASS="textbf">M_DRVAPI</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img120.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_m_drvapi(struct esx_drvapi *)
\end{lstlisting}">
<BR>

<P>
Access API for installable drivers.

<P>
$0095 <SPAN  CLASS="textbf">M_ERRH</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img121.svg"
 ALT="\begin{lstlisting}[language=C]
void esx_m_errh(void (*handler)(uint8_t error))
\end{lstlisting}">
<BR>

<P>
Install error handler for dot command.
<BR>
<P>
$008F <SPAN  CLASS="textbf">M_EXECCMD</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img122.svg"
 ALT="\begin{lstlisting}[language=C]
uint16_t esx_m_execcmd(unsigned char *cmdline)
\end{lstlisting}">
<BR>

<P>
Execute a dot command.

<P>
$008E <SPAN  CLASS="textbf">M_GETDATE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img123.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_m_getdate(struct dos_tm *)
\end{lstlisting}">
<BR>

<P>
Get the current date/time.

<P>
$0093 <SPAN  CLASS="textbf">M_GETERR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img124.svg"
 ALT="\begin{lstlisting}[language=C]
void esx_m_geterr(uint16_t error,unsigned char *msg)
\end{lstlisting}">
<BR>

<P>
$008D <SPAN  CLASS="textbf">M_GETHANDLE</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img125.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_m_gethandle(void)
\end{lstlisting}">
<BR>

<P>
Get the file handle of the currently running dot command

<P>
$0089 <SPAN  CLASS="textbf">M_GETSETDRV</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img126.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_m_getdrv(void)
unsigned char esx_m_setdrv(unsigned char drive)
\end{lstlisting}">
<BR>

<P>
Get or set the default drive.

<P>
$0091 <SPAN  CLASS="textbf">M_SETCAPS</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img127.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_m_setcaps(unsigned char caps)
\end{lstlisting}">
<BR>

<P>
$008B <SPAN  CLASS="textbf">M_TAPEIN</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img128.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_m_tapein_close(void)
unsigned c...
...s(uint16_t block)
unsigned char esx_m_tapein_toggle_pause(void)
\end{lstlisting}">
<BR>

<P>
Tape input redirection control.

<P>
$008C <SPAN  CLASS="textbf">M_TAPEOUT</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img129.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char esx_m_tapeout_close(void)
unsigned ...
...ame)
unsigned char esx_m_tapeout_trunc(unsigned char *filename)
\end{lstlisting}">
<BR>

<P>
Tape output redirection control.

<P>
<SPAN  CLASS="textbf">SLICE_DIRENT</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img130.svg"
 ALT="\begin{lstlisting}[language=C]
struct esx_dirent_slice *esx_slice_dirent(struct esx_dirent *)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">EXTENDED_SNA_LOAD</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img131.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char extended_sna_load(unsigned char handle)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">P3DOS_COPY_CSTR_TO_PSTR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img132.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char *p3dos_copy_cstr_to_pstr(char *pdst, const char *csrc)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">P3DOS_COPY_PSTR_TO_CSTR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img133.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char *p3dos_copy_pstr_to_cstr(char *cdst, const char *psrc)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">P3DOS_CSTR_TO_PSTR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img134.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char *p3dos_cstr_to_pstr(unsigned char *s)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">P3DOS_DOSNAME_FROM_CATNAME</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img135.svg"
 ALT="\begin{lstlisting}[language=C]
char *p3dos_dosname_from_catname(char *dosname, char *catname)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">P3DOS_EDRV_FROM_PDRV</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img136.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char p3dos_edrv_from_pdrv(unsigned char pdrv)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">P3DOS_PDRV_FROM_EDRV</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img137.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char p3dos_pdrv_from_edrv(unsigned char edrv)
\end{lstlisting}">
<BR>

<P>
<SPAN  CLASS="textbf">P3DOS_PSTR_TO_CSTR</SPAN>

<P>
<BR>
<IMG STYLE=""
 SRC="img138.svg"
 ALT="\begin{lstlisting}[language=C]
unsigned char *p3dos_pstr_to_cstr(unsigned char *s)
\end{lstlisting}">
<BR>


<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node152.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node150.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1230"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1232"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node152.html">Ports</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node150.html">Next Extensions</A>
 &nbsp; <B>  <A ID="tex2html1231"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1233"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node152.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Ports</TITLE>
<META NAME="description" CONTENT="Ports">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node155.html">
<LINK REL="previous" HREF="node136.html">
<LINK REL="next" HREF="node153.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node153.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node151.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1234"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1236"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node153.html">8-bit</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node151.html">esxDOS compatible API</A>
 &nbsp; <B>  <A ID="tex2html1235"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1237"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001200000000000000000">
Ports</A>
</H1>

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="6610"></A>
<TABLE>
<CAPTION><STRONG>Table A.1:</STRONG>
ZX Spectrum Ports</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img139.svg"
 ALT="\begin{table}\centering\tiny
\csvautotabular{appendices/ports/ports.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" 8-bit " LINK NODE153}
@{" 16-bit " LINK NODE154}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node153.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>8-bit</TITLE>
<META NAME="description" CONTENT="8-bit">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node154.html">
<LINK REL="previous" HREF="node152.html">
<LINK REL="next" HREF="node154.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node154.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node152.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node152.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1240"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1242"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node154.html">16-bit</A>
<B> Up:</B> <A
 HREF="node152.html">Ports</A>
<B> Previous:</B> <A
 HREF="node152.html">Ports</A>
 &nbsp; <B>  <A ID="tex2html1241"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1243"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001210000000000000000">
8-bit</A>
</H1>
Port $6B (6B) DMA Control (Z80 Mode, 3.01.02)

<P>
Port $0F (0F) DAC B
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $1F (1F) Kempston/Mega Drive Joystick 1/DAC A
<BR>
Read
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = &rdquo;start&rdquo; button</td></tr>
<tr><td valign="top">&nbsp;bit 6 = A/X button</td></tr>
<tr><td valign="top">&nbsp;bit 5 = C/Z button</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Fire/C/Y button</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Up</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Down</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Left</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Right
</td></tr></table>

Disable with Nextreg $05
<BR>
Write
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08
Port $37 (37) Kempston/Mega Drive Joystick 2
<BR>
Read
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = &rdquo;start&rdquo; button</td></tr>
<tr><td valign="top">&nbsp;bit 6 = A/X button</td></tr>
<tr><td valign="top">&nbsp;bit 5 = C/Z button</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Fire/C/Y button</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Up</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Down</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Left</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Right
</td></tr></table>

Disable with Nextreg $05
<BR>
Write ($00 on reset, 3.01.04)
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = Select I/O Mode
  <table width="90%">  <tr><td valign="top">&nbsp;00 = Bit Bang
  </td></tr>
<tr><td valign="top">&nbsp;01 = Clock
  </td></tr>
<tr><td valign="top">&nbsp;10 = UART
  </td></tr>
<tr><td valign="top">&nbsp;11 = Reserved (don't use)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Select Joystick Port for Read
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Left
  </td></tr>
<tr><td valign="top">&nbsp;1 = Right
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bits 3-1 = Reserved, must be $00</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Pin 7 state (both ports)
  
<UL>
<LI>Bit Bang - bit 0 on pin 7
</LI>
<LI>Clock - clock on pin 7
<BR>
0 = Slow clock (Fsys/2048 = 12.672 kHz)
<BR>
1 = Fast clock (Fsys/8 = 3.5 MHz)
</LI>
<LI>UART - Pin 7 = TX, Pin 9 = RX
    0 = ESP
<BR>
1 = Pi
  
</LI>
</UL></td></tr></table>

** A Runt clock may appear in the first cycle
<BR>
The I/O mode should be set by writing this port first followed by
enabling io mo de on the joysticks with a write to nextreg 0x05.

<P>
Port $3F (3F) DAC A
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $4F (4F) DAC C
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $57 (57) Sprite Attributes
<BR>
Byte 1
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = LSB of X coordinate (bit 8 is in byte 3)
</td></tr></table>

Byte 2
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = LSB of Y coordinate (bit 8 is in byte 5)
</td></tr></table>

Byte 3
<table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Palette Offset</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Enable X Mirror</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Enable Y Mirror</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Enable Roration</td></tr>
<tr><td valign="top">&nbsp;bit 0 = By Sprite Type
  <table width="90%">  <tr><td valign="top">&nbsp;Anchor = MSB of X coordinate
  </td></tr>
<tr><td valign="top">&nbsp;Relative = Enable relative palette offset
  </td></tr></table>
</td></tr></table>

Byte 4
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Enable visibility</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Enable Byte 5</td></tr>
<tr><td valign="top">&nbsp;bit 5-0 = Pattern Index (&ldquo;name&rdquo;)
</td></tr></table>

Byte 5 (optional)
<BR>
Anchor
<table width="90%"><tr><td valign="top">&nbsp;bit 7-6 = type and pattern
  <table width="90%">  <tr><td valign="top">&nbsp;00 = 8-bit color
  </td></tr>
<tr><td valign="top">&nbsp;01 = relative
  </td></tr>
<tr><td valign="top">&nbsp;10 = 4-bit color, lower half of pattern (bytes 0-127)
  </td></tr>
<tr><td valign="top">&nbsp;11 = 4-bit color, upper half of pattern (byets 128-255)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Attached relative sprite type
  <table width="90%">  <tr><td valign="top">&nbsp;0 = composite
  </td></tr>
<tr><td valign="top">&nbsp;1 = big sprite
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 4-3 = X-axis scale factor
  <table width="90%">  <tr><td valign="top">&nbsp;00 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img37.svg"
 ALT="$1\times$"></SPAN>
  </td></tr>
<tr><td valign="top">&nbsp;01 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img34.svg"
 ALT="$2\times$"></SPAN> 
  </td></tr>
<tr><td valign="top">&nbsp;10 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img35.svg"
 ALT="$4\times$"></SPAN> 
  </td></tr>
<tr><td valign="top">&nbsp;11 = <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img36.svg"
 ALT="$8\times$"></SPAN></td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 2-1 = Y-axis scale factor</td></tr>
<tr><td valign="top">&nbsp;bit 0 = MSB of Y coordinate
</td></tr></table>

Composite Relative
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = 01</td></tr>
<tr><td valign="top">&nbsp;bit 5 = N6
<BR>
8-bit
  <table width="90%">  <tr><td valign="top">&nbsp;Reserved, must be 0
  </td></tr></table>

  4-bit
  <table width="90%">  <tr><td valign="top">&nbsp;0 = lower half of pattern (bytes 0-127)
  </td></tr>
<tr><td valign="top">&nbsp;1 = upper half of pattern (bytes 128-255)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 4-3 = X-axis scale factor</td></tr>
<tr><td valign="top">&nbsp;bit 2-1 = Y-axis scale factor</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Enable relative pattern offset
</td></tr></table>

Big-sprite Relative
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = 01</td></tr>
<tr><td valign="top">&nbsp;bit 5 = N6
<BR>
8-bit
  <table width="90%">  <tr><td valign="top">&nbsp;Reserved, must be 0
  </td></tr></table>

  4-bit
  <table width="90%">  <tr><td valign="top">&nbsp;0 = lower half of pattern (bytes 0-127)
  </td></tr>
<tr><td valign="top">&nbsp;1 = upper half of pattern (bytes 128-255)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 4-1 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Enable relative pattern offset
</td></tr></table>

<P>
Port $5B (5B) Sprite Pattern
<BR>
Load data into sprite pattern memory auto-incrementing. Port $303B
can be used to set the starting sprite pattern number.

<P>
Port $5F (5F) DAC D
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $6B (6B) DMA Control (Next Mode, 3.01.02)

<P>
Port $DF (DF) DAC A,D
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $E3 (E3) divMMC Control
<BR>
Disable with bit 2 of Nextreg $09
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = conmem, enable divMMC memory</td></tr>
<tr><td valign="top">&nbsp;bit 6 = mapram, enable divMMC allRAM mode</td></tr>
<tr><td valign="top">&nbsp;bits 3-0 = bank, selected divMMC ram bank for $2000-$3FFF region
conmem can be used to manually control divMMC mapping. When enabled
<BR>$0000-$1FFF contains esxDOS ROM or esxDOS page 3
<BR>$2000-$3FFF contains esxDOS RAM page selected by bits 3-0
divMMC automatically maps itself in when instruction fetches hit
specific addresses in the ROM. When this happens, the esxDOS ROM (or divMMC
bank 3 if mapram is set) appears in $0000-$1FFF and the selected divMMC
bank appears as RAM in $2000-$3FFF
bit 6 can only be set, once set only a power cycle can reset it.
nextreg $09 bit 3 can be set to reset this bit.
</td></tr></table>

divMMC automapping is normally disabled by NextZXOS see nextreg $06 bit 4.
<BR>
Port $E7 (E7) SPI <!-- MATH
 $\overline{\hbox{CS}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img56.svg"
 ALT="$\overline{\hbox{CS}}$"></SPAN> (SD card, flash, rpi)
<BR>
Disable with bit 2 of Nextreg $09

<P>
Port $EB (EB) SPI <!-- MATH
 $\overline{\hbox{DATA}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img57.svg"
 ALT="$\overline{\hbox{DATA}}$"></SPAN> (SD card, flash, rpi)
<BR>
Disable with bit 2 of Nextreg $09

<P>
Port $F1 (F1) DAC A (precedence over $xxFD)
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $F3 (F3) DAC B
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $F9 (F9) DAC C (precedence over $xxFD)
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $FB (FB) DAC A,D
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = DAC Value
</td></tr></table>

Disable with bit 3 of Nextreg $08

<P>
Port $FE (FE) ULA
<table width="90%"><tr><td valign="top">&nbsp;bits 7-5 = Unused</td></tr>
<tr><td valign="top">&nbsp;bit 4 = enable ear output </td></tr>
<tr><td valign="top">&nbsp;bit 3 = enable mic output</td></tr>
<tr><td valign="top">&nbsp;bit 2-0 = border colour 
</td></tr></table>

Port $FF (FF) Timex Sinclair/Floating Bus
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = memory paging (not on ZX Next)</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Disable generation of interrupts</td></tr>
<tr><td valign="top">&nbsp;bit 5-3 = Hi-res mode color combination
  <table width="90%">  <tr><td valign="top">&nbsp;000 = Black on white (indexes 0, 135)
  </td></tr>
<tr><td valign="top">&nbsp;001 = Blue on Yellow (indexes 1, 134)
  </td></tr>
<tr><td valign="top">&nbsp;010 = Green on Magenta (indexes 2, 133)
  </td></tr>
<tr><td valign="top">&nbsp;011 = Cyan on Red (indexes 3, 132)
  </td></tr>
<tr><td valign="top">&nbsp;100 = Red on Cyan (indexes 4, 131)
  </td></tr>
<tr><td valign="top">&nbsp;101 = Magenta on Green (indexes 5, 130)
  </td></tr>
<tr><td valign="top">&nbsp;110 = Yellow on Blue (indexes 6, 129)
  </td></tr>
<tr><td valign="top">&nbsp;111 = White on Black (indexes 7, 128)
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 2-0 = ULA Mode
  <table width="90%">  <tr><td valign="top">&nbsp;000 = Normal ULA address
  </td></tr>
<tr><td valign="top">&nbsp;001 = Alternate ULA address
  </td></tr>
<tr><td valign="top">&nbsp;010 = Hi-color mode 
  </td></tr>
<tr><td valign="top">&nbsp;110 = Hi-res mode
  </td></tr></table>
</td></tr></table>

Disable with bit 2 of Nextreg $08

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node154.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node152.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node152.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1240"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1242"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node154.html">16-bit</A>
<B> Up:</B> <A
 HREF="node152.html">Ports</A>
<B> Previous:</B> <A
 HREF="node152.html">Ports</A>
 &nbsp; <B>  <A ID="tex2html1241"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1243"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node154.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>16-bit</TITLE>
<META NAME="description" CONTENT="16-bit">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node153.html">
<LINK REL="next" HREF="node155.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node155.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node152.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node153.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1244"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1246"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node155.html">Registers</A>
<B> Up:</B> <A
 HREF="node152.html">Ports</A>
<B> Previous:</B> <A
 HREF="node153.html">8-bit</A>
 &nbsp; <B>  <A ID="tex2html1245"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1247"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001220000000000000000">
16-bit</A>
</H1>
Port $103B (103B)  I<SUP>2</SUP>C SCL (rtc, rpi)

<P>
Port $113B (113B)  I<SUP>2</SUP>C SDA (rtc, rpi)

<P>
Port $123B (123B) Layer 2
<BR>
Bit 4 = 0
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = Video RAM bank select
  <table width="90%">  <tr><td valign="top">&nbsp;00 = first 16k
  </td></tr>
<tr><td valign="top">&nbsp;01 = second 16k
  </td></tr>
<tr><td valign="top">&nbsp;10 = third 16k
  </td></tr>
<tr><td valign="top">&nbsp;11 = first 48k
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 4 = 0</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Shadow layer 2 select</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Enable layer 2 read paging</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Layer 2 visible (mirrored in register $69)</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Enable layer 2 write paging
</td></tr></table>

Bit 4 = 1
<table width="90%"><tr><td valign="top">&nbsp;bits 7-5 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 4 = 1</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bit 2-0 = 16k bank relative offset
</td></tr></table>

<P>
Port $133B (133B) UART tx
<BR>
Read: UART Status
<BR><table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bit 3 = UART at least half full (3.01.09)</td></tr>
<tr><td valign="top">&nbsp;bit 2 = UART full</td></tr>
<tr><td valign="top">&nbsp;bit 1 = UART transmit busy</td></tr>
<tr><td valign="top">&nbsp;bit 0 = UART receive has data
</td></tr></table>

Write: UART Transmit

<P>
Port $143B (143B) UART rx
<BR>
Read: UART Receive
<BR>
Write: UART Prescalar
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = select prescalar part
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Bits 6-0 of prescalar
  </td></tr>
<tr><td valign="top">&nbsp;1 = Bits 13-7 of prescalar
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bits 6-0 = Prescalar bits
</td></tr></table>

<P>
Port $153B (153B) UART select
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bit 6 = UART select (0 on soft reset) **
  <table width="90%">  <tr><td valign="top">&nbsp;0 = ESP
  </td></tr>
<tr><td valign="top">&nbsp;1 = Pi *
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Prescalar valid in this write</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Reserved (0)</td></tr>
<tr><td valign="top">&nbsp;bits 2-0 = Bits 16-14 of prescalar (0 on hard reset)
</td></tr></table>

* Pi GPIO must be configured for UART, see nextreg $A0
<BR>** Either UART can be redirected to the joystick ports, see port $037

<P>
Port $153B (153B) UART frame (upcoming)
<BR>($18 on hard reset)
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Immediately reset Rx and Tx to idle and empty FIFOs</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Assert break (Tx=0) when Tx reaches idle</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Enable hardware flow control *</td></tr>
<tr><td valign="top">&nbsp;bits 4-3 = Number of bits in a frame
  <table width="90%">  <tr><td valign="top">&nbsp;00 = 5 bits
  </td></tr>
<tr><td valign="top">&nbsp;01 = 6 bits
  </td></tr>
<tr><td valign="top">&nbsp;10 = 7 bits
  </td></tr>
<tr><td valign="top">&nbsp;11 = 8 bits
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Enable parity</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Parity
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Even parity
  </td></tr>
<tr><td valign="top">&nbsp;1 = Odd parity
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Number of stop bits
  <table width="90%">  <tr><td valign="top">&nbsp;0 = 1 stop bit
  </td></tr>
<tr><td valign="top">&nbsp;1 = 2 stop bits
  </td></tr></table>
</td></tr></table>

Port $183B (183B) CTC Channel 0
Port $193B (193B) CTC Channel 1
Port $1A3B (1A3B) CTC Channel 2
Port $1B3B (1B3B) CTC Channel 3
Port $1C3B (1C3B) CTC Channel 4
Port $1D3B (1D3B) CTC Channel 5
Port $1E3B (1E3B) CTC Channel 6
Port $183B (183B) CTC Channel 7
Port $1FFD (1FFD) Plus 3 Memory Paging Control
<table width="90%"><tr><td valign="top">&nbsp;bits 7-3 = Unused, nust be 0</td></tr>
<tr><td valign="top">&nbsp;bit 2 = High bit of ROM selection (low bit is in Port $7FFD)
  <table width="90%">  <tr><td valign="top">&nbsp;00 = ROM0 = 128k editor and menu system
  </td></tr>
<tr><td valign="top">&nbsp;01 = ROM1 = 128k syntax checker
  </td></tr>
<tr><td valign="top">&nbsp;10 = ROM2 = +3DOS
  </td></tr>
<tr><td valign="top">&nbsp;11 = ROM3 = 48k BASIC
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Special mode: Low bit of memory configuration number</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Paging mode
  <table width="90%">  <tr><td valign="top">&nbsp;0 = Normal
  </td></tr>
<tr><td valign="top">&nbsp;1 = Special
  </td></tr></table>
</td></tr></table>

You should echo writes to $5B67

<P>
Port $243B (243B) Next Register Select

<P>
Port $253B (253B) Next Register Data

<P>
Port $303B (303B) Sprite Slot/Flags
<BR>
Write: Sprite Slot Select
<BR>
select sprite slot for Sprite Attribute and Sprite Pattern ports which
independently auto-increment
<BR>
Read: Sprite status
<table width="90%"><tr><td valign="top">&nbsp;bits 7-2 = reserved</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Max sprites per line</td></tr>
<tr><td valign="top">&nbsp;bit 0 = Collision flag
</td></tr></table>

<P>
Port $7FFD (7FFD) Memory Paging Control
<table width="90%"><tr><td valign="top">&nbsp;bits 6-7 = reserved</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Lock memory paging</td></tr>
<tr><td valign="top">&nbsp;bit 4 = low bit of ROM Select (high bit is in Port $1FFD) 
  <table width="90%">  <tr><td valign="top">&nbsp;00 = ROM0 = 128k editor and menu system
  </td></tr>
<tr><td valign="top">&nbsp;01 = ROM1 = 128k syntax checker
  </td></tr>
<tr><td valign="top">&nbsp;10 = ROM2 = +3DOS
  </td></tr>
<tr><td valign="top">&nbsp;11 = ROM3 = 48k BASIC
  </td></tr></table>
</td></tr>
<tr><td valign="top">&nbsp;bit 3 = Shadow screen toggle</td></tr>
<tr><td valign="top">&nbsp;bits 2-0 = LSB of Bank number for slot 4 (MSB is in Port $DFFD)
</td></tr></table>

Disable with bit 5 port $7FFD

<P>
Port $7FFE (7FFE) Keyboard 8 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0: 'B'</td></tr>
<tr><td valign="top">&nbsp;bit 1: 'N'</td></tr>
<tr><td valign="top">&nbsp;bit 2: 'M'</td></tr>
<tr><td valign="top">&nbsp;bit 3: Symbol Shift</td></tr>
<tr><td valign="top">&nbsp;bit 4: Space
</td></tr></table>

<P>
Port $BF3B (BF3B) ULAplus register
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = Select register group

<UL>
<LI>00 = palette group
</LI>
<LI>01 = mode group
</LI>
</UL></td></tr>
<tr><td valign="top">&nbsp;bits 5-0 = data
<table width="90%"><tr><td valign="top">&nbsp;If palette group, selects index 0-63 in ULAplus palette</td></tr>
<tr><td valign="top">&nbsp;If mode group, ignored
</td></tr></table>
</td></tr></table>

<P>
Port $BFF5 (BFF5) AY Info (3.01.09
<BR>(R)
<table width="90%"><tr><td valign="top">&nbsp;bits 7-6 = Active AY chip

<UL>
<LI>01 = AY 0 active
</LI>
<LI>10 = AY 1 active
</LI>
<LI>11 = AY 2 active
</LI>
</UL></td></tr>
<tr><td valign="top">&nbsp;bit 5 = Reserved</td></tr>
<tr><td valign="top">&nbsp;bits 4-0 = currently selected AY register
</td></tr></table>

Port $BFFD (BFFD) AY Data

<P>
Port $BFFE (BFFE) Keyboard 7 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0 = 'H'</td></tr>
<tr><td valign="top">&nbsp;bit 1 = 'J'</td></tr>
<tr><td valign="top">&nbsp;bit 2 = 'K'</td></tr>
<tr><td valign="top">&nbsp;bit 3 = 'L'</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Enter
</td></tr></table>

<P>
Port $DFFD (DFFD) Next Memory Bank Select
<table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bits 3-0 = MSB of bank number for slot 4 (LSB is in Port $7FFD)
</td></tr></table>

<P>
Port $DFFE (DFFE) Keyboard 6 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0 = 'Y'</td></tr>
<tr><td valign="top">&nbsp;bit 1 = 'U'</td></tr>
<tr><td valign="top">&nbsp;bit 2 = 'I'</td></tr>
<tr><td valign="top">&nbsp;bit 3 = 'O'</td></tr>
<tr><td valign="top">&nbsp;bit 4 = 'P'
</td></tr></table>

<P>
Port $EFF7 (EFF7) Pentagon 1024 paging
<table width="90%"><tr><td valign="top">&nbsp;bit 3 = 1 to overlay the bottom 16k with ram from 16k bank 0</td></tr>
<tr><td valign="top">&nbsp;bit 2 = 0 to enable Pentagon 1024 mapping and disable bit 5 port
0x7ffd locking, 1 to select standard zx128 mapping **</td></tr>
<tr><td valign="top">&nbsp;** Applies only when pentagon 1024 mapping mode is enabled via
nextreg 0x8f.
</td></tr></table>

<P>
Port $EFFE (EFFE) Keyboard 5 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0 = ‘6’</td></tr>
<tr><td valign="top">&nbsp;bit 1 = ‘7’</td></tr>
<tr><td valign="top">&nbsp;bit 2 = ‘8’</td></tr>
<tr><td valign="top">&nbsp;bit 3 = ‘9’</td></tr>
<tr><td valign="top">&nbsp;bit 4 = ‘0’
</td></tr></table>

<P>
Port $F7FE (F7FE) Keyboard 4 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0 = ‘5’</td></tr>
<tr><td valign="top">&nbsp;bit 1 = ‘4’</td></tr>
<tr><td valign="top">&nbsp;bit 2 = ‘3’</td></tr>
<tr><td valign="top">&nbsp;bit 3 = ‘2’</td></tr>
<tr><td valign="top">&nbsp;bit 4 = ‘1’
</td></tr></table>

<P>
Port $FADF (FADF) Kempston Mouse Buttons
<table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Wheel delta since last read</td></tr>
<tr><td valign="top">&nbsp;bit 3 = fourth button</td></tr>
<tr><td valign="top">&nbsp;bit 2 = middle button</td></tr>
<tr><td valign="top">&nbsp;bit 1 = left button</td></tr>
<tr><td valign="top">&nbsp;bit 0 = right button
</td></tr></table>

<P>
Port $FBDF (FBDF) Kempston Mouse X
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = X coordinate of mouse
</td></tr></table>

<P>
Port $FBFE (FBFE) Keyboard 3 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0 = ‘T’</td></tr>
<tr><td valign="top">&nbsp;bit 1 = ‘R’</td></tr>
<tr><td valign="top">&nbsp;bit 2 = ‘E’</td></tr>
<tr><td valign="top">&nbsp;bit 3 = ‘W’</td></tr>
<tr><td valign="top">&nbsp;bit 4 = ‘Q’
</td></tr></table>

<P>
Port $FDFE (FDFE) Keyboard 2 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0 = ‘G’</td></tr>
<tr><td valign="top">&nbsp;bit 1 = ‘F’</td></tr>
<tr><td valign="top">&nbsp;bit 2 = ‘D’</td></tr>
<tr><td valign="top">&nbsp;bit 3 = ‘S’</td></tr>
<tr><td valign="top">&nbsp;bit 4 = ‘A’
</td></tr></table>

<P>
Port $FEFE (FEFE) Keyboard 1 (read only)
<table width="90%"><tr><td valign="top">&nbsp;bit 0 = ‘V’</td></tr>
<tr><td valign="top">&nbsp;bit 1 = ‘C’</td></tr>
<tr><td valign="top">&nbsp;bit 2 = ‘X’</td></tr>
<tr><td valign="top">&nbsp;bit 3 = ‘Z’</td></tr>
<tr><td valign="top">&nbsp;bit 4 = Caps Shift
</td></tr></table>

<P>
Port $FF3B (FF3B) ULAplus data
<table width="90%"><tr><td valign="top">&nbsp;If palette group, 8-bit (RRRGGGBB) value for current index</td></tr>
<tr><td valign="top">&nbsp;If mode group, bit 1 = enable ULAplus
</td></tr></table>

<P>
Port $FFDF (FFDF) Kempston Mouse Y
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = Y coordinate of mouse (0-192)
</td></tr></table>

<P>
Port $FFFD (FFFD) AY Control and AY register Select (3.01.09)
<BR>
Read
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = data in selected register of active AY chip
</td></tr></table>

Select Chip
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = 1</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Enable left</td></tr>
<tr><td valign="top">&nbsp;bit 5 = Enable Right</td></tr>
<tr><td valign="top">&nbsp;bits 4-2 = Reserved, must be 1</td></tr>
<tr><td valign="top">&nbsp;bits 1-0 = AY chip select
  <table width="90%">  <tr><td valign="top">&nbsp;00 = Unused
  </td></tr>
<tr><td valign="top">&nbsp;01 = AY 2
  </td></tr>
<tr><td valign="top">&nbsp;10 = AY 1
  </td></tr>
<tr><td valign="top">&nbsp;11 = AY 0
  </td></tr></table>
</td></tr></table>

Select Register
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = 0</td></tr>
<tr><td valign="top">&nbsp;bits 6-5 = Reserved, must be 0</td></tr>
<tr><td valign="top">&nbsp;bits 4-0 = Register Number
</td></tr></table>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node155.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node152.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node153.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1244"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1246"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node155.html">Registers</A>
<B> Up:</B> <A
 HREF="node152.html">Ports</A>
<B> Previous:</B> <A
 HREF="node153.html">8-bit</A>
 &nbsp; <B>  <A ID="tex2html1245"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1247"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node155.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Registers</TITLE>
<META NAME="description" CONTENT="Registers">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node159.html">
<LINK REL="previous" HREF="node152.html">
<LINK REL="next" HREF="node156.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node156.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node154.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1248"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1250"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node156.html">ZX Spectrum Next Registers</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node154.html">16-bit</A>
 &nbsp; <B>  <A ID="tex2html1249"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1251"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001300000000000000000">
Registers</A>
</H1>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" ZX Spectrum Next Registers " LINK NODE156}
@{" AY-3-8912 " LINK NODE157}
@{" zxDMA " LINK NODE158}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node156.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Spectrum Next Registers</TITLE>
<META NAME="description" CONTENT="ZX Spectrum Next Registers">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node157.html">
<LINK REL="previous" HREF="node155.html">
<LINK REL="next" HREF="node157.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node157.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node155.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node155.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1255"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1257"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node157.html">AY-3-8912</A>
<B> Up:</B> <A
 HREF="node155.html">Registers</A>
<B> Previous:</B> <A
 HREF="node155.html">Registers</A>
 &nbsp; <B>  <A ID="tex2html1256"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1258"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001310000000000000000">
ZX Spectrum Next Registers</A>
</H1>
The ZX Next stores configuration state in a field of registers. These
registers are accessible via two I/O ports or via the special nextreg
instructions.

<P>
Port $243B (9275) is used to set the register number, listed below.

<P>
Port $253B (9531) is used to access the register value.

<P>
Some registers are accessible only during the initialization process.

<P>
Register (R) $00 (00) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Machine ID

<UL>
<LI>00000001 = DE1A
</LI>
<LI>00000010 = DE2A
</LI>
<LI>00000101 = FBLABS
</LI>
<LI>00000110 = VTRUCCO
</LI>
<LI>00000111 = WXEDA
</LI>
<LI>00001000 = EMULATORS
</LI>
<LI>00001010 = ZX Spectrum Next
</LI>
<LI>00001011 = Multicore
</LI>
<LI>10101010 = ZX Spectrum Next Core on unAmiga
</LI>
<LI>10111010 = ZX Spectrum Next Core on SiDi
</LI>
<LI>11001010 = ZX Spectrum Next Core on MIST
</LI>
<LI>11011010 = ZX Spectrum Next Core on MiSTer
</LI>
<LI>11011010 = ZX Spectrum Next Core on unAmiga Reloaded
</LI>
<LI>11101010 = ZX Spectrum Next Core on ZX-DOS
</LI>
<LI>11111010 = ZX Spectrum Next Anti-brick
</LI>
</UL>
Register (R) $01 (01) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Core Version
<table width="90%">
bits 7-4 = Major version number
bits 3-0 = Minor version number<tr><td valign="top">&nbsp;See register $0E for sub minor version number
</td></tr></table>

<P>
Register (R/W) $02 (02) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Reset
<BR>
Read

<UL>
<LI>bit 7 = Expansion bus <!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN> Asserted
</LI>
<LI>bits 6-4 = Reserved
</LI>
<LI>bit 3 = Indicates multiface NMI was generated by this nextreg (3.01.09)
</LI>
<LI>bit 2 = Indicates divmmc NMI was generated by this nextreg (3.01.09)
</LI>
<LI>bit 1 = Last reset was Hard reset
</LI>
<LI>bit 0 = Last reset was Soft reset
</LI>
</UL>
Write

<UL>
<LI>bit 7 = Generate/Release Expansion bus <!-- MATH
 $\overline{\hbox{RESET}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img4.svg"
 ALT="$\overline {\hbox {RESET}}$"></SPAN>
</LI>
<LI>bits 6-4 = Reserved, must be 0
</LI>
<LI>bit 3 = Generate multiface NMI (write zero to clear)(3.01.09)
</LI>
<LI>bit 2 = Generate divmmc NMI (write zero to clear)(3.01.09)
</LI>
<LI>bit 1 = generate Hard reset (reboot)
</LI>
<LI>bit 0 = generate Soft reset
</LI>
</UL>

<P>
Register (R/W) $03 (03) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Machine Type
<BR>
A write to this register disables the boot rom in config mode
<BR>
bits 2-0 select machine type when in config mode
<table width="90%">
bit 7 = (W) Display Timing change enable (allow changes to
  bits 6-4) (0 on hard reset)
bits 6-4 = Display Timing
bit 3 = Display Timing user lock control
  <tr><td valign="top">&nbsp;Read
  
<UL>
<LI>0 = No user lock on display timing
</LI>
<LI>1 = User lock on display timing
  
</LI>
</UL>
  </td></tr>
<tr><td valign="top">&nbsp;Write
  
<UL>
<LI>1 = Apply user lock on display timing (0 on hard reset)
  
</LI>
</UL>
bits 2-0 = Machine Type (config mode only)
<BR>
determines roms loaded</td></tr>
<tr><td valign="top">&nbsp;Machine Types/Display Timings
  
<UL>
<LI>000 or 001 = ZX 48K
</LI>
<LI>010 = ZX 128K/+2 (Grey)
</LI>
<LI>011 = ZX +2A-B/+3e/Next Native
</LI>
<LI>100 = Pentagon 128K
  
</LI>
</UL></td></tr></table>

<P>
Register (W) $04 (04) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Configuration Mapping
<table width="90%">
bits 7 = Reserved, must be 0
bits 6-0 = 16k SRAM bank mapping* ($00 on hard reset)<tr><td valign="top">&nbsp;* Maps a 16k SRAM bank over the bottom 16k. Applies only in
  config mode when the bootrom is disabled</td></tr>
<tr><td valign="top">&nbsp;** Odd multiples of 256k are unreliable if storing data in sram
  for the mext core started.</td></tr>
<tr><td valign="top">&nbsp;*** number of useful bits changed from 5 to 7 in coure 3.01.06
</td></tr></table>

<P>
Register (R/W) $05 (05) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 1 Settings

<UL>
<LI>bits 7-6 = joystick 1 mode (MSB)
</LI>
<LI>bits 5-4 = joystick 2 mode (MSB)
</LI>
<LI>bit 3 = joystick 1 mode (LSB)
</LI>
<LI>bit 2 = 50/60 Hz mode (0 = 50Hz, 1 = 60Hz)
</LI>
<LI>bit 1 = joystick 2 mode (LSB)
</LI>
<LI>bit 0 = Enable Scandoubler
</LI>
</UL>
Joystick modes

<UL>
<LI>000 = Sinclair 2 (67890)
</LI>
<LI>001 = Kempston 2 (port $37)
</LI>
<LI>010 = Kempston 1 (port $1F)
</LI>
<LI>011 = Megadrive 1 (port $1F)
</LI>
<LI>100 = Cursor
</LI>
<LI>101 = Megadrive 2 (port $37)
</LI>
<LI>110 = Sinclair 1 (12345)
</LI>
<LI>111 = I/O Mode (3.01.04)
Both joysticks are places in I/O Mode if either is set to I/O
Mode. The underlying joystick type is not changed and reads of this
register will continue to return the last joystick type. Ehether the
joystick is in io mode or not is invisible but this state can be
cleared either through reset or by re-writing the gegister with
joystick type not equal to 111. Recovery time for a normal joystick
read after leaving I/O Mode is at most 64 scan lines.
</LI>
</UL>

<P>
Register (R/W) $06 (06) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 2 Settings

<UL>
<LI>bit 7 = F8 CPU Speed Hotkey Enable (1 on reset)
</LI>
<LI>bit 6 = Enable classic audio mode (beep and tape to internal speaker,
  other audio to ear and HDMI, 3.01.02)
</LI>
<LI>bit 5 = F3 50Hz/60Hz Hotkey Enable (1 on reset)
</LI>
<LI>bit 4 = divMMC Automap/NMI Enable (0 on hard reset)
</LI>
<LI>bit 3 = NMI Button Enable (0 on hard reset)
</LI>
<LI>bit 2 = PS/2 Mode (0 = keyboard, 1 = mouse)
</LI>
<LI>bits 1-0 = PSG Mode (00 = YM, 01 = AY, 11 = hold all PSGs in Reset)
</LI>
</UL>

<P>
Register (R/W) $07 (07) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Turbo mode
<BR>
Read

<UL>
<LI>bits 7-6 = Reserved
</LI>
<LI>bits 5-4 = Current Actual CPU Speed
</LI>
<LI>bits 3-2 = Reserved
</LI>
<LI>bits 1-0 = Current Selected CPU Speed (00 on reset)
</LI>
</UL>
Write

<UL>
<LI>bits 7-2 = Reserved, must be 0
</LI>
<LI>bits 1-0 = Select CPU Speed
</LI>
</UL>
CPU Speeds

<UL>
<LI>00 = 3.5MHz
</LI>
<LI>01 = 7MHz
</LI>
<LI>10 = 14MHz
</LI>
<LI>11 = 28MHz
</LI>
</UL>

<P>
Register (R/W) $08 (08) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 3 Settings

<UL>
<LI>bit 7 = 128K Banking Unlock (inverse of port $7FFD, bit 5) (0
  on reset)
</LI>
<LI>bit 6 = Disable RAM and Port Contention (0 on reset)
</LI>
<LI>bit 5 = PSG Stereo Mode Control (0 = ABC, 1 = ACB) (0 on hard
  reset)
</LI>
<LI>bit 4 = Enable internal speaker (1 on hard reset)
</LI>
<LI>bit 3 = Enable DACs (0 on hard reset)
</LI>
<LI>bit 2 = Enable read of port $FF (Timex) (0 on hard reset)
</LI>
<LI>bit 1 = Enable Multiple PSGs (0 on hard reset)
</LI>
<LI>bit 0 = Enable Issue 2 Keyboard
</LI>
</UL>

<P>
Register (R/W) $09 (09) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 4 setting:
<table width="90%">
bit 7 = PSG 2 Mono Enable (0 on hard reset)
bit 6 = PSG 1 Mono Enable (0 on hard reset)
bit 5 = PSG 0 Mono Enable (0 on hard reset)
bit 4 = Sprite ID lockstep enable (1 = Nextreg $34 and IO Port
  $303B are in lockstep, 0 on reset)
bit 3 = divMMC mapRAM bit Control (reset bit 7 of port $E3)
bit 2 = HDMI audio mute (0 on hard reset)
bits 1-0 = scanlines
  
<UL>
<LI>00 = scanlines off
</LI>
<LI>01 = scanlines 12.5%
</LI>
<LI>10 = scanlines 25%
</LI>
<LI>11 = scanlines 50%
  
</LI>
</UL><tr><td valign="top">&nbsp;In Sprite lockstep, NextREG $34 and Port $303B are in
  lockstep
</td></tr></table>

<P>
Register (R/W) $0A (0A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Peripheral 5 setting:

<UL>
<LI>bits 7-6 = Multiface type (00 on hard reset)
  
<UL>
<LI>00 = Multiface +3 (enable port 0x3F, disable port 0xBF)
</LI>
<LI>01 = Multiface 128 v87.2 (enable port 0xBF, disable port 0x3F)
</LI>
<LI>10 = Multiface 128 v87.12 (enable port 0x9F, disable port 0x1F)
</LI>
<LI>11 = Multiface 1 (enable port 0x9F, disable port 0x1F)
  
</LI>
</UL>
</LI>
<LI>bits 5-4 = Reserved, must be zero
</LI>
<LI>bit 3 = 1 to reverse left and right mouse buttons (3.01.07)
</LI>
<LI>bit 2 = Reserved, must be 0
</LI>
<LI>bits 1-0 = mouse dpi (00 on hard reset) (3.01.05)
  
<UL>
<LI>00 = low dpi
</LI>
<LI>01 = default
</LI>
<LI>10 = medium dpi
</LI>
<LI>11 = high dpi
  
</LI>
</UL>
</LI>
</UL>

<P>
Register (R) $0E (0E) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Core Version (sub minor number)
<table width="90%">
bits 7-0 = Core sub minor version number<tr><td valign="top">&nbsp;(see register $01 for the major and minor version number)
</td></tr></table>

<P>
Register (R/W) $10 (10) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Core Boot
<BR>
Read

<UL>
<LI>bits 7-2 = Reserved
</LI>
<LI>bit 1 = Drive button pressed
</LI>
<LI>bit 0 = NMI button pressed
</LI>
</UL>
Write
<table width="90%">
bit 7 = Reboot FPGA using selected core (0 on reset)
bits 6-5 = Reserved, must be 0
bits 4-0 = Core ID<tr><td valign="top">&nbsp;Core ID with bits 4-0 can only be set in configuration mode
</td></tr></table>

<P>
Register (R/W) $11 (11) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Video Timing (writable in config mode only)
<table width="90%">
bits 7-3 = Reserved, must be 0
bits 2-0 = Mode (VGA = 0..6, HDMI = 7)
  
<UL>
<LI>000 = Base VGA timing, clk28 = 28000000
</LI>
<LI>001 = VGA setting 1, clk28 = 28571429
</LI>
<LI>010 = VGA setting 2, clk28 = 29464286
</LI>
<LI>011 = VGA setting 3, clk28 = 30000000
</LI>
<LI>100 = VGA setting 4, clk28 = 31000000
</LI>
<LI>101 = VGA setting 5, clk28 = 32000000
</LI>
<LI>110 = VGA setting 6, clk28 = 33000000
</LI>
<LI>111 = HDMI, clk28 = 27000000
  
</LI>
</UL><tr><td valign="top">&nbsp;50/60Hz selection depends on bit 2 of register $05</td></tr>
<tr><td valign="top">&nbsp;Only writable in config mode
</td></tr></table>

<P>
Register (R/W) $12 (12) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Active RAM bank

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = RAM bank (point to bank 8 after a Reset, NextZXOS
  modifies to 9)
</LI>
</UL>

<P>
Register (R/W) $13 (13) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Shadow RAM bank

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = RAM bank (point to bank 11 after a Reset, NextZXOS
  modifies to 12)
</LI>
</UL>

<P>
Register (R/W) $14 (14) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Global transparency color

<UL>
<LI>bits 7-0 = Transparency color value ($E3 after a reset)
</LI>
</UL>
(Note: this value is 8-bit, so the transparency is compared against
only by the MSB bits of the final 9-bit colour)
<BR>(Note2: this only affects Layer 2, ULA and LoRes. Sprites use register
$4B for transparency and tilemap uses nextreg $4C)

<P>
Register (R/W) $15 (15) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite and Layer System Setup

<UL>
<LI>bit 7 = LoRes mode (0 on reset)
</LI>
<LI>bit 6 = Sprite priority (1 = sprite 0 on top, 0 = sprite 127 on
  top) (0 on reset)
</LI>
<LI>bit 5 = Enable sprite clipping in over border mode (0 on reset)
</LI>
<LI>bits 4-2 = set layers priorities (000 on reset)
  
<UL>
<LI>000 - S L U
</LI>
<LI>001 - L S U
</LI>
<LI>010 - S U L
</LI>
<LI>011 - L U S
</LI>
<LI>100 - U S L
</LI>
<LI>101 - U L S
</LI>
<LI>110 - S(U+L) ULA and Layer 2 combined, colours clamped to 7
</LI>
<LI>111 - S(U+L-5) ULA and Layer 2 combined, colours clamped to [0,7]
  
</LI>
</UL>
</LI>
<LI>bit 1 = Enable Sprites Over border (0 on reset)
</LI>
<LI>bit 0 = Enable Sprites (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $16 (16) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Horizontal Scroll Control

<UL>
<LI>bits 7-0 = X Offset (0-255)(0 on reset)
</LI>
</UL>

<P>
Register (R/W) $17 (17) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Vertical Scroll Control

<UL>
<LI>bits 7-0 = Y Offset (0-191)(0 on reset)
</LI>
</UL>

<P>
Register (R/W) $18 (18) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Clip Window Definition

<UL>
<LI>bits 7-0 = Coords of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write - X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write - X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write - Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write - Y2 position
  </td></tr></table>
</LI>
</UL>
Reads do not advance the clip position
<BR>
The values are 0,255,0,191 after a Reset

<P>
Register (R/W) $19 (19) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Clip Window Definition

<UL>
<LI>bits 7-0 = Cood. of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write - X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write - X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write - Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write - Y2 position
  </td></tr></table>
</LI>
</UL>
The values are 0,255,0,191 after a Reset
<BR>
Reads do not advance the clip position

<P>
When the clip window is enabled for sprites in "over border" mode, the
X coords are internally doubled and the clip window origin is moved to
the sprite origin inside the border.

<P>
Register (R/W) $1A (1A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 0 (ULA/LoRes) Clip Window Definition

<UL>
<LI>bits 7-0 = Coord. of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write = X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write = X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write = Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write = Y2 position
  </td></tr></table>
</LI>
</UL>
The values are 0,255,0,191 after a Reset
<BR>
Reads do not advance the clip position

<P>
Register (R/W) $1B (1B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Clip Window Definition

<UL>
<LI>bits 7-0 = Coord. of the clip window
  <table width="90%">  <tr><td valign="top">&nbsp;1st write = X1 position
  </td></tr>
<tr><td valign="top">&nbsp;2nd write = X2 position
  </td></tr>
<tr><td valign="top">&nbsp;3rd write = Y1 position
  </td></tr>
<tr><td valign="top">&nbsp;4rd write = Y2 position
  </td></tr></table>
</LI>
</UL>
The values are 0,159,0,255 after a Reset
<BR>
Reads do not advance the clip position
<BR>
The X coords are internally doubled.

<P>
Register (R/W) $1C (1C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Clip Window Control
<BR>
Read

<UL>
<LI>bits 7-6 = Layer 3 Clip Index
</LI>
<LI>bits 5-4 = Layer 0/1 Clip Index
</LI>
<LI>bits 3-2 = Sprite clip index
</LI>
<LI>bits 1-0 = Layer 2 Clip Index
</LI>
</UL>
Write

<UL>
<LI>bits 7-4 = Reserved, must be 0
</LI>
<LI>bit 3 - reset Layer 3 clip index
</LI>
<LI>bit 2 - reset Layer 0/1 clip index
</LI>
<LI>bit 1 - reset sprite clip index.
</LI>
<LI>bit 0 - reset Layer 2 clip index.
</LI>
</UL>

<P>
Register (R) $1E (1E) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Active video line (MSB)

<UL>
<LI>bits 7-1 = Reserved
</LI>
<LI>bit 0 = Active line MSB
</LI>
</UL>

<P>
Register (R) $1F (1F) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Active video line (LSB)

<UL>
<LI>bits 7-0 = Active line LSB (0-255)
</LI>
</UL>

<P>
Register (R/W) $22 (22) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Line Interrupt control

<UL>
<LI>bit 7 = (R) ULA asserting interrupt
</LI>
<LI>bit 7 = (W) Reserved, must be 0
</LI>
<LI>bits 6-3 = Reserved, must be 0
</LI>
<LI>bit 2 = Disable ULA Interrupt (0 on reset)
</LI>
<LI>bit 1 = Enable Line Interrupt (0 on reset)
</LI>
<LI>bit 0 = MSB of Line Interrupt line value (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $23 (23) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Line Interrupt value LSB

<UL>
<LI>bits 7-0 = Line Interrupt line value LSB (0-255)(0 on reset)
</LI>
</UL>

<P>
Register (R/W) $26 (26) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ULA Horizontal Scroll Control

<UL>
<LI>bits 7-0 = ULA X Offset (0-255) (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $27 (27) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ULA Vertical Scroll Control

<UL>
<LI>bits 7-0 = ULA Y Offset (0-191) (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $28 (28) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Stored Palette Value and PS/2 Keymap Address MSB
<BR>
Read

<UL>
<LI>bits 7-0 = Stored palette value (see NextREG $44)
</LI>
</UL>
Write  

<UL>
<LI>bits 7-1 = Reserved, must be 0
</LI>
<LI>bit 0 = PS/2 Keymap Address MSB
</LI>
</UL>

<P>
Register (W) $29 (29) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> PS/2 Keymap Address LSB

<UL>
<LI>bits 7-0 = PS/2 Keymap Address LSB
</LI>
</UL>

<P>
Register (W) $2A (2A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> PS/2 Keymap Data MSB

<UL>
<LI>bits 7-1 = Reserved, must be 0
</LI>
<LI>bit 0 = PS/2 Keymap Data MSB
</LI>
</UL>

<P>
Register (W) $2B (2B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> PS/2 Keymap Data LSB

<UL>
<LI>bits 7-0 = PS/2 Keymap Data LSB
</LI>
</UL>
(writing this register auto-increments the address)

<P>
Register (R/W) $2C (2C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DAC B Mirror (Left)/ I<SUP>2</SUP>S Left Sample MSB
<BR>
Read

<UL>
<LI>bits 7-0 =  I<SUP>2</SUP>S Left Sample MSB
</LI>
</UL>
Write

<UL>
<LI>bits 7-0 = 8-bit sample left DAC ($80 on reset)
</LI>
</UL>

<P>
Register (R/W) $2D (2D) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DAC A+D Mirror (mono/ I<SUP>2</SUP>S Sample LSB
<BR>
Read

<UL>
<LI>bits 7-0 =  I<SUP>2</SUP>S Last Sample LSB
</LI>
</UL>
Write

<UL>
<LI>bits 7-0 = 8-bit sample DACs A + D ($80 on reset)
</LI>
</UL>

<P>
Register (R/W) $2E (2E) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DAC C Mirror (Right/ I<SUP>2</SUP>S Risht Sample MSB
<BR>
Read

<UL>
<LI>bits 7-0 =  I<SUP>2</SUP>S Right Sameple MSB
</LI>
</UL>
Write

<UL>
<LI>bits 7-0 = 8-bit sample Right DACs C ($80 on reset)
</LI>
</UL>

<P>
Register (R/W) $2F (2F) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Horizontal Scroll Control MSB

<UL>
<LI>bits 7-2 = Reserved, must be 0
</LI>
<LI>bits 1-0 = X Offset MSB ($00 on reset)
</LI>
</UL>
Meaningful Range is 0-319 in 40 char mode, 0-639 in 80 char mode

<P>
Register (R/W) $30 (30) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Horizontal Scroll Control LSB

<UL>
<LI>bits 7-0 = X Offset LSB ($00 on reset)
</LI>
</UL>
Meaningful range is 0-319 in 40 char mode, 0-639 in 80 char mode

<P>
Register (R/W) $31 (31) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Vertical Scroll Control

<UL>
<LI>bits 7-0 = Y Offset (0-255) )$00 on reset)
</LI>
</UL>

<P>
Register (R/W) $32 (32) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Horizontal Scroll Control)

<UL>
<LI>bits 7-0 = X Offset (0-255) ($00 on reset)
</LI>
</UL>
Layer 1,0 (LoRes) scrolls in "half-pixels" at the same resolution and
smoothness as Layer 2.

<P>
Register (R/W) $33 (33) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Vertical Scroll Control)

<UL>
<LI>bits 7-0 = Y Offset (0-191) ($00 on reset)
</LI>
</UL>
Layer 1,0 (LoRes) scrolls in "half-pixels" at the same resolution and
smoothness as Layer 2.

<P>
Register (R/W) $34 (34) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Number
<BR>
Lockstep (NextReg $09 bit 4 set)
<table width="90%">
bit 7 = Pattern address offset (Add 128 to pattern address)
bits 6-0 = Sprite number 0-127, Pattern number 0-63<tr><td valign="top">&nbsp;effectively performs an out to port $303B
</td></tr></table>

No Lockstep (NextReg $09 bit 4 clear)

<UL>
<LI>bit 7 = Reserved, must be 0
</LI>
<LI>bits 6-0 = Sprite number 0-127
</LI>
</UL>
This register selects which sprite has its attributes connected to the
sprite attribute registers

<P>
Register (W) $35 (35) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 0

<UL>
<LI>bits 7-0 = Sprite X coordinate LSB (MSB in NextReg $37)
</LI>
</UL>

<P>
Register (W) $36 (36) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 1

<UL>
<LI>bits 7-0 = Sprite Y coordinate LSB (MSB in NextReg $39)
</LI>
</UL>

<P>
Register (W) $37 (37) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 2

<UL>
<LI>bits 7-4 = 4-bit Palette offset
</LI>
<LI>bit 3 = Enable horizontal mirror (reverse)
</LI>
<LI>bit 2 = Enable vertical mirror (reverse)
</LI>
<LI>bit 1 = Enable 90<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img39.svg"
 ALT="$^O$"></SPAN> Clockwise Rotation
</LI>
</UL>
Normal Sprites

<UL>
<LI>bit 0 = X coordinate MSB
</LI>
</UL>
Relative Sprites

<UL>
<LI>bit 0 = Palette offset is relative to anchor sprite
</LI>
</UL>
Rotation is applied before mirroring

<P>
Register (W) $38 (38) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 3

<UL>
<LI>bit 7 = Enable Visiblity
</LI>
<LI>bit 6 = Enable Attribute 4 (0 = Attribute 4 effectively $00)
</LI>
<LI>bits 5-0 = Sprite Pattern Number
</LI>
</UL>

<P>
Register (W) $39 (39) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 4
<BR>
Normal Sprites

<UL>
<LI>bit 7 = 4-bit pattern switch (0 = 8-bit sprite, 1 = 4-bit sprite)
</LI>
<LI>bit 6 = Pattern number bit-7 for 4-bit, 0 for 8-bit
</LI>
<LI>bit 5 = Type of attached relative sprites (0 = Composite, 1 =
  Unified)
</LI>
<LI>bits 4-3 = X scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bits 2-1 = Y scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bit 0 = MSB of Y coordinate
</LI>
</UL>
Relative, Composite Sprites

<UL>
<LI>bit 7-6 = 01
</LI>
<LI>bit 5 = Pattern number bit-7 for 4-bit, 0 for 8-bit
</LI>
<LI>bits 4-3 = X scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bits 2-1 = Y scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)
</LI>
<LI>bit 0 = Pattern number is relative to anchor
</LI>
</UL>
Relative, Unified Sprites

<UL>
<LI>bit 7-6 = 01
</LI>
<LI>bit 5 = Pattern number bit-7 for 4-bit, 0 for 8-bit
</LI>
<LI>bits 4-1 = 0000
</LI>
<LI>bit 0 = Pattern number is relative to anchor
</LI>
</UL>

<P>
Register (R/W) $40 (40) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Palette Index Select

<UL>
<LI>bits 7-0 = Palette Index Number
</LI>
</UL>
Selects the palette index to change the associated colour

<P>
For ULA only, INKs are mapped to indices 0 through 7, BRIGHT INKs to
indices 8 through 15, PAPERs to indices 16 through 23 and BRIGHT
PAPERs to indices 24 through 31.  In EnhancedULA mode, INKs come from
a subset of indices from 0 through 127 and PAPERs from a subset of
indices from 128 through 255.

<P>
The number of active indices depends on the number of attribute bits
assigned to INK and PAPER out of the attribute byte.

<P>
In ULAplus mode, the last 64 entries (indices 192 to 255) hold the
ULAplus palette.  The ULA always takes border colour from PAPER for
standard ULA and Enhanced ULA

<P>
Register (R/W) $41 (41) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> 8-bit Palette Data

<UL>
<LI>bits 7-0 = Colour Entry in RRRGGGBB format
</LI>
</UL>
The lower blue bit of the 9-bit internal colour will be the logical or
of bits 0 and 1 of the 8-bit entry. After each write, the palette
index auto-increments if aut-increment has been enabled (NextReg $43
bit 7), Reads do not auto-increment.

<P>
Register (R/W) $42 (42) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ULANext Attribute Byte Format

<UL>
<LI>bits 7-0 = Attribute byte's INK representation mask (7 on reset)
</LI>
</UL>
The mask can only indicate a solid sequence of bits on the right side
of the attribute byte (1, 3, 7, 15, 31, 63, 127 or 255).

<P>
INKs are mapped to base index 0 in the palette and PAPERs and border
are mapped to base index 128 in the palette.

<P>
The 255 value enables the full ink colour mode making all the palette
entries INK. PAPER and border both take on the fallback colour
(nextreg $4A) in this mode.

<P>
Register (R/W) $43 (43) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Palette Control

<UL>
<LI>bit 7 = Disable palette write auto-increment.
</LI>
<LI>bits 6-4 = Select palette for reading or writing:
  
<UL>
<LI>000 = ULA first palette
</LI>
<LI>100 = ULA second palette
</LI>
<LI>001 = Layer 2 first palette
</LI>
<LI>101 = Layer 2 second palette
</LI>
<LI>010 = Sprite first palette
</LI>
<LI>110 = Sprite second palette
</LI>
<LI>011 = Layer 3 first palette
</LI>
<LI>111 = Layer 3 second palette
  
</LI>
</UL>
</LI>
<LI>bit 3 = Select Sprite palette (0 = first palette, 1 = second
  palette)
</LI>
<LI>bit 2 = Select Layer 2 palette (0 = first palette, 1 = second
  palette)
</LI>
<LI>bit 1 = Select ULA palette (0 = first palette, 1 = second
  palette)
</LI>
<LI>bit 0 = Enable EnhancedULA mode if 1. (0 after a reset)
</LI>
</UL>

<P>
Register (R/W) $44 (44) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> 9-bit Palette Data
<BR>
Non Level 2
<table width="90%"><tr><td valign="top">&nbsp;1st write
bits 7-0 = MSB (RRRGGGBB)</td></tr>
<tr><td valign="top">&nbsp;2nd write
bits 7-1 = Reserved, must be 0
bit 0 = LSB (B)
</td></tr></table>

Level 2
<table width="90%"><tr><td valign="top">&nbsp;1st write
bits 7-0 = MSB (RRRGGGBB)</td></tr>
<tr><td valign="top">&nbsp;2nd write
bit 7 = Priority
bits 6-1 = Reserved, must be 0
bit 0 = LSB (B)
</td></tr></table>

9-bit Palette Data is entered in two consecutive writes; the second
write autoincrements the palette index if auto-increment is enabled in
NextREG $43 bit 7

<P>
If writing an L2 palette, the second write's D7 holds the L2 priority
bit which if set (1) brings the colour defined at that index on top of
all other layers. If you also need the same colour in regular priority
(for example: for enviromental masking) you will have to set it up
again, this time with no priority.

<P>
Reads return the second byte and do not autoincrement. Writes to
nextreg $40, $41, $41, or $43 reset to the first write.

<P>
Register (R/W) $4A (4A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Fallback Colour Value

<UL>
<LI>bits 7-0 = 8-bit colour if all layers are transparent ($E3 on
  reset)
</LI>
</UL>
(black on reset = 0)

<P>
Register (R/W) $4B (4B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Transparency Index

<UL>
<LI>bits 7-0 = Index value ($E3 if reset)
</LI>
</UL>
For 4-bit sprites only the bottom 4-bits are relevant.

<P>
Register (R/W) $4C (4C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Level 3 Transparency Index

<UL>
<LI>bits 7-4 = Reserved, must be 0
</LI>
<LI>bits 3-0 = Index value ($0F on reset)
</LI>
</UL>

<P>
Register (R/W) $50 (50) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 0 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $0000 to $1FFF ($ff on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.
<BR>
A 255 value causes the ROM to become visible.

<P>
Register (R/W) $51 (51) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 1 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $2000 to $3FFF ($ff on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.
<BR>
A 255 value causes the ROM to become visible.

<P>
Register (R/W) $52 (52) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 2 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $4000 to $5FFF ($0A on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $53 (53) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 3 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $6000 to $7FFF ($0B on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $54 (54) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 4 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $8000 to $9FFF ($04 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $55 (55) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 5 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $A000 to $BFFF ($05 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $56 (56) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 6 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $C000 to $DFFF ($00 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Register (R/W) $57 (57) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> MMU Slot 7 Control

<UL>
<LI>bits 7-0 = 8k RAM page at position $E000 to $FFFF ($01 on
  reset)
</LI>
</UL>
Pages can be from 0 to 223 on a fully expanded Next.

<P>
Writing to ports $1FFD, $7FFD and $DFFD writes $FF to MMU0 and
MMU1 and writes appropriate values to MMU6 and MMU7 to map in the
selected 16k bank.

<P>
+3 special modes override the MMUs if used.

<P>
Register (W) $60 (60) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Copper Data 8-bit Write

<UL>
<LI>bits 7-0 = Byte to write to copper instruction memory
</LI>
</UL>
Note that each copper instruction is two bytes long, after a write,
the coppen address is auto-incremented to the next memory position.

<P>
After a write, the index is auto-incremented to the next memory position.

<P>
Register (W) $61 (61) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Copper Address LSB

<UL>
<LI>bits 7-0 = Copper instruction memory address LSB (0 on reset)
</LI>
</UL>

<P>
Register (W) $62 (62) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Copper Control

<UL>
<LI>bits 7-6 = Start Control
  <table width="90%">  <tr><td valign="top">&nbsp;00 = Copper fully stopped
  </td></tr>
<tr><td valign="top">&nbsp;01 = Copper start, execute the list from index 0, and loop
    to the start
  </td></tr>
<tr><td valign="top">&nbsp;10 = Copper start, execute the list from last point, and
    loop to the start
  </td></tr>
<tr><td valign="top">&nbsp;11 = Copper start, execute the list from index 0, and
    restart the list when the raster reaches position (0,0)
  </td></tr></table>

</LI>
<LI>bits 2-0 = Copper instruction memory address (MSB) (0 on reset)
</LI>
</UL>

<P>
Register (W) $63 (63) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Copper Data 16-bit Write

<UL>
<LI>bits 7-0 = Byte to write to copper instruction memory
</LI>
</UL>
The 16-bit value is written in pairs. The first 8-bits are the MSB and
are destined for an even copper instruction address. The sesond 8-bits
are the LSB and are destined for an odd copper instruction address.

<P>
After each write, the copper address is auto-incremented to the next
memory position.

<P>
After a write to an odd address, the all 16-bits are written to copper
memory at once.

<P>
Register (R/W) $64 (64) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Vertical Line Count Offset (3.01.05)
<table width="90%">
bits 7-0 = Offset added to the vertical line counter<tr><td valign="top">&nbsp;affects copper, line interrupt and active line
  count.
<BR>
Normally the ula's pixel row 0 aligns with vertical line count 0.
  With a non-zero offset, the ula's pixel row 0 will align with the
  vertical line offset.
<BR>
Eg, if the offset is 32 then vertical line 32 will correspond to
  the first pixel row in the ula and vertical line 0 will align with
  the first pixel row of the tilemap and sprites.
</td></tr></table>

* Since a change in offset takes effect when the ula reaches row 0,
the change can take up to one frame to occur.
Register (R/W) $68 (68) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ULA Control
<table width="90%">
bit 7 = Disable ULA output (0 on reset)
bit 6-5 = Color blending control for layering modes 6 &amp; 7 (3.01.01)

<UL>
<LI>00 = ULA as blend colour
</LI>
<LI>01 = No blending
</LI>
<LI>10 = ULA/Tilemap mix result as blend colour
</LI>
<LI>11 = Tilemap as blend colour
</LI>
</UL>
bit 4 = Cancel entries in 8x5 matrix for extended keys (3.01.04)
bit 3 = Enable ULAplus (0 on reset)
bit 2 = Enable ULA half pixel scroll (0 on reset)<tr><td valign="top">&nbsp;may change
bit 1 = Reserved (must be 0)
bit 0 = Enable stencil mode (0 on reset)</td></tr>
<tr><td valign="top">&nbsp;When ULA and Layer 3 are enabled, if either are transparent,
  the result is transparent, otherwise the result is the logical AND
  of both colours.
</td></tr></table>

<P>
Register (R/W) $69 (69) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Display Control 1

<UL>
<LI>bit 7 = Layer 2 Enable (Port $123B bit 1 alias)
</LI>
<LI>bit 6 = ULA Shadow display enable (Port $7FFD bit 3 alias)
</LI>
<LI>bits 5-0 = Timex alias (Port $FF alias)
</LI>
</UL>

<P>
Register (R/W) $6A (6A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 1,0 (LoRes) Control

<UL>
<LI>bits 7-6 = reserved, must be 0
</LI>
<LI>bit 5 = Enable Radistan (16-colour) (0 on reset)
</LI>
<LI>bit 4 = Radistan DFILE switch (xor with bit 0 of port $ff) (0
  on reset)
</LI>
<LI>bits 3-0 = Radistsan palette offset (0 on reset)
</LI>
<LI>bits 1-0 = ULAplus palette offset (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $6B (6B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 (Tilemap) Control

<UL>
<LI>bit 7 = Layer 3 Enable (0 on reset)
</LI>
<LI>bit 6 = Layer 3 Size control (0 on reset)
  
<UL>
<LI>0 = 40x32
</LI>
<LI>1 = 80x32
  
</LI>
</UL>
</LI>
<LI>bit 5 = Disable Arrtibute Entry (0 on reset)
</LI>
<LI>bit 4 = palette select (0 on reset)
</LI>
<LI>bit 3 = Enable Text mode (1-bit tilemap) (0 on reset)
</LI>
<LI>bit 2 = Reserved, must be 0
</LI>
<LI>bit 1 = Activate 512 tile mode (0 on reset)
</LI>
<LI>bit 0 = Enable Layer 3 on top of ULA (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $6C (6C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Default Layer 3 Attribute*

<UL>
<LI>bits 7-4 = Palette Offset ($00 on reset)
</LI>
<LI>bit 3 = X mirror (0 on reset)
</LI>
<LI>bit 2 = Y mirror (0 on reset)
</LI>
<LI>bit 1 = Rotate (0 on reset)
</LI>
<LI>bit 0 = Bit 8 of the tile number (512 tile mode) (0 on reset)
</LI>
<LI>bit 0 = ULA over tilemap (256 tile mode) (0 on reset)
</LI>
</UL>
*Active tile attribute if bit 5 of nextreg $6B is set.

<P>
Register (R/W) $6E (6E) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 Tilemap Base Address

<UL>
<LI>bit 7 = Bank Select (3.01.08)
<table width="90%"><tr><td valign="top">&nbsp;0 = Bank 5</td></tr>
<tr><td valign="top">&nbsp;1 = Bank 7
</td></tr></table>

</LI>
<LI>bit 6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = MSB of address of the tilemap in Bank 5 (16k) or 7 (8k)
($2C on reset)
</LI>
</UL>
Soft Reset default $2C - This is because the address is $6C00 so the
MSB is $6C. But the stored value is only the lower 6 bits so it's an
offset into the 16k Bank 5. To calculate therefore subtract $40
leaving you with $2C.

<P>
The value written is an offset into the 16k Bank 5 or the 8k lower
half of Bank 7 allowinf the tilemap to be placed at any multiple of
256 bytes.
Register (R/W) $6F (6F) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 3 Tile Definitions Base Address

<UL>
<LI>bit 7 = Select bank (3.01.08)
<table width="90%"><tr><td valign="top">&nbsp;0 = Bank 5</td></tr>
<tr><td valign="top">&nbsp;1 = Bank 7
</td></tr></table>

</LI>
<LI>bit 6 = Reserved, must be 0
</LI>
<LI>bits 5-0 = MSB of address of the tile definitions in Bank 5 (16k) or 7
(8k) ($0C on reset)
</LI>
</UL>
Soft Reset default $0C - This is because the address is $4C00 so the
MSB is $4C. But the stored value is only the lower 6 bits so it's an
offset into the 16k Bank 5. To calculate therefore subtract $40
leaving you with $0C.

<P>
The value written is an offset into the 16k Bank 5 or the 8k lower
half of Bank 7 allowing the tilemap to be placed at any multiple of
256 bytes.
Register (R/W) $70 (70) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 Control

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bits 5-4 = Resolution (00 on soft reset)
  
<UL>
<LI>00 = <!-- MATH
 $256\times192\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img7.svg"
 ALT="$256\times192\times256$"></SPAN>
</LI>
<LI>01 = <!-- MATH
 $320\times256\times256$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img8.svg"
 ALT="$320\times256\times256$"></SPAN>
</LI>
<LI>10 = <!-- MATH
 $640\times256\times16$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img9.svg"
 ALT="$640\times256\times16$"></SPAN>
</LI>
<LI>11 = Do not use
  
</LI>
</UL>
</LI>
<LI>bits 3-0 = Palette offset ($0 on soft reset)
</LI>
</UL>

<P>
Register (R/W) $71 (71) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Layer 2 X Scroll MSB

<UL>
<LI>bits 7-1 = Reserved, must be 0
</LI>
<LI>bits 0 = MSB of X Offset
</LI>
</UL>

<P>
Register (W) $75 (75) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 0 (Auto-incrementing)
<BR>
See nextreg $35

<P>
Register (W) $76 (76) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 1 (Auto-incrementing)
<BR>
See nextreg $36

<P>
Register (W) $77 (77) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 2 (Auto-incrementing)
<BR>
See nextreg $37

<P>
Register (W) $78 (78) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 3 (Auto-incrementing)
<BR>
See nextreg $38

<P>
Register (W) $79 (79) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 4 (Auto-incrementing)
<BR>
See nextreg $39

<P>
Register (R/W) $7F (7F) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> User Register 0

<UL>
<LI>bits 7-0 = User Register ($FF on hard reset)
</LI>
</UL>

<P>
Caution NextReg numbers above $7F are inaccessible to the Copper

<P>
Register (R/W) $80 (80) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Expansion Bus Enable
<BR>
Immediate

<UL>
<LI>bit 7 = Expansion Bus Enable (0 on hard reset)(3.01.07)
</LI>
<LI>bit 6 = Enable ROMCS ROM replacement from divmmc banks 14/15
  (experimental, 3.01.03)
</LI>
<LI>bit 5 = I/O cycle Disable/Ignore <!-- MATH
 $\overline{\hbox{IORQULA}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img140.svg"
 ALT="$\overline{\hbox{IORQULA}}$"></SPAN> (0 on
  hard reset)
</LI>
<LI>bit 4 = Memory cycle Disable/Ignore <!-- MATH
 $\overline{\hbox{ROMCS}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img141.svg"
 ALT="$\overline{\hbox{ROMCS}}$"></SPAN> (0 on
  hard reset)
</LI>
</UL>
After Soft Reset (Copied into bits 7-4)

<UL>
<LI>bit 3 = Expansion Bus Enable (0 on hard reset)
</LI>
<LI>bit 2 = Enable ROMCS ROM replacement from divmmc banks 14/15
  (experimental, 3.01.03)
</LI>
<LI>bit 1 = I/O cycle Disable/Ignore <!-- MATH
 $\overline{\hbox{IORQULA}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img140.svg"
 ALT="$\overline{\hbox{IORQULA}}$"></SPAN> (0 on
  hard reset)
</LI>
<LI>bit 0 = Memory cycle Disable/Ignore <!-- MATH
 $\overline{\hbox{ROMCS}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img141.svg"
 ALT="$\overline{\hbox{ROMCS}}$"></SPAN> (0 on
  hard reset)
</LI>
</UL>

<P>
Register (R/W) $81 (81) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Expansion Bus Control

<UL>
<LI>bit 7 = (R) Expansion bus <!-- MATH
 $\overline{\hbox{ROMCS}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img141.svg"
 ALT="$\overline{\hbox{ROMCS}}$"></SPAN> asserted
</LI>
<LI>bit 6 = Allow peripherials to override the ULA on some even
  port reads ($00-$0E)(Rotoronics Wafadrive)(3.01.07)
</LI>
<LI>bit 5 = Disable expansion bus NMI debounce (Opus Discovery)(3.01.07)
</LI>
<LI>bit 4 = (W) Propagate max CPU clock at all times (0 on hard
  reset)
</LI>
<LI>bits 3-2 = Reserved, must be 0
</LI>
<LI>bits 1-0 = Max CPU Speed when Expansion Bus is enabled ($00 on
  hard reset, currently fixed at $00)
  
<UL>
<LI>00 = 3.5 MHz
</LI>
<LI>01 = 7 MHz
</LI>
<LI>10 = 14 MHz
</LI>
<LI>11 = 28 MHz
  
</LI>
</UL>
</LI>
</UL>

<P>
Register (R/W) $82 (82) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Internal Port decoding control 1/4

<UL>
<LI>bit 7 = Enable Kempston Port 2 (Port $37) (1 on reset)
</LI>
<LI>bit 6 = Enable Kempston Port 1 (Port $1F) (1 on reset)
</LI>
<LI>bit 5 = Enable DMA (Port $6B) (1 on reset)
</LI>
<LI>bit 4 = Enable +3 Floating Bus (1 on reset)
</LI>
<LI>bit 3 = Enable +3 Paging (Port $1FFD) (1 on reset)
</LI>
<LI>bit 2 = Enable Next Memory Paging (Port $DFFD) (1 on reset)
</LI>
<LI>bit 1 = Enable Paging (Port $7FFD) (1 on reset)
</LI>
<LI>bit 0 = Enable Timex (Port $FF) (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $83 (83) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Internal Port decoding control 2/4

<UL>
<LI>bit 7 = Enable Layer 2 (Port $123B) (1 on reset)
</LI>
<LI>bit 6 = Enable Sprites (Ports $57, $5B, $303B) (1 on reset)
</LI>
<LI>bit 5 = Enable Kempston Mouse (Ports $FADF, $FBDF, $FFDF) (1
  on reset)
</LI>
<LI>bit 4 = Enable UART (Ports $133B, $143B, $153B) (1 on reset)
</LI>
<LI>bit 3 = Enable SPI (Ports $E7, $EB) (1 on reset)
</LI>
<LI>bit 2 = Enable  I<SUP>2</SUP>C (Ports $103B, $113B) (1 on reset)
</LI>
<LI>bit 1 = Enable Multiface (two variable ports) (1 on reset)
</LI>
<LI>bit 0 = Enable divMMC (Port $E3) (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $84 (84) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Internal Port decoding control 3/4

<UL>
<LI>bit 7 = Enable SPECdrum Mono DAC (Port $DF) (1 on reset)
</LI>
<LI>bit 6 = Enable Covox/GS Mono DAC (Port $B3) (1 on reset)
</LI>
<LI>bit 5 = Enable Pentagon/ATM DAC (Port $FB) (1 on reset)
</LI>
<LI>bit 4 = Enable Covox Stereo DAC (Ports $0F, $4F) (1 on reset)
</LI>
<LI>bit 3 = Enable Profi/Covox Stereo DAC (Ports $3F, $5F) (1 on
  reset)
</LI>
<LI>bit 2 = Enable Soundrive DAC Mode 2 (Ports $F1, $F3, $F9,
  $FB) (1 on reset)
</LI>
<LI>bit 1 = Enable Soundrive DAC Mode 1 (Ports $0F, $1F, $4F,
  $5F) (1 on reset)
</LI>
<LI>bit 0 = Enable AY (Ports $FFFD, $BFFD) (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $85 (85) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Internal Port decoding control 4/4

<UL>
<LI>bit 7 = Enable configuration of port decoding on soft reset (3.01.01)
</LI>
<LI>bits 6-4 = Reserved
</LI>
<LI>bit 3 = Enable Z80 CTC ports $183B, $193B, $1A3B, $1B3B, $1C3B,
  $1D3B, $1E3B, and $1F3B
</LI>
<LI>bit 2 = Enable Pentagon 1024 memory port $EFF7
</LI>
<LI>bit 1 = Enable DMA port $0B (3.01.02)
</LI>
<LI>bit 0 = Enable ULAplus (Ports $BF3B, $FF3B) (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $86 (86) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Expansion Port decoding control 1/4

<UL>
<LI>bit 7 = Enable Kempston Port 2 (Port $37) (1 on reset)
</LI>
<LI>bit 6 = Enable Kempston Port 1 (Port $1F) (1 on reset)
</LI>
<LI>bit 5 = Enable DMA (Port $6B) (1 on reset)
</LI>
<LI>bit 4 = Enable +3 Floating Bus (1 on reset)
</LI>
<LI>bit 3 = Enable +3 Paging (Port $1FFD) (1 on reset)
</LI>
<LI>bit 2 = Enable Next Memory Paging (Port $DFFD) (1 on reset)
</LI>
<LI>bit 1 = Enable Paging (Port $7FFD) (1 on reset)
</LI>
<LI>bit 0 = Enable Timex (Port $FF) (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $87 (87) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Expansion Port decoding control 2/4

<UL>
<LI>bit 7 = Enable Layer 2 (Port $123B) (1 on reset)
</LI>
<LI>bit 6 = Enable Sprites (Ports $57, $5B, $303B) (1 on reset)
</LI>
<LI>bit 5 = Enable Kempston Mouse (Ports $FADF, $FBDF, $FFDF) (1
  on reset)
</LI>
<LI>bit 4 = Enable UART (Ports $133B, $143B, $153B) (1 on reset)
</LI>
<LI>bit 3 = Enable SPI (Ports $E7, $EB) (1 on reset)
</LI>
<LI>bit 2 = Enable  I<SUP>2</SUP>C (Ports $103B, $113B) (1 on reset)
</LI>
<LI>bit 1 = Enable Multiface (two variable ports) (1 on reset)
</LI>
<LI>bit 0 = Enable divMMC (Port $E3) (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $88 (88) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Expansion Port decoding control 3/4

<UL>
<LI>bit 7 = Enable SPECdrum Mono DAC (Port $DF) (1 on reset)
</LI>
<LI>bit 6 = Enable Covox/GS Mono DAC (Port $B3) (1 on reset)
</LI>
<LI>bit 5 = Enable Pentagon/ATM DAC (Port $FB) (1 on reset)
</LI>
<LI>bit 4 = Enable Covox Stereo DAC (Ports $0F, $4F) (1 on reset)
</LI>
<LI>bit 3 = Enable Profi/Covox Stereo DAC (Ports $3F, $5F) (1 on
  reset)
</LI>
<LI>bit 2 = Enable Soundrive DAC Mode 2 (Ports $F1, $F3, $F9,
  $FB) (1 on reset)
</LI>
<LI>bit 1 = Enable Soundrive DAC Mode 1 (Ports $0F, $1F, $4F,
  $5F) (1 on reset)
</LI>
<LI>bit 0 = Enable AY (Ports $FFFD, $BFFD) (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $89 (89) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Expansion Port decoding control 4/4

<UL>
<LI>bit 7 = Enable configuration of port decoding on soft reset (3.01.01)
</LI>
<LI>bits 6-4 = Reserved
</LI>
<LI>bit 3 = Enable Z80 CTC ports $183B, $193B, $1A3B, $1B3B, $1C3B,
  $1D3B, $1E3B, and $1F3B
</LI>
<LI>bit 2 = Enable Pentagon 1024 memory port $EFF7
</LI>
<LI>bit 1 = Enable DMA port $0B (3.01.02)
</LI>
<LI>bit 0 = Enable ULAplus (Ports $BF3B, $FF3B) (1 on reset)
</LI>
</UL>

<P>
The Internal Port Decoding Enables always apply.

<P>
When the Expansion Bus is enabled, the Expansion Bus Port Decoding
Enables are logically ANDed with the Internal Enables. A result of 0
for the corresponding bit indicates the internal device is
<SPAN  CLASS="textit">disabled</SPAN>. If the Expansion Bus is enabled, this allows
I/O cycles for disabled ports to propagate to the Expansion Bus,
otherwise corresponding I/O cycles to the Expansion Bus are filtered.

<P>
Register (R/W) $8A (8A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Expansion Bus I/O Propagate Control

<UL>
<LI>bits 7-3 = Reserved, must be 0
</LI>
<LI>bit 4 = Propagate port $FF I/O Cycles (0 on hard reset, 3.01.02)
</LI>
<LI>bit 3 = Propagate port $1FFD I/O Cycles (0 on hard reset)
</LI>
<LI>bit 2 = Propagate port $DFFD I/O Cycles (0 on hard reset)
</LI>
<LI>bit 1 = Propagate port $7FFD I/O Cycles (0 on hard reset)
</LI>
<LI>bit 0 = Propagate port $FE I/O Cycles (1 on hard reset, 3.01.03:
  0 on hard reset)
</LI>
</UL>

<P>
Register (R/W) $8C (8C) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Alternate ROM
<BR>
Immediate

<UL>
<LI>bit 7 = Alt ROM Enable (0 on hard reset)
</LI>
<LI>bit 6 = Alt ROM visible ONLY during writes (0 on hard reset)
</LI>
<LI>bit 5 = Reserved, must be 0
</LI>
<LI>bit 4 = 48k ROM Lock (0 on hard reset)
</LI>
</UL>
After Soft Reset (copied into bits 7-4)

<UL>
<LI>bit 3 = Alt ROM Enable (0 on hard reset)
</LI>
<LI>bit 2 = Alt ROM visible ONLY during writes (0 on hard reset)
</LI>
<LI>bit 1 = Reserved, must be 0
</LI>
<LI>bit 0 = 48k ROM Lock (0 on hard reset)
</LI>
</UL>

<P>
Register (R/W) $8E (8E) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Spectrum 128k Memory Mapping (3.01.01)
<table width="90%">
bit 7 = Bank number bit 3 (port $dffd bit 0)
bit 6-4 = Bank number bits 2-0 (port $7ffd bits 2-0)
bit 3 = Enable change ram page (read as 1)
bit 2 = Paging mode (port $1ffd bit 0)

<UL>
<LI>0 = Normal paging mode
</LI>
<LI>1 = Special paging mode (lot bit of memory configuration)
</LI>
</UL><tr><td valign="top">&nbsp;Normal Paging Mode
bits 1-0 = ROM selection (port $1ffd bit 1 and $7ffd bit 4)</td></tr>
<tr><td valign="top">&nbsp;Special (all RAM) Paging Mode
bits 1-0 = RAM configuration selection (port $1ffd bits 2-1)
</td></tr></table>

Writes can affect all ports $7ffd, $dffd, and $1ffd
<BR>
Writes can always change the ROM/allRAM mapping
<BR>
Writes immediately change the current MMU mapping as if by port write.

<P>
Register (R/W) $8F (8F) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Memory Mapping Mode (3.01.06)

<UL>
<LI>bits 7-2 = Reserved, must be zero
</LI>
<LI>bits 1-0 = Mapping mode applied
  
<UL>
<LI>00 = Standard ZX 128k +3
</LI>
<LI>01 = Profi (removed in 3.01.09)
</LI>
<LI>10 = Pentagon 512k
</LI>
<LI>11 = Pentagon 1024k (limited to 768k on 1MB machines)
  
</LI>
</UL>
</LI>
</UL>
* Standard ZX 128k +3 = principally ports $7FFD, $DFFD, and $1FFD
<BR>* Pentagon 512k = principally port $7FFD
<BR>* Pentagon 1024k = principally ports $7FFD and $EFF7
<BR>** The mapping modes affect how ports $7FFD, $DFFD, $1FFD, and $EFF7
carry out memory paging, see ports

<P>
Register (R/W) $90 (90) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 1/4

<UL>
<LI>bit 7 = Enable Pin 7 (0 on reset)
</LI>
<LI>bit 6 = Enable Pin 6 (0 on reset)
</LI>
<LI>bit 5 = Enable Pin 5 (0 on reset)
</LI>
<LI>bit 4 = Enable Pin 4 (0 on reset)
</LI>
<LI>bit 3 = Enable Pin 3 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 2 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 1 (cannot be enabled) (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 0 (cannot be enabled) (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $91 (91) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 2/4

<UL>
<LI>bit 7 = Enable Pin 15 (0 on reset)
</LI>
<LI>bit 6 = Enable Pin 14 (0 on reset)
</LI>
<LI>bit 5 = Enable Pin 13 (0 on reset)
</LI>
<LI>bit 4 = Enable Pin 12 (0 on reset)
</LI>
<LI>bit 3 = Enable Pin 11 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 10 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 9 (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 8 (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $92 (92) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 3/4

<UL>
<LI>bit 7 = Enable Pin 23 (0 on reset)
</LI>
<LI>bit 6 = Enable Pin 22 (0 on reset)
</LI>
<LI>bit 5 = Enable Pin 21 (0 on reset)
</LI>
<LI>bit 4 = Enable Pin 20 (0 on reset)
</LI>
<LI>bit 3 = Enable Pin 19 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 18 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 17 (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 16 (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $93 (93) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO output enable 4/4

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bit 3 = Enable Pin 27 (0 on reset)
</LI>
<LI>bit 2 = Enable Pin 26 (0 on reset)
</LI>
<LI>bit 1 = Enable Pin 25 (0 on reset)
</LI>
<LI>bit 0 = Enable Pin 24 (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $98 (98) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 1/4

<UL>
<LI>bit 7 = Pin 7 Data (1 on reset)
</LI>
<LI>bit 6 = Pin 6 Data (1 on reset)
</LI>
<LI>bit 5 = Pin 5 Data (1 on reset)
</LI>
<LI>bit 4 = Pin 4 Data (1 on reset)
</LI>
<LI>bit 3 = Pin 3 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 2 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 1 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 0 Data (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $99 (99) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 2/4

<UL>
<LI>bit 7 = Pin 15 Data (1 on reset)
</LI>
<LI>bit 6 = Pin 14 Data (1 on reset)
</LI>
<LI>bit 5 = Pin 13 Data (1 on reset)
</LI>
<LI>bit 4 = Pin 12 Data (1 on reset)
</LI>
<LI>bit 3 = Pin 11 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 10 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 9 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 8 Data (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $9A (9A) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 3/4

<UL>
<LI>bit 7 = Pin 23 Data (1 on reset)
</LI>
<LI>bit 6 = Pin 22 Data (1 on reset)
</LI>
<LI>bit 5 = Pin 21 Data (1 on reset)
</LI>
<LI>bit 4 = Pin 20 Data (1 on reset)
</LI>
<LI>bit 3 = Pin 19 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 18 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 17 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 16 Data (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $9B (9B) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi GPIO Pin State 4/4

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bit 3 = Pin 27 Data (1 on reset)
</LI>
<LI>bit 2 = Pin 26 Data (1 on reset)
</LI>
<LI>bit 1 = Pin 25 Data (1 on reset)
</LI>
<LI>bit 0 = Pin 24 Data (1 on reset)
</LI>
</UL>

<P>
Register (R/W) $A0 (A0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi Peripheral Enable

<UL>
<LI>bits 7-6 = Reserved, must be 0
</LI>
<LI>bit 5 = Enable UART on GPIO 14, 15 (0 on reset)*
</LI>
<LI>bit 4 = Communication Type (0 on reset)
  
<UL>
<LI>0 = Rx to GPIO 15, Tx to GPIO 14 (Pi)
</LI>
<LI>1 = Rx to GPIO 14, Tx to GPIO 15 (Pi Hats)
  
</LI>
</UL>
</LI>
<LI>bit 3 = Enable  I<SUP>2</SUP>C on GPIO 2, 3 (0 on reset)*
</LI>
<LI>bits 2-1 = Reserved, must be 0
</LI>
<LI>bit 0 = Enable SPI on GPIO 7, 8, 9, 10, 11 (0 on reset)*
</LI>
</UL>
*Overrides GPIO Enables

<P>
Register (R/W) $A2 (A2) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi  I<SUP>2</SUP>S Audio Control

<UL>
<LI>bits 7-6 =  I<SUP>2</SUP>S State ($00 on reset)
  
<UL>
<LI>00 =  I<SUP>2</SUP>S Disabled
</LI>
<LI>01 =  I<SUP>2</SUP>S is mono, source R
</LI>
<LI>10 =  I<SUP>2</SUP>S is mono, source L
</LI>
<LI>11 =  I<SUP>2</SUP>S is stereo
  
</LI>
</UL>
</LI>
<LI>bit 5 = Reserved, must be 0
</LI>
<LI>bit 4 = Audio Flow Direction (0 on reset)
  
<UL>
<LI>0 = PCM_DOUT to Pi, PCM_DIN from Pi (Hats)
</LI>
<LI>1 = PCM_DOUT from Pi, PCM_DIN to Pi (Pi)
  
</LI>
</UL>
</LI>
<LI>bit 3 = Mute left (0 on reset)
</LI>
<LI>bit 2 = Mute right (0 on reset)
</LI>
<LI>bit 1 = Slave mode, Reserved must be 1 (remove in 3.01.05)
</LI>
<LI>bit 0 = Direct  I<SUP>2</SUP>S audio to EAR on port $FE (0 on reset)
</LI>
</UL>

<P>
Register (R/W) $A3 (A3) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Pi  I<SUP>2</SUP>S Clock Divide (Master Mode) (removed in 3.01.05)

<UL>
<LI>bits 7-0 = Clock divide value ($0B on reset)
</LI>
</UL>
<!-- MATH
 $\hbox{Divider}=\frac{538461}{\hbox{Rate}}-1$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img58.svg"
 ALT="$\hbox{Divider}=\frac{538461}{\hbox{Rate}}-1$"></SPAN> or
<!-- MATH
 $\hbox{Rate}=\frac{538461}{\hbox{Divider}+1}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img59.svg"
 ALT="$\hbox{Rate}=\frac{538461}{\hbox{Divider}+1}$"></SPAN>

<P>
Register (R/W) $A8 (A8) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ESP WiFi GPIO Output Enable

<UL>
<LI>bits 7-3 = Reserved, must be sero
</LI>
<LI>bit 2 = GPIO2 output enable (fixed at 0, GPIO2 is read-only)
</LI>
<LI>bit 1 = Reserved, must be zero
</LI>
<LI>bit 0 = GPIO0 output enable (fixed at 0, GPIO2 is read-only)
</LI>
</UL>
Register (R/W) $A9 (A9) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> ESP WiFi GPIO

<UL>
<LI>bits 7-3 = Reserved, must be sero
</LI>
<LI>bit 2 = Read/Write GPIO2 (reset = 1)
</LI>
<LI>bit 1 = Reserved, must be zero
</LI>
<LI>bit 0 = Read/Write GPIO0 (reset = 1)
</LI>
</UL>
Register (R) $B0 (B0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Extended Keys 0 (3.01.04)

<UL>
<LI>bit 7 = 1 if ; pressed
</LI>
<LI>bit 6 = 1 if p&#x308;ressed
</LI>
<LI>bit 5 = 1 if , pressed
</LI>
<LI>bit 4 = 1 if . pressed
</LI>
<LI>bit 3 = 1 if UP pressed
</LI>
<LI>bit 2 = 1 if DOWN pressed
</LI>
<LI>bit 1 = 1 if LEFT pressed
</LI>
<LI>bit 0 = 1 if RIGHT pressed
</LI>
</UL>
Register (R) $B1 (B1) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Extended Keys 1 (3.01.04)

<UL>
<LI>bit 7 = 1 if DELETE pressed
</LI>
<LI>bit 6 = 1 if EDIT pressed
</LI>
<LI>bit 5 = 1 if BREAK pressed
</LI>
<LI>bit 4 = 1 if INV VIDEO pressed
</LI>
<LI>bit 3 = 1 if TRUE VIDEO pressed
</LI>
<LI>bit 2 = 1 if GRAPH pressed
</LI>
<LI>bit 1 = 1 if CAPS LOCK pressed
</LI>
<LI>bit 0 = 1 if EXTEND pressed
</LI>
</UL>
Register (R/W) $C0 (C0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Control (3.01.09)
<BR>($00 on reset)

<UL>
<LI>bits 7-5 = Programmable portion of IM2 vector *
</LI>
<LI>bit 4 = Reserved, must be 0
</LI>
<LI>bit 3 = Enable stackless <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> response
</LI>
<LI>bits 2-1 = Reserved, must be 0
</LI>
<LI>bit 0 = Maskable interrupt mode
<table width="90%"><tr><td valign="top">&nbsp;0 - pulse</td></tr>
<tr><td valign="top">&nbsp;1 - IM2
</td></tr></table>
</LI>
</UL>
* In IM2 mode vector generated is:

<UL>
<LI>bits 7-5 = nextreg $C0 bits 7-5
</LI>
<LI>bits 4-1 = Interrupt source
<table width="90%"><tr><td valign="top">&nbsp;0 - line interrupt (highest priority)</td></tr>
<tr><td valign="top">&nbsp;1 - UART 0 Rx</td></tr>
<tr><td valign="top">&nbsp;2 - UART 1 Rx</td></tr>
<tr><td valign="top">&nbsp;3&ndash;10 - CTC channels 0-7</td></tr>
<tr><td valign="top">&nbsp;11 - ULA</td></tr>
<tr><td valign="top">&nbsp;12 - UART 0 Tx</td></tr>
<tr><td valign="top">&nbsp;13 - UART 1 Tx (lowest priority)
</td></tr></table>

</LI>
<LI>bit 0 = 0
</LI>
</UL>

<P>
Register (R/W) $C2 (C2) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> Return Address LSB (3.01.09)
<BR>($00 on reset)

<P>
Register (R/W) $C3 (C3) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> <!-- MATH
 $\overline{\hbox{NMI}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img5.svg"
 ALT="$\overline {\hbox {NMI}}$"></SPAN> Return Address MSB (3.01.09)
<BR>($00 on reset)

<P>
Register (R/W) $C4 (C4) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Enable 0 (3.01.08)
<BR>($83 on reset)

<UL>
<LI>bit 7 = Expansion bus <!-- MATH
 $\overline{\hbox{INT}}$
 -->
<SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img6.svg"
 ALT="$\overline {\hbox {INT}}$"></SPAN>
</LI>
<LI>bits 6-2 = Reserved must be zero
</LI>
<LI>bit 1 = Line
</LI>
<LI>bit 0 = ULA
</LI>
</UL>

<P>
Register (R/W) $C5 (C5) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Enable 1 (3.01.08)
<BR>($00 on reset)

<UL>
<LI>bit 7 = ctc channel 7 zc/to
</LI>
<LI>bit 6 = ctc channel 6 zc/to
</LI>
<LI>bit 5 = ctc channel 5 zc/to
</LI>
<LI>bit 4 = ctc channel 4 zc/to
</LI>
<LI>bit 3 = ctc channel 3 zc/to
</LI>
<LI>bit 2 = ctc channel 2 zc/to
</LI>
<LI>bit 1 = ctc channel 1 zc/to
</LI>
<LI>bit 0 = ctc channel 0 zc/to
</LI>
</UL>

<P>
Register (W) $C6 (C6) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Enable 2 (3.01.08)
<BR>($00 on reset)

<UL>
<LI>bit 7 = Reserved, must be 0
</LI>
<LI>bit 6 = UART1 Tx empty
</LI>
<LI>bit 5 = UART1 Rx half full *
</LI>
<LI>bit 4 = UART1 Rx available *
</LI>
<LI>bit 3 = Reserved, must be 0
</LI>
<LI>bit 2 = UART0 Tx empty
</LI>
<LI>bit 1 = UART0 Rx half full *
</LI>
<LI>bit 0 = UART0 Rx available *
</LI>
</UL>
* For each UART, Rx half full and Rx available are shared interrupts

<P>
Register (W) $C7 (C7) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Reserved (3.01.09)

<P>
Register (R/W) $C8 (C8) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Status 0 (3.01.09)
<BR>($00 on reset)

<UL>
<LI>bits 7-2 = Reserved, must be zero
</LI>
<LI>bit 1 = Line
</LI>
<LI>bit 0 = ULA
</LI>
</UL>
* Set bits indicate the device generated an interrupt in the past
* Writes clear bits where bits are set except in IM2 mode

<P>
Register (R/W) $C9 (C9) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Status 1 (3.01.09)

<UL>
<LI>bit 7 = ctc channel 7 zc/to
</LI>
<LI>bit 6 = ctc channel 6 zc/to
</LI>
<LI>bit 5 = ctc channel 5 zc/to
</LI>
<LI>bit 4 = ctc channel 4 zc/to
</LI>
<LI>bit 3 = ctc channel 3 zc/to
</LI>
<LI>bit 2 = ctc channel 2 zc/to
</LI>
<LI>bit 1 = ctc channel 1 zc/to
</LI>
<LI>bit 0 = ctc channel 0 zc/to
</LI>
</UL>
* Set bits indicate the device generated an interrupt in the past
* Writes clear bits where bits are set except in IM2 mode

<P>
Register (R/W) $CA (CA) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Interrupt Status 2 (3.01.09)
($00 on reset)

<UL>
<LI>bit 7 = Reserved, must be zero
</LI>
<LI>bit 6 = UART1 Tx empty
</LI>
<LI>bit 5 = UART1 Rx almost full *
</LI>
<LI>bit 4 = UART1 Rx available *
</LI>
<LI>bit 3 = Reserved must be zero
</LI>
<LI>bit 2 = UART0 Tx empty
</LI>
<LI>bit 1 = UART0 Rx almost full *
</LI>
<LI>bit 0 = UART0 Rx available *
</LI>
</UL>
* For each UART Rx half full and Rx available are shared interrupts
** Set bits indicate the device generated an interrupt in the past
** Writes clear bits where bits are set except in IM2 mode

<P>
Register (W) $CB (CB) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Reserved (3.01.09)

<P>
Register (R/W) $CC (CC) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DMA Interrupt Enable 0 (3.01.09)
($00 on reset)

<UL>
<LI>bits 7-2 = Reserved, must be 0
</LI>
<LI>bit 1 = Line
</LI>
<LI>bit 0 = ULA
</LI>
</UL>
* Set bits indicate the specified interrupt will interrupt a DMA
  operation when in IM2 mode

<P>
Register (R/W) $CD (CD) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DMA Interrupt Enable 1 (3.01.09)
($00 on reset)

<UL>
<LI>bit 7 = CTC channel 7 zc/to
</LI>
<LI>bit 6 = CTC channel 6 zc/to
</LI>
<LI>bit 5 = CTC channel 5 zc/to
</LI>
<LI>bit 4 = CTC channel 4 zc/to
</LI>
<LI>bit 3 = CTC channel 3 zc/to
</LI>
<LI>bit 2 = CTC channel 2 zc/to
</LI>
<LI>bit 1 = CTC channel 1 zc/to
</LI>
<LI>bit 0 = CTC channel 0 zc/to
</LI>
</UL>
* Set bits indicate the corresponding interrupt will interrupt a DMA
  operation when in IM2 mode

<P>
Register (R/W) $CE (CE) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> DMA Interrupt Enable 2 (3.01.09)
($00 on reset)

<UL>
<LI>bit 7 = Reserved, must be 0
</LI>
<LI>bit 6 = UART1 Tx empty
</LI>
<LI>bit 5 = UART1 Rx half full
</LI>
<LI>bit 4 = UART1 Rx available
</LI>
<LI>bit 3 = Reserved, must be 0
</LI>
<LI>bit 2 = UART0 Tx empty
</LI>
<LI>bit 1 = UART0 Tx half full
</LI>
<LI>bit 0 = UART0 Tx available
</LI>
</UL>
* Set bits indicate the corresponding interrupt will interrupt a DMA
  operation when in IM2 mode.

<P>
Register (W) $CF (CF) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Reserved (3.01.09)

<P>
Register (W) $FF (FF) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Debug LEDs (DE-1, DE-2 am Multicore only)

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node157.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node155.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node155.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1255"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1257"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node157.html">AY-3-8912</A>
<B> Up:</B> <A
 HREF="node155.html">Registers</A>
<B> Previous:</B> <A
 HREF="node155.html">Registers</A>
 &nbsp; <B>  <A ID="tex2html1256"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1258"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node157.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>AY-3-8912</TITLE>
<META NAME="description" CONTENT="AY-3-8912">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node158.html">
<LINK REL="previous" HREF="node156.html">
<LINK REL="next" HREF="node158.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node158.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node155.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node156.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1259"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1261"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node158.html">zxDMA</A>
<B> Up:</B> <A
 HREF="node155.html">Registers</A>
<B> Previous:</B> <A
 HREF="node156.html">ZX Spectrum Next Registers</A>
 &nbsp; <B>  <A ID="tex2html1260"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1262"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001320000000000000000">
AY-3-8912</A>
</H1>

<P>
(R/W) $00 (0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel A fine tune

<UL>
<LI>bits 7-0 = Channel A frequency bits 7-0
</LI>
</UL>

<P>
(R/W) $01 (1) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel A coarse tune

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bits 4-0 = Channel A frequency bits 11-8
</LI>
</UL>

<P>
(R/W) $02 (0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel B fine tune

<UL>
<LI>bits 7-0 = Channel A frequency bits 7-0
</LI>
</UL>

<P>
(R/W) $03 (1) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel B coarse tune

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bits 4-0 = Channel A frequency bits 11-8
</LI>
</UL>

<P>
(R/W) $04 (0) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel C fine tune

<UL>
<LI>bits 7-0 = Channel A frequency bits 7-0
</LI>
</UL>

<P>
(R/W) $05 (1) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel C coarse tune

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bits 4-0 = Channel A frequency bits 11-8
</LI>
</UL>

<P>
(R/W) $06 (6) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Noise period

<UL>
<LI>bits 7-5 = Reserved
</LI>
<LI>bits 4-0 = Noise period to noise generator
</LI>
</UL>

<P>
(R/W) $07 (7) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Mixer control I/O Enable
<table width="90%"><tr><td valign="top">&nbsp;Active low (0=enable, 1= disable)
bit 7-6: Reserved
bit 5: Channel C noise enable
bit 4: Channel B noise enable
bit 3: Channel A noise enable
bit 2: Channel C tone enable
bit 1: Channel B tone enable
bit 0: Channel A tone enable
</td></tr></table>

<P>
(R/W) $0A (10) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel A amplitude

<UL>
<LI>bits 7-5 = Reserved
</LI>
<LI>bit 4 = Amplitude mode
  
<UL>
<LI>0=fixed amplitude
</LI>
<LI>1=use envelope generator (bits 0-3 ignored)
  
</LI>
</UL>
</LI>
<LI>bits 0-3 = value of fixed amplitude
</LI>
</UL>

<P>
(R/W) $0B (11) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel B amplitude
<table width="90%"><tr><td valign="top">&nbsp;like channel A amplitude
</td></tr></table>

<P>
(R/W) $0C (12) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Channel C amplitude
<table width="90%"><tr><td valign="top">&nbsp;like channel A amplitude
</td></tr></table>

<P>
(R/W) $0D (13) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Envelope period fine

<UL>
<LI>bits 7-0 = Envelop period LSB
</LI>
</UL>

<P>
(R/W) $0E (14) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Envelope period coarse

<UL>
<LI>bits 7-0 = Envelop period MSB
</LI>
</UL>

<P>
(R/W) $0F (15) <SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img10.svg"
 ALT="$\Rightarrow$"></SPAN> Envelope shape

<UL>
<LI>bits 7-4 = Reserved
</LI>
<LI>bit 3 = Continue
  
<UL>
<LI>0=drop to amplitude 0 after 1 cycle
</LI>
<LI>1=use ‘Hold’ value
  
</LI>
</UL>
</LI>
<LI>bit 2 = Attack
  
<UL>
<LI>0=generator counts down
</LI>
<LI>1=generator counts up
  
</LI>
</UL>
</LI>
<LI>bit 1-0 = Alternate &amp; Hold
  
<UL>
<LI>00=generator resets after each cycle
</LI>
<LI>01=hold final value
</LI>
<LI>10=generator reverses direction each cycle
</LI>
<LI>11=hold initial value
  
</LI>
</UL>
</LI>
</UL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node158.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node155.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node156.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1259"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1261"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node158.html">zxDMA</A>
<B> Up:</B> <A
 HREF="node155.html">Registers</A>
<B> Previous:</B> <A
 HREF="node156.html">ZX Spectrum Next Registers</A>
 &nbsp; <B>  <A ID="tex2html1260"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1262"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node158.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>zxDMA</TITLE>
<META NAME="description" CONTENT="zxDMA">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node157.html">
<LINK REL="next" HREF="node159.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node159.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node155.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node157.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1263"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1265"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Up:</B> <A
 HREF="node155.html">Registers</A>
<B> Previous:</B> <A
 HREF="node157.html">AY-3-8912</A>
 &nbsp; <B>  <A ID="tex2html1264"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1266"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001330000000000000000">
zxDMA</A>
</H1>
<DIV class="CENTER">
<SPAN CLASS="SCRIPTSIZE">zxndma/registers.csv

</SPAN></DIV>
<BR><HR>

</BODY>
</HTML>
node159.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Extended Opcodes to Mnemonics</TITLE>
<META NAME="description" CONTENT="Extended Opcodes to Mnemonics">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node167.html">
<LINK REL="previous" HREF="node155.html">
<LINK REL="next" HREF="node160.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node160.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node158.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1267"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1269"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node160.html">Single Byte Opcodes</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node158.html">zxDMA</A>
 &nbsp; <B>  <A ID="tex2html1268"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1270"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001400000000000000000">
Extended Opcodes to Mnemonics</A>
</H1>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" Single Byte Opcodes " LINK NODE160}
@{" $CBxx Bit Operations " LINK NODE161}
@{" $DDxx IX " LINK NODE162}
@{" $EDxx Block/Port " LINK NODE163}
@{" $FDxx IY " LINK NODE164}
@{" $DDCBxx IX Bit Operations " LINK NODE165}
@{" $FDCBxx IY Bit Operations " LINK NODE166}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node160.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Single Byte Opcodes</TITLE>
<META NAME="description" CONTENT="Single Byte Opcodes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node161.html">
<LINK REL="previous" HREF="node159.html">
<LINK REL="next" HREF="node161.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node161.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1278"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1280"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node161.html">$CBxx Bit Operations</A>
<B> Up:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Previous:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
 &nbsp; <B>  <A ID="tex2html1279"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1281"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001410000000000000000">
Single Byte Opcodes</A>
</H1>
wIntelN1=,2=,3=,4=,5=,
  6=,7=,8=,9=,10=
wIntelTtabular=|l|l|l|r|r||l|l|l|r|r|,
    table head=Op&amp;Z80&amp;8080&amp;Sz&amp;T&amp;Op&amp;Z80&amp;8080&amp;Sz&amp;T
<BR>,
    table foot=,wIntelN

<P>
zilogN1=,2=,3=,4=,
  5=,6=,7=,8=
zilogTtabular=|l|l|r|r||l|l|r|r|,
    table head=Op&amp;Mnemonic&amp;Sz&amp;T&amp;Op&amp;Mnemonic&amp;Sz&amp;T
<BR>,
    table foot=,zilogN

<P>
<BR><P></P>
<DIV class="CENTER"><A ID="8668"></A>
<TABLE>
<CAPTION><STRONG>Table C.1:</STRONG>
$00-$1F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img142.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/00-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8674"></A>
<TABLE>
<CAPTION><STRONG>Table C.2:</STRONG>
$20-$3F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img143.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/20-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8680"></A>
<TABLE>
<CAPTION><STRONG>Table C.3:</STRONG>
$40-$5F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img144.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/40-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8686"></A>
<TABLE>
<CAPTION><STRONG>Table C.4:</STRONG>
$60-$7F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img145.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/60-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8692"></A>
<TABLE>
<CAPTION><STRONG>Table C.5:</STRONG>
$80-$9F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img146.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/80-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8698"></A>
<TABLE>
<CAPTION><STRONG>Table C.6:</STRONG>
$A0-$BF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img147.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/A0-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8704"></A>
<TABLE>
<CAPTION><STRONG>Table C.7:</STRONG>
$C0-$DF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img148.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/C0-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8710"></A>
<TABLE>
<CAPTION><STRONG>Table C.8:</STRONG>
$E0-$FF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img149.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[wIntelT]{appendices/opcode/E0-opcode.csv}{}%
{\opa&amp;\zia&amp;\ina&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\inb&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>

</BODY>
</HTML>
node161.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>$CBxx Bit Operations</TITLE>
<META NAME="description" CONTENT="$CBxx Bit Operations">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node162.html">
<LINK REL="previous" HREF="node160.html">
<LINK REL="next" HREF="node162.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node162.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node160.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1282"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1284"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node162.html">$DDxx IX</A>
<B> Up:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Previous:</B> <A
 HREF="node160.html">Single Byte Opcodes</A>
 &nbsp; <B>  <A ID="tex2html1283"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1285"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001420000000000000000">
$CBxx Bit Operations</A>
</H1>
<BR><P></P>
<DIV class="CENTER"><A ID="8717"></A>
<TABLE>
<CAPTION><STRONG>Table C.9:</STRONG>
$CB00-$CB1F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img150.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cb00-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8723"></A>
<TABLE>
<CAPTION><STRONG>Table C.10:</STRONG>
$CB20-$CB3F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img151.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cb20-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8729"></A>
<TABLE>
<CAPTION><STRONG>Table C.11:</STRONG>
$CB40-$CB5F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img152.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cb40-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8735"></A>
<TABLE>
<CAPTION><STRONG>Table C.12:</STRONG>
$CB60-$CB7F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img153.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cb60-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8741"></A>
<TABLE>
<CAPTION><STRONG>Table C.13:</STRONG>
$CB80-$CB9F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img154.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cb80-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8747"></A>
<TABLE>
<CAPTION><STRONG>Table C.14:</STRONG>
$CBA0-$CBBF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img155.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cba0-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8753"></A>
<TABLE>
<CAPTION><STRONG>Table C.15:</STRONG>
$CBC0-$CBDF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img156.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cbc0-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8759"></A>
<TABLE>
<CAPTION><STRONG>Table C.16:</STRONG>
$CBE0-$CBFF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img157.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/cbe0-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>

</BODY>
</HTML>
node162.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>$DDxx IX</TITLE>
<META NAME="description" CONTENT="$DDxx IX">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node163.html">
<LINK REL="previous" HREF="node161.html">
<LINK REL="next" HREF="node163.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node163.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node161.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1286"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1288"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node163.html">$EDxx Block/Port</A>
<B> Up:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Previous:</B> <A
 HREF="node161.html">$CBxx Bit Operations</A>
 &nbsp; <B>  <A ID="tex2html1287"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1289"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001430000000000000000">
$DDxx IX</A>
</H1>
<BR><P></P>
<DIV class="CENTER"><A ID="8766"></A>
<TABLE>
<CAPTION><STRONG>Table C.17:</STRONG>
$DD00-$DD5F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img158.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/dd00-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8772"></A>
<TABLE>
<CAPTION><STRONG>Table C.18:</STRONG>
$DD60-$CB8F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img159.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/dd60-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8778"></A>
<TABLE>
<CAPTION><STRONG>Table C.19:</STRONG>
$DD90-$DDFF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img160.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/dd90-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>

</BODY>
</HTML>
node163.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>$EDxx Block/Port</TITLE>
<META NAME="description" CONTENT="$EDxx Block/Port">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node164.html">
<LINK REL="previous" HREF="node162.html">
<LINK REL="next" HREF="node164.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node164.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node162.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1290"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1292"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node164.html">$FDxx IY</A>
<B> Up:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Previous:</B> <A
 HREF="node162.html">$DDxx IX</A>
 &nbsp; <B>  <A ID="tex2html1291"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1293"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001440000000000000000">
$EDxx Block/Port</A>
</H1>
<BR><P></P>
<DIV class="CENTER"><A ID="8785"></A>
<TABLE>
<CAPTION><STRONG>Table C.20:</STRONG>
$ED00-$ED4F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img161.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/ed00-...
...zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\par
* ZX Spectrum Next extension
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8791"></A>
<TABLE>
<CAPTION><STRONG>Table C.21:</STRONG>
$ED50-$ED8F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img162.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/ed50-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8797"></A>
<TABLE>
<CAPTION><STRONG>Table C.22:</STRONG>
$ED90-$EDFF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img163.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/ed90-...
...zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\par
* ZX Spectrum Next extension
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>

</BODY>
</HTML>
node164.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>$FDxx IY</TITLE>
<META NAME="description" CONTENT="$FDxx IY">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node165.html">
<LINK REL="previous" HREF="node163.html">
<LINK REL="next" HREF="node165.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node165.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node163.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1294"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1296"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node165.html">$DDCBxx IX Bit Operations</A>
<B> Up:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Previous:</B> <A
 HREF="node163.html">$EDxx Block/Port</A>
 &nbsp; <B>  <A ID="tex2html1295"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1297"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001450000000000000000">
$FDxx IY</A>
</H1>
<BR><P></P>
<DIV class="CENTER"><A ID="8804"></A>
<TABLE>
<CAPTION><STRONG>Table C.23:</STRONG>
$FD00-$FD5F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img164.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/fd00-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8810"></A>
<TABLE>
<CAPTION><STRONG>Table C.24:</STRONG>
$FD60-$FD8F</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img165.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/fd60-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="8816"></A>
<TABLE>
<CAPTION><STRONG>Table C.25:</STRONG>
$FD90-$FDFF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img166.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/fd90-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>

</BODY>
</HTML>
node165.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>$DDCBxx IX Bit Operations</TITLE>
<META NAME="description" CONTENT="$DDCBxx IX Bit Operations">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node166.html">
<LINK REL="previous" HREF="node164.html">
<LINK REL="next" HREF="node166.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node166.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node164.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1298"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1300"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node166.html">$FDCBxx IY Bit Operations</A>
<B> Up:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Previous:</B> <A
 HREF="node164.html">$FDxx IY</A>
 &nbsp; <B>  <A ID="tex2html1299"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1301"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001460000000000000000">
$DDCBxx IX Bit Operations</A>
</H1>
<BR><P></P>
<DIV class="CENTER"><A ID="8823"></A>
<TABLE>
<CAPTION><STRONG>Table C.26:</STRONG>
$DDCB00-$DDCBFF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img167.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/ddcb00-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>

</BODY>
</HTML>
node166.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>$FDCBxx IY Bit Operations</TITLE>
<META NAME="description" CONTENT="$FDCBxx IY Bit Operations">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node165.html">
<LINK REL="next" HREF="node167.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node167.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node159.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node165.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1302"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1304"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node167.html">Mnemonics to Extended Opcodes</A>
<B> Up:</B> <A
 HREF="node159.html">Extended Opcodes to Mnemonics</A>
<B> Previous:</B> <A
 HREF="node165.html">$DDCBxx IX Bit Operations</A>
 &nbsp; <B>  <A ID="tex2html1303"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1305"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001470000000000000000">
$FDCBxx IY Bit Operations</A>
</H1>
<BR><P></P>
<DIV class="CENTER"><A ID="8830"></A>
<TABLE>
<CAPTION><STRONG>Table C.27:</STRONG>
$FDCB00-$FDCBFF</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img168.svg"
 ALT="\begin{table}\centering\scriptsize
\csvreader[zilogT]{appendices/opcode/fdcb00-opcode.csv}{}%
{\opa&amp;\zia&amp;\sza&amp;\tma&amp;\opb&amp;\zib&amp;\szb&amp;\tmb}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><HR>

</BODY>
</HTML>
node167.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Mnemonics to Extended Opcodes</TITLE>
<META NAME="description" CONTENT="Mnemonics to Extended Opcodes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node168.html">
<LINK REL="previous" HREF="node159.html">
<LINK REL="next" HREF="node168.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node168.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node166.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1306"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1308"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node168.html">File Formats</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node166.html">$FDCBxx IY Bit Operations</A>
 &nbsp; <B>  <A ID="tex2html1307"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1309"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001500000000000000000">
Mnemonics to Extended Opcodes</A>
</H1>
<BR><P></P>
<DIV class="CENTER"><A ID="9007"></A>
<TABLE>
<CAPTION><STRONG>Table D.1:</STRONG>
aci-adc</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img169.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/aci-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9011"></A>
<TABLE>
<CAPTION><STRONG>Table D.2:</STRONG>
add</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img170.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/add-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9015"></A>
<TABLE>
<CAPTION><STRONG>Table D.3:</STRONG>
adi-ani</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img171.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/adi-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9019"></A>
<TABLE>
<CAPTION><STRONG>Table D.4:</STRONG>
bit 0-bit 3</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img172.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/bit0-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9023"></A>
<TABLE>
<CAPTION><STRONG>Table D.5:</STRONG>
bit 4-bit 7</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img173.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/bit4-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9027"></A>
<TABLE>
<CAPTION><STRONG>Table D.6:</STRONG>
brlc-cnz</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img174.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/brlc-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9031"></A>
<TABLE>
<CAPTION><STRONG>Table D.7:</STRONG>
cp-dcr</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img175.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/cp-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9035"></A>
<TABLE>
<CAPTION><STRONG>Table D.8:</STRONG>
dcx-im</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img176.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/dcx-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9039"></A>
<TABLE>
<CAPTION><STRONG>Table D.9:</STRONG>
in-inx</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img177.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/in-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9043"></A>
<TABLE>
<CAPTION><STRONG>Table D.10:</STRONG>
jc-jz</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img178.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/jc-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9047"></A>
<TABLE>
<CAPTION><STRONG>Table D.11:</STRONG>
ld (bc),a-ld (iy+x),x</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img179.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/ld0-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9051"></A>
<TABLE>
<CAPTION><STRONG>Table D.12:</STRONG>
ld (xx),a-ld a,x</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img180.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/ld1-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9055"></A>
<TABLE>
<CAPTION><STRONG>Table D.13:</STRONG>
ld b,(hl)-ld c,x</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img181.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/ld2-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9059"></A>
<TABLE>
<CAPTION><STRONG>Table D.14:</STRONG>
ld d,(hl)-ld e,x</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img182.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/ld3-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9063"></A>
<TABLE>
<CAPTION><STRONG>Table D.15:</STRONG>
ld h,(hl)-ld ixl,x</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img183.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/ld4-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9067"></A>
<TABLE>
<CAPTION><STRONG>Table D.16:</STRONG>
ld iyh,a-ld sp,xx</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img184.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/ld5-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9071"></A>
<TABLE>
<CAPTION><STRONG>Table D.17:</STRONG>
lda-mirror</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img185.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/lda-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9075"></A>
<TABLE>
<CAPTION><STRONG>Table D.18:</STRONG>
mov a,a-mov d,m</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img186.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/mov0-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9079"></A>
<TABLE>
<CAPTION><STRONG>Table D.19:</STRONG>
mov e,a-mov m,l</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img187.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/mov1-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9083"></A>
<TABLE>
<CAPTION><STRONG>Table D.20:</STRONG>
mul-otir</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img188.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/mul-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9087"></A>
<TABLE>
<CAPTION><STRONG>Table D.21:</STRONG>
out-rc</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img189.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/out-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9091"></A>
<TABLE>
<CAPTION><STRONG>Table D.22:</STRONG>
res 0-res 3</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img190.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/res0-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9095"></A>
<TABLE>
<CAPTION><STRONG>Table D.23:</STRONG>
res 4-res 7</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img191.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/res4-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9099"></A>
<TABLE>
<CAPTION><STRONG>Table D.24:</STRONG>
ret-rp</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img192.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/ret-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9103"></A>
<TABLE>
<CAPTION><STRONG>Table D.25:</STRONG>
rr-rz</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img193.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/rr-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9107"></A>
<TABLE>
<CAPTION><STRONG>Table D.26:</STRONG>
sbb-scf</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img194.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/sbb-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9111"></A>
<TABLE>
<CAPTION><STRONG>Table D.27:</STRONG>
set 0-set 3</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img195.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/set0-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9115"></A>
<TABLE>
<CAPTION><STRONG>Table D.28:</STRONG>
set 4-set 7</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img196.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/set4-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9119"></A>
<TABLE>
<CAPTION><STRONG>Table D.29:</STRONG>
setae-stc</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img197.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/setae-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>
<BR><P></P>
<DIV class="CENTER"><A ID="9123"></A>
<TABLE>
<CAPTION><STRONG>Table D.30:</STRONG>
sub-xthl</CAPTION>
<TR><TD><IMG STYLE=""
 SRC="img198.svg"
 ALT="\begin{table}\centering\scriptsize
\csvautotabular{appendices/mnemonic/sub-mnemonics.csv}
\end{table}"></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node168.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node166.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1306"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1308"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node168.html">File Formats</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node166.html">$FDCBxx IY Bit Operations</A>
 &nbsp; <B>  <A ID="tex2html1307"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1309"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node168.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>File Formats</TITLE>
<META NAME="description" CONTENT="File Formats">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node191.html">
<LINK REL="previous" HREF="node167.html">
<LINK REL="next" HREF="node169.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node169.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node167.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1310"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1312"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node169.html">BAS</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node167.html">Mnemonics to Extended Opcodes</A>
 &nbsp; <B>  <A ID="tex2html1311"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1313"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001600000000000000000">
File Formats</A>
</H1>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" BAS " LINK NODE169}
@{" BMP " LINK NODE170}
@{" DSK " LINK NODE171}
@{" NDR " LINK NODE172}
@{" NEX " LINK NODE173}
@{" O " LINK NODE174}
@{" P3D " LINK NODE175}
@{" PT3 " LINK NODE176}
@{" P " LINK NODE177}
@{" SCR " LINK NODE178}
@{" SHC " LINK NODE179}
@{" SHR " LINK NODE180}
@{" SL2 " LINK NODE181}
@{" SLR " LINK NODE182}
@{" SNA " LINK NODE183}
@{" SNX " LINK NODE184}
@{" SPR " LINK NODE185}
@{" TAP " LINK NODE186}
@{" TXT,DOC,ASM,INI,CFG,MD " LINK NODE187}
@{" TZX " LINK NODE188}
@{" Z3 to Z8 " LINK NODE189}
@{" Z80 " LINK NODE190}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node169.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>BAS</TITLE>
<META NAME="description" CONTENT="BAS">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node170.html">
<LINK REL="previous" HREF="node168.html">
<LINK REL="next" HREF="node170.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node170.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1336"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1338"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node170.html">BMP</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node168.html">File Formats</A>
 &nbsp; <B>  <A ID="tex2html1337"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1339"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001610000000000000000">
BAS</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node170.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>BMP</TITLE>
<META NAME="description" CONTENT="BMP">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node171.html">
<LINK REL="previous" HREF="node169.html">
<LINK REL="next" HREF="node171.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node171.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node169.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1340"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1342"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node171.html">DSK</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node169.html">BAS</A>
 &nbsp; <B>  <A ID="tex2html1341"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1343"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001620000000000000000">
BMP</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node171.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>DSK</TITLE>
<META NAME="description" CONTENT="DSK">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node172.html">
<LINK REL="previous" HREF="node170.html">
<LINK REL="next" HREF="node172.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node172.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node170.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1344"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1346"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node172.html">NDR</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node170.html">BMP</A>
 &nbsp; <B>  <A ID="tex2html1345"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1347"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001630000000000000000">
DSK</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node172.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>NDR</TITLE>
<META NAME="description" CONTENT="NDR">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node173.html">
<LINK REL="previous" HREF="node171.html">
<LINK REL="next" HREF="node173.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node173.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node171.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1348"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1350"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node173.html">NEX</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node171.html">DSK</A>
 &nbsp; <B>  <A ID="tex2html1349"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1351"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001640000000000000000">
NDR</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node173.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>NEX</TITLE>
<META NAME="description" CONTENT="NEX">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node174.html">
<LINK REL="previous" HREF="node172.html">
<LINK REL="next" HREF="node174.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node174.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node172.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1352"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1354"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node174.html">O</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node172.html">NDR</A>
 &nbsp; <B>  <A ID="tex2html1353"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1355"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001650000000000000000">
NEX</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node174.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>O</TITLE>
<META NAME="description" CONTENT="O">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node175.html">
<LINK REL="previous" HREF="node173.html">
<LINK REL="next" HREF="node175.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node175.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node173.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1356"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1358"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node175.html">P3D</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node173.html">NEX</A>
 &nbsp; <B>  <A ID="tex2html1357"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1359"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001660000000000000000">
O</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node175.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>P3D</TITLE>
<META NAME="description" CONTENT="P3D">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node176.html">
<LINK REL="previous" HREF="node174.html">
<LINK REL="next" HREF="node176.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node176.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node174.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1360"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1362"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node176.html">PT3</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node174.html">O</A>
 &nbsp; <B>  <A ID="tex2html1361"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1363"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001670000000000000000">
P3D</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node176.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>PT3</TITLE>
<META NAME="description" CONTENT="PT3">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node177.html">
<LINK REL="previous" HREF="node175.html">
<LINK REL="next" HREF="node177.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node177.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node175.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1364"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1366"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node177.html">P</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node175.html">P3D</A>
 &nbsp; <B>  <A ID="tex2html1365"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1367"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001680000000000000000">
PT3</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node177.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>P</TITLE>
<META NAME="description" CONTENT="P">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node178.html">
<LINK REL="previous" HREF="node176.html">
<LINK REL="next" HREF="node178.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node178.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node176.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1368"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1370"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node178.html">SCR</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node176.html">PT3</A>
 &nbsp; <B>  <A ID="tex2html1369"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1371"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001690000000000000000">
P</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node178.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SCR</TITLE>
<META NAME="description" CONTENT="SCR">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node179.html">
<LINK REL="previous" HREF="node177.html">
<LINK REL="next" HREF="node179.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node179.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node177.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1372"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1374"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node179.html">SHC</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node177.html">P</A>
 &nbsp; <B>  <A ID="tex2html1373"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1375"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016100000000000000000">
SCR</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node179.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SHC</TITLE>
<META NAME="description" CONTENT="SHC">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node180.html">
<LINK REL="previous" HREF="node178.html">
<LINK REL="next" HREF="node180.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node180.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node178.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1376"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1378"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node180.html">SHR</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node178.html">SCR</A>
 &nbsp; <B>  <A ID="tex2html1377"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1379"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016110000000000000000">
SHC</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node180.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SHR</TITLE>
<META NAME="description" CONTENT="SHR">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node181.html">
<LINK REL="previous" HREF="node179.html">
<LINK REL="next" HREF="node181.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node181.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node179.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1380"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1382"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node181.html">SL2</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node179.html">SHC</A>
 &nbsp; <B>  <A ID="tex2html1381"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1383"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016120000000000000000">
SHR</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node181.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SL2</TITLE>
<META NAME="description" CONTENT="SL2">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node182.html">
<LINK REL="previous" HREF="node180.html">
<LINK REL="next" HREF="node182.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node182.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node180.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1384"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1386"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node182.html">SLR</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node180.html">SHR</A>
 &nbsp; <B>  <A ID="tex2html1385"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1387"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016130000000000000000">
SL2</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node182.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SLR</TITLE>
<META NAME="description" CONTENT="SLR">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node183.html">
<LINK REL="previous" HREF="node181.html">
<LINK REL="next" HREF="node183.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node183.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node181.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1388"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1390"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node183.html">SNA</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node181.html">SL2</A>
 &nbsp; <B>  <A ID="tex2html1389"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1391"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016140000000000000000">
SLR</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node183.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SNA</TITLE>
<META NAME="description" CONTENT="SNA">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node184.html">
<LINK REL="previous" HREF="node182.html">
<LINK REL="next" HREF="node184.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node184.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node182.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1392"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1394"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node184.html">SNX</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node182.html">SLR</A>
 &nbsp; <B>  <A ID="tex2html1393"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1395"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016150000000000000000">
SNA</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node184.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SNX</TITLE>
<META NAME="description" CONTENT="SNX">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node185.html">
<LINK REL="previous" HREF="node183.html">
<LINK REL="next" HREF="node185.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node185.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node183.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1396"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1398"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node185.html">SPR</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node183.html">SNA</A>
 &nbsp; <B>  <A ID="tex2html1397"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1399"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016160000000000000000">
SNX</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node185.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>SPR</TITLE>
<META NAME="description" CONTENT="SPR">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node186.html">
<LINK REL="previous" HREF="node184.html">
<LINK REL="next" HREF="node186.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node186.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node184.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1400"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1402"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node186.html">TAP</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node184.html">SNX</A>
 &nbsp; <B>  <A ID="tex2html1401"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1403"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016170000000000000000">
SPR</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node186.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>TAP</TITLE>
<META NAME="description" CONTENT="TAP">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node187.html">
<LINK REL="previous" HREF="node185.html">
<LINK REL="next" HREF="node187.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node187.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node185.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1404"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1406"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node187.html">TXT,DOC,ASM,INI,CFG,MD</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node185.html">SPR</A>
 &nbsp; <B>  <A ID="tex2html1405"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1407"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016180000000000000000">
TAP</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node187.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>TXT,DOC,ASM,INI,CFG,MD</TITLE>
<META NAME="description" CONTENT="TXT,DOC,ASM,INI,CFG,MD">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node188.html">
<LINK REL="previous" HREF="node186.html">
<LINK REL="next" HREF="node188.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node188.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node186.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1408"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1410"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node188.html">TZX</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node186.html">TAP</A>
 &nbsp; <B>  <A ID="tex2html1409"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1411"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016190000000000000000">
TXT,DOC,ASM,INI,CFG,MD</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node188.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>TZX</TITLE>
<META NAME="description" CONTENT="TZX">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node189.html">
<LINK REL="previous" HREF="node187.html">
<LINK REL="next" HREF="node189.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node189.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node187.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1412"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1414"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node189.html">Z3 to Z8</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node187.html">TXT,DOC,ASM,INI,CFG,MD</A>
 &nbsp; <B>  <A ID="tex2html1413"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1415"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016200000000000000000">
TZX</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node189.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Z3 to Z8</TITLE>
<META NAME="description" CONTENT="Z3 to Z8">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node190.html">
<LINK REL="previous" HREF="node188.html">
<LINK REL="next" HREF="node190.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node190.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node188.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1416"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1418"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node190.html">Z80</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node188.html">TZX</A>
 &nbsp; <B>  <A ID="tex2html1417"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1419"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016210000000000000000">
Z3 to Z8</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node190.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Z80</TITLE>
<META NAME="description" CONTENT="Z80">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node189.html">
<LINK REL="next" HREF="node191.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node191.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node168.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node189.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1420"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1422"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node191.html">Call Tables</A>
<B> Up:</B> <A
 HREF="node168.html">File Formats</A>
<B> Previous:</B> <A
 HREF="node189.html">Z3 to Z8</A>
 &nbsp; <B>  <A ID="tex2html1421"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1423"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION0016220000000000000000">
Z80</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node191.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Call Tables</TITLE>
<META NAME="description" CONTENT="Call Tables">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node198.html">
<LINK REL="previous" HREF="node168.html">
<LINK REL="next" HREF="node192.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node192.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node190.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1424"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1426"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node192.html">BDOS Call Table</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node190.html">Z80</A>
 &nbsp; <B>  <A ID="tex2html1425"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1427"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001700000000000000000">
Call Tables</A>
</H1>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" BDOS Call Table " LINK NODE192}
@{" BIOS Call Table " LINK NODE193}
@{" NextZXOS Calls " LINK NODE194}
@{" +3DOS Compatible Calls " LINK NODE195}
@{" +3DOS compatible error codes " LINK NODE196}
@{" esxDOS Compatible Calls " LINK NODE197}
</UL></UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node192.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>BDOS Call Table</TITLE>
<META NAME="description" CONTENT="BDOS Call Table">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node193.html">
<LINK REL="previous" HREF="node191.html">
<LINK REL="next" HREF="node193.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node193.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node191.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node191.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1434"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1436"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node193.html">BIOS Call Table</A>
<B> Up:</B> <A
 HREF="node191.html">Call Tables</A>
<B> Previous:</B> <A
 HREF="node191.html">Call Tables</A>
 &nbsp; <B>  <A ID="tex2html1435"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1437"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001710000000000000000">
BDOS Call Table</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node193.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>BIOS Call Table</TITLE>
<META NAME="description" CONTENT="BIOS Call Table">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node194.html">
<LINK REL="previous" HREF="node192.html">
<LINK REL="next" HREF="node194.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node194.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node191.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node192.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1438"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1440"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
<B> Up:</B> <A
 HREF="node191.html">Call Tables</A>
<B> Previous:</B> <A
 HREF="node192.html">BDOS Call Table</A>
 &nbsp; <B>  <A ID="tex2html1439"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1441"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001720000000000000000">
BIOS Call Table</A>
</H1>
<BR><HR>

</BODY>
</HTML>
node194.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>NextZXOS Calls</TITLE>
<META NAME="description" CONTENT="NextZXOS Calls">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node193.html">
<LINK REL="next" HREF="node195.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node195.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node191.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node193.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1442"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1444"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node195.html">+3DOS Compatible Calls</A>
<B> Up:</B> <A
 HREF="node191.html">Call Tables</A>
<B> Previous:</B> <A
 HREF="node193.html">BIOS Call Table</A>
 &nbsp; <B>  <A ID="tex2html1443"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1445"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION001730000000000000000">
NextZXOS Calls</A>
</H1>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
@{" +3DOS Compatible Calls " LINK NODE195}
@{" +3DOS compatible error codes " LINK NODE196}
@{" esxDOS Compatible Calls " LINK NODE197}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
node195.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>+3DOS Compatible Calls</TITLE>
<META NAME="description" CONTENT="+3DOS Compatible Calls">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node196.html">
<LINK REL="previous" HREF="node194.html">
<LINK REL="next" HREF="node196.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node196.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1449"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1451"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node196.html">+3DOS compatible error codes</A>
<B> Up:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
<B> Previous:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
 &nbsp; <B>  <A ID="tex2html1450"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1452"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001731000000000000000">
+3DOS Compatible Calls</A>
</H2>

<P>
<SPAN  CLASS="textbf">Filesystem Calls</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">DOS_VERSION</TD>
<TD CLASS="LEFT">$0103 (0103)</TD>
<TD CLASS="LEFT">Get +3DOS issue and version numbers</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">*DOS_OPEN</TD>
<TD CLASS="LEFT">$0106 (0106)</TD>
<TD CLASS="LEFT">Create and/or open a file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_CLOSE</TD>
<TD CLASS="LEFT">$0109 (0109)</TD>
<TD CLASS="LEFT">Close a file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_ABANDON</TD>
<TD CLASS="LEFT">$010C (010C)</TD>
<TD CLASS="LEFT">Abandon a file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_REF_HEAD</TD>
<TD CLASS="LEFT">$010F (010F)</TD>
<TD CLASS="LEFT">Point at the header data for this file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_READ</TD>
<TD CLASS="LEFT">$0112 (0112)</TD>
<TD CLASS="LEFT">Read bytes into memory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_WRITE</TD>
<TD CLASS="LEFT">$0115 (0115)</TD>
<TD CLASS="LEFT">Write bytes from memory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_BYTE_READ</TD>
<TD CLASS="LEFT">$0118 (0118)</TD>
<TD CLASS="LEFT">Read a byte</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_BYTE_WRITE</TD>
<TD CLASS="LEFT">$011B (011B)</TD>
<TD CLASS="LEFT">Write a byte</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">*DOS_CATALOG</TD>
<TD CLASS="LEFT">$011E (011E)</TD>
<TD CLASS="LEFT">Catalog disk directory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">*DOS_FREE_SPACE</TD>
<TD CLASS="LEFT">$0121 (0121)</TD>
<TD CLASS="LEFT">Free space on disk</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_DELETE</TD>
<TD CLASS="LEFT">$0124 (0124)</TD>
<TD CLASS="LEFT">Delete a file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_RENAME</TD>
<TD CLASS="LEFT">$0127 (0127)</TD>
<TD CLASS="LEFT">Rename a file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_BOOT</TD>
<TD CLASS="LEFT">$012A (012A)</TD>
<TD CLASS="LEFT">Boot an operating system or other program</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_SET_DRIVE</TD>
<TD CLASS="LEFT">$012D (012D)</TD>
<TD CLASS="LEFT">Set/get default drive</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_SET_USER</TD>
<TD CLASS="LEFT">$0130 (0130)</TD>
<TD CLASS="LEFT">Set/get default user number</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">*DOS_GET_POSITION</TD>
<TD CLASS="LEFT">$0133 (0133)</TD>
<TD CLASS="LEFT">Get file pointer for random access</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_SET_POSITION</TD>
<TD CLASS="LEFT">$0136 (0136)</TD>
<TD CLASS="LEFT">Set file pointer for random access</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">*DOS_GET_EOF</TD>
<TD CLASS="LEFT">$0139 (0139)</TD>
<TD CLASS="LEFT">Get end of file position for random access</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_GET_1346</TD>
<TD CLASS="LEFT">$013C (013C)</TD>
<TD CLASS="LEFT">Get memory usage in pages 1, 3, 4, 6</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_SET_1346</TD>
<TD CLASS="LEFT">$013F (013F)</TD>
<TD CLASS="LEFT">Re-allocate memory usage in pages 1, 3, 4, 6</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_FLUSH</TD>
<TD CLASS="LEFT">$0142 (0142)</TD>
<TD CLASS="LEFT">Bring disk up to date</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_SET_ACCESS</TD>
<TD CLASS="LEFT">$0145 (0145)</TD>
<TD CLASS="LEFT">Change open file's access mode</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_SET_ATTRIBUTES</TD>
<TD CLASS="LEFT">$0148 (0148)</TD>
<TD CLASS="LEFT">Change a file's attributes</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_SET_MESSAGE</TD>
<TD CLASS="LEFT">$014E (014E)</TD>
<TD CLASS="LEFT">Enable/disable error messages</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">DD_L_XDPB</TD>
<TD CLASS="LEFT">$0187 (0187)</TD>
<TD CLASS="LEFT">Initialise an XDPB from a disk specification</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_L_DPB</TD>
<TD CLASS="LEFT">$018A (018A)</TD>
<TD CLASS="LEFT">Initialise a DPB from a disk specification</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<SPAN  CLASS="textbf">System Calls</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">DOS_INITIALISE</TD>
<TD CLASS="LEFT">$0100 (0100)</TD>
<TD CLASS="LEFT">Initialise +3DOS</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">IDE_INTERFACE</TD>
<TD CLASS="LEFT">$00A3 (00A3)</TD>
<TD CLASS="LEFT">Initialise card interfaces</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_INIT</TD>
<TD CLASS="LEFT">$00A6 (00A6)</TD>
<TD CLASS="LEFT">Initialise IDEDOS</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_DRIVE</TD>
<TD CLASS="LEFT">$00A9 (00A9)</TD>
<TD CLASS="LEFT">Get unit handle</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">*IDE_SECTOR_READ</TD>
<TD CLASS="LEFT">$00AC (00AC)</TD>
<TD CLASS="LEFT">Low-level sector read</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">*IDE_SECTOR_WRITE</TD>
<TD CLASS="LEFT">$00AF (00AF)</TD>
<TD CLASS="LEFT">Low-level sector write</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITON_READ</TD>
<TD CLASS="LEFT">$00C4 (00C4)</TD>
<TD CLASS="LEFT">Read a partition entry</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_OPEN</TD>
<TD CLASS="LEFT">$00CD (00CD)</TD>
<TD CLASS="LEFT">Open a partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_CLOSE</TD>
<TD CLASS="LEFT">$00D0 (00D0)</TD>
<TD CLASS="LEFT">Close a partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITIONS</TD>
<TD CLASS="LEFT">$01A5 (01A5)</TD>
<TD CLASS="LEFT">Get number of open partitions</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<SPAN  CLASS="textbf">Unimplemented Calls</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">DOS_OPEN_DRIVE</TD>
<TD CLASS="LEFT">$014B (014B)</TD>
<TD CLASS="LEFT">Open a drive as a single file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DOS_MAP_B</TD>
<TD CLASS="LEFT">$0154 (0154)</TD>
<TD CLASS="LEFT">Map B: onto unit 0 or 1</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">DD_INTERFACE</TD>
<TD CLASS="LEFT">$0157 (0157)</TD>
<TD CLASS="LEFT">Is the floppy disk driver interface present?</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_INIT</TD>
<TD CLASS="LEFT">$015A (015A)</TD>
<TD CLASS="LEFT">Initialise disk driver</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_SETUP</TD>
<TD CLASS="LEFT">$015D (015D)</TD>
<TD CLASS="LEFT">Specify drive parameters</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_SET_RETRY</TD>
<TD CLASS="LEFT">$0160 (0160)</TD>
<TD CLASS="LEFT">Set try/retry count</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_READ_SECTOR</TD>
<TD CLASS="LEFT">$0163 (0163)</TD>
<TD CLASS="LEFT">Read a sector</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_WRITE_SECTOR</TD>
<TD CLASS="LEFT">$0166 (0166)</TD>
<TD CLASS="LEFT">Write a sector</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_CHECK_SECTOR</TD>
<TD CLASS="LEFT">$0169 (0169)</TD>
<TD CLASS="LEFT">Check a sector</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_FORMAT</TD>
<TD CLASS="LEFT">$016C (016C)</TD>
<TD CLASS="LEFT">Format a track</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_READ_ID</TD>
<TD CLASS="LEFT">$016F (016F)</TD>
<TD CLASS="LEFT">Read a sector identifier</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_TEST_UNSUITABLE</TD>
<TD CLASS="LEFT">$0172 (0172)</TD>
<TD CLASS="LEFT">Test media suitability</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_LOGIN</TD>
<TD CLASS="LEFT">$0175 (0175)</TD>
<TD CLASS="LEFT">Log in disk, initialise XDPB</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_SEL_FORMAT</TD>
<TD CLASS="LEFT">$0178 (0178)</TD>
<TD CLASS="LEFT">Pre-initialise XDPB for DD FORMAT</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_ASK_1</TD>
<TD CLASS="LEFT">$017B (017B)</TD>
<TD CLASS="LEFT">Is unit 1 &amp; external drive &amp; present?</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_DRIVE_STATUS</TD>
<TD CLASS="LEFT">$017E (017E)</TD>
<TD CLASS="LEFT">Fetch drive status</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_EQUIPMENT</TD>
<TD CLASS="LEFT">$0181 (0181)</TD>
<TD CLASS="LEFT">What type of drive?</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_ENCODE</TD>
<TD CLASS="LEFT">$0184 (0184)</TD>
<TD CLASS="LEFT">Set intercept routine for copy protection</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_L_SEEK</TD>
<TD CLASS="LEFT">$018D (018D)</TD>
<TD CLASS="LEFT">uPD765A seek driver</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_L_READ</TD>
<TD CLASS="LEFT">$0190 (0190)</TD>
<TD CLASS="LEFT">uPD765A read driver</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_L_WRITE</TD>
<TD CLASS="LEFT">$0193 (0193)</TD>
<TD CLASS="LEFT">uPD765A write driver</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_L_ON_MOTOR</TD>
<TD CLASS="LEFT">$0196 (0196)</TD>
<TD CLASS="LEFT">Motor on, wait for motor-on time</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_L_T_OFF_MOTOR</TD>
<TD CLASS="LEFT">$0199 (0199)</TD>
<TD CLASS="LEFT">Start the motor-off ticker</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">DD_L_OFF_MOTOR</TD>
<TD CLASS="LEFT">$019C (019C)</TD>
<TD CLASS="LEFT">Turn the motor off</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">IDE_FORMAT</TD>
<TD CLASS="LEFT">$00B2 (00B2)</TD>
<TD CLASS="LEFT">Format a partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_NEW</TD>
<TD CLASS="LEFT">$00B8 (00B8)</TD>
<TD CLASS="LEFT">Create partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_INIT</TD>
<TD CLASS="LEFT">$00BB (00BB)</TD>
<TD CLASS="LEFT">Initialise partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_ERASE</TD>
<TD CLASS="LEFT">$00BE (00BE)</TD>
<TD CLASS="LEFT">Delete a partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_RENAME</TD>
<TD CLASS="LEFT">$00C1 (00C1)</TD>
<TD CLASS="LEFT">Rename a partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_WRITE</TD>
<TD CLASS="LEFT">$00C7 (00C7)</TD>
<TD CLASS="LEFT">Write a partition entry</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_WINFO</TD>
<TD CLASS="LEFT">$00CA (00CA)</TD>
<TD CLASS="LEFT">Write type-specific partition information</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_GETINFO</TD>
<TD CLASS="LEFT">$00D3 (00D3)</TD>
<TD CLASS="LEFT">Get byte from type-specific partition information</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_PARTITION_SETINFO</TD>
<TD CLASS="LEFT">$00D6 (00D6)</TD>
<TD CLASS="LEFT">Set byte in type-specific partition information</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_DOS_UNPERMANENT</TD>
<TD CLASS="LEFT">$00FA (00FA)</TD>
<TD CLASS="LEFT">Remove permanent drive mapping</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">IDE_IDENTIFY</TD>
<TD CLASS="LEFT">$01A2 (01A2)</TD>
<TD CLASS="LEFT">Return IDE drive identity information</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node196.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1449"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1451"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node196.html">+3DOS compatible error codes</A>
<B> Up:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
<B> Previous:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
 &nbsp; <B>  <A ID="tex2html1450"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1452"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node196.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>+3DOS compatible error codes</TITLE>
<META NAME="description" CONTENT="+3DOS compatible error codes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node197.html">
<LINK REL="previous" HREF="node195.html">
<LINK REL="next" HREF="node197.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node197.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node195.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1453"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1455"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node197.html">esxDOS Compatible Calls</A>
<B> Up:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
<B> Previous:</B> <A
 HREF="node195.html">+3DOS Compatible Calls</A>
 &nbsp; <B>  <A ID="tex2html1454"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1456"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001732000000000000000">
+3DOS compatible error codes</A>
</H2>

<P>
<SPAN  CLASS="textbf">Recoverable disk errors</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">0</TD>
<TD CLASS="LEFT">rc_ready</TD>
<TD CLASS="LEFT">Drive not ready</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">1</TD>
<TD CLASS="LEFT">rc_wp</TD>
<TD CLASS="LEFT">Disk is write protected</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">2</TD>
<TD CLASS="LEFT">rc_seek</TD>
<TD CLASS="LEFT">Seek fail</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">3</TD>
<TD CLASS="LEFT">rc_crc</TD>
<TD CLASS="LEFT">CRC data error</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">4</TD>
<TD CLASS="LEFT">rc_nodata</TD>
<TD CLASS="LEFT">No data</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">5</TD>
<TD CLASS="LEFT">rc_mark</TD>
<TD CLASS="LEFT">Missing address mark</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">6</TD>
<TD CLASS="LEFT">rc_unrecog</TD>
<TD CLASS="LEFT">Unrecognised disk format</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">7</TD>
<TD CLASS="LEFT">rc_unknown</TD>
<TD CLASS="LEFT">Unknown disk error</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">8</TD>
<TD CLASS="LEFT">rc_diskchg</TD>
<TD CLASS="LEFT">Disk changed whilst +3DOS was using it</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">9</TD>
<TD CLASS="LEFT">rc_unsuit</TD>
<TD CLASS="LEFT">Unsuitable media for drive</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<SPAN  CLASS="textbf">Non-recoverable errors</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">20</TD>
<TD CLASS="LEFT">rc_badname</TD>
<TD CLASS="LEFT">Bad filename</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">21</TD>
<TD CLASS="LEFT">rc_badparam</TD>
<TD CLASS="LEFT">Bad parameter</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">22</TD>
<TD CLASS="LEFT">rc_nodrive</TD>
<TD CLASS="LEFT">Drive not found</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">23</TD>
<TD CLASS="LEFT">rc_nofile</TD>
<TD CLASS="LEFT">File not found</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">24</TD>
<TD CLASS="LEFT">rc_exists</TD>
<TD CLASS="LEFT">File already exists</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">25</TD>
<TD CLASS="LEFT">rc_eof</TD>
<TD CLASS="LEFT">End of file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">26</TD>
<TD CLASS="LEFT">rc_diskfull</TD>
<TD CLASS="LEFT">Disk full</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">27</TD>
<TD CLASS="LEFT">rc_dirfull</TD>
<TD CLASS="LEFT">Directory full</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">28</TD>
<TD CLASS="LEFT">rc_ro</TD>
<TD CLASS="LEFT">Read-only file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">29</TD>
<TD CLASS="LEFT">rc_number</TD>
<TD CLASS="LEFT">File number not open (or open with wrong access)</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">30</TD>
<TD CLASS="LEFT">rc_denied</TD>
<TD CLASS="LEFT">Access denied</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">31</TD>
<TD CLASS="LEFT">rc_norename</TD>
<TD CLASS="LEFT">Cannot rename between drives</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">32</TD>
<TD CLASS="LEFT">rc_extent</TD>
<TD CLASS="LEFT">Extent missing</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">33</TD>
<TD CLASS="LEFT">rc_uncached</TD>
<TD CLASS="LEFT">Uncached</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">34</TD>
<TD CLASS="LEFT">rc_toobig</TD>
<TD CLASS="LEFT">File too big</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">35</TD>
<TD CLASS="LEFT">rc_notboot</TD>
<TD CLASS="LEFT">Disk not bootable</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">36</TD>
<TD CLASS="LEFT">rc_inuse</TD>
<TD CLASS="LEFT">Drive in use</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">56</TD>
<TD CLASS="LEFT">rc_invpartition</TD>
<TD CLASS="LEFT">Invalid partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">57</TD>
<TD CLASS="LEFT">rc_partexist</TD>
<TD CLASS="LEFT">Partition already exists</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">58</TD>
<TD CLASS="LEFT">rc_notimp</TD>
<TD CLASS="LEFT">Not implemented</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">59</TD>
<TD CLASS="LEFT">rc_partopen</TD>
<TD CLASS="LEFT">Partition open</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">60</TD>
<TD CLASS="LEFT">rc_nohandle</TD>
<TD CLASS="LEFT">Out of handles</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">61</TD>
<TD CLASS="LEFT">rc_notswap</TD>
<TD CLASS="LEFT">Not a swap partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">62</TD>
<TD CLASS="LEFT">rc_mapped</TD>
<TD CLASS="LEFT">Drive already mapped</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">63</TD>
<TD CLASS="LEFT">rc_noxdpb</TD>
<TD CLASS="LEFT">No XDPB</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">64</TD>
<TD CLASS="LEFT">rc_noswap</TD>
<TD CLASS="LEFT">No suitable swap partition</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">65</TD>
<TD CLASS="LEFT">rc_invdevice</TD>
<TD CLASS="LEFT">Invalid device</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">67</TD>
<TD CLASS="LEFT">rc_cmdphase</TD>
<TD CLASS="LEFT">Command phase error</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">68</TD>
<TD CLASS="LEFT">rc_dataphase</TD>
<TD CLASS="LEFT">Data phase error</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">69</TD>
<TD CLASS="LEFT">rc_notdir</TD>
<TD CLASS="LEFT">Not a directory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">74</TD>
<TD CLASS="LEFT">rc_fragmented</TD>
<TD CLASS="LEFT">File is fragmented, use .DEFRAG</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node197.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node195.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1453"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1455"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node197.html">esxDOS Compatible Calls</A>
<B> Up:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
<B> Previous:</B> <A
 HREF="node195.html">+3DOS Compatible Calls</A>
 &nbsp; <B>  <A ID="tex2html1454"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1456"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node197.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>esxDOS Compatible Calls</TITLE>
<META NAME="description" CONTENT="esxDOS Compatible Calls">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node196.html">
<LINK REL="next" HREF="node198.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node198.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node196.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1457"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1459"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node198.html">List of Figures</A>
<B> Up:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
<B> Previous:</B> <A
 HREF="node196.html">+3DOS compatible error codes</A>
 &nbsp; <B>  <A ID="tex2html1458"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1460"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001733000000000000000">
esxDOS Compatible Calls</A>
</H2>

<P>
<SPAN  CLASS="textbf">Low-level calls</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">disk_filemap</TD>
<TD CLASS="LEFT">$85 (85)</TD>
<TD CLASS="LEFT">obtain file allocation map</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">disk_strmstart</TD>
<TD CLASS="LEFT">$86 (86)</TD>
<TD CLASS="LEFT">start streaming operation</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">disk_strmend</TD>
<TD CLASS="LEFT">$87 (87)</TD>
<TD CLASS="LEFT">end streaming operation</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<SPAN  CLASS="textbf">Miscellaneous calls</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">m_dosversion</TD>
<TD CLASS="LEFT">$88 (88)</TD>
<TD CLASS="LEFT">get NextZXOS version/mode information</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_getsetdrv</TD>
<TD CLASS="LEFT">$89 (89)</TD>
<TD CLASS="LEFT">get/set default drive</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_tapein</TD>
<TD CLASS="LEFT">$8B (8B)</TD>
<TD CLASS="LEFT">tape redirection control (input)</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_tapeout</TD>
<TD CLASS="LEFT">$8C (8C)</TD>
<TD CLASS="LEFT">tape redirection control (output)</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_gethandle</TD>
<TD CLASS="LEFT">$8D (8D)</TD>
<TD CLASS="LEFT">get handle for current dot command</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_getdate</TD>
<TD CLASS="LEFT">$8E (8E)</TD>
<TD CLASS="LEFT">get current date/time</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_execcmd</TD>
<TD CLASS="LEFT">$8F (8F)</TD>
<TD CLASS="LEFT">execute a dot command</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_setcaps</TD>
<TD CLASS="LEFT">$91 (91)</TD>
<TD CLASS="LEFT">set additional capabilities</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_drvapi</TD>
<TD CLASS="LEFT">$92 (92)</TD>
<TD CLASS="LEFT">access API for installable drivers</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_geterr</TD>
<TD CLASS="LEFT">$93 (93)</TD>
<TD CLASS="LEFT">get or generate error message</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_p3dos</TD>
<TD CLASS="LEFT">$94 (94)</TD>
<TD CLASS="LEFT">execute +3DOS/IDEDOS/NextZXOS call</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">m_errh</TD>
<TD CLASS="LEFT">$95 (95)</TD>
<TD CLASS="LEFT">register dot command error handler</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<P>
<SPAN  CLASS="textbf">File calls</SPAN>

<P>
<TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">f_open</TD>
<TD CLASS="LEFT">$9A (9A)</TD>
<TD CLASS="LEFT">open file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_close</TD>
<TD CLASS="LEFT">$9B (9B)</TD>
<TD CLASS="LEFT">close file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_sync</TD>
<TD CLASS="LEFT">$9C (9C)</TD>
<TD CLASS="LEFT">sync file changes to disk</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_read</TD>
<TD CLASS="LEFT">$9D (9D)</TD>
<TD CLASS="LEFT">read file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_write</TD>
<TD CLASS="LEFT">$9E (9E)</TD>
<TD CLASS="LEFT">write file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_seek</TD>
<TD CLASS="LEFT">$9F (9F)</TD>
<TD CLASS="LEFT">set file position</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_fgetpos</TD>
<TD CLASS="LEFT">$A0 (A0)</TD>
<TD CLASS="LEFT">get file position</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_fstat</TD>
<TD CLASS="LEFT">$A1 (A1)</TD>
<TD CLASS="LEFT">get open file information</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_ftruncate</TD>
<TD CLASS="LEFT">$A2 (A2)</TD>
<TD CLASS="LEFT">truncate/extend open file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_opendir</TD>
<TD CLASS="LEFT">$A3 (A3)</TD>
<TD CLASS="LEFT">open directory for reading</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_readdir</TD>
<TD CLASS="LEFT">$A4 (A4)</TD>
<TD CLASS="LEFT">read directory entry</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_telldir</TD>
<TD CLASS="LEFT">$A5 (A5)</TD>
<TD CLASS="LEFT">get directory position</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_seekdir</TD>
<TD CLASS="LEFT">$A6 (A6)</TD>
<TD CLASS="LEFT">set directory position</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_rewinddir</TD>
<TD CLASS="LEFT">$A7 (A7)</TD>
<TD CLASS="LEFT">rewind to start of directory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_getcwd</TD>
<TD CLASS="LEFT">$A8 (A8)</TD>
<TD CLASS="LEFT">get current working directory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_chdir</TD>
<TD CLASS="LEFT">$A9 (A9)</TD>
<TD CLASS="LEFT">change directory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_mkdir</TD>
<TD CLASS="LEFT">$AA (AA)</TD>
<TD CLASS="LEFT">make directory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_rmdir</TD>
<TD CLASS="LEFT">$AB (AB)</TD>
<TD CLASS="LEFT">remove directory</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_stat</TD>
<TD CLASS="LEFT">$AC (AC)</TD>
<TD CLASS="LEFT">get unopen file information</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_unlink</TD>
<TD CLASS="LEFT">$AD (AD)</TD>
<TD CLASS="LEFT">delete file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_truncate</TD>
<TD CLASS="LEFT">$AE (AE)</TD>
<TD CLASS="LEFT">truncate/extend unopen file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_chmod</TD>
<TD CLASS="LEFT">$AF (AF)</TD>
<TD CLASS="LEFT">change file attributes</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_rename</TD>
<TD CLASS="LEFT">$B0 (B0)</TD>
<TD CLASS="LEFT">rename/move file</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
<TR><TD CLASS="LEFT">f_getfree</TD>
<TD CLASS="LEFT">$B1 (B1)</TD>
<TD CLASS="LEFT">get free space</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
<TD CLASS="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node198.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node194.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node196.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1457"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1459"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node198.html">List of Figures</A>
<B> Up:</B> <A
 HREF="node194.html">NextZXOS Calls</A>
<B> Previous:</B> <A
 HREF="node196.html">+3DOS compatible error codes</A>
 &nbsp; <B>  <A ID="tex2html1458"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1460"
  HREF="node200.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
node198.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>List of Figures</TITLE>
<META NAME="description" CONTENT="List of Figures">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node199.html">
<LINK REL="previous" HREF="node191.html">
<LINK REL="next" HREF="node199.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node199.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node197.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1461"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1463"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node199.html">List of Tables</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node197.html">esxDOS Compatible Calls</A>
 &nbsp; <B>  <A ID="tex2html1462"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1464"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<BR>

<H2><A ID="SECTION001800000000000000000">
List of Figures</A>
</H2><OL>
<LI><A ID="tex2html6"
  HREF="node49.html#425">Pattern Example</A>
<LI><A ID="tex2html7"
  HREF="node52.html#445">All Rotate and Mirror Flags</A></OL>
<BR><HR>

</BODY>
</HTML>
node199.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>List of Tables</TITLE>
<META NAME="description" CONTENT="List of Tables">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node200.html">
<LINK REL="previous" HREF="node198.html">
<LINK REL="next" HREF="node200.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node200.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node198.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1465"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1467"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node200.html">Index</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node198.html">List of Figures</A>
 &nbsp; <B>  <A ID="tex2html1466"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1468"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<BR>

<H2><A ID="SECTION001900000000000000000">
List of Tables</A>
</H2><OL>
<LI><A ID="tex2html1"
  HREF="node10.html#142">Layer 1 Mode summary</A>
<LI><A ID="tex2html2"
  HREF="node10.html#148">Layer 1 Memory Map</A>
<LI><A ID="tex2html3"
  HREF="node12.html#156">ULA Colour</A>
<LI><A ID="tex2html4"
  HREF="node13.html#161">ULANext</A>
<LI><A ID="tex2html5"
  HREF="node26.html#232">Hi-Resolution Colours</A>
<LI><A ID="tex2html8"
  HREF="node69.html#1761">Special Paging Modes</A>
<LI><A ID="tex2html9"
  HREF="node85.html#1943">zxnDMA Registers</A>
<LI><A ID="tex2html10"
  HREF="node104.html#2086">Vertical Line Counts and Dot Clock Combinations</A>
<LI><A ID="tex2html11"
  HREF="node104.html#2090">Dot Clocks per Second</A>
<LI><A ID="tex2html12"
  HREF="node106.html#2096">Maximum Horizontal COPPER Compare</A>
<LI><A ID="tex2html13"
  HREF="node106.html#2100">Slack Dot Clocks After Maximum Compare</A>
<LI><A ID="tex2html14"
  HREF="node106.html#2104">Horizontal Timing</A>
<LI><A ID="tex2html15"
  HREF="node106.html#2108">Vertical Timing</A>
<LI><A ID="tex2html16"
  HREF="node107.html#2113">Ideal Extended Resolutions for Both VGA and HDMI</A>
<LI><A ID="tex2html17"
  HREF="node107.html#2117">Ideal Extended Resolution Display Parameters</A>
<LI><A ID="tex2html18"
  HREF="node108.html#2122">Instruction Bit Definition</A>
<LI><A ID="tex2html19"
  HREF="node113.html#2135">Register Bit Definitions</A>
<LI><A ID="tex2html20"
  HREF="node113.html#2139">Control Mode Definitions</A>
<LI><A ID="tex2html21"
  HREF="node122.html#2177">Summary of Video Modes</A>
<LI><A ID="tex2html22"
  HREF="node139.html#3716">System Control Block</A>
<LI><A ID="tex2html23"
  HREF="node139.html#3837">Program Return Codes</A>
<LI><A ID="tex2html24"
  HREF="node139.html#3887">FCB Format</A>
<LI><A ID="tex2html25"
  HREF="node152.html#6610">ZX Spectrum Ports</A>
<LI><A ID="tex2html26"
  HREF="node160.html#8668">$00-$1F</A>
<LI><A ID="tex2html27"
  HREF="node160.html#8674">$20-$3F</A>
<LI><A ID="tex2html28"
  HREF="node160.html#8680">$40-$5F</A>
<LI><A ID="tex2html29"
  HREF="node160.html#8686">$60-$7F</A>
<LI><A ID="tex2html30"
  HREF="node160.html#8692">$80-$9F</A>
<LI><A ID="tex2html31"
  HREF="node160.html#8698">$A0-$BF</A>
<LI><A ID="tex2html32"
  HREF="node160.html#8704">$C0-$DF</A>
<LI><A ID="tex2html33"
  HREF="node160.html#8710">$E0-$FF</A>
<LI><A ID="tex2html34"
  HREF="node161.html#8717">$CB00-$CB1F</A>
<LI><A ID="tex2html35"
  HREF="node161.html#8723">$CB20-$CB3F</A>
<LI><A ID="tex2html36"
  HREF="node161.html#8729">$CB40-$CB5F</A>
<LI><A ID="tex2html37"
  HREF="node161.html#8735">$CB60-$CB7F</A>
<LI><A ID="tex2html38"
  HREF="node161.html#8741">$CB80-$CB9F</A>
<LI><A ID="tex2html39"
  HREF="node161.html#8747">$CBA0-$CBBF</A>
<LI><A ID="tex2html40"
  HREF="node161.html#8753">$CBC0-$CBDF</A>
<LI><A ID="tex2html41"
  HREF="node161.html#8759">$CBE0-$CBFF</A>
<LI><A ID="tex2html42"
  HREF="node162.html#8766">$DD00-$DD5F</A>
<LI><A ID="tex2html43"
  HREF="node162.html#8772">$DD60-$CB8F</A>
<LI><A ID="tex2html44"
  HREF="node162.html#8778">$DD90-$DDFF</A>
<LI><A ID="tex2html45"
  HREF="node163.html#8785">$ED00-$ED4F</A>
<LI><A ID="tex2html46"
  HREF="node163.html#8791">$ED50-$ED8F</A>
<LI><A ID="tex2html47"
  HREF="node163.html#8797">$ED90-$EDFF</A>
<LI><A ID="tex2html48"
  HREF="node164.html#8804">$FD00-$FD5F</A>
<LI><A ID="tex2html49"
  HREF="node164.html#8810">$FD60-$FD8F</A>
<LI><A ID="tex2html50"
  HREF="node164.html#8816">$FD90-$FDFF</A>
<LI><A ID="tex2html51"
  HREF="node165.html#8823">$DDCB00-$DDCBFF</A>
<LI><A ID="tex2html52"
  HREF="node166.html#8830">$FDCB00-$FDCBFF</A>
<LI><A ID="tex2html53"
  HREF="node167.html#9007">aci-adc</A>
<LI><A ID="tex2html54"
  HREF="node167.html#9011">add</A>
<LI><A ID="tex2html55"
  HREF="node167.html#9015">adi-ani</A>
<LI><A ID="tex2html56"
  HREF="node167.html#9019">bit 0-bit 3</A>
<LI><A ID="tex2html57"
  HREF="node167.html#9023">bit 4-bit 7</A>
<LI><A ID="tex2html58"
  HREF="node167.html#9027">brlc-cnz</A>
<LI><A ID="tex2html59"
  HREF="node167.html#9031">cp-dcr</A>
<LI><A ID="tex2html60"
  HREF="node167.html#9035">dcx-im</A>
<LI><A ID="tex2html61"
  HREF="node167.html#9039">in-inx</A>
<LI><A ID="tex2html62"
  HREF="node167.html#9043">jc-jz</A>
<LI><A ID="tex2html63"
  HREF="node167.html#9047">ld (bc),a-ld (iy+x),x</A>
<LI><A ID="tex2html64"
  HREF="node167.html#9051">ld (xx),a-ld a,x</A>
<LI><A ID="tex2html65"
  HREF="node167.html#9055">ld b,(hl)-ld c,x</A>
<LI><A ID="tex2html66"
  HREF="node167.html#9059">ld d,(hl)-ld e,x</A>
<LI><A ID="tex2html67"
  HREF="node167.html#9063">ld h,(hl)-ld ixl,x</A>
<LI><A ID="tex2html68"
  HREF="node167.html#9067">ld iyh,a-ld sp,xx</A>
<LI><A ID="tex2html69"
  HREF="node167.html#9071">lda-mirror</A>
<LI><A ID="tex2html70"
  HREF="node167.html#9075">mov a,a-mov d,m</A>
<LI><A ID="tex2html71"
  HREF="node167.html#9079">mov e,a-mov m,l</A>
<LI><A ID="tex2html72"
  HREF="node167.html#9083">mul-otir</A>
<LI><A ID="tex2html73"
  HREF="node167.html#9087">out-rc</A>
<LI><A ID="tex2html74"
  HREF="node167.html#9091">res 0-res 3</A>
<LI><A ID="tex2html75"
  HREF="node167.html#9095">res 4-res 7</A>
<LI><A ID="tex2html76"
  HREF="node167.html#9099">ret-rp</A>
<LI><A ID="tex2html77"
  HREF="node167.html#9103">rr-rz</A>
<LI><A ID="tex2html78"
  HREF="node167.html#9107">sbb-scf</A>
<LI><A ID="tex2html79"
  HREF="node167.html#9111">set 0-set 3</A>
<LI><A ID="tex2html80"
  HREF="node167.html#9115">set 4-set 7</A>
<LI><A ID="tex2html81"
  HREF="node167.html#9119">setae-stc</A>
<LI><A ID="tex2html82"
  HREF="node167.html#9123">sub-xthl</A></OL>
<BR><HR>

</BODY>
</HTML>
node200.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>Index</TITLE>
<META NAME="description" CONTENT="Index">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node201.html">
<LINK REL="previous" HREF="node199.html">
<LINK REL="next" HREF="node201.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node201.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node199.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1469"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Next:</B> <A
 HREF="node201.html">About this document ...</A>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node199.html">List of Tables</A>
 &nbsp; <B>  <A ID="tex2html1470"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<BR>

<H2><A ID="SECTION002000000000000000000">
Index</A>
</H2><DL COMPACT>
<DT><STRONG>access drive</STRONG>
<DD><A HREF="node139.html#3641">BDOS</A>
<DT><STRONG>auxiliary input</STRONG>
<DD><A HREF="node139.html#3392">BDOS</A>
<DT><STRONG>auxiliary input status</STRONG>
<DD><A HREF="node139.html#3414">BDOS</A>
<DT><STRONG>auxiliary output</STRONG>
<DD><A HREF="node139.html#3398">BDOS</A>
<DT><STRONG>auxiliary output status</STRONG>
<DD><A HREF="node139.html#3420">BDOS</A>
<DT><STRONG>AUXIN</STRONG>
<DD><A HREF="node142.html#3908">Character I/O Functions</A>
<DT><STRONG>AUXIST</STRONG>
<DD><A HREF="node142.html#3915">Character I/O Functions</A>
<DT><STRONG>AUXOST</STRONG>
<DD><A HREF="node142.html#3918">Character I/O Functions</A>
<DT><STRONG>AUXOUT</STRONG>
<DD><A HREF="node142.html#3907">Character I/O Functions</A>
<DT><STRONG>BOOT</STRONG>
<DD><A HREF="node141.html#3893">System Initialization Functions</A>
<DT><STRONG>call resident system extension</STRONG>
<DD><A HREF="node139.html#3734">BDOS</A>
<DT><STRONG>chain to program</STRONG>
<DD><A HREF="node139.html#3693">BDOS</A>
<DT><STRONG>clip window</STRONG>
<DD><A HREF="node43.html#378">Programming Tilemap mode</A>
 | <A HREF="node55.html#579">Global Control of Sprites</A>
<DT><STRONG>close file</STRONG>
<DD><A HREF="node139.html#3472">BDOS</A>
<DT><STRONG>compute file size</STRONG>
<DD><A HREF="node139.html#3621">BDOS</A>
<DT><STRONG>CONIN</STRONG>
<DD><A HREF="node142.html#3904">Character I/O Functions</A>
<DT><STRONG>CONOST</STRONG>
<DD><A HREF="node142.html#3912">Character I/O Functions</A>
<DT><STRONG>CONOUT</STRONG>
<DD><A HREF="node142.html#3905">Character I/O Functions</A>
<DT><STRONG>console input</STRONG>
<DD><A HREF="node139.html#3382">BDOS</A>
<DT><STRONG>console output</STRONG>
<DD><A HREF="node139.html#3388">BDOS</A>
<DT><STRONG>CONST</STRONG>
<DD><A HREF="node142.html#3901">Character I/O Functions</A>
<DT><STRONG>delete file</STRONG>
<DD><A HREF="node139.html#3498">BDOS</A>
<DT><STRONG>DEVINI</STRONG>
<DD><A HREF="node141.html#3896">System Initialization Functions</A>
<DT><STRONG>DEVTBL</STRONG>
<DD><A HREF="node141.html#3895">System Initialization Functions</A>
<DT><STRONG>direct BIOS calls</STRONG>
<DD><A HREF="node139.html#3720">BDOS</A>
<DT><STRONG>direct console I/O</STRONG>
<DD><A HREF="node139.html#3406">BDOS</A>
<DT><STRONG>DOS_CATALOG</STRONG>
<DD><A HREF="node148.html#4014">+3DOS compatible API</A>
<DT><STRONG>DOS_FREE_SPACE</STRONG>
<DD><A HREF="node148.html#4016">+3DOS compatible API</A>
<DT><STRONG>DOS_GET_EOF</STRONG>
<DD><A HREF="node148.html#4026">+3DOS compatible API</A>
<DT><STRONG>DOS_GET_POSITION</STRONG>
<DD><A HREF="node148.html#4023">+3DOS compatible API</A>
<DT><STRONG>DOS_OPEN</STRONG>
<DD><A HREF="node148.html#4005">+3DOS compatible API</A>
<DT><STRONG>DRVTBL</STRONG>
<DD><A HREF="node141.html#3897">System Initialization Functions</A>
<DT><STRONG>FLUSH</STRONG>
<DD><A HREF="node143.html#3943">Disk I/O Functions</A>
<DT><STRONG>flush buffers</STRONG>
<DD><A HREF="node139.html#3697">BDOS</A>
<DT><STRONG>free blocks</STRONG>
<DD><A HREF="node139.html#3742">BDOS</A>
<DT><STRONG>free drive</STRONG>
<DD><A HREF="node139.html#3645">BDOS</A>
<DT><STRONG>get addr(alloc)</STRONG>
<DD><A HREF="node139.html#3562">BDOS</A>
<DT><STRONG>get addr(DPB parms)</STRONG>
<DD><A HREF="node139.html#3588">BDOS</A>
<DT><STRONG>get console mode</STRONG>
<DD><A HREF="node139.html#3841">BDOS</A>
<DT><STRONG>get console status</STRONG>
<DD><A HREF="node139.html#3440">BDOS</A>
<DT><STRONG>get date and time</STRONG>
<DD><A HREF="node139.html#3810">BDOS</A>
<DT><STRONG>get disk free space</STRONG>
<DD><A HREF="node139.html#3685">BDOS</A>
<DT><STRONG>get output delimiter</STRONG>
<DD><A HREF="node139.html#3852">BDOS</A>
<DT><STRONG>get program return code</STRONG>
<DD><A HREF="node139.html#3828">BDOS</A>
<DT><STRONG>get read-only vector</STRONG>
<DD><A HREF="node139.html#3572">BDOS</A>
<DT><STRONG>get system control bock</STRONG>
<DD><A HREF="node139.html#3705">BDOS</A>
<DT><STRONG>get user code</STRONG>
<DD><A HREF="node139.html#3594">BDOS</A>
<DT><STRONG>HOME</STRONG>
<DD><A HREF="node143.html#3922">Disk I/O Functions</A>
<DT><STRONG>IDE_BANK</STRONG>
<DD><A HREF="node148.html#4071">+3DOS compatible API</A>
<DT><STRONG>IDE_BROWSER</STRONG>
<DD><A HREF="node148.html#4069">+3DOS compatible API</A>
<DT><STRONG>IDE_CAPACITY</STRONG>
<DD><A HREF="node148.html#4065">+3DOS compatible API</A>
<DT><STRONG>IDE_DOS_MAP</STRONG>
<DD><A HREF="node148.html#3994">+3DOS compatible API</A>
<DT><STRONG>IDE_DOS_MAPPING</STRONG>
<DD><A HREF="node148.html#3998">+3DOS compatible API</A>
<DT><STRONG>IDE_DOS_UNMAP</STRONG>
<DD><A HREF="node148.html#3996">+3DOS compatible API</A>
<DT><STRONG>IDE_GET_LFN</STRONG>
<DD><A HREF="node148.html#4067">+3DOS compatible API</A>
<DT><STRONG>IDE_PATH</STRONG>
<DD><A HREF="node148.html#4063">+3DOS compatible API</A>
<DT><STRONG>IDE_SNAPLOAD</STRONG>
<DD><A HREF="node148.html#4001">+3DOS compatible API</A>
<DT><STRONG>IDE_SWAP_EX</STRONG>
<DD><A HREF="node148.html#3989">+3DOS compatible API</A>
<DT><STRONG>IDE_SWAP_OPEN</STRONG>
<DD><A HREF="node148.html#3984">+3DOS compatible API</A>
<DT><STRONG>LIST</STRONG>
<DD><A HREF="node142.html#3906">Character I/O Functions</A>
<DT><STRONG>list block</STRONG>
<DD><A HREF="node139.html#3867">BDOS</A>
<DT><STRONG>list output</STRONG>
<DD><A HREF="node139.html#3402">BDOS</A>
<DT><STRONG>LISTST</STRONG>
<DD><A HREF="node142.html#3909">Character I/O Functions</A>
<DT><STRONG>load overlay</STRONG>
<DD><A HREF="node139.html#3728">BDOS</A>
<DT><STRONG>lock record</STRONG>
<DD><A HREF="node139.html#3661">BDOS</A>
<DT><STRONG>make file</STRONG>
<DD><A HREF="node139.html#3528">BDOS</A>
<DT><STRONG>MOVE</STRONG>
<DD><A HREF="node144.html#3947">Memory Select and Move</A>
<DT><STRONG>MULTIO</STRONG>
<DD><A HREF="node143.html#3942">Disk I/O Functions</A>
<DT><STRONG>open file</STRONG>
<DD><A HREF="node139.html#3464">BDOS</A>
<DT><STRONG>palette</STRONG>
<DD><A HREF="node6.html#112">Palette</A>
 | <A HREF="node51.html#433">Sprite Palette</A>
<DT><STRONG>parse filename</STRONG>
<DD><A HREF="node139.html#3875">BDOS</A>
<DT><STRONG>print block</STRONG>
<DD><A HREF="node139.html#3859">BDOS</A>
<DT><STRONG>print string</STRONG>
<DD><A HREF="node139.html#3426">BDOS</A>
<DT><STRONG>READ</STRONG>
<DD><A HREF="node143.html#3931">Disk I/O Functions</A>
<DT><STRONG>read console buffer</STRONG>
<DD><A HREF="node139.html#3430">BDOS</A>
<DT><STRONG>read file date stamps and password mode</STRONG>
<DD><A HREF="node139.html#3778">BDOS</A>
<DT><STRONG>read random</STRONG>
<DD><A HREF="node139.html#3601">BDOS</A>
<DT><STRONG>read sequential</STRONG>
<DD><A HREF="node139.html#3508">BDOS</A>
<DT><STRONG>rename file</STRONG>
<DD><A HREF="node139.html#3538">BDOS</A>
<DT><STRONG>reset disk system</STRONG>
<DD><A HREF="node139.html#3452">BDOS</A>
<DT><STRONG>reset drive</STRONG>
<DD><A HREF="node139.html#3635">BDOS</A>
<DT><STRONG>return current disk</STRONG>
<DD><A HREF="node139.html#3552">BDOS</A>
<DT><STRONG>return directory label data</STRONG>
<DD><A HREF="node139.html#3768">BDOS</A>
<DT><STRONG>return login vector</STRONG>
<DD><A HREF="node139.html#3546">BDOS</A>
<DT><STRONG>return serial number</STRONG>
<DD><A HREF="node139.html#3822">BDOS</A>
<DT><STRONG>return version number</STRONG>
<DD><A HREF="node139.html#3446">BDOS</A>
<DT><STRONG>scroll offset</STRONG>
<DD><A HREF="node43.html#386">Programming Tilemap mode</A>
<DT><STRONG>search for first</STRONG>
<DD><A HREF="node139.html#3482">BDOS</A>
<DT><STRONG>search for next</STRONG>
<DD><A HREF="node139.html#3492">BDOS</A>
<DT><STRONG>SECTRN</STRONG>
<DD><A HREF="node143.html#3939">Disk I/O Functions</A>
<DT><STRONG>SELDSK</STRONG>
<DD><A HREF="node143.html#3923">Disk I/O Functions</A>
<DT><STRONG>select disk</STRONG>
<DD><A HREF="node139.html#3456">BDOS</A>
<DT><STRONG>SELMEM</STRONG>
<DD><A HREF="node144.html#3950">Memory Select and Move</A>
<DT><STRONG>set BDOS error mode</STRONG>
<DD><A HREF="node139.html#3679">BDOS</A>
<DT><STRONG>set console mode</STRONG>
<DD><A HREF="node139.html#3842">BDOS</A>
<DT><STRONG>set date and time</STRONG>
<DD><A HREF="node139.html#3802">BDOS</A>
<DT><STRONG>set default password</STRONG>
<DD><A HREF="node139.html#3816">BDOS</A>
<DT><STRONG>set directory label</STRONG>
<DD><A HREF="node139.html#3758">BDOS</A>
<DT><STRONG>set dma address</STRONG>
<DD><A HREF="node139.html#3558">BDOS</A>
<DT><STRONG>set file attributes</STRONG>
<DD><A HREF="node139.html#3578">BDOS</A>
<DT><STRONG>set multi-sector count</STRONG>
<DD><A HREF="node139.html#3673">BDOS</A>
<DT><STRONG>set output delimiter</STRONG>
<DD><A HREF="node139.html#3853">BDOS</A>
<DT><STRONG>set program return code</STRONG>
<DD><A HREF="node139.html#3829">BDOS</A>
<DT><STRONG>set random record</STRONG>
<DD><A HREF="node139.html#3629">BDOS</A>
<DT><STRONG>set system control bock</STRONG>
<DD><A HREF="node139.html#3706">BDOS</A>
<DT><STRONG>set user code</STRONG>
<DD><A HREF="node139.html#3595">BDOS</A>
<DT><STRONG>SETBNK</STRONG>
<DD><A HREF="node144.html#3951">Memory Select and Move</A>
<DT><STRONG>SETDMA</STRONG>
<DD><A HREF="node143.html#3930">Disk I/O Functions</A>
<DT><STRONG>SETSEC</STRONG>
<DD><A HREF="node143.html#3929">Disk I/O Functions</A>
<DT><STRONG>SETTRK</STRONG>
<DD><A HREF="node143.html#3928">Disk I/O Functions</A>
<DT><STRONG>system reset</STRONG>
<DD><A HREF="node139.html#3378">BDOS</A>
<DT><STRONG>test and write record</STRONG>
<DD><A HREF="node139.html#3655">BDOS</A>
<DT><STRONG>TIME</STRONG>
<DD><A HREF="node145.html#3956">Clock Support Function</A>
<DT><STRONG>transparency</STRONG>
<DD><A HREF="node5.html#90">Video Layering and Transparency</A>
 | <A HREF="node43.html#372">Programming Tilemap mode</A>
 | <A HREF="node55.html#594">Global Control of Sprites</A>
<DT><STRONG>truncate file</STRONG>
<DD><A HREF="node139.html#3750">BDOS</A>
<DT><STRONG>unlock record</STRONG>
<DD><A HREF="node139.html#3667">BDOS</A>
<DT><STRONG>WBOOT</STRONG>
<DD><A HREF="node141.html#3894">System Initialization Functions</A>
<DT><STRONG>WRITE</STRONG>
<DD><A HREF="node143.html#3934">Disk I/O Functions</A>
<DT><STRONG>write file XFCB</STRONG>
<DD><A HREF="node139.html#3792">BDOS</A>
<DT><STRONG>write protect disk</STRONG>
<DD><A HREF="node139.html#3568">BDOS</A>
<DT><STRONG>write random</STRONG>
<DD><A HREF="node139.html#3611">BDOS</A>
<DT><STRONG>write random with zero fill</STRONG>
<DD><A HREF="node139.html#3649">BDOS</A>
<DT><STRONG>write sequential</STRONG>
<DD><A HREF="node139.html#3518">BDOS</A>
<DT><STRONG>XMOVE</STRONG>
<DD><A HREF="node144.html#3952">Memory Select and Move</A>

</DL>
<BR><HR>

</BODY>
</HTML>
node201.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>About this document ...</TITLE>
<META NAME="description" CONTENT="About this document ...">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node200.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next_g.png"> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node200.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1471"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1473"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node200.html">Index</A>
 &nbsp; <B>  <A ID="tex2html1472"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1474"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION002100000000000000000">
About this document ...</A>
</H1>
 <STRONG>ZX Spectrum Next Programming Notes</STRONG><P>
This document was generated using the
<A HREF="http://www.latex2html.org/">LaTeX2HTML</A> translator Version 2020.2 (Released July 1, 2020)
<P>
The command line arguments were: <BR>
 <kbd>latex2html -images zxnext_notes.tex</kbd>
<P>
The translation was initiated on 2020-12-04
<BR><HR>

</BODY>
</HTML>
node202.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2019 (Released January 1, 2019) -->
<HTML lang="EN">
<HEAD>
<TITLE>About this document ...</TITLE>
<META NAME="description" CONTENT="About this document ...">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2019">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="previous" HREF="node201.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next_g.png"> 
<A
 HREF="zxnext_notes.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node201.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1483"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1485"
  HREF="node201.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Up:</B> <A
 HREF="zxnext_notes.html">ZX Spectrum Next Programming</A>
<B> Previous:</B> <A
 HREF="node201.html">Index</A>
 &nbsp; <B>  <A ID="tex2html1484"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1486"
  HREF="node201.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION002100000000000000000">
About this document ...</A>
</H1>
 <STRONG>ZX Spectrum Next Programming Notes</STRONG><P>
This document was generated using the
<A HREF="http://www.latex2html.org/">LaTeX2HTML</A> translator Version 2019 (Released January 1, 2019)
<P>
The command line arguments were: <BR>
 <kbd>latex2html zxnext_notes.tex</kbd>
<P>
The translation was initiated on 2020-07-06
<BR><HR>

</BODY>
</HTML>
zxnext_notes.html
<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>ZX Spectrum Next Programming Notes</TITLE>
<META NAME="description" CONTENT="ZX Spectrum Next Programming Notes">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node1.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev_g.png"> 
<A ID="tex2html83"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html85"
  HREF="node200.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node1.html">Contents</A>
 &nbsp; <B>  <A ID="tex2html84"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html86"
  HREF="node200.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1 class="CENTER">ZX Spectrum Next Programming Notes</H1>
<DIV CLASS="author_info">

<STRONG>Theodore (Alex) Evans</STRONG>
<P>
December 4, 2020</P>
</DIV>
<BR><HR>
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"></A>

<UL CLASS="ChildLinks">
@{" Contents " LINK NODE1}
@{" Introduction " LINK NODE2}
@{" Video " LINK NODE3}
@{" General Features " LINK NODE4}
@{" Video Layering and Transparency " LINK NODE5}
@{" Palette " LINK NODE6}
@{" Scrolling " LINK NODE8}
@{" Clipping " LINK NODE9}
</UL>
@{" Layer 1 " LINK NODE10}
@{" Colour Attributes " LINK NODE11}
@{" Layer 1 Scrolling " LINK NODE21}
@{" Layer 1 Clipping " LINK NODE22}
@{" ZX Spectrum Mode " LINK NODE23}
@{" Alternate Page Mode " LINK NODE24}
@{" Timex Hi-Colour Mode " LINK NODE25}
@{" Timex Hi-Resolution Mode " LINK NODE26}
@{" Lo-Resolution Mode " LINK NODE27}
</UL>
@{" Layer 2 " LINK NODE28}
@{" Configuration " LINK NODE29}
@{" Scrolling " LINK NODE34}
@{" Clipping " LINK NODE35}
</UL>
@{" Layer 3 (Tilemap) Mode " LINK NODE36}
@{" General Description " LINK NODE37}
@{" Data Structures " LINK NODE38}
@{" Memory Organization &amp; Display Layer " LINK NODE41}
@{" Combining ULA &amp; Tilemap " LINK NODE42}
@{" Programming Tilemap mode " LINK NODE43}
</UL>
@{" Sprites " LINK NODE46}
@{" Sprite Patterns " LINK NODE47}
@{" Sprite Palette " LINK NODE51}
@{" Sprite Attributes " LINK NODE52}
@{" Relative Sprites " LINK NODE53}
@{" Programming Sprites " LINK NODE54}
@{" Global Control of Sprites " LINK NODE55}
</UL>
</UL>
<BR>
@{" Audio " LINK NODE56}
@{" ZX Spectrum 1-bit " LINK NODE57}
@{" Sampled 8-bit " LINK NODE58}
@{" Turbosound " LINK NODE59}
@{" Pi Audio " LINK NODE60}
</UL>
</UL>
<BR>
@{" Memory " LINK NODE61}
@{" Memory Management " LINK NODE62}
@{" Default Layout " LINK NODE63}
@{" RAM " LINK NODE64}
@{" ROM " LINK NODE70}
</UL>
@{" Interactions between paging methods " LINK NODE76}
@{" Memory Map " LINK NODE77}
@{" Global Memory Map " LINK NODE78}
@{" Z80 Visible Memory Map " LINK NODE79}
</UL>
</UL>
<BR>
@{" zxnDMA " LINK NODE80}
@{" Overview " LINK NODE81}
@{" Accessing the zxnDMA " LINK NODE82}
@{" Description " LINK NODE83}
@{" Modes of Operation " LINK NODE84}
@{" Programming the zxnDMA " LINK NODE85}
@{" zxnDMA Registers " LINK NODE86}
@{" Programming examples " LINK NODE96}
</UL>
<BR>
@{" Copper and Display Timing " LINK NODE97}
@{" Timing " LINK NODE100}
@{" Instructions " LINK NODE108}
@{" Control " LINK NODE113}
@{" Configuration " LINK NODE118}
</UL>
<BR>
@{" Interrupts " LINK NODE123}
@{" Interrupt Types " LINK NODE124}
@{" Interrupt Modes " LINK NODE128}
@{" Z80 CTC " LINK NODE132}
</UL>
<BR>
@{" Serial Communication " LINK NODE134}
@{" Raspberry Pi0 Acceleration " LINK NODE135}
@{" System Software " LINK NODE136}
@{" CP/M " LINK NODE137}
@{" Utilities " LINK NODE138}
@{" BDOS " LINK NODE139}
@{" BIOS " LINK NODE140}
@{" System Initialization Functions " LINK NODE141}
@{" Character I/O Functions " LINK NODE142}
@{" Disk I/O Functions " LINK NODE143}
</UL>
@{" Memory Select and Move Functions " LINK NODE144}
@{" Clock Support Function " LINK NODE145}
</UL>
</UL>
@{" NextZXOS " LINK NODE146}
@{" NextZXOS " LINK NODE147}
@{" +3DOS compatible API " LINK NODE148}
@{" esxDOS compatible API " LINK NODE149}
@{" Next Extensions " LINK NODE150}
@{" esxDOS compatible API " LINK NODE151}
</UL>
</UL>
<BR>
@{" Ports " LINK NODE152}
@{" 8-bit " LINK NODE153}
@{" 16-bit " LINK NODE154}
</UL>
<BR>
@{" Registers " LINK NODE155}
@{" ZX Spectrum Next Registers " LINK NODE156}
@{" AY-3-8912 " LINK NODE157}
@{" zxDMA " LINK NODE158}
</UL>
<BR>
@{" Extended Opcodes to Mnemonics " LINK NODE159}
@{" Single Byte Opcodes " LINK NODE160}
@{" $CBxx Bit Operations " LINK NODE161}
@{" $DDxx IX " LINK NODE162}
@{" $EDxx Block/Port " LINK NODE163}
@{" $FDxx IY " LINK NODE164}
@{" $DDCBxx IX Bit Operations " LINK NODE165}
@{" $FDCBxx IY Bit Operations " LINK NODE166}
</UL>
<BR>
@{" Mnemonics to Extended Opcodes " LINK NODE167}
@{" File Formats " LINK NODE168}
@{" BAS " LINK NODE169}
@{" BMP " LINK NODE170}
@{" DSK " LINK NODE171}
@{" NDR " LINK NODE172}
@{" NEX " LINK NODE173}
@{" O " LINK NODE174}
@{" P3D " LINK NODE175}
@{" PT3 " LINK NODE176}
@{" P " LINK NODE177}
@{" SCR " LINK NODE178}
@{" SHC " LINK NODE179}
@{" SHR " LINK NODE180}
@{" SL2 " LINK NODE181}
@{" SLR " LINK NODE182}
@{" SNA " LINK NODE183}
@{" SNX " LINK NODE184}
@{" SPR " LINK NODE185}
@{" TAP " LINK NODE186}
@{" TXT,DOC,ASM,INI,CFG,MD " LINK NODE187}
@{" TZX " LINK NODE188}
@{" Z3 to Z8 " LINK NODE189}
@{" Z80 " LINK NODE190}
</UL>
<BR>
@{" Call Tables " LINK NODE191}
@{" BDOS Call Table " LINK NODE192}
@{" BIOS Call Table " LINK NODE193}
@{" NextZXOS Calls " LINK NODE194}
@{" +3DOS Compatible Calls " LINK NODE195}
@{" +3DOS compatible error codes " LINK NODE196}
@{" esxDOS Compatible Calls " LINK NODE197}
</UL>
</UL>
<BR>
@{" List of Figures " LINK NODE198}
@{" List of Tables " LINK NODE199}
@{" Index " LINK NODE200}
@{" About this document ... " LINK NODE201}
</UL>
<!--End of Table of Child-Links-->
<BR><HR>

</BODY>
</HTML>
