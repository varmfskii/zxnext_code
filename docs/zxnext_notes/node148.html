<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020.2 (Released July 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>+3DOS compatible API</TITLE>
<META NAME="description" CONTENT="+3DOS compatible API">
<META NAME="keywords" CONTENT="zxnext_notes">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020.2">

<LINK REL="STYLESHEET" HREF="zxnext_notes.css">

<LINK REL="next" HREF="node149.html">
<LINK REL="previous" HREF="node147.html">
<LINK REL="next" HREF="node149.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node149.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1244"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1246"
  HREF="node213.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node149.html">esxDOS compatible API</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node147.html">NextZXOS</A>
 &nbsp; <B>  <A ID="tex2html1245"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1247"
  HREF="node213.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION001131000000000000000">
+3DOS compatible API</A>
</H2>
Generally to make these calls, you need to set up: place ROM 2 at
$0000-$3fff, RAM bank 7 at $c000-$ffff, stack below $bfe0, and
set up the parameters for the call in the indicated registers. Call
the function at its address. Then, restore your system to its previous
configuration. In general the carry bit of F is cleared on error with
the error code in A. Calls generally affect the contnts of AF, BC, DE,
HL, and IX leaving AF', BC', DE', HL', IY, and SP intact. To simplify,
descriptions will assume this is true and only indicate exceptions to
the rule.

<P>
$0056 <SPAN  CLASS="textbf">IDE_STREAM_OPEN</SPAN>

<P>
Open stream to a channel

<P>
$0059 <SPAN  CLASS="textbf">IDE_STREAM_CLOSE</SPAN>

<P>
Close stream and attached channel

<P>
$005c <SPAN  CLASS="textbf">IDE_STREAM_IN</SPAN>

<P>
Get byte from current stream

<P>
$005f <SPAN  CLASS="textbf">IDE_STREAM_OUT</SPAN>

<P>
Write byte to current stream

<P>
$0062 <SPAN  CLASS="textbf">IDE_STREAM_PTR</SPAN>

<P>
Get or set pointer information for current stream

<P>
$00A0 <SPAN  CLASS="textbf">IDE_VERSION</SPAN>

<P>
Get IDEDOS version number

<P>
$00A3 <SPAN  CLASS="textbf">IDE_INTERFACE</SPAN>

<P>
Initialise card interfaces

<P>
$00A6 <SPAN  CLASS="textbf">IDE_INIT</SPAN>

<P>
Initialise IDEDOS

<P>
$00A9 <SPAN  CLASS="textbf">IDE_DRIVE</SPAN>

<P>
Get unit handle

<P>
$00AC <SPAN  CLASS="textbf">IDE_SECTOR_READ</SPAN>

<P>
Low-level sector read

<P>
$00AF <SPAN  CLASS="textbf">IDE_SECTOR_WRITE</SPAN>

<P>
Low-level sector write

<P>
$00B2 <SPAN  CLASS="textbf">IDE_FORMAT</SPAN>

<P>
Format a partition

<P>
$00B5 <SPAN  CLASS="textbf">IDE_PARTITION_FIND</SPAN>

<P>
Find named partition

<P>
$00B8 <SPAN  CLASS="textbf">IDE_PARTITION_NEW</SPAN>

<P>
Create partition

<P>
$00BB <SPAN  CLASS="textbf">IDE_PARTITION_INIT</SPAN>

<P>
Initialise partition

<P>
$00BE <SPAN  CLASS="textbf">IDE_PARTITION_ERASE</SPAN>

<P>
Delete a partition

<P>
$00C1 <SPAN  CLASS="textbf">IDE_PARTITION_RENAME</SPAN>

<P>
Rename a partition

<P>
$00C4 <SPAN  CLASS="textbf">IDE_PARTITON_READ</SPAN>

<P>
Read a partition entry

<P>
$00C7 <SPAN  CLASS="textbf">IDE_PARTITION_WRITE</SPAN>

<P>
Write a partition entry

<P>
$00CA <SPAN  CLASS="textbf">IDE_PARTITION_WINFO</SPAN>

<P>
Write type-specific partition information

<P>
$00CD <SPAN  CLASS="textbf">IDE_PARTITION_OPEN</SPAN>

<P>
Open a partition

<P>
$00D0 <SPAN  CLASS="textbf">IDE_PARTITION_CLOSE</SPAN>

<P>
Close a partition

<P>
$00D3 <SPAN  CLASS="textbf">IDE_PARTITION_GETINFO</SPAN>

<P>
Get byte from type-specific partition information

<P>
$00D6 <SPAN  CLASS="textbf">IDE_PARTITION_SETINFO</SPAN>

<P>
Set byte in type-specific partition information

<P>
<A NAME="3984"></A>
$00D9 (217) <SPAN  CLASS="textbf">IDE_SWAP_OPEN</SPAN>

<P>
Open a swap partition (file)

<P>
$00DC <SPAN  CLASS="textbf">IDE_SWAP_CLOSE</SPAN>

<P>
Close a swap partition

<P>
$00DF <SPAN  CLASS="textbf">IDE_SWAP_OUT</SPAN>

<P>
Write block to swap partition

<P>
$00E2 <SPAN  CLASS="textbf">IDE_SWAP_IN</SPAN>

<P>
Read block from swap partition

<P>
<A NAME="3989"></A>
$00E5 (231) <SPAN  CLASS="textbf">IDE_SWAP_EX</SPAN>

<P>
Exchange block with swap partition

<P>
Deprecated, use IDE_SWAP_IN and IDE_SWAP_OUT

<P>
$00E8 <SPAN  CLASS="textbf">IDE_SWAP_POS</SPAN>

<P>
Get current block number in swap partition

<P>
$00EB <SPAN  CLASS="textbf">IDE_SWAP_MOVE</SPAN>

<P>
Set current block number in swap partition

<P>
$00EE <SPAN  CLASS="textbf">IDE_SWAP_RESIZE</SPAN>

<P>
Change block size of swap partition

<P>
<A NAME="3994"></A>
$00F1 (241) <SPAN  CLASS="textbf">IDE_DOS_MAP</SPAN>

<P>
Map drive to partition or physical device

<P>
<A NAME="3996"></A>
$00F4 (244) <SPAN  CLASS="textbf">IDE_DOS_UNMAP</SPAN>

<P>
Unmap drive

<P>
<A NAME="3998"></A>
$00F7 (247) <SPAN  CLASS="textbf">IDE_DOS_MAPPING</SPAN>

<P>
Get drive mapping

<P>
$00FA <SPAN  CLASS="textbf">IDE_DOS_UNPERMANENT</SPAN>

<P>
Remove permanent drive mapping

<P>
<A NAME="4001"></A>
$00FD (253) <SPAN  CLASS="textbf">IDE_SNAPLOAD</SPAN>

<P>
Load a snapshot

<P>
$0100 <SPAN  CLASS="textbf">DOS_INITIALISE</SPAN>

<P>
Initialise +3DOS

<P>
$0103 <SPAN  CLASS="textbf">DOS_VERSION</SPAN>

<P>
Get +3DOS issue and version numbers

<P>
<A NAME="4005"></A>
$0106 (262) <SPAN  CLASS="textbf">DOS_OPEN</SPAN>

<P>
Create and/or open a file

<P>
$0109 <SPAN  CLASS="textbf">DOS_CLOSE</SPAN>

<P>
Close a file

<P>
$010C <SPAN  CLASS="textbf">DOS_ABANDON</SPAN>

<P>
Abandon a file

<P>
$010F <SPAN  CLASS="textbf">DOS_REF_HEAD</SPAN>

<P>
Point at the header data for this file

<P>
$0112 <SPAN  CLASS="textbf">DOS_READ</SPAN>

<P>
Read bytes into memory

<P>
$0115 <SPAN  CLASS="textbf">DOS_WRITE</SPAN>

<P>
Write bytes from memory

<P>
$0118 <SPAN  CLASS="textbf">DOS_BYTE_READ</SPAN>

<P>
Read a byte

<P>
$011B <SPAN  CLASS="textbf">DOS_BYTE_WRITE</SPAN>

<P>
Write a byte

<P>
<A NAME="4014"></A>
$011E (286) <SPAN  CLASS="textbf">DOS_CATALOG</SPAN>

<P>
Catalog disk directory

<P>
<A NAME="4016"></A>
$0121 (289) <SPAN  CLASS="textbf">DOS_FREE_SPACE</SPAN>

<P>
Free space on disk

<P>
$0124 <SPAN  CLASS="textbf">DOS_DELETE</SPAN>

<P>
Delete a file

<P>
$0127 <SPAN  CLASS="textbf">DOS_RENAME</SPAN>

<P>
Rename a file

<P>
$012A <SPAN  CLASS="textbf">DOS_BOOT</SPAN>

<P>
Boot an operating system or other program

<P>
$012D <SPAN  CLASS="textbf">DOS_SET_DRIVE</SPAN>

<P>
Set/get default drive

<P>
$0130 <SPAN  CLASS="textbf">DOS_SET_USER</SPAN>

<P>
Set/get default user number

<P>
<A NAME="4023"></A>
$0133 (307) <SPAN  CLASS="textbf">DOS_GET_POSITION</SPAN>

<P>
Get file pointer for random access

<P>
$0136 <SPAN  CLASS="textbf">DOS_SET_POSITION</SPAN>

<P>
Set file pointer for random access

<P>
<A NAME="4026"></A>
$0139 (313) <SPAN  CLASS="textbf">DOS_GET_EOF</SPAN>

<P>
Get end of file position for random access

<P>
$013C <SPAN  CLASS="textbf">DOS_GET_1346</SPAN>

<P>
Get memory usage in pages 1&nbsp; 3&nbsp; 4&nbsp; 6

<P>
$013F <SPAN  CLASS="textbf">DOS_SET_1346</SPAN>

<P>
Re-allocate memory usage in pages 1&nbsp; 3&nbsp; 4&nbsp; 6

<P>
$0142 <SPAN  CLASS="textbf">DOS_FLUSH</SPAN>

<P>
Bring disk up to date

<P>
$0145 <SPAN  CLASS="textbf">DOS_SET_ACCESS</SPAN>

<P>
Change open file's access mode

<P>
$0148 <SPAN  CLASS="textbf">DOS_SET_ATTRIBUTES</SPAN>

<P>
Change a file's attributes

<P>
$014B <SPAN  CLASS="textbf">DOS_OPEN_DRIVE</SPAN>

<P>
Open a drive as a single file

<P>
$014E <SPAN  CLASS="textbf">DOS_SET_MESSAGE</SPAN>

<P>
Enable/disable error messages

<P>
$0151 <SPAN  CLASS="textbf">DOS_REF_XDPB</SPAN>

<P>
Point at XDPB for low level disk access

<P>
$0154 <SPAN  CLASS="textbf">DOS_MAP_B</SPAN>

<P>
Map B: onto unit 0 or 1

<P>
$0157 <SPAN  CLASS="textbf">DD_INTERFACE</SPAN>

<P>
Is the floppy disk driver interface present?

<P>
$015A <SPAN  CLASS="textbf">DD_INIT</SPAN>

<P>
Initialise disk driver

<P>
$015D <SPAN  CLASS="textbf">DD_SETUP</SPAN>

<P>
Specify drive parameters

<P>
$0160 <SPAN  CLASS="textbf">DD_SET_RETRY</SPAN>

<P>
Set try/retry count

<P>
$0163 <SPAN  CLASS="textbf">DD_READ_SECTOR</SPAN>

<P>
Read a sector

<P>
$0166 <SPAN  CLASS="textbf">DD_WRITE_SECTOR</SPAN>

<P>
Write a sector

<P>
$0169 <SPAN  CLASS="textbf">DD_CHECK_SECTOR</SPAN>

<P>
Check a sector

<P>
$016C <SPAN  CLASS="textbf">DD_FORMAT</SPAN>

<P>
Format a track

<P>
$016F <SPAN  CLASS="textbf">DD_READ_ID</SPAN>

<P>
Read a sector identifier

<P>
$0172 <SPAN  CLASS="textbf">DD_TEST_UNSUITABLE</SPAN>

<P>
Test media suitability

<P>
$0175 <SPAN  CLASS="textbf">DD_LOGIN</SPAN>

<P>
Log in disk, initialise XDPB

<P>
$0178 <SPAN  CLASS="textbf">DD_SEL_FORMAT</SPAN>

<P>
Pre-initialise XDPB for DD FORMAT

<P>
$017B <SPAN  CLASS="textbf">DD_ASK_1</SPAN>

<P>
Is unit 1 (external drive) present?

<P>
$017E <SPAN  CLASS="textbf">DD_DRIVE_STATUS</SPAN>

<P>
Fetch drive status

<P>
$0181 <SPAN  CLASS="textbf">DD_EQUIPMENT</SPAN>

<P>
What type of drive?

<P>
$0184 <SPAN  CLASS="textbf">DD_ENCODE</SPAN>

<P>
Set intercept routine for copy protection

<P>
$0187 <SPAN  CLASS="textbf">DD_L_XDPB</SPAN>

<P>
Initialise an XDPB from a disk specification

<P>
$018A <SPAN  CLASS="textbf">DD_L_DPB</SPAN>

<P>
Initialise a DPB from a disk specification

<P>
$018D <SPAN  CLASS="textbf">DD_L_SEEK</SPAN>

<P>
uPD765A seek driver

<P>
$0190 <SPAN  CLASS="textbf">DD_L_READ</SPAN>

<P>
uPD765A read driver

<P>
$0193 <SPAN  CLASS="textbf">DD_L_WRITE</SPAN>

<P>
uPD765A write driver

<P>
$0196 <SPAN  CLASS="textbf">DD_L_ON_MOTOR</SPAN>

<P>
Motor on, wait for motor-on time

<P>
$0199 <SPAN  CLASS="textbf">DD_L_T_OFF_MOTOR</SPAN>

<P>
Start the motor-off ticker

<P>
$019C <SPAN  CLASS="textbf">DD_L_OFF_MOTOR</SPAN>

<P>
Turn the motor off

<P>
$01a2 <SPAN  CLASS="textbf">IDE_IDENTIFY</SPAN>

<P>
Return IDE drive identity information

<P>
$01a5 <SPAN  CLASS="textbf">IDE_PARTITIONS</SPAN>

<P>
Get number of open partitions

<P>
<A NAME="4063"></A>
$01b1 (433) <SPAN  CLASS="textbf">IDE_PATH</SPAN>

<P>
Create, delete, change or get directory

<P>
<A NAME="4065"></A>
$01b4 (436) <SPAN  CLASS="textbf">IDE_CAPACITY</SPAN>

<P>
Get card capacity

<P>
<A NAME="4067"></A>
$01b7 (439) <SPAN  CLASS="textbf">IDE_GET_LFN</SPAN>

<P>
Get long filename

<P>
Obtain a long file name and other file information.

<P>
<A NAME="4069"></A>
$01ba (442) <SPAN  CLASS="textbf">IDE_BROWSER</SPAN>

<P>
File browser

<P>
<A NAME="4071"></A>
$01bd (445) <SPAN  CLASS="textbf">IDE_BANK</SPAN>

<P>
Allocate or free 8K pages in ZX or DivMMC memory

<P>
$01c0 <SPAN  CLASS="textbf">IDE_BASIC</SPAN>

<P>
Execute a BASIC command line

<P>
$01c3 <SPAN  CLASS="textbf">IDE_WINDOW_LINEIN</SPAN>

<P>
Input line from current window stream

<P>
$01c6 <SPAN  CLASS="textbf">IDE_WINDOW_STRING</SPAN>

<P>
Output string to current window stream

<P>
$01c9 <SPAN  CLASS="textbf">IDE_INTEGER_VAR</SPAN>

<P>
Get or set NextBASIC integer variable

<P>
$01cc <SPAN  CLASS="textbf">IDE_RTC</SPAN>

<P>
Query the real-time-clock module

<P>
$01cf <SPAN  CLASS="textbf">IDE_DRIVER</SPAN>

<P>
Access the driver API

<P>
$01d2 <SPAN  CLASS="textbf">IDE_MOUNT</SPAN>

<P>
Unmount/remount SD cards

<P>
$01d2 <SPAN  CLASS="textbf">IDE_MOUNT</SPAN>

<P>
Unmount/remount SD cards

<P>
$01d5 <SPAN  CLASS="textbf">IDE_MODE</SPAN>

<P>
Query NextBASIC display mode info, or change mode

<P>
$01d8 <SPAN  CLASS="textbf">IDE_TOKENISER</SPAN>

<P>
Convert BASIC between plain text &amp; tokenised forms

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node149.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node147.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1244"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1246"
  HREF="node213.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node149.html">esxDOS compatible API</A>
<B> Up:</B> <A
 HREF="node147.html">NextZXOS</A>
<B> Previous:</B> <A
 HREF="node147.html">NextZXOS</A>
 &nbsp; <B>  <A ID="tex2html1245"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1247"
  HREF="node213.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
